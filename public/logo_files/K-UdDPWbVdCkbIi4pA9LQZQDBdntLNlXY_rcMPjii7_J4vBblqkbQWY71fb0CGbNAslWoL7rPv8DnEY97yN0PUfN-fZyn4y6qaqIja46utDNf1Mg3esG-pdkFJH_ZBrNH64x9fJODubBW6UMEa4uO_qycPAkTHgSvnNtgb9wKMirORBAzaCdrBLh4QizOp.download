;/*FB_PKG_DELIM*/

__d("EncryptedBackupsConstructEchoMessages",["$InternalEnum","EchoMessage","EncryptedBackupsUploadQueueProcessor","LSEBPayloadSerializerError","MAWBridge","MAWBridgeUpload","MAWDbMsgUtil","MAWEBSwitch","MAWEBUploadTrackingUtils","MAWIndexedDb","MAWMediaUtils","MAWMessageSortOrderUtils","MAWMsgType","MAWTransactionMode","MAWUploadMessageTxns","MWEBODSEntityName.enum","ODS","WAErrorMessage","WALogger","WAProtocolMsgId","cr:21382","gkx","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r=c("requireDeferred")("EchoSerializationFailureFalcoEvent").__setRef("EncryptedBackupsConstructEchoMessages"),s=c("requireDeferred")("EchoSerializationSuccessFalcoEvent").__setRef("EncryptedBackupsConstructEchoMessages"),t=c("gkx")("12236"),u=b("$InternalEnum").Mirrored(["FATAL","WARN"]);async function v(a){if(b("cr:21382")==null)return;a.forEach(function(a){a=a.uploadTrackingInstanceKey;a!=null&&d("MAWEBUploadTrackingUtils").addPointWorkerOnly(a,"fire_ebls_upload")});var c=await b("cr:21382").uploadMessagesFromWorker(a);c.success||d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[labyryth_web] uploadMessagesFromWorker failed with error: ",""])),c.error);await Promise.all(a.map(function(a){a=a.uploadTrackingInstanceKey;return a==null?Promise.resolve():d("EncryptedBackupsUploadQueueProcessor").ackWithInstanceKeyWorkerOnly(a,c.success)}))}async function w(a){a.forEach(function(a){a=a.uploadTrackingInstanceKey;a!=null&&d("MAWEBUploadTrackingUtils").addPointWorkerOnly(a,"fire_gql_upload_ui_event")});var b=await d("MAWBridge").getBridge().sendAndReceive("event","uploadMessagesToBackupV2",{checkPoint:[],messages:a,qpl:[]});await Promise.all(a.map(function(a){a=a.uploadTrackingInstanceKey;return a==null?Promise.resolve():d("EncryptedBackupsUploadQueueProcessor").ackWithInstanceKeyWorkerOnly(a,b.success)}))}function x(a,b,c,e,f,g,h){var k=b==null?void 0:b.externalId;if(k==null){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] extId is null, source: ",""])),h);return null}if(b!=null&&c!=null){var l=window.performance.now(),m=d("EchoMessage").encodeEchoMessage(a),n=window.performance.now();g=g==null?void 0:g.get(k);g==null&&d("MAWMediaUtils").getMediaTypeFromMsgType(b.type)!=null&&h==="upload_queue"&&d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] attachmentContextArray is null, type: ",""])),b.type);d("MAWEBUploadTrackingUtils").addUploadTrackingByType("point",f,b.externalId,"construct_echo_success");return d("MAWBridgeUpload").createBridgeUploadMessage({actionType:1,attachmentContextArray:g,authTs:b.serverTs,echoDocument:m,echoEncodingLatencyNs:(n-l)*1e6,errorCode:null,errorMessage:null,messageId:k,messageType:b.type,productType:"msgr",protoMsg:e,sortOrderMs:d("MAWMessageSortOrderUtils").generateAuthoritativeMessageSortOrder(b),threadId:a.threadId,traceId:c,uploadTrackingInstanceKey:d("MAWEBUploadTrackingUtils").getUploadTrackingInstanceKey(f,b.externalId)})}return null}function y(a,b){a!=null&&void r.load().then(function(c){return c.log(function(){return{message_id:a,trace_id:b}})})}function z(a,b){a!=null&&void s.load().then(function(c){return c.log(function(){return{message_id:a,trace_id:b}})})}function A(a,b){return a==null||b==null?null:a.find(function(a){var c=a.originalMsgProtocolId;if(a.backupActionType===2&&c!=null){var e=c.author,f=c.chat;c=c.externalId;if(e!=null&&f!=null&&c!=null)return d("WAProtocolMsgId").equals({author:e,chat:f,externalId:c},b)}return d("WAProtocolMsgId").equals(a.msgId,b)})}function B(a,b,e,f,g,h,i){var j,o=a.echoMessage;if(a.maybeErrorDetail!=null){var p,q;a=a.maybeErrorDetail;var r=a.errorCode,s=a.errorMsg;a=a.uploadErrorType;y((p=f==null||(q=f.msgId)==null?void 0:q.externalId)!=null?p:b.externalId,e);switch(a){case u.WARN:r===c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID?d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["media info invalid thrown from constructEchoMessage, error msg: ",""])),s!=null?s:""):d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["possible error when constructing echo message: ",""])),s!=null?s:"");break;case u.FATAL:d("WALogger").ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["fatal error in the upload message flow, error msg: ",""])),s!=null?s:"");break}if(a===u.WARN||r===c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID){p=a===u.WARN?"possible error when constructing echo message: "+(s!=null?s:""):"media info invalid thrown from constructEchoMessage, error msg: "+(s!=null?s:"");d("WALogger").WARN(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] ",""])),p);d("MAWEBUploadTrackingUtils").addUploadTrackingByType("success",g,b.externalId,"construct_echo_success_media/xma_warn/error",{string:{msg:p}});return null}r=d("MAWBridgeUpload").createBridgeUploadMessage({actionType:1,authTs:b.serverTs,echoDocument:null,echoEncodingLatencyNs:null,errorCode:r,errorMessage:s,messageId:(a=o==null?void 0:o.xOfflineThreadingId)!=null?a:"0",messageType:b.type,protoMsg:f!=null?f:void 0,sortOrderMs:d("MAWMessageSortOrderUtils").generateAuthoritativeMessageSortOrder(b),threadId:(p=o==null?void 0:o.threadId)!=null?p:"0",traceId:e,uploadTrackingInstanceKey:d("MAWEBUploadTrackingUtils").getUploadTrackingInstanceKey(g,b.externalId)});d("MAWEBUploadTrackingUtils").addUploadTrackingByType("fail",g,b.externalId,"construct_echo_failed",{string:{error_description:d("MAWEBUploadTrackingUtils").EBUploadTrackingWorkerFailurePoints.FAILED_TO_CONSTRUCT_ECHO_MESSAGE,errorMsg:s!=null?s:"null error msg, msg type: "+b.type}});return r}if((o==null?void 0:o.xOfflineThreadingId)==null){var v;p=d("MAWBridgeUpload").createBridgeUploadMessage({actionType:1,authTs:b.serverTs,echoDocument:null,echoEncodingLatencyNs:null,errorCode:c("LSEBPayloadSerializerError").OTID_NOT_FOUND_IN_ACT_MESSAGES,errorMessage:null,messageId:"0",messageType:b.type,protoMsg:f!=null?f:void 0,sortOrderMs:d("MAWMessageSortOrderUtils").generateAuthoritativeMessageSortOrder(b),threadId:(a=o==null?void 0:o.threadId)!=null?a:"0",traceId:e,uploadTrackingInstanceKey:d("MAWEBUploadTrackingUtils").getUploadTrackingInstanceKey(g,b.externalId)});d("MAWEBUploadTrackingUtils").addUploadTrackingByType("fail",g,b.externalId,"construct_echo_failed",{string:{error_description:d("MAWEBUploadTrackingUtils").EBUploadTrackingWorkerFailurePoints.FAILED_TO_CONSTRUCT_ECHO_MESSAGE,errorMsg:"oitd not found"}});z((s=f==null||(v=f.msgId)==null?void 0:v.externalId)!=null?s:b.externalId,e);return p}r=x(o,b,e,f!=null?f:void 0,g,h,i);if(r==null)return null;a=r;d("MAWEBUploadTrackingUtils").addUploadTrackingByType("point",g,b.externalId,"issue_message_upload_ui_event",{bool:{echo_deprecation_user:t,echo_document_missing:!t&&!o}});z((s=f==null||(j=f.msgId)==null?void 0:j.externalId)!=null?s:b.externalId,e);return a}async function C(a,b,c,e,f){var g=new Map();a.forEach(function(a){return g.set(a.dbMsg.externalId,a)});a=await D(a);return a.map(function(a){var h=g.get(a.externalId);if(h==null)return null;var i=h.dbMsg;h=h.traceId;var j=A(b,d("MAWDbMsgUtil").getProtocolMsgIdFromDbMsg(i));return B(a,i,h,j,c,e,f)}).filter(Boolean)}async function a(a,e,f,g){if(!c("MAWEBSwitch").isEnabled()){d("WALogger").LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Cannot proceed with encodeAndSendEchoMessage: Encrypted Backups are not enabled"])));e.forEach(function(a,b){d("MAWEBUploadTrackingUtils").endSuccessWorkerOnly(a,"upload_tracking_cancelled_eb_turned_off_upload",{string:{externalId:b,from:"uploadMessageFromUploadQueue"}})});return}try{a=await C(a.filter(function(a){var b=d("MAWEBUploadTrackingUtils").isUploadSupported(a.dbMsg)&&a.dbMsg.type!==d("MAWMsgType").MSG_TYPE.RAVEN;b||d("MAWEBUploadTrackingUtils").addUploadTrackingByType("success",e,a.dbMsg.externalId,"upload_not_supported",{string:{msgType:a.dbMsg.type}});return b}),f,e,g,"upload_queue");return b("cr:21382")!=null?v(a):w(a)}catch(a){f="[labyrinth_web] Error while encode and upload message to backup: "+String(a);d("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["",""])),f);d("WAErrorMessage").maybeGetMessageFromError(a).includes("uploadMessagesToBackupV2 is not defined for event")&&(q||(q=d("ODS"))).bumpEntityKey(7319,c("MWEBODSEntityName.enum").MAW_EB_UPLOAD_TRACKING,"echo_uploadMessagesToBackupV2_not_defined_for_event");throw a}}var D=d("MAWIndexedDb").makeMsgrTransactor({editMsgHistory:(e=d("MAWTransactionMode")).READONLY,media:e.READONLY,mediaBackup:e.READONLY,messages:e.READONLY,reactions:e.READONLY,receiverFetchInfo:e.READONLY,threads:e.READONLY,xma:e.READONLY},"constructEchoMessage",function(a){return function(){for(var b=arguments.length,c=new Array(b),e=0;e<b;e++)c[e]=arguments[e];return d("MAWUploadMessageTxns").constructEchoMessage.apply(void 0,[a].concat(c))}});g.UploadErrorType=u;g.uploadMessageFromUploadQueue=a}),98);
__d("EBWorkerEBDBApiDeferred",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("EBWorkerEBDBApi").__setRef("EBWorkerEBDBApiDeferred");function a(){return h.load().then(function(a){return a.startListeningEBDeviceRegistrations()})}function b(a){return h.load().then(function(b){return b.addNewDevice(a)})}function d(a){return h.load().then(function(b){return b.trackConsistency(a)})}g.startListeningEBDeviceRegistrations=a;g.addNewDevice=b;g.trackConsistency=d}),98);
__d("EncryptedBackupsMediaRestoreProbeQpl",["MAWQplProxy","WAGetPlatformFromStanzaId","justknobx","qpl"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.isRetroactiveUpload,e=a.mediaType,f=a.msgType,g=a.probeDelayMs,h=a.restoreMethod,i=a.sampleRate,j=a.stanzaId,k=a.triggerSource,l=a.version;a=a.xmaType;return d("MAWQplProxy").startQplUserFlow(c("qpl")._(521473213,"27"),{bool:{isRetroactiveUpload:b},"int":{probeDelayMs:g,sampleRate:i},string:{e2eePlatform:d("WAGetPlatformFromStanzaId").getPlatformFromStanzaId(j),mediaType:e,msgType:f,restoreMethod:h,triggerSource:k,version:l,xmaType:a==null?"<null>":a}},{providedTimeoutInMs:c("justknobx")._("3047")})}g.startMediaRestoreProbeQPLFlow=a}),98);
__d("MAWGetMediaApi",["MAWDbMediaTxns","MAWDexieTable","MAWIndexedDb","MAWTransactionMode","MWFBLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(a){var b=a.media;a=a.xmaMediaType;return b==null?null:{media:b,xmaMediaType:a}};b=d("MAWIndexedDb").makeMsgrTransactor({media:(a=d("MAWTransactionMode")).READONLY},"getMediaByPlaintextHash",function(a){return function(b){return d("MAWDbMediaTxns").maybeGetMediaFromPlaintextHash(a,b)}});c=d("MAWIndexedDb").makeMsgrTransactor({media:a.READONLY},"getMediaByMediaId",function(a){return function(b){return d("MAWDbMediaTxns").maybeGetMediaFromMediaId(a,b)}});e=d("MAWIndexedDb").makeMsgrTransactor({media:a.READONLY,xma:a.READONLY},"getMediaByXMAId",function(a){return function(b){return a.xma.get(b).then(function(c){if(c==null){d("MWFBLogger").MWMediaLogger.tags(["downloadMediaForUI"]).MUSTFIX(h||(h=babelHelpers.taggedTemplateLiteralLoose(["cannot find xma with xmaId ",""])),b);return[]}return d("MAWDexieTable").dexieAll([d("MAWDbMediaTxns").maybeGetMediaFromMediaId(a,c.defaultPreviewMediaId).then(function(a){return i({media:a,xmaMediaType:"preview"})}),d("MAWDbMediaTxns").maybeGetMediaFromMediaId(a,c.headerMediaId).then(function(a){return i({media:a,xmaMediaType:"headerImage"})}),d("MAWDbMediaTxns").maybeGetMediaFromMediaId(a,c.faviconMediaId).then(function(a){return i({media:a,xmaMediaType:"favicon"})})])})}});g.getMediaByPlaintextHash=b;g.getMediaByMediaId=c;g.getMediaByXMAId=e}),98);
__d("MAWGetMsgByProtocolIdApi",["MAWDbMsgTxns","MAWIndexedDb","MAWTransactionMode"],(function(a,b,c,d,e,f,g){"use strict";a=d("MAWIndexedDb").makeMsgrTransactor({messages:d("MAWTransactionMode").READONLY},"getMsgsByProtocolMsgIdsTxn",function(a){return function(b){return d("MAWDbMsgTxns").getMsgsByProtocolMsgId(a,b)}});g.getMsgsByProtocolMsgIdsTxn=a}),98);
__d("MAWDeletedMsgApi",["MAWIndexedDb","MAWTransactionMode"],(function(a,b,c,d,e,f,g){"use strict";a=d("MAWIndexedDb").makeMsgrTransactor({deletedMessages:d("MAWTransactionMode").READONLY},"getDeletedMsgByProtocolIdApi",function(a){return function(b){return a.deletedMessages.get(babelHelpers["extends"]({},b))}});g.getDeletedMsgByProtocolIdApi=a}),98);
__d("MAWIsMsgDeletedWithReason",["MAWDbDeletedMessages","MAWDeletedMsgApi"],(function(a,b,c,d,e,f,g){"use strict";async function a(a){a=await d("MAWDeletedMsgApi").getDeletedMsgByProtocolIdApi(a);return!a?!1:a.reason===d("MAWDbDeletedMessages").DbDeletedMsgReasonEnum.ChatDelete||a.reason===d("MAWDbDeletedMessages").DbDeletedMsgReasonEnum.Revoke}g.isMsgDeletedWithReason=a}),98);
__d("EncryptedBackupsMediaRestoreProbe",["$InternalEnum","EncryptedBackupsMediaRestoreProbeQpl","EncryptedBackupsResignCdnUrl","MAWCastToMsgrServerMediaType","MAWDbXMATxns","MAWGetMediaApi","MAWGetMsgByProtocolIdApi","MAWIndexedDb","MAWIsMsgDeletedWithReason","MAWMsgType","MAWTransactionMode","WAGlobals","WAJids","WAMediaUtils","WAPromiseDelays","WAResultOrError","WATagsLogger","cr:10071","gkx","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q=d("WATagsLogger").TAGS(["MediaRestoreProbe"]),r=c("justknobx")._("2045");async function a(a){var e=a.isRetroactiveUpload,f=a.triggerSource;a=a.uploadEntity;var g=q.TAGS([a.msgId.externalId]);switch(a.dbMsgType){case d("MAWMsgType").MSG_TYPE.REACTION:case d("MAWMsgType").MSG_TYPE.EDIT_ACTION:return d("WAResultOrError").makeResult("no-attachment-with-msg")}var p=z(),s=a.dbMsgType;s=w(s);s=Math.random()<p*s/100;if(!s||a.triggerSource==="upload-message-from-mps")return Promise.resolve(d("WAResultOrError").makeResult("not-sampled"));var x=b("cr:10071")==null?"sproc":"gql";g.LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["start probe media backup through ",", is retroactive upload: ",""])),x,e);await d("WAPromiseDelays").delayMs(c("gkx")("2067")?5e3:r);var y=babelHelpers.extends({},a.msgId,{author:d("WAGlobals").getMyUserJid()===a.msgId.author?d("WAJids").AUTHOR_ME:a.msgId.author});s=await d("MAWGetMsgByProtocolIdApi").getMsgsByProtocolMsgIdsTxn([y]);var A=s[0];if(A==null){s=await d("MAWIsMsgDeletedWithReason").isMsgDeletedWithReason(y);if(s){g.LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["msg is deleted"])));return d("WAResultOrError").makeResult("msg-deleted")}g.ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["no dbMsg found - msgType: "," - source: ",", retroactive: ",""])),a.dbMsgType,f,e);return d("WAResultOrError").makeError("missing-db-msg")}s=await v({dbMsg:A,logger:g,protocolMsgId:y});if(s.type==="no-attachment"){g.LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["skip restore probe because no attachment found"])));return d("WAResultOrError").makeResult("no-attachment-with-msg")}a=t(s,A.msgId);s=await Promise.all(a.map(function(a){if(a.success===!1)return a;var b=d("EncryptedBackupsMediaRestoreProbeQpl").startMediaRestoreProbeQPLFlow({isRetroactiveUpload:e,mediaType:a.value.serverMediaType,msgType:A.type,probeDelayMs:r,restoreMethod:x,sampleRate:p,stanzaId:y.externalId,triggerSource:f,version:"maw_db",xmaType:a.value.xmaType});g.LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["start probing. serverMediaType: ",", xmaType: "," "])),a.value.serverMediaType,a.value.xmaType);return u({dbMsg:A,logger:g,payload:a.value,probeQPL:b,protocolMsgId:y}).then(function(a){if(a.success){g.LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Probe success"])));b.endSuccess();return a}g.LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["Probe failed: "," "])),a.error);b.endFail(a.error,{string:{failReason:a.error}});return a}).catch(function(a){g.LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["Probe failed: "," "])),a.toString());b.endFail("runtime-error",{string:{failReason:a.toString()}});return d("WAResultOrError").makeError("runtime-error")})}));a=s.map(function(a){return a.success?null:a.error}).filter(Boolean);return a.length>0?d("WAResultOrError").makeError(a):d("WAResultOrError").makeResult("restore-media-success")}var s=b("$InternalEnum")({DEFAULT_PREVIEW:"defaultPreview",FAVICON:"favicon",HEADER:"header",PREVIEWS:"previews"});function t(a,b){switch(a.type){case"xma":return a.medias.map(function(a){var c=a.dbMedia;a=a.xmaType;c=y(b,c.mediaEntries);return!c.success?d("WAResultOrError").makeError("missing-media-entry"):d("WAResultOrError").makeResult({objectId:c.value.objectId,serverMediaType:c.value.serverMediaType,xmaType:a})});case"media-with-preview":var c,e=y(b,a.fullsize.mediaEntries);if(!e.success)return[d("WAResultOrError").makeError("missing-media-entry")];var f=[d("WAResultOrError").makeResult({objectId:e.value.objectId,serverMediaType:e.value.serverMediaType,xmaType:null})];if(((c=e.value.downloadableThumbnail)==null?void 0:c.directPath)!=null){c=e.value.downloadableThumbnail;f.push(d("WAResultOrError").makeResult({objectId:c.objectId,serverMediaType:"preview",xmaType:null}))}return f;default:a.type;e=y(b,a.fullsize.mediaEntries);return!e.success?[d("WAResultOrError").makeError("missing-media-entry")]:[d("WAResultOrError").makeResult({objectId:e.value.objectId,serverMediaType:e.value.serverMediaType,xmaType:null})]}}async function u(a){var b=a.dbMsg,c=a.logger,e=a.payload,f=a.probeQPL;a=a.protocolMsgId;var g=b.msgId,h=b.sortOrderMs;if(h==null)return d("WAResultOrError").makeError("missing-sort-order-ms");var i=e.objectId;e=e.serverMediaType;if(e==null||i==null)return d("WAResultOrError").makeError("invalid-media-entry");e=d("MAWCastToMsgrServerMediaType").castToMsgrServerMediaType(e,b.type===d("MAWMsgType").MSG_TYPE.XMA);if(e==null)return d("WAResultOrError").makeError("unsupported-media-type");b=await d("EncryptedBackupsResignCdnUrl").resignCdnUrl({deliveryObjectId:i,logger:c,mediaDownloadFlow:f,mediaType:e,msgId:g,protocolMsgId:a,sortOrderMs:h});return!b.success?b:d("WAResultOrError").makeResult("restore-media-success")}async function v(a){var b=a.dbMsg,c=a.logger;a=a.protocolMsgId;switch(b.type){case d("MAWMsgType").MSG_TYPE.IMAGE:case d("MAWMsgType").MSG_TYPE.VIDEO:if(b.plaintextHash==null)return{type:"no-attachment"};var e=await d("MAWGetMediaApi").getMediaByPlaintextHash(b.plaintextHash);if(e!=null){var f=e==null?void 0:e.mediaEntries.get(b.msgId);if(f!=null){f=d("WAMediaUtils").decodeMediaEntryData(f).downloadableThumbnail;if(f!=null&&f.objectId!=null)return{fullsize:e,preview:f,type:"media-with-preview"}}}return e==null?{type:"no-attachment"}:{fullsize:e,type:"media"};case d("MAWMsgType").MSG_TYPE.PTT:case d("MAWMsgType").MSG_TYPE.GIF:case d("MAWMsgType").MSG_TYPE.STICKER:case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:if(b.plaintextHash==null)return{type:"no-attachment"};f=await d("MAWGetMediaApi").getMediaByPlaintextHash(b.plaintextHash);return f==null?{type:"no-attachment"}:{fullsize:f,type:"media"};case d("MAWMsgType").MSG_TYPE.RAVEN:case d("MAWMsgType").MSG_TYPE.TEXT:case d("MAWMsgType").MSG_TYPE.FUTUREPROOF:case d("MAWMsgType").MSG_TYPE.CIPHERTEXT:case d("MAWMsgType").MSG_TYPE.UNAVAILABLE:case d("MAWMsgType").MSG_TYPE.ADMIN:case d("MAWMsgType").MSG_TYPE.REVOKED:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:case d("MAWMsgType").MSG_TYPE.ICDC_ALERT:case d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH:case d("MAWMsgType").MSG_TYPE.GROUP_POLL_CREATE:case d("MAWMsgType").MSG_TYPE.GROUP_POLL_UPDATE:case d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE:return{type:"no-attachment"};default:b.type;e=await x(a,c);return e.length===0?{type:"no-attachment"}:{medias:e,type:"xma"}}}function w(a){switch(a){case d("MAWMsgType").MSG_TYPE.VIDEO:return 13;case d("MAWMsgType").MSG_TYPE.STICKER:return 10;case d("MAWMsgType").MSG_TYPE.PTT:return 8;case d("MAWMsgType").MSG_TYPE.GIF:return 40;case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:return 40;case d("MAWMsgType").MSG_TYPE.XMA:return 2;default:return 1}}var x=d("MAWIndexedDb").makeMsgrTransactor({media:d("MAWTransactionMode").READONLY,messages:d("MAWTransactionMode").READONLY,xma:d("MAWTransactionMode").READONLY},"getMediaByProtocolMsgId",function(a){return function(b,c){return d("MAWDbXMATxns").maybeGetXMAPayloadFromProtocolMsgId(a,b).then(function(a){if(!a.success){c.ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["cannot find media for xma with protocolMsgId ",""])),b);return[]}a=a.value;var d=a.defaultPreview,e=a.favicon,f=a.header;a=a.previews;return[d==null?null:{dbMedia:d,xmaType:s.DEFAULT_PREVIEW},e==null?null:{dbMedia:e,xmaType:s.FAVICON},f==null?null:{dbMedia:f,xmaType:s.HEADER}].concat((a!=null?a:[]).map(function(a){return a==null?null:{dbMedia:a,xmaType:s.PREVIEWS}})).filter(Boolean)})}});function y(a,b){b=b.get(a);return b==null?d("WAResultOrError").makeError("missing-media-entry"):d("WAResultOrError").makeResult(d("WAMediaUtils").decodeMediaEntryData(b))}function z(){return c("gkx")("2067")?100:c("justknobx")._("2722")}g.sampleProbeMediaRestore=a;g.ProbeXmaType=s;g.getMediaRestoreProbeSamplingRate=z}),98);
__d("MAWCastToMsgType",["MAWMsgType"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a){case"image":return d("MAWMsgType").MSG_TYPE.IMAGE;case"video":return d("MAWMsgType").MSG_TYPE.VIDEO;case"gif":return d("MAWMsgType").MSG_TYPE.GIF;case"sticker":return d("MAWMsgType").MSG_TYPE.STICKER;case"file":return d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE;case"audio":return d("MAWMsgType").MSG_TYPE.PTT;case"xma":return d("MAWMsgType").MSG_TYPE.XMA}}g.castMsgrServerMediaTypeToMsgType=a}),98);
__d("EncryptedBackupsMediaRestoreProbeV2",["EncryptedBackupsMediaRestoreProbe","EncryptedBackupsMediaRestoreProbeQpl","MAWCastToMsgType","MAWCastToServerMediaType","Random","WAMediaUtils","WAResultOrError","WATagsLogger","cr:10071","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n=c("justknobx")._("2045"),o=d("WATagsLogger").TAGS(["MediaRestoreProbeV2"]);function p(a){switch(a){case"video":return 13;case"sticker":return 10;case"audio":return 8;case"gif":return 40;case"file":return 40;case"xma":return 2;case"image":case"preview":return 1}}async function a(a){var c=a.backupMessage,e=a.chatJid,f=a.sortOrderMs,g=a.stanzaId,r=a.triggerSource;if(b("cr:10071")==null)return d("WAResultOrError").makeResult("not-in-gk");a=q(c);if(a.success===!1)return a;var s=o.TAGS([g]);c=a.value;if(c==="no-attachment-with-msg"){s.LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["skip restore probe because no attachment found"])));return d("WAResultOrError").makeResult(c)}var t=c.map(function(a){return a.serverMediaType}).filter(function(a){return a!=="preview"}).find(Boolean);if(t==null){s.LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["skip restore probe because no attachment found"])));return d("WAResultOrError").makeResult("no-attachment-with-msg")}var u=d("EncryptedBackupsMediaRestoreProbe").getMediaRestoreProbeSamplingRate();a=p(t);a=d("Random").coinflip(100/(u*a));if(!a)return Promise.resolve(d("WAResultOrError").makeResult("not-sampled"));a=await Promise.all(c.map(function(a){var c=d("EncryptedBackupsMediaRestoreProbeQpl").startMediaRestoreProbeQPLFlow({isRetroactiveUpload:!1,mediaType:d("MAWCastToServerMediaType").castMsgrServerMediaTypeToServerMediaType(a.serverMediaType),msgType:d("MAWCastToMsgType").castMsgrServerMediaTypeToMsgType(t),probeDelayMs:n,restoreMethod:"gql",sampleRate:u,stanzaId:g,triggerSource:r,version:"protobuf",xmaType:a.xmaType});s.LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["start probing. serverMediaType: ",", xmaType: "," "])),a.serverMediaType,a.xmaType);return b("cr:10071").eblsResignCdnUrlWithGraphQL({chatJid:e,deliveryObjectId:a.objectId,externalId:g,mediaDownloadFlow:{addAnnotations:function(a){c.addAnnotations(babelHelpers.extends({},a))},addPoint:function(a,b){c.addPoint(a,babelHelpers.extends({},b))}},mediaType:a.serverMediaType,sortOrderMs:f}).then(function(a){if(a.success){s.LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Probe success"])));c.endSuccess();return d("WAResultOrError").makeResult("restore-media-success")}s.LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Probe failed: "," "])),a.error);c.endFail(a.error,{string:{failReason:a.error}});return a}).catch(function(a){s.LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Probe failed: "," "])),a.toString());c.endFail("runtime-error",{string:{failReason:a.toString()}});return d("WAResultOrError").makeError("runtime-error")})}));c=a.map(function(a){return a.success?null:a.error}).filter(Boolean);return c.length>0?d("WAResultOrError").makeError(c):d("WAResultOrError").makeResult("restore-media-success")}function q(a){a=a.encryptedTransportMessage();if(a==null)return d("WAResultOrError").makeError("missing-transport");var b=a.consumerMessage();if(b!=null){var c=b.imageMessage();if(c!=null)return s(c,"image");c=b.videoMessage();if(c!=null){var e;e=((e=c.payload.ancillary)==null?void 0:e.gifPlayback)===!0||((e=c.payload.ancillary)==null?void 0:e.gifAttribution)!=null;return s(c,e?"gif":"video")}c=b.audioMessage();if(c!=null){e=r(c,"audio");return e.success===!1?e:d("WAResultOrError").makeResult([e.value])}c=b.stickerMessage();if(c!=null){e=r(c,"sticker");return e.success===!1?e:d("WAResultOrError").makeResult([e.value])}c=b.documentMessage();if(c!=null){e=r(c,"file");return e.success===!1?e:d("WAResultOrError").makeResult([e.value])}}c=(b=a.armadillo())==null?void 0:b.extendedContentMessage();if(c!=null){e=c.previews().map(function(a){var b;return a==null||(b=a.integral)==null||(b=b.transport)==null||(b=b.ancillary)==null?void 0:b.objectId}).filter(Boolean);b=(a=c.favicon())==null||(a=a.integral)==null||(a=a.transport)==null||(a=a.ancillary)==null?void 0:a.objectId;c=(a=c.headerImage())==null||(a=a.integral)==null||(a=a.transport)==null||(a=a.ancillary)==null?void 0:a.objectId;return d("WAResultOrError").makeResult([b!=null?{objectId:d("WAMediaUtils").stringToDeliveryObjectId(b),xmaType:d("EncryptedBackupsMediaRestoreProbe").ProbeXmaType.FAVICON}:null,c!=null?{objectId:d("WAMediaUtils").stringToDeliveryObjectId(c),xmaType:d("EncryptedBackupsMediaRestoreProbe").ProbeXmaType.HEADER}:null,e.length>0?{objectId:d("WAMediaUtils").stringToDeliveryObjectId(e[0]),xmaType:d("EncryptedBackupsMediaRestoreProbe").ProbeXmaType.DEFAULT_PREVIEW}:null].concat(e.map(function(a){return{objectId:d("WAMediaUtils").stringToDeliveryObjectId(a),xmaType:d("EncryptedBackupsMediaRestoreProbe").ProbeXmaType.PREVIEWS}})).filter(Boolean).map(function(a){return babelHelpers.extends({},a,{serverMediaType:"xma"})}))}return d("WAResultOrError").makeResult("no-attachment-with-msg")}function r(a,b){var c;a=a==null||(c=a.payload.integral)==null||(c=c.transport)==null||(c=c.ancillary)==null?void 0:c.objectId;return a!=null?d("WAResultOrError").makeResult({objectId:d("WAMediaUtils").stringToDeliveryObjectId(a),serverMediaType:b}):d("WAResultOrError").makeError("missing-object-id")}function s(a,b){var c;b=r(a,b);if(b.success===!1)return b;a=a==null||(c=a.payload.integral)==null||(c=c.transport)==null||(c=c.ancillary)==null||(c=c.thumbnail)==null||(c=c.downloadableThumbnail)==null?void 0:c.objectId;var e=b.value.objectId;return a!=null&&a!==e?d("WAResultOrError").makeResult([b.value,{objectId:d("WAMediaUtils").stringToDeliveryObjectId(a),serverMediaType:"preview"}]):d("WAResultOrError").makeResult([b.value])}g.sampleProbeMediaRestoreV2=a}),98);
__d("EncryptedBackupsWorkerScheduler",["WorkerScheduler","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){h==null&&(h=d("WorkerScheduler").makeScheduler("eb",{concurrency:1,maxConcurrency:1,maxThrottleMs:c("gkx")("9699")?5e3:1e3,timeToStuckMs:6e4}));return h}g.ebScheduler=a}),98);
__d("EncryptedBackupsUploadQueueProcessor",["EBDBMetricsConsistencyOperationEnum","EBEnableUnifiedAttachment","EBLogger","EBUnifyLegacyMediaUpload","EBWorkerEBDBApiDeferred","EncryptedBackupsConstructEchoMessages","EncryptedBackupsMediaRestoreProbe","EncryptedBackupsMediaRestoreProbeV2","EncryptedBackupsUploadQueue","EncryptedBackupsUtils","EncryptedBackupsWorkerScheduler","MAWBridge","MAWBridgeUpload","MAWEBSwitch","MAWEBUploadTrackingUtils","MAWGetMsgByProtocolIdApi","MAWMpsGating","MAWProtobufDeserializers","MAWTraceUtils","MWEBODSEntityName.enum","MpsTypes","ODS","WACommsConnectionState","WAErrorMessage","WAGetSafeQPLError","WAGlobals","WAJids","WAStanzaUtils","WAWaitForUserUnblocked","WorkerScheduler","cr:11435","cr:21382","gkx","justknobx","performanceAbsoluteNow","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=d("EBLogger").EBLogger.tags(["EbUploadQueue"]),B=new Map();function C(){var a=(z||(z=c("performanceAbsoluteNow")))(),b=!1;for(var e of B.entries()){var f=e[0],g=e[1].addedAtMs;a-g>c("justknobx")._("3472")&&(b=!0,d("MAWEBUploadTrackingUtils").endFailWorkerOnly(f,"message_upload_timeout",{string:{error_description:d("MAWEBUploadTrackingUtils").EBUploadTrackingWorkerFailurePoints.MESSAGE_UPLOAD_TIMEOUT}}),B.delete(f))}return b}var D=null,E=null,F=null;async function G(){await d("WAWaitForUserUnblocked").waitForUserUnblocked();if(F!=null)return;A.DEBUG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[scheduleEB] Running..."])));E!=null&&(A.DEBUG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[scheduleEB] Cancelling scheduled retry as another process has triggered a run"]))),window.clearTimeout(E),E=null);F=d("EncryptedBackupsWorkerScheduler").ebScheduler().task({fn:async function(){void d("EBWorkerEBDBApiDeferred").trackConsistency(d("EBDBMetricsConsistencyOperationEnum").EBConsistencyOperation.Upload).then(function(a){return d("MAWBridge").getBridge().fireAndForget("event","trackEbConsistency",{workerDeviceId:a})});if(!c("MAWEBSwitch").isEnabled())return!1;var a=await J();a=a.isEmpty;return!a},name:"eb_upload",priority:d("WorkerScheduler").BACKGROUND_PRIORITY});F.run().then(function(a){F=null,a&&void G()}).catch(function(a){F=null;A.MUSTFIX(j||(j=babelHelpers.taggedTemplateLiteralLoose([""," cannot process EB upload"])),a);var b=d("WAErrorMessage").maybeGetMessageFromError(a);B.forEach(function(c,e,f){b.includes("uploadMessagesToBackupV2 is not defined for event")?d("MAWEBUploadTrackingUtils").endSuccessWorkerOnly(e,"upload_eb_msgs_error",{string:{comms_status_on_failure:d("WACommsConnectionState").WACommsConnectionState.isConnected()===!0?"connected":"disconnected",error:d("WAGetSafeQPLError").getSafeQPLErrorMessage(a),error_description:d("MAWEBUploadTrackingUtils").EBUploadTrackingWorkerFailurePoints.RUNTIME_ERROR,reason:d("WAGetSafeQPLError").getSafeQPLErrorMessage(a)}}):d("MAWEBUploadTrackingUtils").endFailWorkerOnly(e,"upload_eb_msgs_error",{string:{comms_status_on_failure:d("WACommsConnectionState").WACommsConnectionState.isConnected()===!0?"connected":"disconnected",error:d("WAGetSafeQPLError").getSafeQPLErrorMessage(a),error_description:d("MAWEBUploadTrackingUtils").EBUploadTrackingWorkerFailurePoints.RUNTIME_ERROR,reason:d("WAGetSafeQPLError").getSafeQPLErrorMessage(a)}})});B.clear();A.DEBUG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[scheduleEB] Waiting ","ms before scheduling next run due to an error"])),c("justknobx")._("2366"));E=globalThis.setTimeout(async function(){E=null,d("WACommsConnectionState").WACommsConnectionState.isConnected()===!1&&(A.DEBUG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[scheduleEB] Network is currently disconneted. Waiting for the network to reconnect before continuing eb upload."]))),await d("WACommsConnectionState").WACommsConnectionState.waitForConnection(),A.DEBUG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[scheduleEB] Network has been re-established."])))),A.DEBUG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[scheduleEB] Finished waiting, scheduling next run"]))),void G()},c("justknobx")._("2366"))})}function H(){D==null&&(D=globalThis.setInterval(C,5e3)),void G()}function a(){c("MAWEBSwitch").onSet(function(a){a&&H()});H();var a=d("EncryptedBackupsUploadQueue").ebUploadQueue();a.subscribe(function(a){a.type==="flush"&&H()})}async function I(a){var e=b("cr:21382")!=null?await b("cr:21382").uploadMessagesFromWorker(a).then(function(b){b.success||(A.MUSTFIX(o||(o=babelHelpers.taggedTemplateLiteralLoose(["uploadMessagesFromWorker failed with error: ",""])),b.error),a.forEach(function(a){a=a.uploadTrackingInstanceKey;if(a!=null){d("MAWEBUploadTrackingUtils").endFailWorkerOnly(a,"gql_upload_runtime_error",{string:{error_description:(a=b.error)!=null?a:"unknown gql upload error"}})}}));return b}):await d("MAWBridge").getBridge().sendAndReceive("event","uploadMessagesToBackupV2",{checkPoint:[],messages:a,qpl:[]}).catch(function(a){var b=d("WAErrorMessage").maybeGetMessageFromError(a);A.MUSTFIX(p||(p=babelHelpers.taggedTemplateLiteralLoose(["uploadMessagesToBackupV2 failed with error: ",""])),b);b.includes("uploadMessagesToBackupV2 is not defined for event")&&(y||(y=d("ODS"))).bumpEntityKey(7319,c("MWEBODSEntityName.enum").MAW_EB_UPLOAD_TRACKING,"echo_skip_uploadMessagesToBackupV2_not_defined_for_event");throw a});e.success&&await Promise.all(a.map(function(a){a=a.uploadTrackingInstanceKey;return a==null?Promise.resolve():K(a,e.success)}))}async function J(){var a=d("EncryptedBackupsUploadQueue").ebUploadQueue(),e=[],f=await a.read({filter:function(a){if(a.sortOrderMs==null||d("EncryptedBackupsUtils").entryOlderThan30Days(a.sortOrderMs)){e.push(a.queueId);return!1}else return!B.has(d("MAWEBUploadTrackingUtils").genInstanceKeyForUploadQueue(a.msgId))},limit:c("justknobx")._("2368"),order:"desc"});await a.delete(e);if(f.length===0)return{isEmpty:!0};A.DEBUG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["upload queue uploading "," messages"])),f.length);a=f.map(function(b){var c,e=d("MAWEBUploadTrackingUtils").genInstanceKeyForUploadQueue(b.msgId),a=b.isRetroactiveUpload==null?!1:b.isRetroactiveUpload;return{bridgeUploadMessage:d("MAWBridgeUpload").createBridgeUploadMessage({actionType:b.backupActionType===3?2:1,attachmentContextArray:b.attachmentContext,echoDocument:void 0,echoEncodingLatencyNs:void 0,errorCode:void 0,errorMessage:void 0,messageId:((c=b.backupDirective)==null?void 0:c.supplementalKey)!=null?(c=b.backupDirective)==null?void 0:c.originalMsgProtocolId.externalId:b.msgId.externalId,protoMsg:{backupActionType:b.backupActionType,msgId:b.msgId,originalMsgProtocolId:(c=b.backupDirective)==null?void 0:c.originalMsgProtocolId,protobuf:b.protobuf,senderId:b.senderId,serverTs:b.serverTs,sortOrderMs:b.sortOrderMs,supplementalKey:(c=b.supplementalKey)!=null?c:(c=b.backupDirective)==null?void 0:c.supplementalKey,tags:b.tags},sortOrderMs:b.sortOrderMs||0,threadId:d("WAJids").threadIdForChatJid(b.msgId.chat),traceId:e.toString(),uploadTrackingInstanceKey:e}),isRetroactiveUpload:a,legacyAttachmentContext:b.legacyAttachmentContext,messageType:b.dbMsgType,queueId:b.queueId,triggerSource:(c=b.triggerSource)!=null?c:"unknown"}});var g=a.filter(function(a){return a.bridgeUploadMessage.actionType===2}),h=a.filter(function(a){return a.bridgeUploadMessage.actionType!==2}),i=c("gkx")("8488"),j=c("gkx")("11710");if(i||j&&g.length>0){g=i?a:g;a=g.length===a.length;var k=(z||(z=c("performanceAbsoluteNow")))();for(var l of g){var m=l.bridgeUploadMessage,n=l.isRetroactiveUpload,o=l.messageType,p=l.queueId,s=l.triggerSource;m.uploadTrackingInstanceKey!=null&&B.set(m.uploadTrackingInstanceKey,{addedAtMs:k,queueId:p});p=(p=m.protoMsg)==null?void 0:p.msgId;if(p!=null&&m.uploadTrackingInstanceKey!=null){p=m.uploadTrackingInstanceKey;d("MAWEBUploadTrackingUtils").startUploadTracking(d("WAStanzaUtils").toStanzaId(m.messageId),o,s,p,!0,n,(s=(o=m.attachmentBackupContext)==null||(o=o.attachmentInfos)==null?void 0:o.length)!=null?s:0,"protobuf_only")}}N(g.map(function(a){return a.legacyAttachmentContext}).filter(Boolean));p=g.map(function(a){a=a.bridgeUploadMessage;a.uploadTrackingInstanceKey!=null&&d("MAWEBUploadTrackingUtils").addPointWorkerOnly(a.uploadTrackingInstanceKey,"fire_protobuf_only_upload_bridge_event");return a});await I(p);if(i||a)return{isEmpty:!1}}var t=new Map(),u=[];n=[];var v=[],w=new Map(),x=new Map();m=(z||(z=c("performanceAbsoluteNow")))();for(o of f){if(o.backupActionType===3&&(j||i))continue;s=L(o);if(s==null){c("promiseDone")(d("EncryptedBackupsUploadQueue").ebUploadQueue().ack([o.queueId]));continue}k=d("MAWEBUploadTrackingUtils").genInstanceKeyForUploadQueue(o.msgId);B.set(k,{addedAtMs:m,queueId:o.queueId});w.set(s.externalId,(l=o.attachmentContext)!=null?l:v);g=o.msgId.externalId;p=o.originalMsgProtocolId.externalId;g!==p&&x.set(g,{currentExternalId:g,originalMsgExternalId:p});if(!t.has(s.externalId)){var y;t.set(s.externalId,k);d("MAWEBUploadTrackingUtils").startUploadTracking(s.externalId,o.dbMsgType,(a=o.triggerSource)!=null?a:"unknown",k,!0,o.isRetroactiveUpload,(f=o==null||(y=o.attachmentContext)==null?void 0:y.length)!=null?f:0,"dual_upload");u.push(s);n.push({originalMsgId:s,uploadEntity:o})}}if(b("cr:11435")!==null){l=new Map();for(g of n){p=g.uploadEntity.msgId.chat;f=(k=(a=g.uploadEntity.backupDirective)==null?void 0:a.originalMsgProtocolId.externalId)!=null?k:g.uploadEntity.msgId.externalId;j=(s=l.get(p))!=null?s:[];j.push(f);l.set(p,j)}i=Array.from(l.entries()).map(function(a){var c=a[0];a=a[1];return b("cr:11435").mpsCop().loadMsgsByMessageIdsIntoMaw({config:{shouldFetchSupplementals:!1,shouldFetchTags:!1,strategy:"local-only"},debug:{purpose:"eb_echo_upload"},messageIds:a.map(d("MpsTypes").toMessageId),threadId:d("MpsTypes").toThreadId(c)})});i.length>0&&await Promise.allSettled(i)}t.forEach(function(a,b){d("MAWEBUploadTrackingUtils").addPointWorkerOnly(a,"queue_get_original_msg_ids_done")});m=await d("MAWGetMsgByProtocolIdApi").getMsgsByProtocolMsgIdsTxn(u).catch(function(a){var b=u.map(function(b){var e=c("justknobx")._("4483"),f=Promise.reject(a);e&&(f=d("MAWGetMsgByProtocolIdApi").getMsgsByProtocolMsgIdsTxn([b]).then(function(a){return a[0]}));return f.catch(function(c){var f=t.get(b.externalId);f!=null?d("MAWEBUploadTrackingUtils").endFailWorkerOnly(f,"get_db_msgs_error",{string:{error_description:d("MAWEBUploadTrackingUtils").EBUploadTrackingWorkerFailurePoints.ERROR_FETCHING_DB_MESSAGE,reason:d("WAGetSafeQPLError").getSafeQPLErrorMessage(c)}}):A.WARN(r||(r=babelHelpers.taggedTemplateLiteralLoose(["Cannot get message from db: ",""])),a);if(e&&c.name==="EARError"){var g=Promise.resolve();if(f!=null){f=(f=B.get(f))!=null?f:{queueId:null};f=f.queueId;f!=null&&(g=d("EncryptedBackupsUploadQueue").ebUploadQueue().delete([f]))}return g}return Promise.reject(c)})});return Promise.all(b).then(function(a){return a.filter(Boolean)})});var C=m.map(function(a){return a.externalId});o=n.filter(function(a){return!C.includes(a.originalMsgId.externalId)});o.forEach(function(a){var b=t.get(a.originalMsgId.externalId);if(b!=null){d("MAWEBUploadTrackingUtils").addPointWorkerOnly(b,"missing_entity_in_maw_db",{string:{missing_msg_id:a.originalMsgId.externalId,msg_type:a.uploadEntity.dbMsgType,trigger_source:(b=a.uploadEntity.triggerSource)!=null?b:"unknown"}})}});var D=new Map();m.forEach(function(a){var b=t.get(a.externalId);if(b==null)return;d("MAWEBUploadTrackingUtils").addPointWorkerOnly(b,"queue_get_msgs_done");var c=x.get(a.externalId);c!=null&&d("MAWEBUploadTrackingUtils").addPointWorkerOnly(b,"external_id_mismatch",{string:{currentExternalId:c.currentExternalId,differing_ids_type:a.type,originalMsgExternalId:c.originalMsgExternalId}});D.set(a.externalId,(b=w.get(a.externalId))!=null?b:v)});M(t,u,m);N(h.map(function(a){return a.legacyAttachmentContext}).filter(Boolean));await d("EncryptedBackupsConstructEchoMessages").uploadMessageFromUploadQueue(m.map(function(a){var b;b=((b=d("MAWEBUploadTrackingUtils").getUploadTrackingInstanceKey(t,a.externalId))!=null?b:d("MAWTraceUtils").createTraceId()).toString();d("MAWEBUploadTrackingUtils").addUploadTrackingByType("point",t,a.externalId,"construct_echo_start");return{dbMsg:a,traceId:b}}),t,h.map(function(a){return a.bridgeUploadMessage.protoMsg}).filter(Boolean),D);return{isEmpty:!1}}async function K(a,b){var e,f=d("EncryptedBackupsUploadQueue").ebUploadQueue();b?d("MAWEBUploadTrackingUtils").endSuccessWorkerOnly(a,"upload_queue_ack_worker_success"):d("MAWEBUploadTrackingUtils").endFailWorkerOnly(a,"upload_queue_ack_worker_fail",{string:{error_description:d("MAWEBUploadTrackingUtils").EBUploadTrackingWorkerFailurePoints.FAILED_TO_ACK_MESSAGE,reason:"failure to ack upload queue"}});e=(e=B.get(a))!=null?e:{queueId:null};var g=e.queueId;if(g==null)return;if(b){e=await f.read({filter:function(a){return a.queueId===g},limit:1,order:"desc"});b=e[0];if(b==null){A.MUSTFIX(s||(s=babelHelpers.taggedTemplateLiteralLoose(["upload queue - uploadEntity was null when attepmting to ack"])));return}if(c("gkx")("5680")){if(b.msgType==="media"&&(d("MAWMpsGating").isEbUploadViaMpsEnabled()&&b.triggerSource==="upload-message-from-mps"||!d("MAWMpsGating").isEbUploadViaMpsEnabled()&&b.triggerSource!=="upload-message-from-mps")){e=babelHelpers.extends({},b.msgId,{author:d("WAGlobals").getMyUserJid()===b.msgId.author?d("WAJids").AUTHOR_ME:b.msgId.author});var h=d("MAWProtobufDeserializers").DeserializedBackupMessage.create(b.protobuf);void d("EncryptedBackupsMediaRestoreProbeV2").sampleProbeMediaRestoreV2({backupMessage:h,chatJid:e.chat,sortOrderMs:(h=b==null?void 0:b.sortOrderMs)!=null?h:0,stanzaId:e.externalId,triggerSource:(h=b.triggerSource)!=null?h:"unknown"}).catch(function(a){A.MUSTFIX(t||(t=babelHelpers.taggedTemplateLiteralLoose(["Unexpected runtime error in probeMediaRestoreV2: ",""])),a)})}}else{void d("EncryptedBackupsMediaRestoreProbe").sampleProbeMediaRestore({isRetroactiveUpload:(e=b.isRetroactiveUpload)!=null?e:!1,triggerSource:(h=b.triggerSource)!=null?h:"unknown",uploadEntity:b}).catch(function(a){A.MUSTFIX(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Unexpected runtime error in probeMediaRestore: ",""])),a)})}}await f.ack([g]);B.delete(a);H()}function L(a){var b=a.originalMsgProtocolId;return b.author==null||b.chat==null?null:{author:d("WAGlobals").getMyUserJid()===b.author?d("WAJids").AUTHOR_ME:b.author,chat:b.chat,externalId:a.backupActionType===4?a.msgId.externalId:a.originalMsgProtocolId.externalId}}function M(a,b,c){if(b.length>c.length){var e=new Set(b.map(function(a){return a.externalId}));c.forEach(function(b){if(e.has(b.externalId)){e.delete(b.externalId);var c=a.get(b.externalId);c!=null?d("MAWEBUploadTrackingUtils").addPointWorkerOnly(c,"msg_found",{string:{originalMsgType:b.type}}):A.WARN(v||(v=babelHelpers.taggedTemplateLiteralLoose(["upload queue - instanceKey not found from uploadTrackingInstanceKeyMap, in checkMsgExist msg found"])))}});e.forEach(async function(b){b=a.get(b);if(b!=null){var c;d("MAWEBUploadTrackingUtils").endSuccessWorkerOnly(b,"upload_queue_msg_not_found");c=(c=B.get(b))!=null?c:{queueId:null};c=c.queueId;B.delete(b);if(c==null)return;await d("EncryptedBackupsUploadQueue").ebUploadQueue().delete([c])}else A.WARN(w||(w=babelHelpers.taggedTemplateLiteralLoose(["upload queue - instanceKey not found from uploadTrackingInstanceKeyMap, in checkMsgExist msg not found 1"])))})}else c.forEach(function(b){var c=a.get(b.externalId);c!=null?d("MAWEBUploadTrackingUtils").addPointWorkerOnly(c,"msg_found",{string:{originalMsgType:b.type}}):A.WARN(x||(x=babelHelpers.taggedTemplateLiteralLoose(["upload queue - instanceKey not found from uploadTrackingInstanceKeyMap, in checkMsgExist msg found 2"])))})}function N(a){if(a.length===0)return;var b=[];a.forEach(function(a){a!=null&&a.forEach(function(a){b.push({tag:"UploadAttachment",value:a})})});b.length>0&&d("EBUnifyLegacyMediaUpload").getEnableUnifyLegacyMediaUpload()&&!d("EBEnableUnifiedAttachment").getEbEnableUnifiedAttachment()&&d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:b})}g.scheduleNextRun=H;g.listenForEbUploadQueueFlush=a;g.uploadEBMsgs=J;g.ackWithInstanceKeyWorkerOnly=K;g.buildProtocolMsgIdFromEntity=L}),98);
__d("MAWConvertExtendedContentOverlayIconGlyphToXMAGatingType",["EchoMessageXMAFieldUtils","WAArmadilloXMA.pb","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){switch(a){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.INFO:return d("EchoMessageXMAFieldUtils").XMAGatingType.INFO;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.EYE_OFF:return d("EchoMessageXMAFieldUtils").XMAGatingType.EYE_OFF;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.NEWS_OFF:return d("EchoMessageXMAFieldUtils").XMAGatingType.NEWS_OFF;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.WARNING:return d("EchoMessageXMAFieldUtils").XMAGatingType.WARNING;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.PRIVATE:return d("EchoMessageXMAFieldUtils").XMAGatingType.PRIVATE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.NONE:return d("EchoMessageXMAFieldUtils").XMAGatingType.NONE;default:d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Not a valid ExtendedContentOverlayIconGlyph: ",""])),a);return d("EchoMessageXMAFieldUtils").XMAGatingType.NONE}}g.convertExtendedContentOverlayIconGlyphToXMAGatingType=a}),98);
__d("MAWConvertExtendedContentTargetTypeToXMATargetType",["EchoMessageXMAFieldUtils","WAArmadilloXMA.pb","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){switch(a){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_MENTION:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_PHOTO_MENTION;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_IMAGE_POST_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_SINGLE_IMAGE_POST_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_MULTIPOST_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_MULTIPOST_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SINGLE_VIDEO_POST_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_SINGLE_VIDEO_POST_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_PHOTO_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_VIDEO_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_CLIPS_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_CLIPS_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_IGTV_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_IGTV_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_SHOP_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_SHOP_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_PROFILE_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_PROFILE_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_PHOTO_HIGHLIGHT_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_PHOTO_HIGHLIGHT_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_VIDEO_HIGHLIGHT_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_VIDEO_HIGHLIGHT_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REPLY:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_REPLY;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.IG_STORY_REACTION:return d("EchoMessageXMAFieldUtils").XMAContentType.IG_STORY_REACTION;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.FB_FEED_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_REPLY:return d("EchoMessageXMAFieldUtils").XMAContentType.FB_STORY_REPLY;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.FB_STORY_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_MENTION:return d("EchoMessageXMAFieldUtils").XMAContentType.FB_STORY_MENTION;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_VIDEO_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.FB_FEED_VIDEO_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_GAMING_CUSTOM_UPDATE:return d("EchoMessageXMAFieldUtils").XMAContentType.FB_GAMING_CUSTOM_UPDATE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_PRODUCER_STORY_REPLY:return d("EchoMessageXMAFieldUtils").XMAContentType.FB_PRODUCER_STORY_REPLY;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.MSG_EXTERNAL_LINK_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_AUDIO_CALL:return d("EchoMessageXMAFieldUtils").XMAContentType.RTC_AUDIO_CALL;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_VIDEO_CALL:return d("EchoMessageXMAFieldUtils").XMAContentType.RTC_VIDEO_CALL;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_AUDIO_CALL:return d("EchoMessageXMAFieldUtils").XMAContentType.RTC_MISSED_AUDIO_CALL;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_VIDEO_CALL:return d("EchoMessageXMAFieldUtils").XMAContentType.RTC_MISSED_VIDEO_CALL;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_AUDIO_CALL:return d("EchoMessageXMAFieldUtils").XMAContentType.RTC_GROUP_AUDIO_CALL;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_VIDEO_CALL:return d("EchoMessageXMAFieldUtils").XMAContentType.RTC_GROUP_VIDEO_CALL;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_EVENT:return d("EchoMessageXMAFieldUtils").XMAContentType.FB_EVENT;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_RECEIVER_FETCH:return d("EchoMessageXMAFieldUtils").XMAContentType.MSG_RECEIVER_FETCH;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_SHORT:return d("EchoMessageXMAFieldUtils").XMAContentType.FB_SHORT;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_LOCATION_SHARING:return d("EchoMessageXMAFieldUtils").XMAContentType.MSG_LOCATION_SHARING;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_LOCATION_SHARING_V2:return d("EchoMessageXMAFieldUtils").XMAContentType.MSG_LOCATION_SHARING_V2;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_MEMORIES_SHARE:return d("EchoMessageXMAFieldUtils").XMAContentType.MSG_MEMORIES_SHARE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_PROFILE_DIRECTORY_ITEM:return d("EchoMessageXMAFieldUtils").XMAContentType.FB_PROFILE_DIRECTORY_ITEM;default:d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Not a valid ExtendedContentTargetType: ",""])),a);return d("EchoMessageXMAFieldUtils").XMAContentType.NONE}}g.convertExtendedContentTargetTypeToXMATargetType=a}),98);
__d("MAWConvertExtendedContentXMLLayoutTypeToXMALayoutType",["EchoMessageXMAFieldUtils","WAArmadilloXMA.pb","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){switch(a){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_XMA_LAYOUT_TYPE.SINGLE:return d("EchoMessageXMAFieldUtils").XMALayoutType.SINGLE;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_XMA_LAYOUT_TYPE.PORTRAIT:return d("EchoMessageXMAFieldUtils").XMALayoutType.PORTRAIT;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_XMA_LAYOUT_TYPE.HSCROLL:return d("EchoMessageXMAFieldUtils").XMALayoutType.HSCROLL;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_XMA_LAYOUT_TYPE.STANDARD_DXMA:return d("EchoMessageXMAFieldUtils").XMALayoutType.STANDARD_DXMA;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_XMA_LAYOUT_TYPE.LIST_DXMA:return d("EchoMessageXMAFieldUtils").XMALayoutType.LIST_DXMA;case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_XMA_LAYOUT_TYPE.GRID:return d("EchoMessageXMAFieldUtils").XMALayoutType.GRID;default:d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Not a valid ExtendedContentXMLLayoutType: ",""])),a);return d("EchoMessageXMAFieldUtils").XMALayoutType.SINGLE}}g.convertExtendedContentXMLLayoutTypeToXMALayoutType=a}),98);
__d("MAWDbReceiverFetchTxns",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){return a.receiverFetchInfo.get({receiverFetchId:b})}f.maybeGetReceiverFetchInfoFromReceiverFetchId=a}),66);
__d("MAWGetAttachmentTypeForServerMediaType",["EchoMessageMediaFieldUtils","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){switch(a){case"image":return d("EchoMessageMediaFieldUtils").AttachmentType.IMAGE;case"video":return d("EchoMessageMediaFieldUtils").AttachmentType.VIDEO;case"ptt":return d("EchoMessageMediaFieldUtils").AttachmentType.PTT;case"gif":return d("EchoMessageMediaFieldUtils").AttachmentType.GIF;case"sticker":return d("EchoMessageMediaFieldUtils").AttachmentType.STICKER;case"xma-image":return d("EchoMessageMediaFieldUtils").AttachmentType.XMA;case"document":return d("EchoMessageMediaFieldUtils").AttachmentType.DOCUMENT;default:d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Not a valid AttachmentType: ",""])),a);return null}}g.getAttachmentTypeForServerMediaType=a}),98);
__d("MAWGetMediaAttachmentTypeForServerMediaType",["EchoMessageMediaFieldUtils","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){switch(a){case"image":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.IMAGE;case"video":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.VIDEO;case"ptt":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.PTT;case"gif":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.GIF;case"sticker":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.STICKER;case"audio":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.AUDIO;case"document":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.DOCUMENT;case"ppic":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.PROFILE_PICTURE;case"md-app-state":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.APP_STATE;case"md-msg-hist":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.HISTORY_SYNC;case"thumbnail-image":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.THUMBNAIL_IMAGE;case"thumbnail-video":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.THUMBNAIL_VIDEO;case"thumbnail-gif":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.THUMBNAIL_GIF;case"thumbnail-document":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.THUMBNAIL_DOCUMENT;case"thumbnail-link":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.THUMBNAIL_LINK;case"novi-video":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.NOVI_VIDEO;case"novi-image":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.NOVI_IMAGE;case"xma-image":return d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.XMA_IMAGE;default:d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Not a valid EchoMessageActMediaAttachmentType: ",""])),a);return null}}g.getMediaAttachmentTypeForServerMediaType=a}),98);
__d("MAWGetPreviewContentTypeForMediaType",["EchoMessageMediaFieldUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a){case"image":return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.IMAGE_JPEG;case"gif":return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.GIF;case"sticker":return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.STICKER;case"video":return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.AUDIO_MP4;case"ptt":return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.AUDIO_WAV;case"xma-image":return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.IMAGE_JPEG;default:return null}}g.getPreviewContentTypeForMediaType=a}),98);
__d("MAWUploadMessageTxns",["EBLogger","EchoCommonUtils","EchoEncodingUtils","EchoMessage","EchoMessageMediaFieldUtils","EchoMessageQuoteFieldUtils","EncryptedBackupsConstructEchoMessages","LSEBPayloadSerializerError","LSMEBTaskCreationSource","MAWBridgeEventTransmitter","MAWConvertExtendedContentOverlayIconGlyphToXMAGatingType","MAWConvertExtendedContentTargetTypeToXMATargetType","MAWConvertExtendedContentXMLLayoutTypeToXMALayoutType","MAWDbEditMsgHistoryTxns","MAWDbMediaTxns","MAWDbMsg","MAWDbMsgTxns","MAWDbMsgUtil","MAWDbReactionsTxns","MAWDbReceiverFetchTxns","MAWDbXMATxns","MAWDexieTable","MAWGetAttachmentTypeForServerMediaType","MAWGetMediaAttachmentTypeForServerMediaType","MAWGetPreviewContentTypeForMediaType","MAWJidUtils","MAWJids","MAWMessageSortOrderUtils","MAWMsgType","MAWUserJidWrapper","MAWVault","MAWXMAUtils","WAArmadilloXMA.pb","WABase64","WAJids","WAMediaUtils","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m="You unsent a message";function n(a){switch(a.specialTextSize){case 1:return d("EchoMessage").MessageTextSize.SMALL;case 2:return d("EchoMessage").MessageTextSize.MEDIUM;case 3:return d("EchoMessage").MessageTextSize.LARGE;default:return d("EchoMessage").MessageTextSize.NONE}}function o(a,b){return d("MAWDbXMATxns").maybeGetXMAFromProtocolMsgId(a,d("MAWJidUtils").maybeToProtocolMsgId(b.author,b.threadJid,b.externalId)).then(function(e){if(e!=null)return e.previewMediaIds!=null?d("MAWDexieTable").dexieAll(e.previewMediaIds.map(function(b){return d("MAWDbMediaTxns").maybeGetMediaFromMediaId(a,b)})).then(function(a){for(a of a)if(a==null)return d("MAWDexieTable").dexieResolve({maybeErrorDetail:{errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"constructEchoMessage: DbMedia is null for the XMA message",uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.WARN},xmaData:void 0});return v(e)}):v(e);else{d("EBLogger").EBLogger.MUSTFIX(h||(h=babelHelpers.taggedTemplateLiteralLoose(["No XMA object found for msg with external id ",". Cannot upload XMA"])),b.externalId);return d("MAWDexieTable").dexieResolve({maybeErrorDetail:{errorCode:c("LSEBPayloadSerializerError").UNKNOWN_ERROR,errorMsg:"constructEchoMessage: no xma object found for msg with external id "+b.externalId,uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.WARN},xmaData:void 0})}})}function p(a,b){try{return d("MAWDbMsg").isMediaMsg(a)||a.type===d("MAWMsgType").MSG_TYPE.XMA||a.type===d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH}catch(e){a="[labyrinth_web] Invalid msg type for isMediaMsg check: "+String(e);d("EBLogger").EBLogger.catching(e).MUSTFIX(i||(i=babelHelpers.taggedTemplateLiteralLoose(["",""])),a);b.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:a,uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.FATAL};return!1}}function q(a,b){return{echoMessage:null,externalId:a,maybeErrorDetail:{errorCode:c("LSEBPayloadSerializerError").NOT_IMPLEMENTED,errorMsg:b,uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.WARN}}}function r(a,b,c){var e=d("MAWDexieTable").dexieResolve(c.threadJid),f={mediaMetadata:null,previewMetadata:null},g=p(c,f);g=g?t(a,c):d("MAWDexieTable").dexieResolve(f);f=u(a,c);b=c.quote!=null?B(a,c.quote,e,b):d("MAWDexieTable").dexieResolve();var h=d("MAWDbMsg").isXMAMsg(c)?o(a,c):d("MAWDexieTable").dexieResolve(null);a=d("MAWDbEditMsgHistoryTxns").getEditHistoryAsEchoWithJidPromise(a,c.externalId,c.author,e);return{editHistoryPromise:a,mediaMetadataUploadPromise:g,quotedMsgPromise:b,reactionsPromise:f,threadJidPromise:e,xmaDataUploadRequestPromise:h}}function s(a,b,c,e,f,g,h,i){var k,l=d("WAJids").threadIdForChatJid(a),o=h.serverTs;k=(k=h.editCount)!=null?k:0;g.length>0&&g.length-1!==h.editCount&&(d("EBLogger").EBLogger.WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Edit history has length ",", but edit count on message is ",""])),g.length,h.editCount),k=g.length-1);o={authoritativeTimestampMs:o!=null?o*1e3:void 0,contentSubtype:d("EchoMessage").EchoMessageContentSubtype.NONE,contentType:d("EchoMessage").EchoMessageContentType.TEXT,displayTimestampMs:h.ts*1e3,editCount:k,editHistory:g,from:d("EchoCommonUtils").craftEchoAddress(null,i,"AdvancedCrypto"),groupId:h.groupId,groupIndex:h.groupIndex,groupSize:h.groupSize,isForwarded:h.isForwarded,messageId:h.externalId,serializationOrigin:d("EchoMessage").EchoSerializationOriginType.WEB,sortOrderMs:d("MAWMessageSortOrderUtils").generateAuthoritativeMessageSortOrder(h),textSize:n(h),threadId:l,version:d("EchoMessage").ECHO_MESSAGE_MIGRATION_DOCUMENT_VERSION,xContentType:d("EchoEncodingUtils").convertDbMsgTypeToXMessageContentType(h.type),xMessagePlaceholderType:d("EchoMessage").EchoMessagePlaceholderType.NO_PLACEHOLDER,xOfflineThreadingId:h.externalId,xThreadId:l};((k=h.msgContent)==null?void 0:k.content)!=null&&(o=babelHelpers["extends"]({},o,{text:d("MAWVault").unvault(h.msgContent.content)}));h.type===d("MAWMsgType").MSG_TYPE.REVOKED&&(o.contentType=d("EchoMessage").EchoMessageContentType.PLACEHOLDER,o.contentSubtype=d("EchoMessage").EchoMessageContentSubtype.UNSEND,o.revokeSentTimestampMs=h.originalTs,o.revokeUnsentTimestampMS=h.unsendMsgContentDeleteTs,o.text=m);if(e!=null){g=A(e);i=d("MAWXMAUtils").isXMAStoryReply(e.xmaMessageType)?C(g.senderId,a):g.senderId;l=d("EchoCommonUtils").craftEchoAddress(null,i,"AdvancedCrypto");e.sortOrderMs!=null&&(o.quoteData={quoteMessageId:e.externalId,quoteMessageSender:l,quoteSortOrderInMs:e.sortOrderMs,replyType:h.type===d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE?d("EchoMessageQuoteFieldUtils").EchoMessageQuoteReplyType.BUMP:void 0,status:d("EchoMessageQuoteFieldUtils").EchoMessageQuoteStatus.VALID})}if(d("MAWMsgType").isMAWSupportedMediaType(h.type)){k=b.mediaMetadata;if(k!=null){o=babelHelpers["extends"]({},o,{contentType:d("EchoMessage").EchoMessageContentType.MEDIA,mediaData:k});a=b.previewMetadata;a!=null&&(o=babelHelpers["extends"]({},o,{previewMediaData:a}))}else if(h.type!==d("MAWMsgType").MSG_TYPE.XMA)return{echoMessage:o,externalId:h.externalId,maybeErrorDetail:b.maybeErrorDetail}}if(f!=null&&f.xmaData!=null&&h.type===d("MAWMsgType").MSG_TYPE.XMA){o.xmaData=f.xmaData;o.contentType=d("EchoMessage").EchoMessageContentType.XMA;if(o.mediaData==null&&((g=f.xmaData)==null?void 0:g.xmaDefaultCTA)!=null&&o.text==null){o.text=(i=f.xmaData)==null?void 0:i.xmaDefaultCTA}}else if(f!=null&&f.xmaData==null&&h.type===d("MAWMsgType").MSG_TYPE.XMA)return{echoMessage:o,externalId:h.externalId,maybeErrorDetail:f.maybeErrorDetail};h.type===d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH&&(o.receiverFetchId=h.receiverFetchId);return{echoMessage:babelHelpers["extends"]({},o,c),externalId:h.externalId}}function a(a,b){return d("MAWDexieTable").dexieAll(b.map(function(b){var c=b.dbMsg;b=b.quotedMsg;if(!d("MAWMsgType").isEBSupportedMsgType(c.type))return d("MAWDexieTable").dexieResolve(q(c.externalId,'constructEchoMessage: "'+String(c.type)+'" NYI'));if(c.serverTs==null)return d("MAWDexieTable").dexieResolve(q(c.externalId,'constructEchoMessage: "'+String(c.type)+'" Not authoritative msg. '));var e=d("WATimeUtils").castToUnixTime(0);if(c.serverTs===e||c.serverTs===null&&c.ts===e){e="constructEchoMessage: Invalid timestamp - timestamp for message corresponds to 1/1/1970";d("EBLogger").EBLogger.MUSTFIX(k||(k=babelHelpers.taggedTemplateLiteralLoose(["",""])),e);return d("MAWDexieTable").dexieResolve(q(c.externalId,e))}e=A(c);var f=e.senderId;e=r(a,b,c);b=e.editHistoryPromise;var g=e.mediaMetadataUploadPromise,h=e.quotedMsgPromise,i=e.reactionsPromise,j=e.threadJidPromise;e=e.xmaDataUploadRequestPromise;return d("MAWDexieTable").dexieAll([j,g,i,h,e,b]).then(function(a){var b=a[0],d=a[1],e=a[2],g=a[3],h=a[4];a=a[5];return s(b,d,e,g,h,a,c,f)})}))}function t(a,b){var e={mediaMetadata:null,previewMetadata:null};if(b.type===d("MAWMsgType").MSG_TYPE.XMA)return d("MAWDbXMATxns").maybeGetXMAFromProtocolMsgId(a,d("MAWJidUtils").maybeToProtocolMsgId(b.author,b.threadJid,b.externalId)).then(function(b){if(b!=null)return w(a,b);else{e.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] Media meta data couldn't be created for XMA because DbXMA is not in IndexedDB. This probably means the XMA message was not sent properly by ChatX.",uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.FATAL};return d("MAWDexieTable").dexieResolve(e)}});if(b.type===d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH){if(b.receiverFetchId==null){e.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] No receiver fetch id found in a receiver fetch msg",uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.FATAL};return d("MAWDexieTable").dexieResolve(e)}return d("MAWDbReceiverFetchTxns").maybeGetReceiverFetchInfoFromReceiverFetchId(a,b.receiverFetchId).then(function(a){if(a==null){e.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] No corresponding receiver fetch info found for receiver fetch msg",uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.FATAL};return d("MAWDexieTable").dexieResolve(e)}else return d("MAWDexieTable").dexieResolve(D(a))})}if(!d("MAWMsgType").isMAWSupportedMediaType(b.type)){e.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").NOT_SUPPORTED_ON_WEB,errorMsg:"[labyrinth_web] Media type is not supported for msg, type: "+b.type,uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.WARN};return d("MAWDexieTable").dexieResolve(e)}if(b.mediaId==null){e.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] No media id found in a media msg",uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.FATAL};return d("MAWDexieTable").dexieResolve(e)}var f=d("WATimeUtils").DAY_SECONDS*28,g=b.serverTs;if(g!=null&&d("WATimeUtils").unixTime()-g>f){e.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] Media is older than 28 days and is not being uploaded.",uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.WARN};return d("MAWDexieTable").dexieResolve(e)}return d("MAWDbMediaTxns").maybeGetMediaFromMediaId(a,b.mediaId).then(function(a){if(!a){e.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] No media db entry for media id",uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.FATAL};return d("MAWDexieTable").dexieResolve(e)}return d("MAWDexieTable").dexieResolve(x(b.msgId,a,!1))})}function u(a,b){b=d("MAWDbMsgUtil").getProtocolMsgIdFromDbMsg(b);return b==null?d("MAWDexieTable").dexieResolve():d("MAWDbReactionsTxns").getReactionForEcho(a,b).then(function(a){if(a!=null&&a.length>0){var b=d("WAJids").extractUserId(d("MAWUserJidWrapper").getMyUserJid()),c=a.map(function(a){var c=d("WAJids").authorToUserId(a.author,b);return d("EchoCommonUtils").craftEchoAddress(a.reaction,c,"AdvancedCrypto")}),e=a.map(function(a){var c=d("WAJids").authorToUserId(a.author,b);return d("EchoCommonUtils").craftEchoAddress((a.ts*1e3).toString(),c,"AdvancedCrypto")});a=a.map(function(a){var c=d("WAJids").authorToUserId(a.author,b);return d("EchoCommonUtils").craftEchoAddress(a.externalId.toString(),c,"AdvancedCrypto")});return{reactionAuthoritativeTimestampMs:e,reactions:c,reactionXOfflineThreadingIds:a}}})}function v(a){var b={xmaData:null};if(a.isTombstoned==null){b.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no isTombstoned to construct XMAData",uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.FATAL};return b}var e={xmaContentRef:a.contentRef,xmaDataclass:a.xmaDataclass,xmaHeaderSubtitle:a.overlayTitle,xmaHeaderTitle:a.headerTitle,xmaIsTombstoned:a.isTombstoned,xmaMaxSubtitleNumLines:a.maxSubtitleNumOfLines,xmaMaxTitleNumLines:a.maxTitleNumOfLines,xmaSubtitleText:a.subtitleText,xmaTargetExpiry:a.targetExpiringAtSec,xmaTargetId:a.targetId,xmaTargetUsername:a.targetUsername,xmaTitleText:a.titleText},f=a.xmaLayoutType||d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_XMA_LAYOUT_TYPE.SINGLE;e=babelHelpers["extends"]({},e,{xmaLayoutType:d("MAWConvertExtendedContentXMLLayoutTypeToXMALayoutType").convertExtendedContentXMLLayoutTypeToXMALayoutType(f)});a.targetType!=null&&(e=babelHelpers["extends"]({},e,{xmaTargetType:d("MAWConvertExtendedContentTargetTypeToXMATargetType").convertExtendedContentTargetTypeToXMATargetType(a.targetType)}));a.overlayIconGlyph!=null&&(e=babelHelpers["extends"]({},e,{xmaGatingType:d("MAWConvertExtendedContentOverlayIconGlyphToXMAGatingType").convertExtendedContentOverlayIconGlyphToXMAGatingType(a.overlayIconGlyph)}));a.defaultCTA!=null&&a.defaultCTA.nativeUrl!=null&&(e=babelHelpers["extends"]({},e,{xmaDefaultCTA:a.defaultCTA.nativeUrl}));b.xmaData=e;return b}function w(a,b){var e={mediaMetadata:null,previewMetadata:null};if(b.previewMediaIds!=null){var f=b.previewMediaIds[0];return d("MAWDbMediaTxns").maybeGetMediaFromMediaId(a,f).then(function(a){if(!a){e.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] No media db entry for media id to be used for xma",uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.WARN};return d("MAWDexieTable").dexieResolve(e)}var f=b.msgId;if(f==null){e.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] No message id found in a xma msg",uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.FATAL};return d("MAWDexieTable").dexieResolve(e)}return d("MAWDexieTable").dexieResolve(x(f,a,!0))})}else return d("MAWDexieTable").dexieResolve(e)}function x(a,b,e,f){var g;f={mediaMetadata:null,previewMetadata:null};g=(g=b.mediaEntries)==null?void 0:g.get(a);if(g==null){f.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no media entry to construct mediaMetadata",uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.FATAL};return f}a=d("WAMediaUtils").decodeMediaEntryData(g);g=(a==null?void 0:a.objectId)!=null?d("WAMediaUtils").stringToDeliveryObjectId(a.objectId):null;if(g==null){d("EBLogger").EBLogger.MUSTFIX(l||(l=babelHelpers.taggedTemplateLiteralLoose(["no objectId to construct mediaMetadata isXMA: ",""])),e);f.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no objectId to construct mediaMetadata",uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.FATAL};return f}var h=d("MAWGetAttachmentTypeForServerMediaType").getAttachmentTypeForServerMediaType(a.serverMediaType);if(h==null){f.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no attachment type to construct mediaMetadata",uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.FATAL};return f}var i=a.mediaKey;if(i==null){f.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no mediaKey to construct mediaMetadata",uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.FATAL};return f}var j=a.mediaKeyTimestamp;if(j==null){f.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no mediaKeyTimestamp to construct mediaMetadata",uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.FATAL};return f}var k=a.directPath;if(k==null){f.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no directPath to construct mediaMetadata",uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.FATAL};return f}if(a.serverMediaType==null){f.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no mediaContentType to construct mediaMetadata",uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.FATAL};return f}e=e?"image/jpeg":d("WAMediaUtils").getMimeTypeFromServerMediaType(a.serverMediaType);var m=d("MAWGetMediaAttachmentTypeForServerMediaType").getMediaAttachmentTypeForServerMediaType(a.serverMediaType);if(m==null){f.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no xAttachmentType to construct mediaMetadata",uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.FATAL};return f}if(a.serverMediaType!=null&&a.serverMediaType in{gif:1,image:1,sticker:1}&&b.validatedImageInfo==null){f.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no imageinfo to construct mediaMetadata",uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.FATAL};return f}if(a.serverMediaType==="video"&&b.validatedVideoInfo==null){f.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no videoinfo to construct mediaMetadata",uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.FATAL};return f}if(a.serverMediaType==="ptt"&&b.validatedAudioInfo==null){f.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no audioinfo to construct mediaMetadata",uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.FATAL};return f}if(a.fileSha256==null){f.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no WA fileSha256 found",uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.FATAL};return f}var n=d("WABase64").encodeB64UrlSafe(a.fileSha256);if(a.fileEncSha256==null){f.maybeErrorDetail={errorCode:c("LSEBPayloadSerializerError").MEDIA_INFO_INVALID,errorMsg:"[labyrinth_web] no WA fileEncSha256 found",uploadErrorType:d("EncryptedBackupsConstructEchoMessages").UploadErrorType.FATAL};return f}f=d("WABase64").encodeB64UrlSafe(a.fileEncSha256);var o=null,p=null,q=null,r=null,s=null,t=void 0,u=d("MAWGetPreviewContentTypeForMediaType").getPreviewContentTypeForMediaType(a.serverMediaType);if(b.validatedImageInfo!=null){var v;o=(v=b.validatedImageInfo.width)!=null?v:0;p=(v=b.validatedImageInfo.height)!=null?v:0;r=(v=b.validatedImageInfo.jpegThumbnailWidth)!=null?v:0;s=(v=b.validatedImageInfo.jpegThumbnailHeight)!=null?v:0}if(b.validatedVideoInfo!=null){o=(v=b.validatedVideoInfo.width)!=null?v:0;p=(v=b.validatedVideoInfo.height)!=null?v:0;r=(v=b.validatedVideoInfo.jpegThumbnailWidth)!=null?v:0;s=(v=b.validatedVideoInfo.jpegThumbnailHeight)!=null?v:0;q=(v=b.validatedVideoInfo.duration)!=null?v:0}if(b.validatedAudioInfo!=null){q=(v=b.validatedAudioInfo.duration)!=null?v:0}b.validatedDocumentFileInfo!=null&&(t=b.validatedDocumentFileInfo.filename);v={attachmentObjectId:g,attachmentType:h,directPath:k,encryptedHash:f,mediaBackupStatus:"success",mediaContentType:e,mediaKey:d("EchoEncodingUtils").convertMediaKeyToString(i),mediaKeyTimestamp:j,plaintextHash:n,size:b.size,xAttachmentType:m,xContentType:"full"};g=null;h=a.downloadableThumbnail;if((h==null?void 0:h.objectId)!=null){g={attachmentObjectId:h.objectId,attachmentType:d("EchoMessageMediaFieldUtils").AttachmentType.IMAGE,directPath:k,encryptedHash:f,mediaBackupStatus:"success",mediaContentType:"image/jpeg",mediaKey:d("EchoEncodingUtils").convertMediaKeyToString(i),mediaKeyTimestamp:j,plaintextHash:n,size:b.size,xAttachmentType:d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.MESSENGER_PREVIEW,xContentType:"preview"};e=h.fileSha256!=null?d("WABase64").encodeB64UrlSafe(h.fileSha256):null;m=h.fileEncSha256!=null?d("WABase64").encodeB64UrlSafe(h.fileEncSha256):null;a=h.mediaKey!=null?d("EchoEncodingUtils").convertMediaKeyToString(i):null;g=z(g,h.directPath,m,e,a,h.mediaKeyTimestamp)}v=y(v,null,u,o,p,q,r,s,t);return{mediaMetadata:v,previewMetadata:g}}function y(a,b,c,d,e,f,g,h,i){a=a;b!=null&&(a=babelHelpers["extends"]({},a,{backupEntFbid:b}));c!=null&&(a=babelHelpers["extends"]({},a,{previewContentType:c}));d!=null&&(a=babelHelpers["extends"]({},a,{width:d}));e!=null&&(a=babelHelpers["extends"]({},a,{height:e}));f!=null&&(a=babelHelpers["extends"]({},a,{mediaPlayableDuration:f*1e3}));g!=null&&(a=babelHelpers["extends"]({},a,{previewContentWidth:g}));h!=null&&(a=babelHelpers["extends"]({},a,{previewContentHeight:h}));i!=null&&(a=babelHelpers["extends"]({},a,{filename:i}));return a}function z(a,b,c,d,e,f){a=a;b!=null&&(a=babelHelpers["extends"]({},a,{directPath:b}));c!=null&&(a=babelHelpers["extends"]({},a,{encryptedHash:c}));d!=null&&(a=babelHelpers["extends"]({},a,{plaintextHash:d}));e!=null&&(a=babelHelpers["extends"]({},a,{mediaKey:e}));f!=null&&(a=babelHelpers["extends"]({},a,{mediaKeyTimestamp:f}));return a}function A(a){a=d("WAJids").authorToUserId(a.author,d("WAJids").userIdFromJid(d("MAWUserJidWrapper").getMyUserJid()));var b=d("MAWJids").toUserJid(a);return{senderId:a,senderJid:b}}function B(a,b,e,f){var g=b.content.msgId,h=b.content.externalId;return f!=null?d("MAWDexieTable").dexieResolve(f):d("MAWDbMsgTxns").maybeGetMsg(a,g).then(function(a){if(a==null)return e.then(function(a){var b=d("WAJids").threadIdForChatJid(a);d("MAWBridgeEventTransmitter").issuePointQueryOutsideTxn(h,b,void 0,c("LSMEBTaskCreationSource").POINT_QUERY_FROM_EB,a);return null});else return d("MAWDexieTable").dexieResolve(a)})}function C(a,b){var c=d("WAJids").extractUserId(d("MAWUserJidWrapper").getMyUserJid());b=d("WAJids").interpretAsUserJid(b);if(b==null)throw d("EBLogger").EBLogger.mustfixThrow("this is a flow check, participant jid can not be null");return a===c?d("WAJids").extractUserId(b):c}function D(a){return{mediaMetadata:{attachmentObjectId:a.receiverFetchId,attachmentType:d("EchoMessageMediaFieldUtils").AttachmentType.STICKER,directPath:"",encryptedHash:null,height:a.previewHeight,mediaContentType:"image/webp",plaintextHash:a.receiverFetchId,previewContentHeight:a.previewHeight,previewContentType:d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.STICKER,previewContentWidth:a.previewWidth,width:a.previewWidth,xAttachmentType:d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.STICKER,xContentType:d("EchoMessage").EchoXMessageContentType.STICKER},previewMetadata:null}}g.constructEchoMessage=a;g.constructXMAData=v;g.constructMediaMetadata=x;g.setConditionalFields=y}),98);
__d("EBUploadUniqueMessage",["EncryptedBackupsConstructEchoMessages","MAWEBSwitch","MAWEBUploadTrackingUtils","MAWMpsGating","MAWMsgType","MAWTraceUtils","Promise","WALogger","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function a(a,e,f,g,k){if(!c("MAWEBSwitch").isEnabled()){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Cannot proceed with encodeAndSendEchoMessage: Encrypted Backups are not enabled"])));f.forEach(function(a,b){d("MAWEBUploadTrackingUtils").endSuccessWorkerOnly(a,"upload_tracking_cancelled_eb_turned_off_upload",{string:{externalId:b,from:"uploadUniqueMessage"}})});return(j||(j=b("Promise"))).resolve()}if(d("MAWMpsGating").isEbUploadViaMpsEnabled()){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Skipping upload, as it should have been processed by MPS"])));return(j||(j=b("Promise"))).resolve()}k=a.filter(function(a){return d("MAWEBUploadTrackingUtils").isUploadSupported(a)}).map(function(a){var b;d("MAWEBUploadTrackingUtils").addUploadTrackingByType("point",f,a.externalId,"construct_echo_start",{bool:{isMedia:d("MAWMsgType").isMAWSupportedMediaType(a.type)},string:{msgType:a.type}});b=((b=d("MAWEBUploadTrackingUtils").getUploadTrackingInstanceKey(f,a.externalId))!=null?b:d("MAWTraceUtils").createTraceId()).toString();return{lastRetryTs:d("WATimeUtils").millisTime(),msg:a,retriedTimes:0,traceId:b}});return d("EncryptedBackupsConstructEchoMessages").uploadMessageFromUploadQueue(k.map(function(a){var b=a.msg.quoteExternalId;if(b!=null)return{dbMsg:a.msg,quotedMsg:e==null?void 0:e.get(b),traceId:a.traceId};else return{dbMsg:a.msg,traceId:a.traceId}}),f,g!=null?g:[],new Map()).then(function(){return(j||(j=b("Promise"))).resolve()})}g.uploadUniqueMessage__DEPRECATED_DO_NOT_USE=a}),98);
__d("EncryptedBackupsDYIFileUtils",["FBLogger"],(function(a,b,c,d,e,f,g){"use strict";var h="media";e="messages.zip";function i(){if(navigator.storage!=null&&navigator.storage.getDirectory!=null)return navigator.storage.getDirectory();throw c("FBLogger")("labyrinth_web").mustfixThrow("Storage management API is not supported. Please try one of the supported browsers.")}async function a(){var a=await i();return a.getDirectoryHandle(h,{create:!0})}async function b(a,b,d){a=await a.getFileHandle(b,{create:!0});try{b=await a.createSyncAccessHandle();b.write(d);b.flush();b.close()}catch(e){if(e instanceof Error){if(e instanceof TypeError)try{b=await a.createWritable();await b.write(d);await b.close();return}catch(a){if(a instanceof Error){if(a instanceof TypeError)throw c("FBLogger")("labyrinth_web").mustfixThrow("Write operation is not supported. Please try one of the supported browsers.");throw c("FBLogger")("labyrinth_web").mustfixThrow("Failed to write using writable: %e",a.message)}throw a}throw c("FBLogger")("labyrinth_web").mustfixThrow("Failed to write using sync access handle: %s",e.message)}throw e}}async function d(a,b){a=await a.getFileHandle(b);try{var d=await a.createSyncAccessHandle(),e=new ArrayBuffer(d.getSize());d.read(e);d.close();return new Blob([e])}catch(d){if(d instanceof Error){if(d instanceof TypeError)return a.getFile();throw c("FBLogger")("labyrinth_web").mustfixThrow("Failed to read file %s, %s",b,d.message)}throw d}}g.DyiMediaFolder=h;g.DyiArchiveFilename=e;g.getRootFolderHandle=i;g.getMediaFolderHandle=a;g.writeFile=b;g.readFile=d}),98);
__d("MAWThreadKeyUtils",["I64","vulture"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){return(h||(h=d("I64"))).to_string(a)}function b(a){return a}function e(a){c("vulture")("9DZDuAw4Bd5gY57CNHpZSR8vpLc=");return a}function f(a){return(h||(h=d("I64"))).of_string(a)}function i(a){return a}g.stringThreadKeyFromThreadKey=a;g.toStringThreadKey=b;g.stringThreadKeyFromString=e;g.stringThreadKeyToI64=f;g.stringThreadKeyToString=i}),98);
__d("EncryptedBackupsDYIGenerateThreadMetadata",["CurrentUser","EncryptedBackupsDYISingleton","I64","IGDWebUtils","LSMessagingThreadTypeUtil","MAWThreadKeyUtils","ReQL"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(){return d("IGDWebUtils").isOnInstagramWeb()?(j||(j=d("I64"))).of_string(c("CurrentUser").getEIMU()):(j||(j=d("I64"))).of_string(c("CurrentUser").getAccountID())}function l(a,b){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.tables.threads).getKeyRange(d("MAWThreadKeyUtils").stringThreadKeyToI64(b)))}function m(a,b){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.tables.contacts).getKeyRange(b))}function a(a,b){return d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.tables.contacts).filter(function(a){return b.has((j||(j=d("I64"))).to_string(a.id))}))}function n(a,b){var c;return(c=d("ReQL")).toArrayAsync(c.leftJoin(c.fromTableAscending(a.tables.participants,["contactId"]).getKeyRange(b),c.fromTableAscending(a.tables.contacts,["name"])))}function o(a){return d("LSMessagingThreadTypeUtil").isOneToOne(a)||d("LSMessagingThreadTypeUtil").isOpenOneToOne(a)}function p(a,b,c){if(c!=null&&c.trim()!=="")return c+"_"+b;switch(a.length){case 0:return"Thread_"+b;case 1:return a[0]+"_"+b;case 2:return a[0]+"and"+a[1]+"_"+b;case 3:return""+a[0]+a[1]+"and"+a[2]+"_"+b;case 4:return""+a[0]+a[1]+a[2]+"and1other_"+b;default:return""+a[0]+a[1]+a[2]+"and"+(a.length-3)+"others_"+b}}async function q(a,b,c,e,f,g){var i=[],k=[f];f=await l(c,a);if(f!=null)if(o(f.threadType)){var q=b.getThreadIdForThreadKey(a);if(q==null){b.getLogger().WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Cannot find thread id for thread key ",""])),a);return}q=await m(c,(j||(j=d("I64"))).of_string(q));(q==null?void 0:q.id)!=null&&(q==null?void 0:q.name)!=null&&b.setContactNameForContactId((j||(j=d("I64"))).to_string(q.id),q.name);q=(q==null?void 0:q.name)||"Unknown User";i.push(q);k.push(q);b.setThreadMetaDataByThreadKey(a,k,p(i,g,f.threadName))}else{q=await n(c,f.threadKey);q.forEach(function(a){var c=a[0];a=a[1];(c==null?void 0:c.contactId)!=null&&(a==null?void 0:a.name)!=null&&b.setContactNameForContactId((j||(j=d("I64"))).to_string(c.contactId),a.name);if(!(j||(j=d("I64"))).equal(c.contactId,e)){c=(a==null?void 0:a.name)||"Unknown User";i.push(c);k.push(c)}});b.setThreadMetaDataByThreadKey(a,k,p(i,g,f.threadName))}else b.setThreadMetaDataByThreadKey(a,k,p(i,g))}async function b(a){var b,c=d("EncryptedBackupsDYISingleton").getSingleton(),e=c.getLogger(),f=await c.getDB(),g=await m(f,k()),h=(b=g==null?void 0:g.id)!=null?b:(j||(j=d("I64"))).zero,l=(b=g==null?void 0:g.name)!=null?b:"Me";c.setContactNameForContactId((j||(j=d("I64"))).to_string(h),l);return a.reduce(async function(a,b,d){await a;a=c.getThreadIdForThreadKey(b);a==null&&void e.WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Cannot find thread id for thread key ",""])),b);return q(b,c,f,h,l,d)},Promise.resolve())}g.getAllUnmappedContacts=a;g.EncryptedBackupsDYIGenerateThreadMetadata=b}),98);
__d("EncryptedBackupsDYIZipUtils",["EncryptedBackupsDYIFileUtils","jszip"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m;async function a(a,b,e,f){f("stream_file_start");var g=new(c("jszip"))();for(a of a){var o=a.threadName+".json";g.file(o,JSON.stringify(a,null,2))}b.forEach(function(a){return n(g,a)});var p=g.generateInternalStream({compression:"DEFLATE",compressionOptions:{level:6},type:"Uint8Array"});o=await d("EncryptedBackupsDYIFileUtils").getRootFolderHandle();a=await o.getFileHandle("messages.zip",{create:!0});var q=await a.createWritable({keepExisting:!1,mode:"exclusive"});return new Promise(function(a,b){var c=0;p.on("data",function(a,d){p.pause(),c++,c%1e3===0&&void e.LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Writing "," (","%)"])),d.currentFile,d.percent),void q.write(a).then(function(){p.resume()},function(a){void e.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Error during data event"]))),f("stream_file_error"),b(a)})});p.on("end",function(){void e.LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Finished ZIP file generation. Saving the results"]))),f("stream_file_end"),f("write_file_start"),void q.close().then(function(){f("write_file_end"),void e.LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Closed the writing stream"]))),a()},function(a){void e.ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Error during end event"]))),f("write_file_error"),b(a)})});p.on("error",function(a){void e.ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Generic stream error"]))),f("stream_file_error"),b(a)});p.resume()})}function n(a,b){var c=b.split("/").pop(),e=d("EncryptedBackupsDYIFileUtils").getMediaFolderHandle().then(function(a){return d("EncryptedBackupsDYIFileUtils").readFile(a,c!=null?c:b)});a.file(b,e)}g.generateZipFile=a}),98);
__d("EncryptedBackupsDYISingleton",["EncryptedBackupsDYIFileUtils","EncryptedBackupsDYIGenerateThreadMetadata","EncryptedBackupsDYISingletonFactory","EncryptedBackupsDYITypes","EncryptedBackupsDYIZipUtils","FBLogger","I64","LSIntEnum","MAWBridge","MAWQplProxy","WAHashUtils"],(function(a,b,c,d,e,f,g){"use strict";var h=["senderId"],i,j,k,l,m,n,o,p,q,r,s,t,u,v=null;function w(){try{return WorkerGlobalScope!==void 0&&self instanceof WorkerGlobalScope}catch(a){return!1}}function a(a,b,e){if(v==null)switch(a){case d("EncryptedBackupsDYITypes").EncryptedBackupsDYIConfig.Armadillo:if(w())throw c("FBLogger")("labyrinth_web").mustfixThrow("EncryptedBackupsDYISingleton for Armadillo can only be initialised in the main thread");v=d("EncryptedBackupsDYISingletonFactory").getMAWEncryptedBackupsDYISingleton(b,e);break;case d("EncryptedBackupsDYITypes").EncryptedBackupsDYIConfig.Instamadillo:if(!w())throw c("FBLogger")("labyrinth_web").mustfixThrow("EncryptedBackupsDYISingleton for Instamadillo can only be initialised in the worker");v=d("EncryptedBackupsDYISingletonFactory").getIGDEncryptedBackupsDYISingleton(b,e);break}}function b(){if(v==null)throw c("FBLogger")("labyrinth_web").mustfixThrow("EncryptedBackupsDYISingleton is not initialised. Please call EncryptedBackupsDYISingleton.initSingleton() first.");return v}e=function(){function a(a,b,c,d){this.$5=new Map(),this.$6=new Set(),this.$7=new Set(),this.$8=new Map(),this.$9=new Map(),this.$10=new Map(),this.$11=new Map(),this.$12=new Map(),this.$1=a,this.$2=b,this.$3=c,this.$4=d}var b=a.prototype;b.getDB=function(){return this.$1()};b.getLogger=function(){return this.$4};b.getAllMediaUrls=function(){return Array.from(this.$5.values())};b.$13=function(a){return this.$5.get(a)};b.setMediaUrlByPlainTextHash=function(a,b){if(this.$5.has(a))return;this.$5.set(a,b)};b.addThreadKeyToThreadsRestoreInProgress=function(a){this.$6.add(a)};b.isThreadRestoreInProgressForThreadKey=function(a){return this.$6.has(a)};b.deleteThreadKeyFromThreadsRestoreInProgress=function(a){this.$6.delete(a),this.$4.LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Finished handling message range queries for thread with thread key ",". "," threads left"])),a,this.$6.size),this.$14()&&(this.$4.LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["DYI flow complete - generating output"]))),void this.$15())};b.isThreadsRestoreComplete=function(){return this.$6.size===0};b.addPlaintextHashToAttachmentDownloadsInProgress=function(a){this.$7.add(a),this.$4.LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Started processing attachment with plaintext hash ","."])),d("WAHashUtils").sanitisePlaintextHash(a))};b.deletePlaintextHashFromAttachmentDownloadsInProgress=function(a){this.$7.delete(a),this.$4.LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Finished processing attachment with plaintext hash ",". "," attachments left"])),d("WAHashUtils").sanitisePlaintextHash(a),this.$7.size),this.$7.size<30&&this.$4.LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Remaining attachments: ",""])),Array.from(this.$7).map(d("WAHashUtils").sanitisePlaintextHash).join(", ")),this.$14()&&(this.$4.LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["DYI flow complete - generating output"]))),void this.$15())};b.isAttachmentDownloadInProgressForPlaintextHash=function(a){return this.$7.has(a)};b.isAttachmentDownloadCompleteForPlaintextHash=function(a){return!!this.$5.get(a)};b.isAttachmentDownloadComplete=function(){return this.$7.size===0};b.setMessagesByThreadKey=function(a,b,c){a=this.getMessagesByThreadKey(a);a.set(b,c)};b.getMessagesByThreadKey=function(a){this.$16(a)||this.$8.set(a,new Map());return this.$8.get(a)};b.$16=function(a){return this.$8.has(a)};b.hasMessage=function(a,b){a=this.$8.get(a);return a==null?!1:a.has(b)};b.getThreadIdForThreadKey=function(a){return this.$10.get(a)};b.getThreadKeyForThreadId=function(a){return this.$11.get(a)};b.setThreadMapping=function(a,b){this.$10.set(a,b),this.$11.set(b,a)};b.setThreadMetaDataByThreadKey=function(a,b,c){this.$9.set(a,{participants:b,threadName:c})};b.getThreadMetadataMap=function(){return this.$9};b.setContactNameForContactId=function(a,b){this.$12.set(a,b)};b.getContactNameForContactId=function(a){return this.$12.get(a)};b.getContactNameMap=function(){return this.$12};b.getOutput=function(){var a=this;return Array.from(this.getThreadMetadataMap(),function(b){var c=b[0];b=b[1];var d=a.$16(c);d=d?Array.from(a.getMessagesByThreadKey(c),function(b){b[0];b=b[1];return babelHelpers.extends({},b,{media:Array.from(b.media,function(b){b=a.$13(b);return{uri:b!=null?"./"+b:"Failed to download media"}})})}):[];d=d.map(function(b){var c=b.senderId,d=babelHelpers.objectWithoutPropertiesLoose(b,h);if(c!=null&&d.senderName==="Unknown User"){c=a.getContactNameForContactId(c);if(c!=null)return babelHelpers.extends({},d,{senderName:c})}return b});c=d.sort(function(a,b){return typeof a.timestamp==="number"&&typeof b.timestamp==="number"?a.timestamp-b.timestamp:0});return babelHelpers.extends({},b,{messages:c})})};b.$14=function(){return this.isAttachmentDownloadComplete()&&this.isThreadsRestoreComplete()};b.$17=function(a){switch(a){case 0:return d("EncryptedBackupsDYITypes").EncryptedBackupsDYIState.InProgress;case 1:return d("EncryptedBackupsDYITypes").EncryptedBackupsDYIState.Completed;case 2:return d("EncryptedBackupsDYITypes").EncryptedBackupsDYIState.Failed;case-1:default:return d("EncryptedBackupsDYITypes").EncryptedBackupsDYIState.NotStarted}};b.updateDYIStatus=async function(a){var b=await this.getDB();await b.runInTransaction(async function(b){await b.encrypted_backups_dyi_backup_restore_status.put({currentStatus:(t||(t=d("LSIntEnum"))).ofNumber(a),pk:(u||(u=d("I64"))).zero})},"readwrite",void 0,void 0,f.id+":517");d("MAWBridge").getBridge().fireAndForget("event","updateDYIStatus",{qplEvent:this.$2,qplInstanceKeyE2E:(b=this.$3)!=null?b:void 0,status:this.$17(a)})};b.$18=async function(){var a=this,b=new Set();this.getContactNameMap().forEach(function(a,c){a==="Unknown User"&&b.add(c)});var c=await this.getDB();c=await d("EncryptedBackupsDYIGenerateThreadMetadata").getAllUnmappedContacts(c,b);c.forEach(function(b){var c=(u||(u=d("I64"))).to_string(b.id);a.setContactNameForContactId(c,b.name)});this.$4.LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["Fetched remaining contact names, total of "," contacts"])),this.getContactNameMap().size.toString())};b.$15=async function(){var a=this;this.logDYIQPLPoint("complete_dyi_flow_start");await this.$18();this.$4.LOG(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Generating output"])));var b=this.getOutput(),c=Array.from(this.$5.values());this.$4.LOG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["Generating zip file"])));try{await d("EncryptedBackupsDYIZipUtils").generateZipFile(b,c,this.$4,function(b,c){a.logDYIQPLPoint(b,c)}),this.logDYIQPLPoint("complete_dyi_flow_end"),await this.updateDYIStatus(1)}catch(a){this.$4.ERROR(r||(r=babelHelpers.taggedTemplateLiteralLoose(["Failed to generate zip file: ",""])),a),this.logDYIQPLPoint("complete_dyi_flow_error"),await this.updateDYIStatus(2)}finally{void this.clear()}};b.exitDYIEarly=async function(a,b){b!=null&&this.$4.LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["DYI Exiting Early - Found "," instamadillo threads"])),b),this.logDYIQPLPoint("dyi_exit_early",{int:{dyi_threads:b}}),await this.updateDYIStatus(a?2:1),void this.clear()};b.clear=async function(){this.$5=new Map();this.$6=new Set();this.$7=new Set();this.$8=new Map();this.$9=new Map();var a=await d("EncryptedBackupsDYIFileUtils").getRootFolderHandle();await a.removeEntry(d("EncryptedBackupsDYIFileUtils").DyiMediaFolder,{recursive:!0})};b.logDYIQPLPoint=function(a,b){this.$3!=null&&d("MAWQplProxy").sendQplPointThroughBridge(this.$2,a,{annotations:b,instanceKey:this.$3})};return a}();g.initSingleton=a;g.getSingleton=b;g.EncryptedBackupsDYISingleton=e}),98);
__d("EncryptedBackupsDYISingletonFactory",["EncryptedBackupsDYISingleton","WATagsLogger","qpl"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return new(d("EncryptedBackupsDYISingleton").EncryptedBackupsDYISingleton)(a,c("qpl")._(521478596,"1329"),b,d("WATagsLogger").TAGS(["labyrinth_web","labyrinth_dyi",b==null?"":b.toString()]))}function b(a,b){return new(d("EncryptedBackupsDYISingleton").EncryptedBackupsDYISingleton)(a,c("qpl")._(521479842,"2163"),b,d("WATagsLogger").TAGS(["igd_labyrinth_web","igd_dyi",b==null?"":b.toString()]))}g.getMAWEncryptedBackupsDYISingleton=a;g.getIGDEncryptedBackupsDYISingleton=b}),98);
__d("EncryptedBackupsDYIMediaDownloadHandlers",["EncryptedBackupsDYIFileUtils","EncryptedBackupsDYISingleton","FBLogger","WAResultOrError","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";a=async function(a,b,e,f){f=await d("EncryptedBackupsDYIFileUtils").getMediaFolderHandle();b=b.split("/")[1];b=c("uuidv4")()+"."+b;await d("EncryptedBackupsDYIFileUtils").writeFile(f,b,e);f=d("EncryptedBackupsDYISingleton").getSingleton();f.setMediaUrlByPlainTextHash(a,d("EncryptedBackupsDYIFileUtils").DyiMediaFolder+"/"+b);f.deletePlaintextHashFromAttachmentDownloadsInProgress(a);return d("WAResultOrError").makeResult()};b=function(){c("FBLogger")("labyrinth_web").debug("[DYIMediaPreviewHandler] Skipping previews for DYI");return Promise.resolve(d("WAResultOrError").makeResult())};g.DYIMediaDownloadHandler=a;g.DYIMediaPreviewHandler=b}),98);
__d("MAWMediaPreviewDownloadManager",["WAResolvable"],(function(a,b,c,d,e,f,g){"use strict";var h=1e4,i=[],j=new Map();function a(a){if(j.has(a))return;l();var b=new(d("WAResolvable").Resolvable)();j.set(a,b);i.push(a)}function b(a,b){var c=j.get(a);if(c==null)return;c.reject(b);k(a)}function c(a){return j.get(a)}function k(a){j["delete"](a)}function l(){if(i.length>=h){var a=i.shift();a!=null&&j["delete"](a)}}function e(){i=[],j.clear()}g.markMediaPreviewAsDownloading=a;g.markMediaPreviewAsFailed=b;g.getMediaPreviewDownloadingResolvable=c;g.removeMediaPreviewDownloadingResolvable=k;g.clear=e}),98);
__d("MAWHandleMediaPreviewBeforeDownloadApi",["MAWMediaPreviewDownloadManager","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a){d("MAWMediaPreviewDownloadManager").markMediaPreviewAsDownloading(a);return(h||(h=b("Promise"))).resolve()};g.handleMediaPreviewBeforeDownload=a}),98);
__d("MAWHandleMediaPreviewDownloadApi",["MAWBridgeTypesCreators","MAWDbMediaTxns","MAWDbMsgTxns","MAWDexieTable","MAWIndexedDb","MAWLoggerUtils","MAWMediaAfterTxns","MAWMediaDownloadStatus","MAWMediaDownloadStatusForUI","MAWMediaPreviewDownloadManager","MAWMediaUtils","MAWTransactionMode","MWFBLogger","WACryptoSha256","WAHashUtils","WAResultOrError","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=d("MWFBLogger").MWMediaLogger.tags([d("MAWLoggerUtils").Tag.MediaDownload,d("MAWLoggerUtils").Tag.MessageReceive,"MediaPreview"]);a=async function(a,b,e,f){var g=d("WAHashUtils").toPlaintextHash(await d("WACryptoSha256").sha256(b));d("MAWMediaDownloadStatusForUI").sendMediaDownloadStatusToUI({details:"handle_media_download",hash:a,status:c("MAWMediaDownloadStatus").DOWNLOADING,type:"preview"});var h=d("MAWMediaPreviewDownloadManager").getMediaPreviewDownloadingResolvable(a);h!=null&&(h.resolve(new Blob([b],{type:"image/jpeg"})),d("MAWMediaPreviewDownloadManager").removeMediaPreviewDownloadingResolvable(a));return k(a,g,b,e,f)};var k=d("MAWIndexedDb").makeMsgrTransactor({chunk:(b=d("MAWTransactionMode")).READWRITE,media:b.READWRITE,messages:b.READONLY,threads:b.READONLY},"handleMediaPreviewDownload",function(a){return function(b,e,f,g,k){return d("MAWDexieTable").dexieAll([d("MAWDbMediaTxns").maybeGetMediaFromPlaintextHash(a,b),d("MAWDbMsgTxns").maybeGetMsgByProtocolMsgId(a,k)]).then(function(k){var l=k[0],m=k[1];j.DEBUG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Handling preview for main hash ","... preview hash ","..."])),d("WAHashUtils").sanitisePlaintextHash(b),d("WAHashUtils").sanitisePlaintextHash(e));if(l==null){d("MAWMediaDownloadStatusForUI").sendMediaDownloadStatusToUI({details:"missing_media_on_save",hash:b,status:c("MAWMediaDownloadStatus").MANUAL_RETRYABLE_FAILURE,type:"preview"});j.WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Main media for preview is null. Type: ",""])),g);return d("WAResultOrError").makeError("missing-media-on-save")}k=function(){switch(g){case"image":return a.media.update(l.mediaId,babelHelpers.extends({},l,{validatedImageInfo:babelHelpers.extends({},l.validatedImageInfo,{jpegThumbnail:f})}));case"video":return a.media.update(l.mediaId,babelHelpers.extends({},l,{validatedVideoInfo:babelHelpers.extends({},l.validatedVideoInfo,{jpegThumbnail:f})}));default:g;return d("MAWDexieTable").dexieResolve()}};d("MAWMediaDownloadStatusForUI").sendMediaDownloadStatusToUI({details:"handle_media_download_success",hash:b,status:c("MAWMediaDownloadStatus").SUCCESS,type:"preview"});c("gkx")("9695")||(k(),k=function(){return d("MAWDexieTable").dexieResolve()});return k().then(function(){return a.messages.where("msgId").anyOf(l.msgIds).toArray().then(function(b){return a.threads.where("jid").anyOf(b.map(function(a){return a.threadJid})).toArray().then(function(c){return d("MAWDexieTable").dexieAll(c.map(function(c){var e=d("MAWMediaUtils").createHdTypesForBridgeMedia(b);c=d("MAWBridgeTypesCreators").createBridgeMedia({chatJid:c.jid,filteredMsgIds:d("MAWBridgeTypesCreators").getMsgIdsFilteredByJid(b,c.jid),hasMediaForUI:!0,hdTypes:e,media:l,sortOrderMs:m==null?void 0:m.sortOrderMs});return d("MAWMediaAfterTxns").handleNewMediaAfterTxnWithBridgeMedia(a,c,b)})).then(function(){return d("WAResultOrError").makeResult()})})})})})}});g.handleMediaPreviewDownload=a}),98);
__d("MAWHandleMediaPreviewDownloadAsFailedApi",["MAWMediaPreviewDownloadManager","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a,c){d("MAWMediaPreviewDownloadManager").markMediaPreviewAsFailed(a,c);return(h||(h=b("Promise"))).resolve()};g.handleMediaPreviewDownloadFailed=a}),98);
__d("MebWAMediaDownloader",["MAWHandleMediaPreviewBeforeDownloadApi","MAWHandleMediaPreviewDownloadApi","MAWHandleMediaPreviewDownloadAsFailedApi","WAAPI","WAIsMediaExpiredError","WALogger","WAStartMediaDownloadQplFlow","WATimeUtils","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h,i;a=function(){function a(a,b,c){this.mediaDownloadMetadata=a,this.downloadCallbacks=b,this.waApiDownloadCall=c}var b=a.prototype;b.handle=async function(){var a,b=this.mediaDownloadMetadata.mediaEntry.mediaKeyTimestamp;if(b==null){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web][WAMediaDownloader] Cannot download media - missing mediaKeyTimestamp"])));return this.handleError()}b=!d("WATimeUtils").happenedWithin(b,29*d("WATimeUtils").DAY_SECONDS);a=(a=this.mediaDownloadMetadata.isUrlRenewed)!=null?a:!1;if(!a&&(b||c("gkx")("23960"))){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] downloading media from MI directly"])));return this.handleUrlExpired()}a=this.mediaDownloadMetadata;b=a.hash;var e=a.mediaEntry;a=a.protocolMsgId;b=await this.waApiDownloadCall(b,e,a);if(b.success)return this.downloadCallbacks.onDownloadSuccess({mimeType:b.value.mimeType,plaintext:b.value.plaintext});if(d("WAIsMediaExpiredError").isMediaExpiredError(b.error))return this.handleUrlExpired();else return this.handleError()};b.handleUrlExpired=async function(){var a;await this.downloadCallbacks.onUrlExpired();return(a=this.mediaDownloadHandler)==null?void 0:a.handle()};b.handleError=async function(){var a;await this.downloadCallbacks.onDownloadError();return(a=this.mediaDownloadHandler)==null?void 0:a.handle()};b.getDownloadMetadata=function(){return this.mediaDownloadMetadata};b.setNextHandler=function(a){this.mediaDownloadHandler=a};return a}();b=function(a,b,e){var f=d("WAStartMediaDownloadQplFlow").startMediaDownloadQplFlow({downloadEntry:"MebWAMediaDownloader",msgType:null,protocolMsgId:e,triggerUIView:null});return c("WAAPI").downloadMedia({downloadMediaMetric:f,handleMediaPreviewBeforeDownload:d("MAWHandleMediaPreviewBeforeDownloadApi").handleMediaPreviewBeforeDownload,handleMediaPreviewDownload:d("MAWHandleMediaPreviewDownloadApi").handleMediaPreviewDownload,handleMediaPreviewDownloadFailed:d("MAWHandleMediaPreviewDownloadAsFailedApi").handleMediaPreviewDownloadFailed,hash:a,mediaEntry:b,protocolMsgId:e})};g.MebWAMediaDownloader=a;g.MebWADownloadMediaFromWorker=b}),98);
__d("EncryptedBackupsDYIMessageProcessingUtils",["EncryptedBackupsDYIMediaDownloadHandlers","EncryptedBackupsDYISingleton","FBLogger","MAWBridge","MAWFrontendMediaUtils","MebWAMediaDownloader","WAHashUtils","WAJids","WALongInt","WAMediaUtils","WAProgressiveJpegGetScanLengths","WAResultOrError","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q;function a(a,b){return{isUnsent:!1,media:new Set(),reactions:[],senderName:r(a),text:"",timestamp:b!=null?b:0,type:""}}function r(a){var b=d("EncryptedBackupsDYISingleton").getSingleton(),c="Unknown User";if(a!=null){b=b.getContactNameForContactId(a);b!=null&&(c=b)}return c}async function b(a,b,e,f){var g=d("EncryptedBackupsDYISingleton").getSingleton(),l=g.getLogger(),m=l.TAGS([d("WAHashUtils").sanitisePlaintextHash(a)]);c("FBLogger")("labyrinth_web").tags(["labyrinth_dyi"]).debug("Sending the media download bridge call for plaintext hash: %s",d("WAHashUtils").sanitisePlaintextHash(a));f=await d("MAWBridge").getBridge().sendAndReceive("backend","dyiDownloadMediaV2",{mediaEntry:f,plaintextHash:a,protocolMsgId:b,sortOrderMs:e});c("FBLogger")("labyrinth_web").tags(["labyrinth_dyi"]).debug("Received the media download result from the bridge for plaintext hash: %s, success: %s, error: %s",d("WAHashUtils").sanitisePlaintextHash(a),f.success?"true":"false",f.error);if(f.success){e=f.value;var n=e.unvalidatedMimeType;e=e.validatedResult;n=e.skipValidation?n:e.mimeType;n=await d("EncryptedBackupsDYIMediaDownloadHandlers").DYIMediaDownloadHandler(a,n,e.validatedPlaintext,b);if(!n.success){m.WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Failed to save media: ",", ",""])),n.error,n.payload);l.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Failed to save media: ",", ",""])),n.error,n.payload);g.deletePlaintextHashFromAttachmentDownloadsInProgress(a);return}}else{m.WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media: ",", ",""])),f.error,f.payload);l.ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media: ",", ",""])),f.error,f.payload);g.deletePlaintextHashFromAttachmentDownloadsInProgress(a);return}}function e(a,b,c,e,f,g,h,i,j,k,r){var s=d("EncryptedBackupsDYISingleton").getSingleton(),t=s.getLogger(),u=t.TAGS([d("WAHashUtils").sanitisePlaintextHash(j)]),v={author:d("WAJids").toMsgrUserJid(h),chat:d("WAJids").toMsgrUserJid(f),externalId:i},w={hash:j,isUrlRenewed:!1,mediaEntry:e,protocolMsgId:v,sortOrderMs:k};h={onDownloadError:function(){u.WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media"])));t.ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media"])));s.deletePlaintextHashFromAttachmentDownloadsInProgress(w.hash);return Promise.resolve()},onDownloadSuccess:async function(a){u.LOG(n||(n=babelHelpers.taggedTemplateLiteralLoose(["Successfully downloaded media"])));var b=a.mimeType;a=a.plaintext;await d("EncryptedBackupsDYIMediaDownloadHandlers").DYIMediaDownloadHandler(w.hash,b,a,v)},onUrlExpired:function(){u.LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["Media CDN URL has expired and should be renewed"])));return Promise.resolve()}};var x=new(d("MebWAMediaDownloader").MebWAMediaDownloader)(w,h,a),y=e.serverMediaType;e=e.objectId;if(y!=null&&e!=null&&typeof k==="number"){b={backupEntFbid:b,deliveryObjectId:e,hash:j,mediaType:y,messageId:i,productType:c,sortOrder:k,threadId:f,threadKey:g};e={onResignCdnUrlFailure:function(a){u.WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Failed to resign CDN URL: ",""])),a.message);t.ERROR(q||(q=babelHelpers.taggedTemplateLiteralLoose(["Failed to resign CDN URL: ",""])),a.message);s.deletePlaintextHashFromAttachmentDownloadsInProgress(w.hash);return Promise.resolve()},onResignCdnUrlSuccess:async function(){}};j=r(b,e);x.setNextHandler(j);j.setNextHandler(new(d("MebWAMediaDownloader").MebWAMediaDownloader)(w,h,a))}void x.handle()}function f(a,b,c){var e,f,g,h;e=(e=a.integral)==null||(e=e.transport)==null||(e=e.ancillary)==null?void 0:e.mimetype;if(e==null)return d("WAResultOrError").makeError("mime-type-missing");e=d("MAWFrontendMediaUtils").getMediaTypeAndServerMediaTypeFromBlob(e,b).serverMediaType;if(e==null)return d("WAResultOrError").makeError("server-media-type-missing");b=(b=a.integral)==null||(b=b.transport)==null||(b=b.integral)==null?void 0:b.directPath;if(b==null)return d("WAResultOrError").makeError("direct-path-missing");f=(f=a.integral)==null||(f=f.transport)==null||(f=f.integral)==null?void 0:f.fileSha256;if(f==null)return d("WAResultOrError").makeError("plaintext-hash-missing");g=d("WALongInt").maybeNumber((g=a.integral)==null||(g=g.transport)==null||(g=g.integral)==null?void 0:g.mediaKeyTimestamp);if(g==null)return d("WAResultOrError").makeError("media-key-timestamp-missing");var i;if(((h=a.ancillary)==null?void 0:h.scanLengths)!=null&&((h=a.ancillary)==null?void 0:h.scansSidecar)!=null){h=a.ancillary;var j=h.scanLengths;h=h.scansSidecar;i={scanLengths:j.map(d("WAProgressiveJpegGetScanLengths").asProgressiveJpegScanLength),sidecar:h}}var k;if(((j=a.integral)==null||(j=j.transport)==null||(j=j.ancillary)==null||(j=j.thumbnail)==null?void 0:j.downloadableThumbnail)!=null){h=a.integral.transport.ancillary.thumbnail.downloadableThumbnail;j=h.directPath;var l=h.fileEncSha256,m=h.fileSha256,n=h.mediaKey,o=h.mediaKeyTimestamp;h=h.objectId;k={directPath:j,fileEncSha256:l,fileSha256:m,mediaKey:n,mediaKeyTimestamp:d("WALongInt").maybeNumber(o),objectId:h}}o={directPath:b,downloadableThumbnail:k,fileEncSha256:(j=a.integral)==null||(j=j.transport)==null||(j=j.integral)==null?void 0:j.fileEncSha256,filename:c,fileSha256:f,mediaKey:(l=a.integral)==null||(l=l.transport)==null||(l=l.integral)==null?void 0:l.mediaKey,mediaKeyTimestamp:d("WATimeUtils").castToUnixTime(g),objectId:(m=a.integral)==null||(m=m.transport)==null||(m=m.ancillary)==null?void 0:m.objectId,progressiveJpegDetails:i,serverMediaType:e,size:d("WALongInt").maybeNumber((n=a.integral)==null||(n=n.transport)==null||(n=n.ancillary)==null?void 0:n.fileLength)};return d("WAResultOrError").makeResult(d("WAMediaUtils").rawDataToMediaEntry(o))}g.buildBaseDyiMessage=a;g.getSenderName=r;g.downloadMediaWithMediaManager=b;g.startMediaDownloadChain=e;g.decodeMediaEntryFromAttachmentPayload=f}),98);
__d("MAWCiphertextRecoveryLogging",["FBLogger","MAWMsgType","ODS"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){var c=new Set(a.filter(function(a){return a.type===d("MAWMsgType").MSG_TYPE.CIPHERTEXT}).map(function(a){return a.externalId}));a=b.filter(function(a){return a.type!==d("MAWMsgType").MSG_TYPE.CIPHERTEXT&&c.has(a.externalId)});if(a.length===0)return;i(a.length)}function i(a){a===void 0&&(a=1),(h||(h=d("ODS"))).bumpEntityKey(3185,"mwchat_ciphertext_recovered_by_eb","Ciphertext recovered by EB",a),c("FBLogger")("messenger_web").info("Ciphertext recovered by EB, count: %s",a)}g.compareAndLogCiphertextRecoveredByEB=a;g.logCiphertextRecoveredByEB=i}),98);
__d("MAWDbRavenActionTxns",["FBLogger","MAWBridgeTypesCreators","MAWDbMsg","MAWIndexedDb","MAWMsg","MAWRavenUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e){return a.messages.where("externalId").equals(b.ravenActionToMsgExternalId).filter(function(a){return a.threadJid===e.jid}).first().then(function(f){var g=f==null?void 0:f.msgId;if(g==null){c("FBLogger")("maw_incoming_handlers").warn("[MAWDbRavenActionTxns] Cannot Write Raven Action without ID of Raven Message.");return}return h(a,f).then(function(c){var d=babelHelpers["extends"]({msgId:g,threadJid:e.jid},b);return a.unrenderedMessages.add(d).then(function(a){return babelHelpers["extends"]({rowId:a},d)})}).then(function(a){d("MAWIndexedDb").afterTransaction({tag:"RavenActionUpdate",value:d("MAWBridgeTypesCreators").createBridgeRavenAction(a)});return})})}function h(a,b){if((b==null?void 0:b.type)!=="Raven")throw c("FBLogger")("messenger_web").mustfixThrow("Cannot Modify Message because Message is not Raven Message");var e=[d("MAWMsg").MAWRavenMsgEphemeralMediaState.cast(Number(b.ravenEphemeralMediaState)),d("MAWMsg").MAWRavenMsgEphemeralType.cast(Number(b.ravenEphemeralType))],f=e[0];e=e[1];if(f==null||e==null)throw c("FBLogger")("messenger_web").mustfixThrow("ravenEphemeralMediaStateEnum or ravenEphemeralTypeEnum is null");f=d("MAWRavenUtils").getNextRavenMessageEphemeralState(f,e);return a.messages.put(babelHelpers["extends"]({},b,{ravenEphemeralMediaState:f}))}function b(a,b,c){c=d("MAWDbMsg").isRavenActionMsgType(c)&&(b==null?void 0:b.externalId)!=null?[b.externalId]:[];return a.messages.where("externalId").anyOf(c).filter(function(a){return a.author===(b==null?void 0:b.author)&&a.threadJid===(b==null?void 0:b.chat)}).first()}g.writeRavenActionMsg=a;g.modifyRavenMsgWithActionMsg=h;g.maybeGetRavenMsgQueryByProtocolMsgId=b}),98);
__d("MAWEncryptedBackupCacheManager",[],(function(a,b,c,d,e,f){"use strict";var g=new Map();function h(a){return g.has(a)}function a(a){return g.get(a)}function b(a){h(a)&&g["delete"](a)}function c(a,b){g.set(a,b)}f.peekPendingStanzaCache=h;f.getPendingStanzaCacheValue=a;f.removePendingStanzaCacheValue=b;f.addPendingStanzaToPendingStanzaCache=c}),66);
__d("MAWHandlePendingStanzasInRestoreV2",["EBUploadUniqueMessage","LSMEBTaskCreationSource","MAWBridgeEventTransmitter","MAWDbPendingStanza","MAWDbPendingStanzaTxns","MAWDexieTable","MAWEBUploadTrackingUtils","MAWEncryptedBackupCacheManager","MAWIndexedDb","MAWTransactionMode","MAWWriteRevokeMessageTxns","Promise","WAJids","WALogger","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r,s,t,u;a=function(a,c,d){a=a.restoredMsgsData;if(a){var e=a.newlyAddedMsgs;e=e.concat(a.existingMsgs);return v(e,c,d)}return(u||(u=b("Promise"))).resolve()};var v=function(a,e,f){f==null||f.addPoint("apply_pending_stanza_start");var g=0,k=0,l=0,m=0,n=new Map();return D().then(function(a){a==null||a.map(function(a){var b=a.pendingContent.content.externalId;if(b==null){d("WALogger").WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] externalId is null for pendingStanza"])));return}n.set(a.externalIdWithType,a)}),m=n.size}).then(function(){var b=new Set();return z(a).then(function(f){return d("MAWDexieTable").dexieAll(a.map(function(a){var c=a.externalId,h=f.get(a.threadJid);if(h==null){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Could not find thread for chatId "," for pendingStanza"])),a.threadJid);return d("MAWDexieTable").dexieResolve()}if(e)if(d("MAWEncryptedBackupCacheManager").peekPendingStanzaCache(c)){var m=d("MAWEncryptedBackupCacheManager").getPendingStanzaCacheValue(c);if(m==null){d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Pending Stanza not found in the cache. This shouldn't happen."])));return}return y(m,a,h,e).then(function(a){a!=null&&b.add(m);d("MAWEncryptedBackupCacheManager").removePendingStanzaCacheValue(c);n["delete"](m.externalIdWithType);a=m.pendingContent.type;a===d("MAWDbPendingStanza").PENDING_TYPE.REVOKED&&g++;k++})}else n.clear();else{var o=c+"_"+d("MAWDbPendingStanza").PENDING_REVOKED,p=n.get(o);if(p!=null)return y(p,a,h,e).then(function(a){a!=null&&(b.add(p),g++,l++),n["delete"](p.externalIdWithType)})}})).then(function(){if(!e){var a=w(n);g+=a[1];k+=a[0]+a[1];c("promiseDone")(x(Array.from(b)))}})})}).then(function(a){f==null||f.addPoint("apply_pending_stanza_end",{"int":{initialRestorePendingStanzaCount:l,pendingStanzasToBeUploadedCount:m,pointRestorePendingStanzaCount:k,revokedCount:g}});return(u||(u=b("Promise"))).resolve()})},w=function(a){var b=0,c=0;a.forEach(function(a){var e=a.pendingContent.type;e===d("MAWDbPendingStanza").PENDING_TYPE.REVOKED?c++:e===d("MAWDbPendingStanza").PENDING_TYPE.DELETE_FOR_ME&&b++;C(a)});a.clear();return[b,c]},x=(e=d("MAWIndexedDb")).makeMsgrTransactor({pendingStanzas:(f=d("MAWTransactionMode")).READWRITE},"deletePendingStanzasFromIndexedDB",function(a){return function(b){return d("MAWDbPendingStanzaTxns").deletePendingStanzas(a,b)}}),y=function(a,e,f,g){var h=a.pendingContent.type;if(h===d("MAWDbPendingStanza").PENDING_TYPE.REVOKED)return B(a,e,f,g).then(function(a){if(a!=null){var b=d("MAWEBUploadTrackingUtils").genInstanceKeyOnly();d("MAWEBUploadTrackingUtils").startUploadTracking(a.externalId,a.type,"upload-pending-stanza",b,!1,!1,void 0,"echo_only");c("promiseDone")(d("EBUploadUniqueMessage").uploadUniqueMessage__DEPRECATED_DO_NOT_USE([a],void 0,new Map([[a.externalId,b]]),void 0,"revoked_message"))}});else if(h===d("MAWDbPendingStanza").PENDING_TYPE.DELETE_FOR_ME)return A(a);else{d("WALogger").WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] pendingStanza type "," is not supported"])),h);return(u||(u=b("Promise"))).resolve()}},z=e.makeMsgrTransactor({threads:f.READONLY},"getThreadsForMessages",function(a){return function(b){var c=[];b.forEach(function(a){c.push(a.threadJid)});return a.threads.where("jid").anyOf(c).toArray().then(function(a){var b=new Map();a.forEach(function(a){if(a==null){d("WALogger").WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] thread is null"])));return d("MAWDexieTable").dexieResolve()}b.set(a.jid,a)});return b})}}),A=e.makeMsgrTransactor({pendingStanzas:f.READWRITE},"deleteForMeMsg",function(a){return function(b){d("WALogger").LOG(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Delete For Me pending stanza does not need to be applied."])));return d("MAWDexieTable").dexieAll([a.pendingStanzas["delete"](b.rowId)]).then(function(){return d("MAWDexieTable").dexieResolve(b)})}}),B=e.makeMsgrTransactor({chunk:f.READONLY,deletedMessages:f.READWRITE,ftsPurgeBacklog:f.READWRITE,groupInfo:f.READWRITE,media:f.READONLY,messages:f.READWRITE,pendingStanzas:f.READWRITE,reactions:f.READWRITE,threads:f.READWRITE,xma:f.READONLY},"revokeMessage",function(a){return function(b,c,e,f){var g=b.pendingContent.content.externalId;if(g==null){d("WALogger").ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] externalId is null for pendingStanza"])));return d("MAWDexieTable").dexieResolve()}var h=b.pendingContent.content.revokedExternalId;if(h==null){d("WALogger").ERROR(o||(o=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] revokedExternalId is null for pendingStanza"])));return d("MAWDexieTable").dexieResolve()}var i=b.pendingContent.content.ts;if(i==null){d("WALogger").ERROR(p||(p=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] pendingStanzaTs is null for pendingStanza"])));return d("MAWDexieTable").dexieResolve()}return d("MAWWriteRevokeMessageTxns").revokeUnstoredMsg(a,c,e,g,h,c.serverTs,c.ts,f).then(function(c){a.pendingStanzas["delete"](b.rowId);return d("MAWDexieTable").dexieResolve(c)})}});function C(a){var b=a.pendingContent.content.threadJid;if(b==null){d("WALogger").WARN(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] threadJid is null for pendingStanza"])));return}var e=d("WAJids").threadIdForChatJid(b),f=a.pendingContent.type;if(f===d("MAWDbPendingStanza").PENDING_TYPE.REVOKED){var g=a.pendingContent.content.revokedExternalId;if(g==null){d("WALogger").WARN(r||(r=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] revokedExternalId is null for pendingStanza"])));return}g=g}else if(f===d("MAWDbPendingStanza").PENDING_TYPE.DELETE_FOR_ME){var h=a.pendingContent.content.externalId;if(h==null){d("WALogger").WARN(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] revokedExternalId is null for pendingStanza"])));return}g=h}else{d("WALogger").WARN(t||(t=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] pendingStanza type "," is not supported"])),f);return}d("MAWEncryptedBackupCacheManager").addPendingStanzaToPendingStanzaCache(g,a);d("MAWBridgeEventTransmitter").issuePointQueryOutsideTxn(g,e,void 0,c("LSMEBTaskCreationSource").POINT_QUERY_FROM_EB,b)}var D=e.makeMsgrTransactor({pendingStanzas:f.READONLY},"getAllPendingStanzas",function(a){return function(){return d("MAWDbPendingStanzaTxns").getAllPendingStanzas(a)}});g.applyPendingStanzas=a;g.issuePointQueryForPendingStanza=C}),98);
__d("MAWHandlePointRestoredMsgV2",["EBUploadUniqueMessage","MAWEBUploadTrackingUtils","MAWGetMsgQuoteTxn","Promise","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;function a(a){d("WALogger").LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Started handling of point restored message"])));a=a.restoredMsgsData;if(a){var c=a.existingMsgs;a=a.newlyAddedMsgs;a=a.concat(c);var e=[],f=new Map(),g=[],l=new Map();a.forEach(function(a){e.push(a);g.push(a.externalId);var b=d("MAWEBUploadTrackingUtils").genInstanceKeyOnly();l.set(a.externalId,b);d("MAWEBUploadTrackingUtils").startUploadTracking(a.externalId,a.type,"point-restore",b,!1,!1,void 0,"echo_only")});c=d("MAWGetMsgQuoteTxn").maybeBatchGetMsgsByQuoteExternalIdWithTransaction(g);return c.then(function(a){a.forEach(function(a){var b=a.quoteExternalId;b!=null&&f.set(b,a)});return e.length>0?d("EBUploadUniqueMessage").uploadUniqueMessage__DEPRECATED_DO_NOT_USE(e,f,l,void 0,"point_restore"):(k||(k=b("Promise"))).resolve()}).then(function(a){d("WALogger").LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Completed handling of point restored message"])))})}d("WALogger").LOG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Completed handling of point restored message"])));return(k||(k=b("Promise"))).resolve()}g.uploadPointRestoredMessageIfRequired=a}),98);
__d("MAWRestoreMsgsUiUpdator",["MAWBridgeEventTransmitter","MAWDbMsg","MAWDbThread","MAWDexieTable","MAWFolderTypes","MAWThreadSnippetBuildTxns","emptyFunction","gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e,f,g,j,l,m,n,o,p){g=h(a,g,e,f,l,m);return g.then(function(c){if(m==null||j){var e=k(c);e&&d("MAWBridgeEventTransmitter").updateThreadOutsideTxn(c.cannotReplyReason,d("MAWFolderTypes").FOLDER_ID.INBOX,c.jid);return i(a,b,c,n,o,p,m).then(function(){return c})}return c}).then(function(b){return d("MAWThreadSnippetBuildTxns").refreshThreadSnippet(a,b)}).then(c("emptyFunction"))}function h(a,b,c,e,f,g){var h=babelHelpers["extends"]({},b,{lastReadMsg:f,lastReadMsgTs:e,newestMsgTs:c,oldestMsg:g,threadOrder:d("MAWDbThread").craftThreadOrder(c,b.jid)});return a.threads.put(h).then(function(){return h})}function i(a,b,e,f,g,h,i){var k=b.map(function(a){return a}).reverse(),l=e.jid;if(f!=null){h=d("MAWDbMsg").toMsgId(f);if(h!=null)return a.messages.get({msgId:h}).then(function(b){if(b!=null){b=b.sortOrderMs;var f;c("gkx")("23906")?f=d("MAWDexieTable").dexieResolve(0):f=a.messages.where(["threadJid","sortOrderMs"]).between([l,k[0].sortOrderMs],[l,b],!1,!1).count();return f.then(function(a){a===0&&j(k,g,e)})}})}return d("MAWDexieTable").dexieResolve()}function j(a,b,c){c=b==null?void 0:b.sortOrderMs;var d=a[a.length-1],e=d.sortOrderMs;b!=null&&d!=null&&c!=null&&e!=null&&c<e&&a.push(b)}function k(a){return a.archived===!0&&a.cannotReplyReason!=="viewer_not_subscribed"}g.updateThreadAndMessages=a;g.shouldThreadBeUnarchived=k}),98);
__d("MAWRestoreMsgsTxns",["ArmadilloDataTraceType","FBLogger","LSMEBTaskCreationSource","MAWBridgeEventTransmitter","MAWDbMsg","MAWDbMsgTxns","MAWDexieTable","MAWFTSTxns","MAWIndexedDb","MAWJidUtils","MAWLocalizationType","MAWMsgType","MAWQplProxy","MAWRestoreMsgsUiUpdator","MAWTimeUtils","MAWTransactionMode","MAWUseProtocolMsgIdForMsgId","WAHashStringToNumber","WAJids","WALogger","WATimeUtils","emptyFunction","justknobx","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a,b,c){return c!=null?a.messages.where(["threadJid","sortOrderMs"]).between([b.jid,c.ts],[b.jid,d("MAWDbMsg").MAX_MSG_SORT_ORDER],!1,!0).limit(1).first():d("MAWDexieTable").dexieResolve()}function a(a,b,c){return d("MAWDbMsgTxns").maybeGetMsg(a,c).then(function(c){if(c!=null)return a.messages.where(["threadJid","sortOrderMs"]).between([b.jid,c.sortOrderMs],[b.jid,d("MAWDbMsg").MAX_MSG_SORT_ORDER],!1,!0).limit(1).first();else return d("MAWDexieTable").dexieResolve()})}function k(a){return a!=null&&a.type===d("MAWMsgType").MSG_TYPE.ADMIN&&(a.msgContent.adminType===d("MAWLocalizationType").LOCALIZATION_TYPE.E2EE_THREAD_DESCRIPTION||a.msgContent.adminType===d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_THREAD_ADMIN_MESSAGE||a.msgContent.adminType===d("MAWLocalizationType").LOCALIZATION_TYPE.CUTOVER_IGD_THREAD_ADMIN_MESSAGE||a.msgContent.adminType===d("MAWLocalizationType").LOCALIZATION_TYPE.DUAL_THREAD_CUTOVER_ADMIN_MESSAGE)}var l=(e=d("MAWIndexedDb")).makeMsgrTransactor({messages:(f=d("MAWTransactionMode")).READONLY},"checkForDecryptionFailuresToPointRestore",function(a){return function(){return a.messages.filter(function(a){return a.type===d("MAWMsgType").MSG_TYPE.UNAVAILABLE||a.type===d("MAWMsgType").MSG_TYPE.CIPHERTEXT}).toArray().then(function(a){a.forEach(function(a){a.threadJid!=null&&d("MAWBridgeEventTransmitter").issuePointQueryOutsideTxn(a.externalId,d("WAJids").threadIdForChatJid(a.threadJid),void 0,c("LSMEBTaskCreationSource").EB_POINT_QUERY_RETRY_DECRYPTION_FAILURES,a.threadJid)})})}});function m(a,b,c,e,f,g,h,i,j){var k=g.isOldestMsgUpdated,l=g.lastReadMsg,m=g.lastReadMsgTs,n=g.newestMsgTs;g=g.oldestMsgId;var p=!0;b&&(p=o(n,e));b=d("MAWDexieTable").dexieResolve();p&&(f.length>0&&(b=d("MAWRestoreMsgsUiUpdator").updateThreadAndMessages(a,f,n,m,c,k,l,g,h,i,j)));return b.then(function(){return d("MAWDexieTable").dexieResolve()})}function b(a){var b=a.existingMsgs,e=a.hasMoreBefore,f=a.instanceKey,g=a.isPointRestore,h=a.maybeNewestMsg,i=a.maybeOldestAdminMsg,j=a.maybeOldestMsg,k=a.minMsgId,l=a.newMsgs,m=a.optimisticMsgs,n=a.shouldSkipSyncToUI,o=a.taskSource;a=a.thread;o=o===c("LSMEBTaskCreationSource").EB_POINT_QUERY_RETRY_DECRYPTION_FAILURES;var p=new Map(),q=[];b.map(function(a){a.type===d("MAWMsgType").MSG_TYPE.UNAVAILABLE||a.type===d("MAWMsgType").MSG_TYPE.CIPHERTEXT?q.push(a):p.set(a.externalId,a)});var r=[];return x(l,b,a.jid,p,h,g,i,j,r,m,f,e,k,o,q,n).then(function(a){return a})}function n(a,b){a.altIndex!==d("MAWDbMsg").SPAM_ALT_INDEX&&a.altIndex!==d("MAWDbMsg").FUTUREPROOF_SPAM_ALT_INDEX&&d("MAWBridgeEventTransmitter").startTraceOutsideTxn(a,b,d("ArmadilloDataTraceType").armadilloMessageSend)}function o(a,b){return a==null?!0:b.some(function(b){return b.sortOrderMs!=null&&b.sortOrderMs>=a})}var p=e.makeMsgrTransactor({messages:f.READONLY},"getMsgsByProtocolMsgIds",function(a){return function(){for(var b=arguments.length,c=new Array(b),e=0;e<b;e++)c[e]=arguments[e];return d("MAWDbMsgTxns").getMsgsByProtocolMsgId.apply(void 0,[a].concat(c))}}),q=e.makeMsgrTransactor({messages:f.READONLY},"restoreGetMsg",function(a){return function(b){return d("MAWDbMsgTxns").maybeGetMsg(a,b)}}),r=e.makeMsgrTransactor({messages:f.READONLY},"restoreGetThreadNewestMessage",function(a){return function(b){return d("MAWDbMsgTxns").getThreadNewestMessageBySortOrder(a,b.jid)}}),s=e.makeMsgrTransactor({messages:f.READONLY},"restoreMaybeGetOldestNonAdminMessage",function(a){return function(b){return d("MAWDbMsgTxns").getThreadOldestMessageBySortOrder(a,b.jid).then(function(c){if(c==null)return d("MAWDexieTable").dexieResolve({maybeOldestAdminMsg:null,maybeOldestMsg:null});else if(k(c))return j(a,b,c).then(function(a){return{maybeOldestAdminMsg:c,maybeOldestMsg:a}});return{maybeOldestAdminMsg:null,maybeOldestMsg:c}})}});function t(a,b,e,f,g,h,i,j,l){return d("MAWDexieTable").dexieAll(b.map(function(b){return d("MAWDbMsgTxns").maybeGetMsgByExternalId(a,b.externalId,e.jid,b.author).then(function(a){if(a!=null)return;a=f.get(b.externalId);if(a==null){a=d("WATimeUtils").castUnixTimeToMillisTime(b.ts);j.newestMsgTs=a>j.newestMsgTs?a:j.newestMsgTs;var c=d("MAWUseProtocolMsgIdForMsgId").shouldUseProtocolMsgIdForMsgId()?d("MAWJidUtils").formatProtocolMsgIdFromMsg(b):d("MAWDbMsg").craftMsgIdV2(e.chatId,j.msgNextInChatMsgId,b);j.msgNextInChatMsgId+=1;(j.oldestMsgId==null||!h&&a<j.oldestMsgTs)&&(j.isOldestMsgUpdated=!0,j.oldestMsgId=i!=null&&d("WATimeUtils").castUnixTimeToMillisTime(i.ts)<a?i.msgId:c,j.oldestMsgTs=i!=null&&d("WATimeUtils").castUnixTimeToMillisTime(i.ts)<a?d("WATimeUtils").castUnixTimeToMillisTime(i.ts):a);(j.newestMsgTs===a||k(g))&&(j.newestMsgId=c);b.author===d("WAJids").AUTHOR_ME&&(j.lastReadMsgTs==null||a>j.lastReadMsgTs)&&(j.lastReadMsg=c,j.lastReadMsgTs=a);a=babelHelpers["extends"]({},b,{msgId:c,sortOrderMs:d("MAWDbMsg").getSortOrderWithFallback(b)});l.push(a)}})})).then(c("emptyFunction"))}function u(a,b){return d("MAWDexieTable").dexieAll([d("MAWDbMsgTxns").getThreadNewestMessageId(a,b.jid),d("MAWDbMsgTxns").getThreadNewestMessageMs(a,b.jid),d("MAWUseProtocolMsgIdForMsgId").shouldUseProtocolMsgIdForMsgId()?d("MAWDexieTable").dexieResolve(0):d("MAWDbMsgTxns").getNextMsgIdNumberForThread(a,b)]).then(function(a){var b=a[0],c=a[1];a=a[2];return{newestMsgId:b,newestMsgTs:c,nextInChatMsgId:a}})}function v(a,b,e,f,g,h,i,j,k,l,m){return t(a,b,e,f,g,h,i,j,k).then(function(b){if(l!=null)for(b of k){var g=b.externalId;g=l.get(g);g!=null&&(b.ts=d("WATimeUtils").castMilliSecondsToUnixTime(g.ts))}var h=c("justknobx")._("3227")?k.map(function(a){return babelHelpers["extends"]({},a,{source:m===!0?"media_restore":"eb_restore"})}):k;return d("MAWDexieTable").dexieAll([a.messages.bulkAdd(h,{allKeys:!0}).then(function(a){return a.map(function(a,b){return babelHelpers["extends"]({},h[b],{rowId:a})})}),m!==!0&&c("justknobx")._("3227")?a.messages.bulkPut(Array.from(f.values()).map(function(a){return babelHelpers["extends"]({},a,{source:"eb_restore"})})):d("MAWDexieTable").dexieResolve()]).then(function(b){var c=b[0];return a.threads.put(e).then(function(){return c})})})}function w(a,b,c){b=b.map(function(a){var b=c.find(function(b){return b.externalId===a.externalId});if(b==null)return null;b=babelHelpers["extends"]({externalId:b.externalId,msgId:b.msgId,protocolMsgId:b.protocolMsgId,rowId:b.rowId},a);return b}).filter(Boolean);return a.messages.bulkPut(b).then(function(){})}var x=e.makeMsgrTransactor({ftsBackloggedMessages:f.READWRITE,groupInfo:f.READWRITE,messages:f.READWRITE,threads:f.READWRITE},"createRestoredMessagesAndUpdateThread",function(a){return function(b,c,e,f,g,j,k,l,o,p,q,r,s,t,x,y){return a.threads.get({jid:e}).then(function(q){if(q==null){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Thread with jid "," does not exist for restore"])),e);return d("MAWDexieTable").dexieResolve()}return u(a,q).then(function(e){var h=e.newestMsgId,t=e.newestMsgTs;e=e.nextInChatMsgId;var u={isOldestMsgUpdated:!1,lastReadMsg:q.lastReadMsg,lastReadMsgTs:d("MAWTimeUtils").ensureValidMillisTime(q.lastReadMsgTs),msgNextInChatMsgId:e,newestMsgId:h,newestMsgTs:d("MAWTimeUtils").ensureValidMillisTime(t)||d("WATimeUtils").castToMillisTime(0),oldestMsgId:l==null?void 0:l.msgId,oldestMsgTs:d("WATimeUtils").castUnixTimeToMillisTime((e=l==null?void 0:l.ts)!=null?e:d("WATimeUtils").castToUnixTime(0))};h=w(a,b,x);return h.then(function(){return d("MAWDexieTable").dexieAll([v(a,b,q,f,g,j,k,u,o,p,y),d("MAWFTSTxns").maybePutMessagesToBacklog(a,b.map(function(a){return a.externalId}))]).then(function(b){b=b[0];if(y!==!0)for(var e of b)n(e,q.jid);e=c.concat(b);var f={existingMsgs:c,newlyAddedMsgs:b,threadJid:q.jid};e=y!==!0?m(a,j,q,e,b,u,s,k,r):d("MAWDexieTable").dexieResolve();return e.then(function(){return f})})["catch"](function(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Failed to create restored messages and update thread metadata ",""])),a)})})})})}});g.getNextMsgBasedOnSortOrderMs=a;g.isE2eeOrCutoverAdminMsg=k;g.checkForDecryptionFailuresToPointRestore=l;g.restoreMsgsForThread=b;g.getMsgsByProtocolMsgIds=p;g.getMsg=q;g.maybeGetThreadNewestMessage=r;g.maybeGetOldestNonAdminMessage=s;g.prepareUnstoredMsgArrayAndUpdateKeyVariables=t}),98);
__d("MAWRestoreValidationUtils",["MAWEBRestoreTrackingUtils"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a.reduce(function(a,b){if(b.externalId!=null){a[b.externalId]=((b=a[b.externalId])!=null?b:0)+1;return a}return a},{})}function a(a){var b=a.dbMsgArray,c=a.deanonData,e=a.echoMsgExternalIds,f=a.protobufMsgs,g=a.restoreQplFlow;a=a.traceId;var i=h(b);if(f==null&&e==null)return;b=f!=null?f.map(function(a){return{externalId:a.otid}}):e!=null?e:[];var j=h(b);f=Object.entries(i).filter(function(a){a[0];a=a[1];return a>1});e=Object.entries(j).filter(function(a){a[0];a=a[1];return a>1});b=Object.keys(j).filter(function(a){return!i[a]});var k=Object.keys(i).filter(function(a){return!j[a]});e={"int":{duplicates_in_eb_restore:e.length,duplicates_in_maw:f.length,maw_vs_eb_restore_missing_in_reference:k.length,maw_vs_eb_restore_missing_in_target:b.length}};if(c!=null){var l=h(c);f=Object.keys(i).filter(function(a){return!l[a]});k=Object.keys(l).filter(function(a){return!i[a]});b=Object.keys(l).filter(function(a){return!j[a]});c=Object.keys(j).filter(function(a){return!l[a]});var m=Object.entries(l).filter(function(a){a[0];a=a[1];return a>1});e["int"]=babelHelpers["extends"]({},e["int"],{duplicates_in_deanon:m.length,eb_restore_vs_deanon_missing_in_reference:c.length,eb_restore_vs_deanon_missing_in_target:b.length,maw_vs_deanon_missing_in_reference:f.length,maw_vs_deanon_missing_in_target:k.length})}g==null||g.addPoint("restore_validation",e);d("MAWEBRestoreTrackingUtils").addQPLRestorePointWithAnnotationsWorker({annotations:e,pointName:"restore_validation",traceId:a});return e}g.compareRestoredMsgstoDeanonData=a}),98);
__d("MAWWriteReceiverFetchTxns",["FBLogger","MAWBridgeReceiverFetchInfo","MAWDbReceiverFetchTxns","MAWDexieTable","MAWIndexedDb","WALogger","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,e,f,g,h){return d("MAWDbReceiverFetchTxns").maybeGetReceiverFetchInfoFromReceiverFetchId(a,h.receiverFetchId).then(function(i){if(i==null)return a.receiverFetchInfo.add(h).then(function(){d("MAWIndexedDb").afterTransaction({tag:"NewReceiverFetchInfo",value:d("MAWBridgeReceiverFetchInfo").createBridgeReceiverFetchInfoPayloadFromUnstoredInfo(b,e,f,g,h)})})["catch"](function(a){c("FBLogger")("messenger_web_media").mustfix("Failed to add receiver fetch info to db, error: %s",a.message)});else{var j=babelHelpers["extends"]({},i,h);return a.receiverFetchInfo.update(h.receiverFetchId,j).then(function(){d("MAWIndexedDb").afterTransaction({tag:"NewReceiverFetchInfo",value:d("MAWBridgeReceiverFetchInfo").createBridgeReceiverFetchInfoPayloadFromDbInfo(b,e,f,g,j)})})["catch"](function(a){c("FBLogger")("messenger_web_media").mustfix("Failed to update receiver fetch info in db, error: %s",a.message)})}})}function b(a,b,e,f,g,i,j,k,l){return d("MAWDbReceiverFetchTxns").maybeGetReceiverFetchInfoFromReceiverFetchId(a,f).then(function(m){m=m;if(m==null)if(l==null){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Receiver fetch info not found for receiver fetch id: ",""])),f);return d("MAWDexieTable").dexieResolve()}else m={mimetype:i,previewHeight:j,previewWidth:k,receiverFetchId:f,type:l};m=babelHelpers["extends"]({},m,{accessibilitySummaryText:g!=null?g:void 0,previewUrl:b,previewUrlExpirationTimestampMs:e});return a.receiverFetchInfo.put(m).then(c("emptyFunction"))["catch"](function(a){c("FBLogger")("messenger_web_media").mustfix("Failed to update receiver fetch info in db, error: %s",a.message)})})}g.handleUnstoredReceiverFetchInfo=a;g.updateReceiverFetchInfoWithPreviewUrl=b}),98);
__d("MAWHandleEchoMsgsRestoreApiV2",["EBLogger","EchoMessage","LSDataTraceCheckPoint","LSIntEnum","LSMEBTaskCreationSource","MAWAckLevel","MAWBridgeEventTransmitter","MAWCiphertextRecoveryLogging","MAWDbEditMsgHistoryTxns","MAWDbMsg","MAWDbThreadTxns","MAWDexieTable","MAWHandleEchoMediaMsgsRestoreV2","MAWHandleEchoMsgsRestoreApiUtils","MAWHandleEchoReactionsRestore","MAWHandleEchoXMARestoreV2","MAWHandlePendingStanzasInRestoreV2","MAWHandlePointRestoredMsgV2","MAWIndexedDb","MAWJids","MAWMsgType","MAWQplProxy","MAWRepliesRestoreUtils","MAWRestoreMsgsTxns","MAWRestoreValidationUtils","MAWTraceUtils","MAWTransactionMode","MAWWriteReceiverFetchTxns","MWEBODSEntityName.enum","MWEBODSUtils","WAGlobals","WAJids","WAResultOrError","WAStanzaUtils","WATimeUtils","gkx","promiseDone","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=d("EBLogger").EBLogger.tags(["restore"]);a=async function(a,b,e,f,g,m,n,o,p,q,r,s,t,u){d("MWEBODSUtils").markODSForEB(c("MWEBODSEntityName.enum").MAW_EB_RESTORE_COUNTER,"deprecated_echo_restore");var v=n==null?E:E.tags([n]);v.DEBUG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Low level api handleEchoMsgsRestore v2 initiated restore of "," messages. isPointRestore: "," startSortKey: "," taskSource: ",""])),b.length,e,o,r);g=e?d("MAWHandleEchoMsgsRestoreApiUtils").MAWRestoreType.POINT_RESTORE:o!=null?d("MAWHandleEchoMsgsRestoreApiUtils").MAWRestoreType.PAGINATED_RESTORE:d("MAWHandleEchoMsgsRestoreApiUtils").MAWRestoreType.INITIAL_RESTORE;g=g;var w=s!=null?s:d("MAWQplProxy").startQplUserFlow(c("qpl")._(521486220,"827"),{bool:{uploadedFromEBQueue:u},int:{messages:b.length},string:{message_backup_type:"echo",restore_type:g,trace_id:n!=null?n:""}},{providedTimeoutInMs:3e5});d("MAWTraceUtils").recordCheckpointForTrace(n,(D||(D=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_WEB_ECHO_MESSAGE_RESTORE_BEGIN),[],!1);var x=await H(a,n),y={messageIds:[],pendingRestoreSortKeys:[]};if(x){s=F(x,b,e,f,w,m,p,q,n,r,t);var z=a;return s.then(function(f){var g,h=(g=f.restoredMsgsData)!=null&&g.newlyAddedMsgs?(g=f.restoredMsgsData)==null?void 0:g.newlyAddedMsgs.length:0;v.DEBUG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Message creation complete. MessagesCreated: "," isPointRestore: "," startSortKey: "," taskSource: ",""])),h,e,o,r);K(a,f,p,q);var l=r===c("LSMEBTaskCreationSource").MEDIA_GALLERY_RESTORE;return Promise.all([I(f,w),J(f,w,n,r),d("MAWHandleEchoReactionsRestore").writeEchoReactionsToReactionsStore(f,d("WAGlobals").getMyUserJid(),w),N(z,f,x==null?void 0:x.jid)]).then(function(g){return Promise.all([d("MAWRepliesRestoreUtils").updateQuoteDataForReplyMessages(f,w,l),d("MAWHandleEchoXMARestoreV2").writeXMAToXMAStore(f,w,n,l),c("gkx")("2251")?d("MAWHandlePendingStanzasInRestoreV2").applyPendingStanzas(f,e,w):d("MAWDexieTable").dexieResolve(),O(f,w)]).then(function(){c("promiseDone")(d("MAWHandlePointRestoredMsgV2").uploadPointRestoredMessageIfRequired(f));var g=f.restoredMsgsData;g=g!=null&&g.existingMsgs?g==null?void 0:g.existingMsgs.length:0;var i=b.length;w.endSuccess({int:{existingMsgs:g,messages_lost:b.length-g-h,newlyAddedMsgs:h,restoredMsgs:g+h,totalMsgsToRestore:i},string:{threadJidPrimaryId:a}});d("MAWTraceUtils").recordCheckpointForTrace(n,(D||(D=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_RESTORE_MESSAGES_SUCCESS),[],!1);d("MAWTraceUtils").recordCheckpointForTrace(n,D.ofNumber(c("LSDataTraceCheckPoint").FLOW_END_AND_FLUSH),[],!0);f.quotesToBeRestored.forEach(function(a){y.messageIds.push(a.messageId),y.pendingRestoreSortKeys.push(a.sortOrderMs)});v.DEBUG(j||(j=babelHelpers.taggedTemplateLiteralLoose(["HandleEchoMsgsRestore v2 completed. newlyAdded: "," existing: "," isPointRestore: ",""])),h,g,e);return Promise.resolve(d("WAResultOrError").makeResult(y))})}).catch(function(a){v.catching(a).MUSTFIX(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Error while restoring media/reaction"])));w.endFail("error_in_handle_media_or_reaction");return Promise.resolve(d("WAResultOrError").makeResult(y))})})}else w.endFail("missing_thread_for_thread_jid"),v.MUSTFIX(l||(l=babelHelpers.taggedTemplateLiteralLoose([" Missing thread for thread jid: ",""])),a),K(a,null,p,q);return Promise.resolve(d("WAResultOrError").makeResult(y))};async function F(a,b,e,f,g,h,i,j,k,l,m){g==null||g.addPoint("message_restore_start");var n=new Map(),o=[];b=await G(b,e,a,n,f,g,k);var p=b.dbThread,q=b.hasMoreBefore,r=b.messagesToAdd;f=b.quotesToBeRestoredForThread;o.push.apply(o,f);b=r.map(function(b){return{author:b.author,chat:a.jid,externalId:d("WAStanzaUtils").toStanzaId(b.externalId)}});return Promise.all([d("MAWRestoreMsgsTxns").maybeGetThreadNewestMessage(a),d("MAWRestoreMsgsTxns").maybeGetOldestNonAdminMessage(a),d("MAWRestoreMsgsTxns").getMsgsByProtocolMsgIds(b)]).then(function(a){var b=a[0],f=a[1],s=f.maybeOldestAdminMsg;f=f.maybeOldestMsg;a=a[2];var t=new Set(a.filter(function(a){return a.type!==d("MAWMsgType").MSG_TYPE.CIPHERTEXT}).map(function(a){return a.externalId})),u=r.filter(function(a){return!t.has(a.externalId)});d("MAWCiphertextRecoveryLogging").compareAndLogCiphertextRecoveredByEB(a,r);var v=l===c("LSMEBTaskCreationSource").MEDIA_GALLERY_RESTORE;b={existingMsgs:a,hasMoreBefore:q,instanceKey:i,isPointRestore:e,maybeNewestMsg:b,maybeOldestAdminMsg:s,maybeOldestMsg:f,minMsgId:h,newMsgs:u,optimisticMsgs:j,shouldSkipSyncToUI:v,taskSource:l,thread:p,traceId:k};var w=[];a.forEach(function(a){return w.push({externalId:a.externalId})});u.forEach(function(a){return w.push({externalId:a.externalId})});return d("MAWRestoreMsgsTxns").restoreMsgsForThread(b).then(function(a){var b=[];(a==null?void 0:a.existingMsgs)!=null&&(b=b.concat(a==null?void 0:a.existingMsgs));(a==null?void 0:a.newlyAddedMsgs)!=null&&(b=b.concat(a==null?void 0:a.newlyAddedMsgs));g==null||g.addPoint("message_restore_end");m!=null&&!e&&d("MAWRestoreValidationUtils").compareRestoredMsgstoDeanonData({dbMsgArray:b,deanonData:m,echoMsgExternalIds:w,protobufMsgs:void 0,restoreQplFlow:g,traceId:k});return{echoMsgMap:n,quotesToBeRestored:o,restoredMsgsData:a,thread:p}})})}async function G(a,b,c,e,f,g,h){var i=new Set(),j=new Map(),k=h==null?E:E.tags([h]),l=[];if(a==null||a.length===0){k.WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["No messages to be restored for thread: ",""])),c.jid);return{dbThread:c,hasMoreBefore:!1,messagesToAdd:[],quotesToBeRestoredForThread:l}}var s=0,t=[];a.forEach(function(a){a=d("EchoMessage").decodeEchoMessage(a);if(a==null){k.MUSTFIX(n||(n=babelHelpers.taggedTemplateLiteralLoose(["Failed to decode the message"])));return}a.contentType===d("EchoMessage").EchoMessageContentType.DECRYPTION_FAILURE&&s++;var b=a.xOfflineThreadingId;if(b==null){k.MUSTFIX(o||(o=babelHelpers.taggedTemplateLiteralLoose(["Message ID must not be null"])));return}if(i.has(b)){k.WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Ignore duplicate restore request of an existing message"])));return}i.add(b);t.push(a)});s===a.length&&(g==null||g.addPoint("decryption_failure_batch",{int:{decryptionFailuresCount:s}}));t.forEach(function(a){if(a.xOfflineThreadingId==null)return;var b=d("WAStanzaUtils").toStanzaId(a.xOfflineThreadingId),f=d("MAWHandleEchoMsgsRestoreApiUtils").getUnstoredDbMessageFromEchoMessage(a,c.jid,d("WAGlobals").getMyUserJid(),b,h,"echo_content");if(f.success===!0){f=f.value;j.set(b,f);e.set(b,a);a=a==null?void 0:a.quoteData;if(a!=null){var g=d("WAStanzaUtils").toStanzaId(a.quoteMessageId);if(g!=null&&!j.has(g))l.push({messageId:a.quoteMessageId,sortOrderMs:a.quoteSortOrderInMs.toString()});else{a=d("MAWRepliesRestoreUtils").addQuoteDataToReplyMessage(f,j.get(g));j.set(b,a)}}}});a=Array.from(j.values());a.sort(function(a,b){return((a=a.sortOrderMs)!=null?a:0)-((a=b.sortOrderMs)!=null?a:0)});g=b||f!==!1;g||k.DEBUG(q||(q=babelHelpers.taggedTemplateLiteralLoose(["No more messages to restore for thread: ",""])),c.jid);a.length>0&&k.DEBUG(r||(r=babelHelpers.taggedTemplateLiteralLoose(["Oldest message timestamp: "," and newest message timestamp: "," of the batch for thread: ",""])),a[0].sortOrderMs,a[a.length-1].sortOrderMs,c.jid);return{dbThread:c,hasMoreBefore:g,messagesToAdd:a,quotesToBeRestoredForThread:l}}var H=d("MAWIndexedDb").makeMsgrTransactor({threads:(b=d("MAWTransactionMode")).READONLY},"restoreGetThread",function(a){return function(b,c){var e=c==null?E:E.tags([c]);return d("MAWDbThreadTxns").getThreadPrimaryId(a,b).then(function(a){if(a.success)return a.value;else{e.MUSTFIX(s||(s=babelHelpers.taggedTemplateLiteralLoose(["threadJidPrimaryId "," missing from index db"])),b);return d("MAWDexieTable").dexieResolve()}})}}),I=d("MAWIndexedDb").makeMsgrTransactor({editMsgHistory:b.READWRITE,messages:b.READWRITE},"restoreEditMsgHistory",function(a){return function(b,c){c==null||c.addPoint("msg_history_start");var e=b.restoredMsgsData;if(e!=null){var f=e.newlyAddedMsgs.map(function(c){var f=[],g=c.externalId,h=c.author,i=e.threadJid;c=b.echoMsgMap.get(g);if(c!=null){var j=c.editHistory;return d("MAWDbEditMsgHistoryTxns").getEditHistoryAsEcho(a,g,h,i).then(function(b){if(b.length>=j.length)return d("MAWDexieTable").dexieResolve([]);j.forEach(function(a){return f.push({author:h,editExternalId:a.messageId!=null?d("WAStanzaUtils").toStanzaId(a.messageId):null,editTs:d("WATimeUtils").castToUnixTime(a.timestamp),msgContent:{content:a.text},originalMsgExternalId:g,sendStatus:d("MAWAckLevel").ACK.sent,threadJid:i})});b.length>0&&d("MAWDbEditMsgHistoryTxns").bulkRemoveEditHistory(a,g,h,i);return d("MAWDexieTable").dexieResolve(f)})}else return d("MAWDexieTable").dexieResolve([])});return d("MAWDexieTable").dexieAll(f).then(function(b){return d("MAWDbEditMsgHistoryTxns").bulkAddEditMsgHistory(a,b.flat()).then(function(a){return c==null?void 0:c.addPoint("msg_history_end")})})}else{c==null||c.addPoint("msg_history_end");return d("MAWDexieTable").dexieResolve()}}}),J=function(a,b,d,e){if(c("gkx")("1614"))return Promise.resolve();else{b==null||b.addPoint("media_restore_start");return L(a,d,e).then(function(a){b==null||b.addPoint("media_restore_end",{int:{media:a}});return Promise.resolve()})}};function K(a,b,e,f,g){g=g==null?E:E.tags([g]);if(e!=null&&c("gkx")("23961")){var h,i,j,k;h=(h=b==null||(i=b.restoredMsgsData)==null?void 0:i.newlyAddedMsgs.length)!=null?h:0;j=(j=b==null||(k=b.restoredMsgsData)==null?void 0:k.existingMsgs.length)!=null?j:0;if(f!=null&&f.size>0){var l,m,n=new Set([].concat((b==null||(l=b.restoredMsgsData)==null||(l=l.newlyAddedMsgs)==null?void 0:l.map(function(a){return a.externalId}))||[],(b==null||(m=b.restoredMsgsData)==null||(m=m.existingMsgs)==null?void 0:m.map(function(a){return a.externalId}))||[]));b=Array.from(f.keys()).reduce(function(a,b){return a+(n.has(b)?0:1)},0);b>0?(g.WARN(t||(t=babelHelpers.taggedTemplateLiteralLoose(["Missed restoring optimistic messages for thread: "," count: "," }"])),a,b),d("MAWQplProxy").sendQPLFailThroughBridge(c("qpl")._(521482576,"1069"),"optimistic_msgs_missed_restore",{int:{messages_backend_existing:j,messages_backend_restored:h,missed_message_count:b,optimistic_msgs_count:f.size}},e)):d("MAWQplProxy").sendQPLSuccessThroughBridge(c("qpl")._(521482576,"1069"),{int:{messages_backend_existing:j,messages_backend_restored:h,optimistic_msgs_count:f.size}},e)}else d("MAWQplProxy").sendQPLSuccessThroughBridge(c("qpl")._(521482576,"1069"),{int:{messages_backend_existing:j,messages_backend_restored:h,optimistic_msgs_count:0}},e)}}function L(a,b,e){e===void 0&&(e=c("LSMEBTaskCreationSource").UNKNOWN);var f=a.restoredMsgsData,g=0;if(f){var h=f.existingMsgs.filter(function(a){return d("MAWDbMsg").isMediaMsg(a)&&a.mediaId==null}),i=f.newlyAddedMsgs;h=[].concat(h,i);var j=f.threadJid,k=[];h.map(function(c){var e=c.externalId;e=a.echoMsgMap.get(e);var f=(e==null?void 0:e.viewOnce)!=null&&(e==null?void 0:e.viewOnce);if(!f&&(c.type!==d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH&&(e==null?void 0:e.contentType)===d("EchoMessage").EchoMessageContentType.MEDIA||(e==null?void 0:e.contentType)===d("EchoMessage").EchoMessageContentType.XMA)){f=M(j,c,a.echoMsgMap,(e==null?void 0:e.contentType)===d("EchoMessage").EchoMessageContentType.XMA,b);f!=null&&(g+=1,k.push(f))}});return d("MAWHandleEchoMediaMsgsRestoreV2").downloadMediaAndWriteToMediaStore(k,a.thread.jid,e).then(function(a){return g})}return Promise.resolve(g)}function M(a,b,c,e,f){c=c.get(b.externalId);f=f==null?E:E.tags([f]);if(c==null){e?f.tags(["xma"]).WARN(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Echo message is missing from the map: ",""])),b.externalId):f.tags(["xma"]).MUSTFIX(v||(v=babelHelpers.taggedTemplateLiteralLoose(["Echo message is missing from the map: ",""])),b.externalId);return null}var g=c.mediaData;if(g==null){e?f.tags(["media"]).WARN(w||(w=babelHelpers.taggedTemplateLiteralLoose(["Media data is null for the message: ",""])),c.messageId):f.tags(["media"]).MUSTFIX(x||(x=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Media data is null for the message: ",""])),c.messageId);return null}var h=c.from;if(h==null){e?f.tags(["xma"]).WARN(y||(y=babelHelpers.taggedTemplateLiteralLoose(["from field is missing from xma message: ",""])),c.messageId):f.tags(["media"]).MUSTFIX(z||(z=babelHelpers.taggedTemplateLiteralLoose(["from field is missing from media message: ",""])),c.messageId);return null}var i=c.sortOrderMs;if(i==null){e?f.tags(["xma"]).WARN(A||(A=babelHelpers.taggedTemplateLiteralLoose(["timestamp field should not be null as it is required for attachment download retry: ",""])),c.messageId):f.tags(["media"]).MUSTFIX(B||(B=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] timestamp field should not be null as it is required for attachment download retry: ",""])),c.messageId);return null}f=d("MAWJids").toUserJid(h.localKey);h=f===d("WAGlobals").getMyUserJid()?d("WAJids").AUTHOR_ME:f;f=b.externalId;b=b.msgId;h={author:h,echoMsg:c,externalId:f,isXMA:e,messageTimestamp:i,msgId:b,threadJId:a};f=Date.now()-i<1e3*60*60*24*30;return babelHelpers.extends({},h,{mediaData:g,previewMediaData:f?c.previewMediaData:null})}function N(a,b,e){a!=null&&e!=null&&b.quotesToBeRestored.map(function(b){d("MAWBridgeEventTransmitter").issuePointQueryOutsideTxn(b.messageId,a,b.sortOrderMs,c("LSMEBTaskCreationSource").POINT_QUERY_FROM_EB,e)})}function O(a,b,c){var e=c==null?E:E.tags([c]);b==null||b.addPoint("receiver_fetch_restore_start");c=a.restoredMsgsData;if(c==null){b==null||b.addPoint("receiver_fetch_restore_end");return Promise.resolve()}var f=c.newlyAddedMsgs;f=f.concat(c.existingMsgs);var g=f.filter(function(a){return a.type===d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH}).map(function(b){var c=b.externalId;c=a.echoMsgMap.get(c);c=c==null?void 0:c.receiverFetchData;if(c==null||b.receiverFetchId==null)return null;if(c.type!=="sticker"){e.WARN(C||(C=babelHelpers.taggedTemplateLiteralLoose(["Not a supported receiver fetch type: ",""])),c.type);return null}c={mimetype:c.mimetype,previewHeight:c.previewHeight,previewWidth:c.previewWidth,receiverFetchId:b.receiverFetchId,type:c.type};return{dbMsg:b,unstoredDbReceiverFetchInfo:c}}).filter(Boolean);if(g.length>0)return P(g).then(function(a){b==null||b.addPoint("receiver_fetch_restore_end",{int:{receiver_fetch:g.length}});return Promise.resolve()});b==null||b.addPoint("receiver_fetch_restore_end",{int:{receiver_fetch:0}});return Promise.resolve()}var P=d("MAWIndexedDb").makeMsgrTransactor({receiverFetchInfo:b.READWRITE},"restoreWriteReceiverFetchInfosToDb",function(a){return function(b){return d("MAWDexieTable").dexieAll(b.map(function(b){var c=b.dbMsg;b=b.unstoredDbReceiverFetchInfo;return d("MAWWriteReceiverFetchTxns").handleUnstoredReceiverFetchInfo(a,c.threadJid,c.msgId,c.sortOrderMs,c.ts,b)}))}});g.handleEchoMsgsBulkRestore=a;g.getThread=H;g.getMediaMetadataForDownload=M;g.writeReceiverFetchInfosToDb=P}),98);
__d("MAWUnstoredQuotedMsgUtils",["FBLogger","MAWMsgType","WAJids","WAMsgType"],(function(a,b,c,d,e,f,g){"use strict";function h(a){if(a==null)return;var b=a.content;a=a.remoteJid;var e;switch(b.type){case d("MAWMsgType").MSG_TYPE.TEXT:e=j(b);break;case d("MAWMsgType").MSG_TYPE.IMAGE:e=k(b);break;case d("MAWMsgType").MSG_TYPE.VIDEO:e=l(b);break;case d("MAWMsgType").MSG_TYPE.PTT:e=m(b);break;case d("MAWMsgType").MSG_TYPE.GIF:e=n(b);break;case d("MAWMsgType").MSG_TYPE.STICKER:e=o(b);break;case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:e=q(b);break;case d("MAWMsgType").MSG_TYPE.UNAVAILABLE:e=r(b);break;case d("MAWMsgType").MSG_TYPE.EXPIRED_EPHEMERAL:e=s(b);break;case d("WAMsgType").NOTE_REPLY:e=p(b);break;case d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH:e=t(b);break;default:b.type;throw c("FBLogger")("messenger_web").mustfixThrow("For flow")}return{content:e,remoteJid:a}}function i(a){if(d("WAJids").isAuthorSystem(a.author))throw c("FBLogger")("messenger_web").mustfixThrow("A system message cannot be quoted");return{author:a.author,externalId:a.externalId,ts:a.ts}}function j(a){return babelHelpers["extends"]({},i(a),{msgContent:a.msgContent,type:d("MAWMsgType").MSG_TYPE.TEXT})}function k(a){return babelHelpers["extends"]({},i(a),{type:d("MAWMsgType").MSG_TYPE.IMAGE})}function l(a){return babelHelpers["extends"]({},i(a),{type:d("MAWMsgType").MSG_TYPE.VIDEO})}function m(a){return babelHelpers["extends"]({},i(a),{type:d("MAWMsgType").MSG_TYPE.PTT})}function n(a){return babelHelpers["extends"]({},i(a),{type:d("MAWMsgType").MSG_TYPE.GIF})}function o(a){return babelHelpers["extends"]({},i(a),{type:d("MAWMsgType").MSG_TYPE.STICKER})}function p(a){return babelHelpers["extends"]({},i(a),{expirationTs:a.expirationTs,msgContent:a.msgContent,type:d("WAMsgType").NOTE_REPLY})}function q(a){return babelHelpers["extends"]({},i(a),{type:d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE})}function r(a){return babelHelpers["extends"]({},i(a),{type:d("MAWMsgType").MSG_TYPE.UNAVAILABLE})}function s(a){return babelHelpers["extends"]({},i(a),{type:d("MAWMsgType").MSG_TYPE.EXPIRED_EPHEMERAL})}function t(a){return babelHelpers["extends"]({},i(a),{type:d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH})}function a(a){return{quote:h(a.quote)}}g.getWithQuoteMsg=a}),98);
__d("MAWUnstoredTypedMsgUtils",["MAWAdminMsgType","MAWDbMsg","MAWMsgType","MAWRavenUtils","MAWUnstoredQuotedMsgUtils","WAJids"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return{ack:a.ack,author:a.id.author,ebTimestampMs:a.ebTimestampMs,externalId:a.id.externalId,reportingMeta:a.reportingMeta,serverTs:a.serverTs,ts:a.ts}}function i(a){return{forwardingScore:a.forwardingScore,isForwarded:a.isForwarded}}function j(a){return{ephemeralSetting:k(a.ephemeralSetting),messageDeleteTs:a.deleteTs,messageExpirationTs:a.expirationTs}}function k(a){if(a==null)return;return{ephemeralExpirationInSec:a.expirationTs,ephemeralLastUpdatedOrSetTimestamp:a.updatedTs}}function a(a,b){return babelHelpers["extends"]({},h(a),i(a),d("MAWUnstoredQuotedMsgUtils").getWithQuoteMsg(a),j(a),{altIndex:void 0,collapsibleId:a.collapsibleId,isCollapsed:a.isCollapsed,msgContent:{commands:b.commands,content:(a=b.sentWithMessage)!=null?a:"",mentionedJids:b.mentionedJids},type:d("MAWMsgType").MSG_TYPE.XMA,xmaMessageType:b.targetType})}function b(a){return babelHelpers["extends"]({},h(a),i(a),d("MAWUnstoredQuotedMsgUtils").getWithQuoteMsg(a),j(a),{altIndex:void 0,editCount:0,msgContent:a.msgContent,specialTextSize:a.specialTextSize,type:d("MAWMsgType").MSG_TYPE.TEXT})}function c(a){return babelHelpers["extends"]({},h(a),i(a),d("MAWUnstoredQuotedMsgUtils").getWithQuoteMsg(a),j(a),{altIndex:void 0,plaintextHash:(a=a.mediaId)!=null?a:void 0,type:d("MAWMsgType").MSG_TYPE.IMAGE})}function e(a){return babelHelpers["extends"]({},h(a),d("MAWUnstoredQuotedMsgUtils").getWithQuoteMsg(a),j(a),{altIndex:void 0,ravenEphemeralMediaState:d("MAWRavenUtils").getEphemeralMediaState(a.ravenEphemeralMediaState),ravenEphemeralType:a.ravenEphemeralType,ravenMediaType:a.ravenMediaType,type:d("MAWMsgType").MSG_TYPE.RAVEN})}function f(a){return babelHelpers["extends"]({},h(a),i(a),d("MAWUnstoredQuotedMsgUtils").getWithQuoteMsg(a),j(a),{altIndex:void 0,plaintextHash:(a=a.mediaId)!=null?a:void 0,type:d("MAWMsgType").MSG_TYPE.VIDEO})}function l(a){return babelHelpers["extends"]({},h(a),i(a),d("MAWUnstoredQuotedMsgUtils").getWithQuoteMsg(a),j(a),{altIndex:void 0,type:d("MAWMsgType").MSG_TYPE.PTT})}function m(a){return{adminMsgContent:a.adminMsgContent,adminType:a.adminType}}function n(a){return babelHelpers["extends"]({},h(a),{altIndex:void 0,author:d("WAJids").AUTHOR_SYSTEM,msgContent:m(a.msgContent),type:d("MAWMsgType").MSG_TYPE.ADMIN})}function o(a){return babelHelpers["extends"]({},h(a),i(a),d("MAWUnstoredQuotedMsgUtils").getWithQuoteMsg(a),j(a),{altIndex:void 0,plaintextHash:(a=a.mediaId)!=null?a:void 0,type:d("MAWMsgType").MSG_TYPE.GIF})}function p(a){return babelHelpers["extends"]({},h(a),i(a),d("MAWUnstoredQuotedMsgUtils").getWithQuoteMsg(a),j(a),{altIndex:void 0,plaintextHash:(a=a.mediaId)!=null?a:void 0,type:d("MAWMsgType").MSG_TYPE.STICKER})}function q(a){return babelHelpers["extends"]({},h(a),i(a),d("MAWUnstoredQuotedMsgUtils").getWithQuoteMsg(a),j(a),{altIndex:void 0,type:d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE})}function r(a){return babelHelpers["extends"]({},h(a),{altIndex:d("MAWDbMsg").FUTUREPROOF_ALT_INDEX,msgContent:a.msgContent,type:d("MAWMsgType").MSG_TYPE.FUTUREPROOF})}function s(a){return babelHelpers["extends"]({},h(a),{altIndex:void 0,ebTimestampMs:a.ebTimestampMs,revokedExternalId:a.revokedExternalId,type:d("MAWMsgType").MSG_TYPE.REVOKED})}function t(a){return{adminMsgContent:a.adminMsgContent,adminType:a.adminType}}function u(a){return babelHelpers["extends"]({},h(a),{altIndex:void 0,msgContent:t(a.msgContent),type:d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN})}function v(a){return{adminMsgContent:a.adminMsgContent,adminType:a.adminType,screenshotActionType:a.screenshotActionType,version:a.version}}function w(a){return babelHelpers["extends"]({},h(a),{altIndex:void 0,msgContent:v(a.msgContent),type:d("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION})}function x(a){return{adminType:a.adminType,authorName:a.authorName}}function y(a){return babelHelpers["extends"]({},h(a),{altIndex:void 0,msgContent:x(a.msgContent),type:d("MAWMsgType").MSG_TYPE.ICDC_ALERT})}function z(a){return babelHelpers["extends"]({},h(a),d("MAWUnstoredQuotedMsgUtils").getWithQuoteMsg(a),j(a),{altIndex:void 0,type:d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE})}function A(a,b){b=b.receiverFetchId;return babelHelpers["extends"]({},h(a),i(a),d("MAWUnstoredQuotedMsgUtils").getWithQuoteMsg(a),j(a),{altIndex:void 0,receiverFetchId:b,type:d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH})}function B(a,b){var c=a.id.author===d("WAJids").AUTHOR_ME;b=[b.name];c||b.unshift(a.id.author!==d("WAJids").AUTHOR_ME&&a.id.author!==d("WAJids").AUTHOR_SYSTEM?d("WAJids").userIdFromJid(a.id.author):a.id.author);c=c?d("MAWAdminMsgType").CURRENT_USER_CREATED_POLL:d("MAWAdminMsgType").PARTICIPANT_CREATED_POLL;return babelHelpers["extends"]({},h(a),{altIndex:void 0,msgContent:{adminMsgContent:b,adminType:c,version:1},type:d("MAWMsgType").MSG_TYPE.GROUP_POLL_CREATE})}function C(a){return babelHelpers["extends"]({},h(a),{altIndex:void 0,type:d("MAWMsgType").MSG_TYPE.GROUP_POLL_UPDATE})}g.getXMAMsg=a;g.getTextMsg=b;g.getImageMsg=c;g.getRavenMsg=e;g.getVideoMsg=f;g.getPttMsg=l;g.getAdminMsg=n;g.getGifMsg=o;g.getStickerMsg=p;g.getDocumentFileMsg=q;g.getFutureproofMsg=r;g.getRevokedMsg=s;g.getEphemeralSettingAdminMsg=u;g.getEphemeralScreenshotActionMsg=w;g.getICDCAlertMsg=y;g.getBumpExistingMessageMsg=z;g.getReceiverFetchMsg=A;g.getGroupPollCreateMsg=B;g.getGroupPollUpdateMsg=C}),98);
__d("MAWUnstoredMsgUtils",["FBLogger","MAWMsgType","MAWUnstoredTypedMsgUtils","qex"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.unstoredGroupPollCreateInfo,e=a.unstoredMsg,f=a.unstoredReceiverFetchInfo;a=a.unstoredXMA;if(e==null)return null;switch(e.type){case d("MAWMsgType").MSG_TYPE.TEXT:return d("MAWUnstoredTypedMsgUtils").getTextMsg(e);case d("MAWMsgType").MSG_TYPE.IMAGE:return d("MAWUnstoredTypedMsgUtils").getImageMsg(e);case d("MAWMsgType").MSG_TYPE.VIDEO:return d("MAWUnstoredTypedMsgUtils").getVideoMsg(e);case d("MAWMsgType").MSG_TYPE.PTT:return d("MAWUnstoredTypedMsgUtils").getPttMsg(e);case d("MAWMsgType").MSG_TYPE.ADMIN:return d("MAWUnstoredTypedMsgUtils").getAdminMsg(e);case d("MAWMsgType").MSG_TYPE.FUTUREPROOF:return d("MAWUnstoredTypedMsgUtils").getFutureproofMsg(e);case d("MAWMsgType").MSG_TYPE.REVOKED:return d("MAWUnstoredTypedMsgUtils").getRevokedMsg(e);case d("MAWMsgType").MSG_TYPE.GIF:return d("MAWUnstoredTypedMsgUtils").getGifMsg(e);case d("MAWMsgType").MSG_TYPE.STICKER:return d("MAWUnstoredTypedMsgUtils").getStickerMsg(e);case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:return d("MAWUnstoredTypedMsgUtils").getDocumentFileMsg(e);case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SETTING_ADMIN:return d("MAWUnstoredTypedMsgUtils").getEphemeralSettingAdminMsg(e);case d("MAWMsgType").MSG_TYPE.EPHEMERAL_SCREENSHOT_ACTION:return d("MAWUnstoredTypedMsgUtils").getEphemeralScreenshotActionMsg(e);case d("MAWMsgType").MSG_TYPE.ICDC_ALERT:return d("MAWUnstoredTypedMsgUtils").getICDCAlertMsg(e);case d("MAWMsgType").MSG_TYPE.XMA:if((a==null?void 0:a.xma)==null)throw c("FBLogger")("messenger_web").mustfixThrow("XMA content cannot be parsed without XMA payload");return d("MAWUnstoredTypedMsgUtils").getXMAMsg(e,a==null?void 0:a.xma);case d("MAWMsgType").MSG_TYPE.RAVEN:return d("MAWUnstoredTypedMsgUtils").getRavenMsg(e);case d("MAWMsgType").MSG_TYPE.RAVEN_ACTION:case d("MAWMsgType").MSG_TYPE.REACTION:case d("MAWMsgType").MSG_TYPE.EDIT_ACTION:return null;case d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE:return d("MAWUnstoredTypedMsgUtils").getBumpExistingMessageMsg(e);case d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH:if(f==null)throw c("FBLogger")("messenger_web").mustfixThrow("Receiver Fetch Info cannot be null for Receiver Fetch Msg");return d("MAWUnstoredTypedMsgUtils").getReceiverFetchMsg(e,f);case d("MAWMsgType").MSG_TYPE.GROUP_POLL_CREATE:if(!c("qex")._("3169"))throw c("FBLogger")("messenger_web").mustfixThrow("Group polls are not yet supported");if(b==null)throw c("FBLogger")("messenger_web").mustfixThrow("Poll Create Info cannot be null for Poll Create Msg");return d("MAWUnstoredTypedMsgUtils").getGroupPollCreateMsg(e,b);case d("MAWMsgType").MSG_TYPE.GROUP_POLL_UPDATE:if(!c("qex")._("3169"))throw c("FBLogger")("messenger_web").mustfixThrow("Group polls are not yet supported");return d("MAWUnstoredTypedMsgUtils").getGroupPollUpdateMsg(e);default:e.type;return null}}function b(a){if(a==null)return null;switch(a.type){case d("MAWMsgType").MSG_TYPE.TEXT:return d("MAWUnstoredTypedMsgUtils").getTextMsg(a);case d("MAWMsgType").MSG_TYPE.GIF:return d("MAWUnstoredTypedMsgUtils").getGifMsg(a);case d("MAWMsgType").MSG_TYPE.STICKER:return d("MAWUnstoredTypedMsgUtils").getStickerMsg(a);default:return null}}function e(a){a=a.unstoredMsg;if(!a||a.type!==d("MAWMsgType").MSG_TYPE.REACTION)return null;a=a;return{ack:a.ack,author:a.id.author,externalId:a.id.externalId,groupingKey:a.groupingKey,reaction:a.reaction,reactToAuthor:a.reactToAuthor,reactToExternalId:a.reactToExternalId,senderTimestampMs:a.senderTimestampMs,threadJid:a.id.chat,ts:a.ts}}function f(a){a=a.unstoredMsg;if(!a||a.type!==d("MAWMsgType").MSG_TYPE.RAVEN_ACTION)return null;a=a;return{ack:a.ack,actionTimestamp:a.actionTimestamp,actionType:a.actionType,author:a.id.author,externalId:a.id.externalId,ravenActionToMsgExternalId:a.ravenActionToMsgExternalId,ts:a.ts,type:a.type}}function h(a){a=a.unstoredIncomingGroupInvite;return!a?null:babelHelpers["extends"]({},a)}function i(a){return a==null?null:{ack:a.ack,author:a.id.author,editMsgContent:a.editMsgContent,externalId:a.id.externalId,originalMsgExternalId:a.originalMsgExternalId,reportingMeta:a.reportingMeta,serverTs:a.serverTs,specialTextSize:a.specialTextSize,ts:a.ts,type:a.type}}function j(a){a=a.unstoredReceiverFetchInfo;return a==null?null:babelHelpers["extends"]({},a,{type:"sticker"})}function k(a){a=a.unstoredGroupPollCreateInfo;return a==null?null:babelHelpers["extends"]({},a,{latestSenderTimestampsMs:new Map()})}function l(a){a=a.unstoredGroupPollUpdateInfo;return a==null?null:{encryptedMessage:a.pollUpdateMessage}}g.getUnstoredMsg=a;g.getUnstoredAssociatedMsg=b;g.getUnstoredReaction=e;g.getUnstoredRavenActionMsg=f;g.getGroupInvite=h;g.getUnstoredEditActionMsg=i;g.getUnstoredReceiverFetchInfo=j;g.getUnstoredGroupPollCreateInfo=k;g.getUnstoredDbGroupPollUpdateInfo=l}),98);
__d("MAWUnstoredMediaUtils",["MAWUnstoredMsgUtils","WASortedLists"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a==null?null:{accessibilitySummaryText:a.accessibilitySummaryText,mediaEntry:a.mediaEntry,mediaType:a.mediaType,msgIds:d("WASortedLists").emptySet(),plaintextHash:a.plaintextHash,size:a.size,ts:a.ts,validatedAudioInfo:a.validatedAudioInfo,validatedDocumentFileInfo:a.validatedDocumentFileInfo,validatedImageInfo:a.validatedImageInfo,validatedVideoInfo:a.validatedVideoInfo}}function a(a){a=a.unstoredXMA;if(a==null)return;var b=a.unstoredAssociatedMedia,c=a.unstoredAssociatedMsg,e=a.unstoredFavicon,f=a.unstoredHeaderMedia,g=a.unstoredPreviews;a=a.xma;return{unstoredAssociatedMedia:(b=h(b))!=null?b:void 0,unstoredAssociatedMsg:(b=d("MAWUnstoredMsgUtils").getUnstoredAssociatedMsg(c))!=null?b:void 0,unstoredDbXMA:{author:a.author,contentRef:a.contentRef,ctas:a.ctas,defaultCTA:a.defaultCTA,externalId:a.externalId,headerTitle:a.headerTitle,isTombstoned:a.isTombstoned,maxSubtitleNumOfLines:a.maxSubtitleNumOfLines,maxTitleNumOfLines:a.maxTitleNumOfLines,overlayDescription:a.overlayDescription,overlayIconGlyph:a.overlayIconGlyph,overlayTitle:a.overlayTitle,subtitleText:a.subtitleText,targetExpiringAtSec:a.targetExpiringAtSec,targetId:a.targetId,targetType:a.targetType,targetUsername:a.targetUsername,threadJid:a.threadJid,titleText:a.titleText,xmaDataclass:a.xmaDataclass,xmaLayoutType:a.xmaLayoutType},unstoredFavicon:(c=h(e))!=null?c:void 0,unstoredHeaderMedia:(b=h(f))!=null?b:void 0,unstoredPreviews:g?g.map(function(a){return h(a)}).filter(Boolean):void 0}}g.getUnstoredMedia=h;g.getUnstoredXMA=a}),98);
__d("MAWUnstoredContentToUnstoredDbContentUtils",["MAWUnstoredMediaUtils","MAWUnstoredMsgUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b,c=(b=d("MAWUnstoredMsgUtils")).getUnstoredMsg(a),e=d("MAWUnstoredMediaUtils").getUnstoredMedia(a.unstoredMedia),f=b.getUnstoredReaction(a),g=b.getUnstoredRavenActionMsg(a),h=d("MAWUnstoredMediaUtils").getUnstoredXMA(a),i=b.getGroupInvite(a),j=b.getUnstoredEditActionMsg(a.unstoredEditMsg),k=b.getUnstoredReceiverFetchInfo(a),l=b.getUnstoredGroupPollCreateInfo(a);b=b.getUnstoredDbGroupPollUpdateInfo(a);if(i==null)return{contentTypeForLogging:a.contentTypeForLogging,unstoredDbEditActionMsg:j,unstoredDbGroupPollCreateInfo:l,unstoredDbGroupPollUpdateInfo:b,unstoredDbMedia:e,unstoredDbMsg:c,unstoredDbRavenActionMsg:g,unstoredDbReaction:f,unstoredDbReceiverFetchInfo:k,unstoredXMA:h,xmaTargetTypeForLogging:a.xmaTargetTypeForLogging};else return{contentTypeForLogging:a.contentTypeForLogging,unstoredDbEditActionMsg:j,unstoredDbGroupPollCreateInfo:l,unstoredDbGroupPollUpdateInfo:b,unstoredDbMedia:e,unstoredDbMsg:c,unstoredDbRavenActionMsg:g,unstoredDbReaction:f,unstoredDbReceiverFetchInfo:k,unstoredIncomingDbGroupInvite:i,unstoredXMA:h,xmaTargetTypeForLogging:a.xmaTargetTypeForLogging}}g.unstoredContentToUnstoredDbContent=a}),98);
__d("MAWWriteReactionTxns",["FBLogger","MAWAckLevel","MAWAuthor","MAWDbMsg","MAWDbReaction","MAWDbReactionsTxns","MAWDexieTable","MAWJidUtils","MAWUseProtocolMsgIdForMsgId"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e){var f=b.author,g=b.externalId,h=b.groupingKey,i=b.reaction,j=b.reactToAuthor,k=b.reactToExternalId,l=b.senderTimestampMs,m=b.ts;return d("MAWDexieTable").dexieAll([a.messages.where("externalId").equals(k).toArray(),a.reactions.where("reactToExternalId").equals(k).toArray(),d("MAWUseProtocolMsgIdForMsgId").shouldUseProtocolMsgIdForMsgId()?d("MAWDexieTable").dexieResolve(null):d("MAWDbReactionsTxns").getNextReactionIdNumberForThread(a,e)]).then(function(b){var n=b[0],o=b[1];b=b[2];var p=d("MAWDbReaction").findMatchingReaction(o,e.jid,f);o=o.find(function(a){return a.externalId===g});o!=null&&c("FBLogger")("maw_db").warn("We are inserting duplicate reaction");var q=d("MAWAuthor").getAuthorUserJid(j);o=n.find(function(a){return a.threadJid===e.jid&&q===d("MAWAuthor").getAuthorUserJid(a.author)});n=p==null?void 0:p.ack;(p==null?void 0:p.ack)===d("MAWAckLevel").ACK.partialOptimistic&&(n=d("MAWAckLevel").ACK.clock);var r=d("MAWDbReaction").formatReactionForDb(e.jid,g,b!=null?d("MAWDbMsg").craftReactionId(e.chatId,b):d("MAWJidUtils").formatProtocolMsgIdFromExternalId(e.jid,g),k,i,h,j,o==null?void 0:o.msgId,m,f,p==null?void 0:p.rowId,n,l);return d("MAWDbReactionsTxns").putReaction(a,r).then(function(a){a=babelHelpers["extends"]({},r,{rowId:a});return a})})}g.writeReaction=a}),98);
__d("MAWWriteReactionMsgApi",["MAWIndexedDb","MAWTransactionMode","MAWWriteReactionTxns","WAJids"],(function(a,b,c,d,e,f,g){"use strict";var h=function(a,b,c,e,f,g){g===void 0&&(g=d("WAJids").AUTHOR_ME);var h=e.groupingKey,i=e.reaction,j=e.reactToAuthor,k=e.reactToExternalId;e=e.senderTimestampMs;var l={author:g,externalId:b,groupingKey:h,reaction:i,reactToAuthor:j,reactToExternalId:k,senderTimestampMs:e,ts:f};return a.threads.get({jid:c}).then(function(b){return b==null?"missing_thread":d("MAWWriteReactionTxns").writeReaction(a,l,b)}).then(function(a){return a==="missing_thread"?{type:"missing_thread"}:{msgId:a.reactionId,protocolMsgId:{author:g,chat:c,externalId:a.externalId},type:"not_sent"}})};a=d("MAWIndexedDb").makeMsgrTransactor({messages:d("MAWTransactionMode").READONLY,reactions:d("MAWTransactionMode").READWRITE,threads:d("MAWTransactionMode").READONLY},"writeReactionMsg",function(a){return function(b,c,e,f,g){g===void 0&&(g=d("WAJids").AUTHOR_ME);return h(a,b,c,e,f,g)}});g.writeReactionMsg=a}),98);
__d("MAWHandleEchoProtobufsRestoreApi",["EBLogger","EchoMessageMediaFieldUtils","EncryptedBackupsDYIMessageProcessingUtils","LSDataTraceCheckPoint","LSIntEnum","LSMEBTaskCreationSource","MAWBridge","MAWBridgeEventTransmitter","MAWBridgeMsg","MAWDbEditMsgHistoryTxns","MAWDbMsg","MAWDbRavenActionTxns","MAWDexieTable","MAWEBRestoreTrackingUtils","MAWHandleEchoMediaMsgsRestoreV2","MAWHandleEchoMsgsRestoreApiUtils","MAWHandleEchoMsgsRestoreApiV2","MAWHandleEchoXMARestoreV2","MAWHandleXmaTransactionUtil","MAWIndexedDb","MAWJids","MAWLoadReplyMediaTxns","MAWMediaManagementTxns","MAWMsg","MAWMsgType","MAWODSProxy","MAWQplProxy","MAWRestoreMsgsTxns","MAWRestoreValidationUtils","MAWTraceUtils","MAWTransactionMode","MAWUnstoredContentToUnstoredDbContentUtils","MAWUpdateQuotedMsgTxns","MAWWriteReactionMsgApi","MAWWriteReceiverFetchTxns","MWEBODSEntityName.enum","MWEBODSUtils","MessageBackupSupplementalKeyGenerator","WAAckLevel","WAArmadilloApplication.pb","WAArmadilloBackupMessage.pb","WABase64","WAConsumerApplication.pb","WAGlobals","WAHashUtils","WAJids","WAMediaTransport.pb","WAMediaUtils","WAMsgApplication.pb","WAMsgType","WAOdsEnums","WAParseConsumerMessageProtocol","WAParseMediaTransportProtocol","WAParseMessageApplication","WAStanzaUtils","WATimeUtils","decodeProtobuf","emptyFunction","gkx","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=d("EBLogger").EBLogger.tags(["ProtobufRestore"]);function L(a){var b=a.isMediaGalleryRestore,e=a.taskSource;b!=null&&b?(d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.EB_RESTORE,key:"is_media_gallery_restore_param"}),K.WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["isMediaGalleryRestore is deprecated. Consider using taskSource insted"]))),b=c("LSMEBTaskCreationSource").MEDIA_GALLERY_RESTORE):b=e!=null?e:c("LSMEBTaskCreationSource").UNKNOWN;return babelHelpers.extends({},a,{isMediaGalleryRestore:void 0,taskSource:b})}var M=(b=d("MAWIndexedDb")).makeMsgrTransactor({chunk:(e=d("MAWTransactionMode")).READONLY,media:e.READONLY,messages:e.READWRITE,receiverFetchInfo:e.READONLY,xma:e.READONLY},"associateQuotedMessagesForRestoredDbMsgs",function(a){return function(b,c,e){var f=0;return d("MAWDexieTable").dexieAll(b.map(function(b){return d("MAWUpdateQuotedMsgTxns").associateQuotedMessage(a,c,b,!0).then(function(b){b!=null&&b.length>0&&(f+=b.length,b.forEach(function(b){return d("MAWLoadReplyMediaTxns").getReplyMediaForMsgQuote(a,b).then(function(a){d("MAWIndexedDb").afterTransaction({tag:"MsgUpdated",value:d("MAWBridgeMsg").createBridgeMsg(b,a)})})}))})})).then(function(){e==null||e.addPoint("replies_restore_end",{int:{replies:f}});return d("MAWDexieTable").dexieResolve()})}});function N(a,b,c){c={author:c,chat:b,externalId:a};return c}function O(a,b,c){var e=new Map(),f=a.metadata;a=a.reactionData;if(f!=null&&a!=null){var g=f.senderId,h=f.messageId;if(g!=null&&h!=null){a.forEach(function(a){var f=a.ts,i=a.senderId,j=a.reactionExternalId,k=d("WAStanzaUtils").toStanzaId(h);if(i==null||j==null)return;j=d("WAStanzaUtils").toStanzaId(j);i=d("MAWJids").toUserJid(i);var l=d("MAWJids").toUserJid(g);i=i===c?d("WAJids").AUTHOR_ME:i;l=l===c?d("WAJids").AUTHOR_ME:l;var m=i===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED;m={ack:m,chatJid:b,reaction:a.reaction,reactionAuthor:i,reactionExternalId:j,reactToExternalId:k,reactToMsgAuthor:l,ts:f};e.set(j,m)});return e}}}function P(a,b,c,e,f,g,h,n,o,p,q,r,s,t,u,v){if(a===d("MAWMsgType").MSG_TYPE.TEXT)if(h==null){K.MUSTFIX(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Text content cannot be null for msg type text - unable to restore msg"])));return}else{h={ack:c===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED,forwardingScore:g,id:e,isForwarded:f,msgContent:{content:h,mentionedJids:n!=null?n.map(d("WAJids").validateUserJid).filter(Boolean):void 0},ts:b,type:d("MAWMsgType").MSG_TYPE.TEXT};return h}else if(a===d("MAWMsgType").MSG_TYPE.VIDEO){n={ack:c===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED,forwardingScore:g,id:e,isForwarded:f,mediaId:void 0,ts:b,type:d("MAWMsgType").MSG_TYPE.VIDEO};return n}else if(a===d("MAWMsgType").MSG_TYPE.GIF){h={ack:c===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED,forwardingScore:g,id:e,isForwarded:f,mediaId:void 0,ts:b,type:d("MAWMsgType").MSG_TYPE.GIF};return h}else if(a===d("MAWMsgType").MSG_TYPE.IMAGE){n={ack:c===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED,forwardingScore:g,id:e,isForwarded:f,mediaId:void 0,ts:b,type:d("MAWMsgType").MSG_TYPE.IMAGE};return n}else if(a===d("MAWMsgType").MSG_TYPE.STICKER){h={ack:c===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED,forwardingScore:g,id:e,isForwarded:f,mediaId:void 0,ts:b,type:d("MAWMsgType").MSG_TYPE.STICKER};return h}else if(a===d("MAWMsgType").MSG_TYPE.PTT){n={ack:c===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED,forwardingScore:g,id:e,isForwarded:f,mediaId:void 0,ts:b,type:d("MAWMsgType").MSG_TYPE.PTT};return n}else if(a===d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE){h={ack:c===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED,forwardingScore:g,id:e,isForwarded:f,mediaId:void 0,ts:b,type:d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE};return h}else if(a===d("MAWMsgType").MSG_TYPE.XMA){n={ack:c===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED,forwardingScore:g,id:e,isForwarded:f,ts:b,type:d("MAWMsgType").MSG_TYPE.XMA};return n}else if(a===d("MAWMsgType").MSG_TYPE.REVOKED){if(o==null){K.MUSTFIX(j||(j=babelHelpers.taggedTemplateLiteralLoose(["No revoked msg external id found for revoked msg"])));return}h={ack:c===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED,ebTimestampMs:null,id:e,msgContent:void 0,revokedExternalId:o,ts:b,type:d("MAWMsgType").MSG_TYPE.REVOKED,unsendMsgContentDeleteTs:b};return h}else if(a===d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE){n={ack:d("WAAckLevel").ACK.SENT,id:e,ts:b,type:d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE};return n}else if(a===d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH){o={ack:c===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED,forwardingScore:g,id:e,isForwarded:f,ts:b,type:d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH};return o}else if(a===d("MAWMsgType").MSG_TYPE.RAVEN){if(p==null){K.MUSTFIX(k||(k=babelHelpers.taggedTemplateLiteralLoose(["No raven msg ephemeral type found for raven msg"])));return}if(q==null){K.MUSTFIX(l||(l=babelHelpers.taggedTemplateLiteralLoose(["No raven msg media type found for raven msg"])));return}h={ack:c===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED,id:e,mediaId:r,ravenEphemeralMediaState:d("MAWMsg").MAWRavenMsgEphemeralMediaState.UNSEEN,ravenEphemeralType:p,ravenMediaType:q,ts:b,type:d("MAWMsgType").MSG_TYPE.RAVEN};return h}else if(a===d("MAWMsgType").MSG_TYPE.GROUP_POLL_CREATE){if(s==null||t==null||u==null||v==null){K.MUSTFIX(m||(m=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] One of the mandatory fields is missing for the group poll creation msg"])));return}n={ack:c===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED,id:e,ts:b,type:d("MAWMsgType").MSG_TYPE.GROUP_POLL_CREATE};return n}}function Q(a,b,c,e,f){if(f==null){K.MUSTFIX(n||(n=babelHelpers.taggedTemplateLiteralLoose(["XMA data is null - unable to extract XMA content for message"])));return}var g=f==null?void 0:f.ctas.map(function(a){return{actionUrl:a.actionUrl,buttonType:a.buttonType,ctaType:a.ctaType,nativeUrl:a.nativeUrl,title:a.title}}),h=f.targetType;if(h==null){K.MUSTFIX(o||(o=babelHelpers.taggedTemplateLiteralLoose(["No target type found for XMA - unable to extract XMA content for message"])));return}var i;f.targetExpiringAtSec!=null&&typeof f.targetExpiringAtSec==="number"&&(i=d("WATimeUtils").castToUnixTime(f.targetExpiringAtSec));a={author:a,contentRef:f.contentRef,ctas:g,defaultCTA:g.length>0?g[0]:void 0,externalId:b,headerTitle:f.headerTitle,maxSubtitleNumOfLines:f.maxSubtitleNumOfLines,maxTitleNumOfLines:f.maxTitleNumOfLines,msgId:c,overlayDescription:f.overlayDescription,overlayIconGlyph:f.overlayIconGlyph,overlayTitle:f.overlayTitle,subtitleText:f.subtitleText,targetExpiringAtSec:i,targetId:f.targetId,targetType:h,targetUsername:f.targetUsername,threadJid:e,titleText:f.titleText,xmaLayoutType:f.xmaLayoutType};return a}function R(a,b,c,e,f){var g,h,i=a.metadata,j=a.msgType;if(i==null){K.MUSTFIX(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Missing required metadata, unable to create db msg from protobuf"])));return}if(j==null){K.MUSTFIX(q||(q=babelHelpers.taggedTemplateLiteralLoose(["Missing required msg type, unable to create db msg from protobuf"])));return}var k=i.messageId;i=i.senderId;g=(g=a.decodedPayload)==null?void 0:g.text;h=(h=a.decodedPayload)==null?void 0:h.mentionedJid;if(k==null){K.MUSTFIX(r||(r=babelHelpers.taggedTemplateLiteralLoose(["Missing required message id, unable to create db msg from protobuf"])));return}if(i==null){K.MUSTFIX(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Missing required author, unable to create db msg from protobuf"])));return}var l=d("WATimeUtils").castMilliSecondsToUnixTime(a.sortOrderMs);i=d("MAWJids").toUserJid(i);var m=d("WAStanzaUtils").toStanzaId(k),n=i===c?d("WAJids").AUTHOR_ME:i,o=N(m,b,i);if(a.editMsgData.length>0){var v=l;a.editMsgData.forEach(function(a){var b;if(a.ts>v&&((b=a.editMsgContent.message)==null?void 0:b.text)!=null){v=a.ts;g=(b=a.editMsgContent.message)==null?void 0:b.text;h=(b=a.editMsgContent.message)==null?void 0:b.mentionedJid}})}o=P(j,l,n,o,a.isForwarded,a.forwardingScore,g,h,a.revokedMsgExternalId,a.ravenMsgEphemeralType,a.ravenMsgMediaType,(l=a.ravenUnstoredMedia)==null?void 0:l.plaintextHash,(n=a.groupPollInfo)==null?void 0:n.encKey,(o=a.groupPollInfo)==null?void 0:o.name,(l=a.groupPollInfo)==null?void 0:l.options,(n=a.groupPollInfo)==null?void 0:n.selectableOptionsCount);if(o==null){K.MUSTFIX(t||(t=babelHelpers.taggedTemplateLiteralLoose(["Missing required fields, unable to create db msg from protobuf for thread jid "," and otid ",""])),b,m);return}var w;if(a.xmaData!=null&&((l=a.xmaData)==null?void 0:l.targetType)!=null){l={author:i,externalId:m,targetType:(n=a.xmaData)==null?void 0:n.targetType,threadJid:b};w={unstoredAssociatedMedia:void 0,unstoredAssociatedMsg:void 0,unstoredFavicon:void 0,unstoredHeaderMedia:void 0,unstoredPreviews:void 0,xma:l}}i={unstoredGroupPollCreateInfo:a.groupPollInfo,unstoredMedia:void 0,unstoredMsg:o,unstoredQuotedMedia:void 0,unstoredReceiverFetchInfo:a.receiverFetchInfo,unstoredXMA:w};o.type===d("MAWMsgType").MSG_TYPE.RAVEN&&a.ravenUnstoredMedia!=null&&(i.unstoredMedia=a.ravenUnstoredMedia);n=d("MAWUnstoredContentToUnstoredDbContentUtils").unstoredContentToUnstoredDbContent(i);if(n.unstoredDbMsg!=null){b=n.unstoredDbMsg;b.sortOrderMs=a.sortOrderMs;b.serverTs=d("WATimeUtils").castToUnixTime(a.sortOrderMs/1e3);a.noteReply!=null&&(b.quote={content:a.noteReply,remoteJid:void 0});l=e.get(k);b.author!=null&&c===b.author&&b.author!==d("WAJids").AUTHOR_SYSTEM&&(b.author=d("WAJids").AUTHOR_ME);l!=null&&(b.quoteExternalId=d("WAStanzaUtils").toStanzaId(l));j===d("MAWMsgType").MSG_TYPE.TEXT&&(b.editCount=a.editMsgData.length);o={author:b.author,stanzaId:m,unstoredDbContent:n};n.unstoredDbMedia!=null&&f!=null&&f.set(m,n.unstoredDbMedia);return o}K.MUSTFIX(u||(u=babelHelpers.taggedTemplateLiteralLoose(["Failed to create db msg from protobuf"])))}function S(a){switch(a){case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.IMAGE:return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.IMAGE_JPEG;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.GIF:return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.GIF;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.STICKER:return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.STICKER;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.VIDEO:return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.AUDIO_MP4;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.AUDIO:return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.AUDIO_WAV;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.XMA_IMAGE:return d("EchoMessageMediaFieldUtils").EchoMessageMediaPreviewType.IMAGE_JPEG;default:return null}}function aa(a){switch(a){case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.IMAGE:return d("EchoMessageMediaFieldUtils").AttachmentType.IMAGE;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.GIF:return d("EchoMessageMediaFieldUtils").AttachmentType.GIF;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.STICKER:return d("EchoMessageMediaFieldUtils").AttachmentType.STICKER;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.VIDEO:return d("EchoMessageMediaFieldUtils").AttachmentType.VIDEO;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.AUDIO:return d("EchoMessageMediaFieldUtils").AttachmentType.PTT;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.XMA_IMAGE:return d("EchoMessageMediaFieldUtils").AttachmentType.XMA;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.DOCUMENT:return d("EchoMessageMediaFieldUtils").AttachmentType.DOCUMENT;default:return null}}function ba(){try{return WorkerGlobalScope!==void 0&&self instanceof WorkerGlobalScope}catch(a){return!1}}function ca(a){var b,e=ba()?d("WAGlobals").getConfig().isOctetStreamAttachmentMimeTypeEnabled():c("gkx")("4644");switch(a){case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.IMAGE:b="image/jpeg";break;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.AUDIO:b="audio/wav";break;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.VIDEO:b="video/mp4";break;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.GIF:b="image/gif";break;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.STICKER:b="image/webp";break;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.XMA_IMAGE:b="image/jpeg";break;case d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.DOCUMENT:b=e?"application/octet-stream":"application/pdf";break;default:K.MUSTFIX(v||(v=babelHelpers.taggedTemplateLiteralLoose(["Unsupported media type, cannot get mimetype for attachment"])))}return b}function T(a,b,c){var e,f,g,h,i,j,k,l,m,n;b=b;var o=a.ancillary,p=a.integral,q=p==null||(e=p.transport)==null||(e=e.integral)==null?void 0:e.fileSha256,r=p==null||(f=p.transport)==null||(f=f.integral)==null?void 0:f.fileEncSha256,s=p==null||(g=p.transport)==null||(g=g.integral)==null?void 0:g.mediaKey,t=(p==null||(h=p.transport)==null||(h=h.integral)==null?void 0:h.mediaKeyTimestamp)!=null?typeof (p==null||(i=p.transport)==null?void 0:i.integral.mediaKeyTimestamp)==="number"?p==null||(j=p.transport)==null?void 0:j.integral.mediaKeyTimestamp:void 0:void 0,u=o==null?void 0:o.gifPlayback;u!=null&&u&&(b=d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.GIF);u=p==null||(k=p.transport)==null||(k=k.ancillary)==null||(k=k.thumbnail)==null?void 0:k.thumbnailHeight;var v=p==null||(l=p.transport)==null||(l=l.ancillary)==null||(l=l.thumbnail)==null?void 0:l.thumbnailWidth,y=S(b),z=aa(b);if(z===null){K.MUSTFIX(w||(w=babelHelpers.taggedTemplateLiteralLoose(["Invalid attachment type, cannot restore attachment"])));return}a=d("EncryptedBackupsDYIMessageProcessingUtils").decodeMediaEntryFromAttachmentPayload(a,z===d("EchoMessageMediaFieldUtils").AttachmentType.XMA,c);a.success||K.WARN(x||(x=babelHelpers.taggedTemplateLiteralLoose(["Cannot generate media entry data, ",""])),a.error);z={attachmentObjectId:p==null||(m=p.transport)==null||(m=m.ancillary)==null?void 0:m.objectId,attachmentType:z,directPath:p==null||(n=p.transport)==null||(n=n.integral)==null?void 0:n.directPath,encryptedHash:r!=null?d("WAHashUtils").toPlaintextHash(r):void 0,filename:c,height:o==null?void 0:o.height,mediaEntryData:a.value,mediaKey:s!=null?d("WABase64").encodeB64UrlSafe(s):void 0,mediaKeyTimestamp:t,mediaPlayableDuration:o==null?void 0:o.seconds,plaintextHash:q!=null?d("WAHashUtils").toPlaintextHash(q):void 0,width:o==null?void 0:o.width,xAttachmentType:b,xContentType:"full"};p=ca(b);p!=null&&(z.mediaContentType=p);y!=null&&(z.previewContentType=y,z.previewContentHeight=u,z.previewContentWidth=v);return d("EchoMessageMediaFieldUtils").convertMediaMetadataDetailsToMediaMetadata(z,"protobuf")}function U(a,b,c){var e;b=T(a,b,c);if(b==null)return{mediaMetadata:void 0,previewMetadata:null};c=a.integral;a=null;c=c==null||(e=c.transport)==null||(e=e.ancillary)==null||(e=e.thumbnail)==null?void 0:e.downloadableThumbnail;if(c!=null){var f=c.fileSha256,g=c.fileEncSha256,h=c.mediaKey,i=typeof c.mediaKeyTimestamp==="number"?c.mediaKeyTimestamp:void 0;a={attachmentObjectId:c.objectId,attachmentType:d("EchoMessageMediaFieldUtils").AttachmentType.IMAGE,directPath:c.directPath,encryptedHash:g!=null?d("WAHashUtils").toPlaintextHash(g):void 0,filename:void 0,height:void 0,mediaKey:h!=null?d("WABase64").encodeB64UrlSafe(h):void 0,mediaKeyTimestamp:i,mediaPlayableDuration:void 0,plaintextHash:f!=null?d("WAHashUtils").toPlaintextHash(f):void 0,width:void 0,xAttachmentType:d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.MESSENGER_PREVIEW,xContentType:"preview"};return{mediaMetadata:b,previewMetadata:d("EchoMessageMediaFieldUtils").convertMediaMetadataDetailsToMediaMetadata(a,"protobuf")}}return{mediaMetadata:b,previewMetadata:null}}function V(a,b,c,e,f,g){g===void 0&&(g=null),b!=null&&a!=null&&(c.push({mediaMetadata:b,mediaRestoreType:e,previewMetadata:g}),f.set(d("WAStanzaUtils").toStanzaId(a),c))}function da(a){switch(a){case 0:return d("MAWMsg").MAWRavenMsgEphemeralType.VIEW_ONCE;case 1:return d("MAWMsg").MAWRavenMsgEphemeralType.ALLOW_REPLAY;case 2:return d("MAWMsg").MAWRavenMsgEphemeralType.KEEP_IN_CHAT;default:return void 0}}function ea(a,b,c,e,f,g,h,i,j,k,l){var m,n,o,p,q,r,s,t,u,v=W(a,g,h,i),w=v==null||(m=v.obj.payload)==null?void 0:m.content,x={editMsgData:[],externalId:e,forwardingScore:(n=v==null||(o=v.metadata)==null?void 0:o.forwardingScore)!=null?n:0,isForwarded:(n=v==null||(p=v.metadata)==null?void 0:p.isForwarded)!=null?n:!1,metadata:a.metadata,reactionData:[],sortOrderMs:b,unknownFieldCount:a.$$unknownFieldCount},D=[];if(w!=null){if(w.messageText!=null){x.msgType=d("MAWMsgType").MSG_TYPE.TEXT;x.decodedPayload=w.messageText;return x}else if(w.extendedContentMessage!=null){x.msgType=d("MAWMsgType").MSG_TYPE.XMA;x.xmaData=w.extendedContentMessage;if(((n=w.extendedContentMessage)==null?void 0:n.headerImage)!=null){n=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMediaTransport.pb").ImageTransportSpec,(b=w.extendedContentMessage)==null?void 0:b.headerImage.payload);b=T(n,d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.IMAGE);V(e,b,D,"xma_header",j)}if(((n=w.extendedContentMessage)==null?void 0:n.favicon)!=null){n=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMediaTransport.pb").ImageTransportSpec,(b=w.extendedContentMessage)==null?void 0:b.favicon.payload);b=T(n,d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.IMAGE);V(e,b,D,"xma_favicon",j)}if(((n=w.extendedContentMessage)==null?void 0:n.previews)!=null){(b=w.extendedContentMessage)==null||b.previews.forEach(function(a){a=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMediaTransport.pb").ImageTransportSpec,a.payload);a=T(a,d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.IMAGE);x.mediaMetadata=a;V(e,a,D,"xma_preview",j)})}return x}else if(w.audioMessage!=null){b=d("decodeProtobuf").decodeProtobuf(d("WAMediaTransport.pb").AudioTransportSpec,(n=w.audioMessage)==null||(n=n.audio)==null?void 0:n.payload);n=T(b,d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.AUDIO);x.msgType=d("MAWMsgType").MSG_TYPE.PTT;x.mediaMetadata=n;V(e,n,D,"attachment",j);return x}else if(w.videoMessage!=null){b=d("decodeProtobuf").decodeProtobuf(d("WAMediaTransport.pb").VideoTransportSpec,(b=w.videoMessage)==null||(b=b.video)==null?void 0:b.payload);b=U(b,d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.VIDEO);var E=b.mediaMetadata;b=b.previewMetadata;n=E;n!=null&&n.xAttachmentType===d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.GIF?x.msgType=d("MAWMsgType").MSG_TYPE.GIF:x.msgType=d("MAWMsgType").MSG_TYPE.VIDEO;x.mediaMetadata=n;V(e,n,D,"attachment",j,b);return x}else if(w.imageMessage!=null){b=d("decodeProtobuf").decodeProtobuf(d("WAMediaTransport.pb").ImageTransportSpec,(E=w.imageMessage)==null||(E=E.image)==null?void 0:E.payload);E=U(b,d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.IMAGE);b=E.mediaMetadata;E=E.previewMetadata;n=b;x.msgType=d("MAWMsgType").MSG_TYPE.IMAGE;x.mediaMetadata=n;V(e,n,D,"attachment",j,E);return x}else if(w.stickerMessage!=null){E=d("decodeProtobuf").decodeProtobuf(d("WAMediaTransport.pb").StickerTransportSpec,(b=w.stickerMessage)==null||(b=b.sticker)==null?void 0:b.payload);if(((b=E.integral)==null?void 0:b.receiverFetchId)!=null){b=d("WAParseMediaTransportProtocol").parseStickerReceiverFetchInfo(E);if(b==null){K.MUSTFIX(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[MAWHandleEchoProtobufsRestoreApi] consumerMessage has no sticker receiver fetch info"])));return x}x.msgType=d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH;x.receiverFetchInfo=b;return x}n=T(E,d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.STICKER);x.msgType=d("MAWMsgType").MSG_TYPE.STICKER;x.mediaMetadata=n;V(e,n,D,"attachment",j);return x}else if(w.documentMessage!=null){E=d("decodeProtobuf").decodeProtobuf(d("WAMediaTransport.pb").DocumentTransportSpec,(b=w.documentMessage)==null||(b=b.document)==null?void 0:b.payload);n=T(E,d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.DOCUMENT,(b=w.documentMessage)==null?void 0:b.fileName);x.msgType=d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE;x.mediaMetadata=n;V(e,n,D,"attachment",j);return x}}else if((v==null||(q=v.obj.payload)==null||(q=q.applicationData)==null?void 0:q.revoke)!=null){var F;E=v==null||(F=v.obj.payload)==null||(F=F.applicationData)==null||(F=F.revoke)==null||(F=F.key)==null?void 0:F.id;if(E==null)K.MUSTFIX(z||(z=babelHelpers.taggedTemplateLiteralLoose(["Unable to retrieve revoked message external id"])));else{x.revokedMsgExternalId=d("WAStanzaUtils").toStanzaId(E);x.msgType=d("MAWMsgType").MSG_TYPE.REVOKED;return x}}if((v==null||(r=v.obj.payload)==null||(r=r.content)==null?void 0:r.bumpExistingMessage)!=null){var G;w=v==null||(G=v.obj.payload)==null||(G=G.content)==null?void 0:G.bumpExistingMessage;E=(b=w.key)==null?void 0:b.id;E!=null&&(h.has(E)||g.add(E),i.set(e,E));h=(b=w.key)==null?void 0:b.participant;if(h==null){h=(g=w.key)==null?void 0:g.remoteJid}if(h==null)K.MUSTFIX(A||(A=babelHelpers.taggedTemplateLiteralLoose(["No author found for original message that was bumped - unable to restore"])));else{i=d("WAJids").unsafeCoerceToUserJid(h);E=i===c?d("WAJids").AUTHOR_ME:i;k.set(d("WAStanzaUtils").toStanzaId(e),E);x.msgType=d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE;return x}}if((v==null||(s=v.obj)==null||(s=s.payload)==null||(s=s.content)==null?void 0:s.noteReplyMessage)!=null){var H;b=v==null||(H=v.obj)==null||(H=H.payload)==null||(H=H.content)==null?void 0:H.noteReplyMessage;w=b.noteTimestampMs;g=b.noteText;i=(h=a.metadata)==null?void 0:h.senderId;if(w!=null&&typeof w==="number"&&i!=null&&f!=null){k=d("MAWJids").toUserJid(i);E=d("MAWJids").toUserJid(f);a=E===k?c:E;h={author:a===c?d("WAJids").AUTHOR_ME:a,externalId:d("WAStanzaUtils").toStanzaId(e),ts:d("WATimeUtils").castMilliSecondsToUnixTime(w),type:d("WAMsgType").NOTE_REPLY};if((g==null?void 0:g.text)!=null){i={content:g==null?void 0:g.text,mentionedJids:g==null?void 0:g.mentionedJid.map(function(a){return d("MAWJids").toUserJid(a)})};h.msgContent=i}x.noteReply=h}if(b.textContent!=null){x.msgType=d("MAWMsgType").MSG_TYPE.TEXT;x.decodedPayload=b.textContent;return x}else if(b.stickerContent!=null){f=d("decodeProtobuf").decodeProtobuf(d("WAMediaTransport.pb").StickerTransportSpec,b.stickerContent.payload);n=T(f,d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.STICKER);x.msgType=d("MAWMsgType").MSG_TYPE.STICKER;x.mediaMetadata=n;V(e,n,D,"attachment",j);return x}else if(b.videoContent!=null){k=d("decodeProtobuf").decodeProtobuf(d("WAMediaTransport.pb").VideoTransportSpec,b.videoContent.payload);n=T(k,d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.VIDEO);n!=null&&n.xAttachmentType===d("EchoMessageMediaFieldUtils").EchoMessageActMediaAttachmentType.GIF?x.msgType=d("MAWMsgType").MSG_TYPE.GIF:x.msgType=d("MAWMsgType").MSG_TYPE.VIDEO;x.mediaMetadata=n;V(e,n,D,"attachment",j);return x}}if((v==null||(t=v.obj)==null||(t=t.payload)==null||(t=t.content)==null?void 0:t.ravenMessageMsgr)!=null){var I,J,L;x.ravenMsgEphemeralType=da(v==null||(I=v.obj)==null||(I=I.payload)==null||(I=I.content)==null||(I=I.ravenMessageMsgr)==null?void 0:I.ephemeralType);if((v==null||(J=v.obj)==null||(J=J.payload)==null||(J=J.content)==null||(J=J.ravenMessageMsgr)==null?void 0:J.imageMessage)!=null){if(l==null||!l){var M;x.ravenUnstoredMedia=d("WAParseMediaTransportProtocol").decodeImageTransport(v==null||(M=v.obj)==null||(M=M.payload)==null||(M=M.content)==null||(M=M.ravenMessageMsgr)==null||(M=M.imageMessage)==null?void 0:M.payload,d("WATimeUtils").castMilliSecondsToUnixTime(x.sortOrderMs),"image")}x.ravenMsgMediaType=d("MAWMsg").MAWRavenMsgMediaType.IMAGE}else if((v==null||(L=v.obj)==null||(L=L.payload)==null||(L=L.content)==null||(L=L.ravenMessageMsgr)==null?void 0:L.videoMessage)!=null){if(l==null||!l){var N;E=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAMediaTransport.pb").VideoTransportSpec,v==null||(N=v.obj)==null||(N=N.payload)==null||(N=N.content)==null||(N=N.ravenMessageMsgr)==null||(N=N.videoMessage)==null?void 0:N.payload);c=d("WAParseMediaTransportProtocol").parseVideoMsg(E,d("WATimeUtils").castMilliSecondsToUnixTime(x.sortOrderMs),!1);c!=null?x.ravenUnstoredMedia=c:K.MUSTFIX(B||(B=babelHelpers.taggedTemplateLiteralLoose(["Decoded raven video unstored message is null - unable to restore"])))}x.ravenMsgMediaType=d("MAWMsg").MAWRavenMsgMediaType.VIDEO}x.msgType=d("MAWMsgType").MSG_TYPE.RAVEN;return x}else if((v==null||(u=v.obj)==null||(u=u.payload)==null||(u=u.content)==null?void 0:u.pollCreationMessage)!=null){x.msgType=d("MAWMsgType").MSG_TYPE.GROUP_POLL_CREATE;a=v.obj.payload.content.pollCreationMessage;w=a.encKey;g=a.name;i=a.options;h=a.selectableOptionsCount;w!=null&&g!=null&&i!=null&&(x.groupPollInfo={encKey:w,name:g,options:i.map(function(a){a=a.optionName;return a}).filter(Boolean),selectableOptionsCount:h||0});return x}v!=null&&fa(x,v.obj);K.MUSTFIX(C||(C=babelHelpers.taggedTemplateLiteralLoose(["Unable to retrieve decoded protobuf from backup message - unsupported message type"])));return x}function fa(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p;(b==null||(c=b.payload)==null||(c=c.content)==null?void 0:c.locationMessage)!=null&&(a.futureProofMessageType="locationMessage");(b==null||(d=b.payload)==null||(d=d.content)==null?void 0:d.liveLocationMessage)!=null&&(a.futureProofMessageType="liveLocationMessage");(b==null||(e=b.payload)==null||(e=e.content)==null?void 0:e.pollUpdateMessage)!=null&&(a.futureProofMessageType="pollUpdateMessage");(b==null||(f=b.payload)==null||(f=f.content)==null?void 0:f.viewOnceMessage)!=null&&(a.futureProofMessageType="viewOnceMessage");(b==null||(g=b.payload)==null||(g=g.content)==null?void 0:g.contactMessage)!=null&&(a.futureProofMessageType="contactMessage");(b==null||(h=b.payload)==null||(h=h.content)==null?void 0:h.extendedTextMessage)!=null&&(a.futureProofMessageType="extendedTextMessage");(b==null||(i=b.payload)==null||(i=i.content)==null?void 0:i.groupInviteMessage)!=null&&(a.futureProofMessageType="groupInviteMessage");(b==null||(j=b.payload)==null||(j=j.content)==null?void 0:j.commonSticker)!=null&&(a.futureProofMessageType="commonSticker");(b==null||(k=b.payload)==null||(k=k.content)==null?void 0:k.screenshotAction)!=null&&(a.futureProofMessageType="screenshotAction");(b==null||(l=b.payload)==null||(l=l.content)==null?void 0:l.extendedMessageContentWithSear)!=null&&(a.futureProofMessageType="extendedMessageContentWithSear");(b==null||(m=b.payload)==null||(m=m.content)==null?void 0:m.imageGalleryMessage)!=null&&(a.futureProofMessageType="imageGalleryMessage");(b==null||(n=b.payload)==null||(n=n.content)==null?void 0:n.paymentsTransactionMessage)!=null&&(a.futureProofMessageType="paymentsTransactionMessage");(b==null||(o=b.payload)==null||(o=o.applicationData)==null?void 0:o.metadataSync)!=null&&(a.futureProofMessageType="metadataSync");(b==null||(p=b.payload)==null||(p=p.applicationData)==null?void 0:p.aiBotResponse)!=null&&(a.futureProofMessageType="aiBotResponse")}function W(a,b,c,e){var f;f=(f=a.metadata)==null?void 0:f.messageId;a=d("decodeProtobuf").decodeProtobuf(d("WAMsgApplication.pb").MessageApplicationSpec,a.encryptedTransportMessage);var g=d("WAParseMessageApplication").parseMessageApplication(a);if(g.type==="error"){K.MUSTFIX(D||(D=babelHelpers.taggedTemplateLiteralLoose(["Message contains unparseable message application - unable to restore message"])));return}a=a.metadata;var h=a==null?void 0:a.quotedMessage;h=h==null?void 0:h.stanzaId;f!=null&&h!=null&&(c.has(h)||b.add(h),e.set(f,h));if(g.subprotocolType==="armadillo"){c=d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAArmadilloApplication.pb").ArmadilloSpec,g.payload);return{metadata:a,obj:c}}else if(g.subprotocolType==="consumerMessage")return{metadata:a,obj:d("decodeProtobuf").decodeProtobufWithUnknowns(d("WAConsumerApplication.pb").ConsumerApplicationSpec,g.payload)}}function X(a,b,c,d,e,f,g,h,i){return a.map(function(a){return Y(a,b,c,d,e,f,g,h,i)})}function Y(a,b,c,e,f,g,h,i,j){g===void 0&&(g=new Map());var k=d("decodeProtobuf").decodeProtobuf(d("WAArmadilloBackupMessage.pb").BackupMessageSpec,a.toplevelProtobuf.decryptedProtobuf);k=ea(k,a.toplevelProtobuf.protobufTimestampMS,b,a.otid,c,e,f,g,h,i,j);c=a.supplementalProtobufs;for(h of c){i=h[0];j=h[1];c=d("MessageBackupSupplementalKeyGenerator").parseIdentifierString(i);d("MAWODSProxy").odsBumpEntityKey({entity:d("WAOdsEnums").Entity.MAW_EB_DECODE_MESSAGE_PROTOBUF_SUPPLEMENTAL,key:c.type});var l=d("decodeProtobuf").decodeProtobuf(d("WAArmadilloBackupMessage.pb").BackupMessageSpec,j.decryptedProtobuf);if(l.encryptedTransportMessage==null)continue;switch(c.type){case"raven_action_message":var m=W(l,e,f,g),n=c.senderJid;n=n===b?d("WAJids").AUTHOR_ME:n;if(m!=null){var o,p,q;m=m.obj;o=(o=m.payload)==null||(o=o.content)==null||(o=o.ravenActionNotifMessage)==null?void 0:o.actionTimestamp;p=(p=m.payload)==null||(p=p.content)==null||(p=p.ravenActionNotifMessage)==null?void 0:p.actionType;if(o!=null&&p!=null&&typeof o==="number"&&((q=m.payload)==null||(q=q.content)==null||(q=q.ravenActionNotifMessage)==null||(q=q.key)==null?void 0:q.id)!=null){m=d("WAStanzaUtils").toStanzaId((q=m.payload)==null||(q=q.content)==null||(q=q.ravenActionNotifMessage)==null||(q=q.key)==null?void 0:q.id);if(((q=l.metadata)==null?void 0:q.timestampMs)!=null&&typeof ((q=l.metadata)==null?void 0:q.timestampMs)==="number"&&((q=l.metadata)==null?void 0:q.messageId)!=null){var r;q=(q=l.metadata)==null?void 0:q.messageId;r=d("WATimeUtils").castMilliSecondsToUnixTime((r=l.metadata)==null?void 0:r.timestampMs);q=d("WAStanzaUtils").toStanzaId(q);p=p===0?d("MAWMsg").MAWRavenActionNotifType.PLAYED:p===1?d("MAWMsg").MAWRavenActionNotifType.SCREENSHOTTED:d("MAWMsg").MAWRavenActionNotifType.FORCE_DISABLED;o={ack:d("WAAckLevel").ACK.RECEIVED,actionTimestamp:d("WATimeUtils").castMilliSecondsToUnixTime(o),actionType:p,author:n,externalId:q,ravenActionToMsgExternalId:m,ts:r,type:d("MAWMsgType").MSG_TYPE.RAVEN_ACTION};k.ravenActionUnstoredMsg=o}}}break;case"reaction":n=(p=l.metadata)==null?void 0:p.messageId;m=(q=W(l,e,f,g))==null||(q=q.obj.payload)==null||(q=q.content)==null?void 0:q.reactionMessage;r=d("WAJids").extractUserId(c.senderJid);m!=null&&r!=null&&k.reactionData.push({reaction:m,reactionExternalId:n,senderId:r,ts:d("WATimeUtils").castMilliSecondsToUnixTime(j.protobufTimestampMS)});break;case"edit":p=(o=W(l,e,f,g))==null||(o=o.obj.payload)==null||(o=o.content)==null?void 0:o.editMessage;m=(q=l.metadata)==null?void 0:q.senderId;if(p!=null){r=(n=p.key)==null?void 0:n.id;j=p.timestampMs;if(r!=null&&j!=null&&m!=null&&typeof j==="number"){o=d("MAWJids").toUserJid(m);q=o===b?d("WAJids").AUTHOR_ME:o;k.editMsgData.push({author:q,editMsgContent:p,externalId:d("WAStanzaUtils").toStanzaId(k.externalId),originalMsgExternalId:d("WAStanzaUtils").toStanzaId(r),ts:d("WATimeUtils").castMilliSecondsToUnixTime(j)})}}break;case"poll_update":n=W(l,e,f,g);if(n==null)continue;o=(m=n.obj.payload)==null||(m=m.content)==null?void 0:m.pollUpdateMessage;if(o!=null){q={externalId:d("WAStanzaUtils").toStanzaId(c.rawIdentifierString)};o.addOption!=null&&(q.addOption=o.addOption);o.vote!=null&&(q.vote=o.vote);o.pollCreationMessageKey!=null&&(q.pollCreationMessageKey=o.pollCreationMessageKey);k.groupPollUpdateData!=null?k.groupPollUpdateData.push(q):k.groupPollUpdateData=[q]}break;case"unknown":p=i.split(":");r=p[0];K.MUSTFIX(E||(E=babelHelpers.taggedTemplateLiteralLoose(["Unknown supplemental identifier. Identifier prefix: ",". Parts: ",""])),r||"null",p.length);break;default:c.type}}f.add(a.otid);return k}function ga(a,b,e,f,g,h){g==null||g.addPoint("replies_restore_start");return M(a,f,g).then(function(){b!=null&&(h.forEach(function(a){d("MAWBridgeEventTransmitter").issuePointQueryOutsideTxn(a,b,void 0,c("LSMEBTaskCreationSource").POINT_QUERY_FROM_EB,f)}),h.clear())})}function ha(a,b,c,e){c==null||c.addPoint("xma_restore_start");var f=[],g=new Map();return Promise.all(a.map(async function(a){if(d("MAWDbMsg").isXMAMsg(a)){var c=a.externalId,h=b.get(c);if(h!=null&&h.xmaData!=null){h=Q(a.author,a.externalId,a.msgId,a.threadJid,h.xmaData);if(h!=null){var i,j,k=[],l=[],m=[],n=new Map();c=e.get(c);c!=null&&c.forEach(function(b){var c=d("WAMediaUtils").stringToDeliveryObjectId(b.mediaMetadata.attachmentObjectId),e=d("WAHashUtils").stringToPlaintextHash(d("MAWHandleEchoMediaMsgsRestoreV2").getBase64WithoutPadding(b.mediaMetadata.plaintextHash)),f=n.get(e);n.set(e,f!=null?[].concat(f,[a.msgId]):[a.msgId]);m.push(c);b.mediaRestoreType==="xma_header"&&(i=c);b.mediaRestoreType==="xma_favicon"&&(j=c);b.mediaRestoreType==="xma_preview"&&k.push(c)});var o=await d("MAWHandleEchoXMARestoreV2").getMediaForXMAByObjectIds(n);o.forEach(function(a,b){g.set(a.mediaId,a)});if(i!=null){h.headerMediaId=(c=o.get(i))==null?void 0:c.mediaId}if(j!=null){h.faviconMediaId=(c=o.get(j))==null?void 0:c.mediaId}k.forEach(function(a){a=(a=o.get(a))==null?void 0:a.mediaId;a!=null&&l.push(a)});h.previewMediaIds=l;l.length>0&&(h.defaultPreviewMediaId=l[0]);f.push(h)}}}})).then(function(){return d("MAWHandleEchoXMARestoreV2").writeXMAsToDb(f).then(function(a){a.forEach(async function(a){var b;a.previewMediaIds!=null&&a.previewMediaIds.length>0&&(b=g.get(a.previewMediaIds[0]));a=await d("MAWHandleXmaTransactionUtil").checkMediaChunkTransactionAndCreatedBridgeXma(b,a);d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:[{tag:"NewXMA",value:a}]})}),c==null||c.addPoint("xma_restore_end",{int:{xma:a.length}})})})}async function a(a){d("MWEBODSUtils").markODSForEB(c("MWEBODSEntityName.enum").MAW_EB_RESTORE_COUNTER,"deprecated_protobuf_restore");a=L(a);var b=a.currentUserJid,e=a.deanonApiPayload,f=a.decryptedMessagesProtobufs,g=a.echoMessages,h=a.hasMoreAfter,i=a.hasMoreBefore,j=a.instanceKey,k=a.isPointRestore,l=a.minMsgId,m=a.referenceTimestamp,n=a.requestId,o=a.taskSource,p=a.threadJidPrimaryId;a=a.uploadedFromEbQueue;if(f.length===0)return Promise.resolve();K.DEBUG(F||(F=babelHelpers.taggedTemplateLiteralLoose(["Protobuf restore initiated for "," messages. isPointRestore: "," referenceTimestamp: ",""])),f.length,k,m);var q=new Set(),r=new Set(),s=new Map(),t=new Map(),u=new Map(),v=p,w=await d("MAWHandleEchoMsgsRestoreApiV2").getThread(p,n);m=k?d("MAWHandleEchoMsgsRestoreApiUtils").MAWRestoreType.POINT_RESTORE:m!=null?d("MAWHandleEchoMsgsRestoreApiUtils").MAWRestoreType.PAGINATED_RESTORE:d("MAWHandleEchoMsgsRestoreApiUtils").MAWRestoreType.INITIAL_RESTORE;m=m;var x=d("MAWQplProxy").startQplUserFlow(c("qpl")._(521486220,"827"),{bool:{isPointRestore:k,uploadedFromEbQueue:a},int:{messages:f.length},string:{message_backup_type:"protobuf",restore_type:m}},{providedTimeoutInMs:3e5});d("MAWEBRestoreTrackingUtils").addQPLRestorePointWithAnnotationsWorker({annotations:{bool:{isPointRestore:k,uploadedFromEbQueue:a},int:{messages:f.length},string:{message_backup_type:"protobuf",restore_type:m}},pointName:"restore_maw_job_start",traceId:n});d("MAWTraceUtils").recordCheckpointForTrace(n,(J||(J=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_WEB_ECHO_MESSAGE_RESTORE_BEGIN),[],!1);try{if(w){m=X(f,b,p,q,r,s,u,t);x==null||x.addPoint("restore_protobuf_decode_done",{int:{decoded_count:m.length,input_decode_gap:f.length-m.length}});var y=w.jid,z=new Set(),A=new Map(),B=new Map(),C=m.map(function(a){A.set(d("WAStanzaUtils").toStanzaId(a.externalId),a);var c=R(a,y,b,s,B);c==null&&z.add(a.externalId);return c}).filter(Boolean),D=m.filter(function(a){return z.has(a==null?void 0:a.externalId)});g!=null&&g.length>0&&g.length!==f.length&&(x==null||x.addPoint("mismatch_between_echo_and_protobuf_payload_from_server",{int:{echoMessagesLength:g.length,protobufMessagesLength:f.length}}));if(D.length>0){var E=new Map();D.forEach(function(a){var b="unknown";a.msgType!=null?b=a.msgType:a.futureProofMessageType!=null&&(b=a.futureProofMessageType);a=E.get(b);a!=null?E.set(b,a+1):E.set(b,1)});var I={};E.forEach(function(a,b){b="protobuf_restore_failure_"+b;I[b]=a});x==null||x.addPoint("protobuf_restore_failed_count_by_msg_type",{int:I});if(g!=null&&g.length===f.length){K.DEBUG(G||(G=babelHelpers.taggedTemplateLiteralLoose(["Cannot support message type for protobuf restore - reverting to echo restore"])));r.clear();x==null||x.addPoint("reverting_to_echo_restore");await d("MAWHandleEchoMsgsRestoreApiV2").handleEchoMsgsBulkRestore(p,g,!1,i,h,l,void 0,void 0,j,void 0,o,x,void 0,a);return}}D=C.map(function(a){return{author:a.author,chat:w.jid,externalId:a.stanzaId}});var M=new Set();g=C.map(function(a){M.add(a.stanzaId);return babelHelpers.extends({},babelHelpers.extends({},a.unstoredDbContent.unstoredDbMsg,{threadJid:w.jid}))});var N=new Map();e!=null&&e.forEach(function(a){N.set(a.externalId,a.sortOrderMs)});m.forEach(function(a){var b=a.sortOrderMs;a=a.externalId;if(N.size>0&&b!=null){a=N.get(a);a!=null&&(a!==b&&(x==null||x.addPoint("protobuf_restore_toplevel_ts_mismatch")))}});g.sort(function(a,b){return((a=a.sortOrderMs)!=null?a:0)-((a=b.sortOrderMs)!=null?a:0)});h=await Promise.all([d("MAWRestoreMsgsTxns").maybeGetThreadNewestMessage(w),d("MAWRestoreMsgsTxns").maybeGetOldestNonAdminMessage(w),d("MAWRestoreMsgsTxns").getMsgsByProtocolMsgIds(D)]);a=h[0];C=h[1];m=C.maybeOldestAdminMsg;D=C.maybeOldestMsg;C=h[2];var O=new Set(C.filter(function(a){return a.type!==d("MAWMsgType").MSG_TYPE.CIPHERTEXT}).map(function(a){return a.externalId}));h=g.filter(function(a){return!O.has(a.externalId)});g=k||i;i={bumpMessageAuthorMap:t,existingMsgs:C,hasMoreBefore:g!=null?g:!0,instanceKey:j,isPointRestore:k,maybeNewestMsg:a,maybeOldestAdminMsg:m,maybeOldestMsg:D,minMsgId:l,newMsgs:h,thread:w};x==null||x.addPoint("message_restore_start");t=await d("MAWRestoreMsgsTxns").restoreMsgsForThread(i);C=0;g=0;x==null||x.addPoint("message_restore_end");j=[];(t==null?void 0:t.existingMsgs)!=null&&(j=j.concat(t==null?void 0:t.existingMsgs),C=t==null?void 0:t.existingMsgs.length);(t==null?void 0:t.newlyAddedMsgs)!=null&&(j=j.concat(t==null?void 0:t.newlyAddedMsgs),g=t==null?void 0:t.newlyAddedMsgs.length);d("MAWRestoreValidationUtils").compareRestoredMsgstoDeanonData({dbMsgArray:j,deanonData:e,echoMsgExternalIds:void 0,protobufMsgs:f,restoreQplFlow:x,traceId:n});var P=[];await Promise.all(j.map(async function(a){if(a!=null)if(u.has(a.externalId)){var b=a.sortOrderMs,c=d("WAParseConsumerMessageProtocol").interpretAsNonSystemAuthor(a.author),e=u.get(a.externalId);b==null?K.MUSTFIX(H||(H=babelHelpers.taggedTemplateLiteralLoose([" Cannot download media - timestamp cannot be null"]))):e!=null&&a.mediaId==null&&e.map(function(e){e={author:c,echoMsg:void 0,externalId:a.externalId,isXMA:d("MAWDbMsg").isXMAMsg(a),mediaData:e.mediaMetadata,messageTimestamp:b,msgId:a.msgId,previewMediaData:e.previewMetadata,threadJId:a.threadJid};P.push(e)})}else if(a.type===d("MAWMsgType").MSG_TYPE.RAVEN){e=B.get(a.externalId);e!=null&&await la(a,e)}}));a=d("MAWHandleEchoMediaMsgsRestoreV2").downloadMediaAndWriteToMediaStore(P,y,o!=null?o:c("LSMEBTaskCreationSource").UNKNOWN);m=Promise.all(j.map(async function(a){a=A.get(a.externalId);a!=null&&(await ia(a,y,x,b),await ja(a,y,b,x),a.ravenActionUnstoredMsg!=null&&await ma(a.ravenActionUnstoredMsg,w))}));x==null||x.addPoint("media_restore_start");await Promise.all([a,m]);x==null||x.addPoint("media_restore_end",{int:{media:P.length}});await ha(j,A,x,u);await na(j,A,x);await ga(j,v,k,y,x,q);x.endSuccess({int:{existingMsgs:C,messages_lost:f.length-C-g,newlyAddedMsgs:g,restoredMsgs:C+g,totalMsgsToRestore:f.length},string:{threadJidPrimaryId:p}});d("MAWTraceUtils").recordCheckpointForTrace(n,(J||(J=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_RESTORE_MESSAGES_SUCCESS),[],!1);d("MAWTraceUtils").recordCheckpointForTrace(n,J.ofNumber(c("LSDataTraceCheckPoint").FLOW_END_AND_FLUSH),[],!0)}}finally{u.clear(),r.clear()}}async function ia(a,b,c,e){c.addPoint("msg_history_start");if(a.editMsgData.length>0){var f,g,h,i=[],j=a.sortOrderMs;f=(f=a.metadata)==null?void 0:f.messageId;g=(g=a.metadata)==null?void 0:g.senderId;h=(h=a.decodedPayload)==null?void 0:h.text;if(f!=null&&g!=null){j=d("WATimeUtils").castMilliSecondsToUnixTime(j);g=d("MAWJids").toUserJid(g);f=d("WAStanzaUtils").toStanzaId(f);e=g===e?d("WAJids").AUTHOR_ME:g;g=Z(e,h,f,f,j,b);g!=null&&i.push(g);a.editMsgData.forEach(function(a){var c;c=Z(a.author,(c=a.editMsgContent.message)==null?void 0:c.text,a.externalId,a.originalMsgExternalId,a.ts,b);c!=null&&i.push(c)});await ka(i);c.addPoint("msg_history_end")}}}function Z(a,b,c,e,f,g){var h=a===d("WAJids").AUTHOR_ME?d("WAAckLevel").ACK.SENT:d("WAAckLevel").ACK.RECEIVED;if(b!=null)return{author:a,editExternalId:c,editTs:f,msgContent:{content:b},originalMsgExternalId:e,sendStatus:h,threadJid:g};K.MUSTFIX(I||(I=babelHelpers.taggedTemplateLiteralLoose(["No text content found in edit msg"])));return void 0}async function ja(a,b,c,e){c=O(a,b,c);a=a.metadata;if(c!=null&&a!=null){e.addPoint("reactions_restore_start");var f=a.messageId,g=[];c.forEach(function(a,b){return g.push({stanzaId:b,waReactionMsg:a})});a=Promise.all(g.map(async function(a){var c=a.waReactionMsg,e=c.ts;e!=null&&f!=null&&await d("MAWWriteReactionMsgApi").writeReactionMsg(a.stanzaId,b,{groupingKey:c.reaction.groupingKey,reaction:c.reaction.text,reactToAuthor:d("WAParseConsumerMessageProtocol").interpretAsNonSystemAuthor(c.reactToMsgAuthor),reactToExternalId:c.reactToExternalId,senderTimestampMs:c.reaction.senderTimestampMs},e,d("WAParseConsumerMessageProtocol").interpretAsNonSystemAuthor(c.reactionAuthor))}));await a;e.addPoint("reactions_restore_end")}}var ka=b.makeMsgrTransactor({editMsgHistory:e.READWRITE,messages:e.READWRITE},"bulkAddEditMsgHistory",function(a){return function(b){return d("MAWDbEditMsgHistoryTxns").bulkAddEditMsgHistory(a,b).then(c("emptyFunction"))}}),la=b.makeMsgrTransactor({chunk:e.READWRITE,media:e.READWRITE,mediaBackup:e.READWRITE,messages:e.READWRITE},"handleUnstoredMedia",function(a){return function(b,c){return d("MAWMediaManagementTxns").handleUnstoredDbMedia(a,c,b,"ebrestore",!1,!1,"EncryptedBackups")}}),ma=b.makeMsgrTransactor({messages:e.READWRITE,unrenderedMessages:e.READWRITE},"writeRavenActinomsg",function(a){return function(b,c){return d("MAWDbRavenActionTxns").writeRavenActionMsg(a,b,c)}});function na(a,b,c){c==null||c.addPoint("receiver_fetch_restore_start");var e=[];a.forEach(function(a){if(a.type===d("MAWMsgType").MSG_TYPE.RECEIVER_FETCH&&a.receiverFetchId!=null){var c=b.get(a.externalId);if(c!=null&&c.receiverFetchInfo!=null){c=babelHelpers.extends({},c.receiverFetchInfo,{type:"sticker"});e.push({dbMsg:a,unstoredDbReceiverFetchInfo:c})}}});return $(e).then(function(){c==null||c.addPoint("receiver_fetch_restore_end")}).catch(function(a){c==null||c.addPoint("receiver_fetch_restore_failure")})}var $=b.makeMsgrTransactor({receiverFetchInfo:e.READWRITE},"restoreWriteReceiverFetchInfosToTb",function(a){return function(b){return d("MAWDexieTable").dexieAll(b.map(function(b){var c=b.dbMsg;b=b.unstoredDbReceiverFetchInfo;return d("MAWWriteReceiverFetchTxns").handleUnstoredReceiverFetchInfo(a,c.threadJid,c.msgId,c.sortOrderMs,c.ts,b)}))}});g.removeDeprecatedProtobufRestoreArgs=L;g.associateQuotedMessagesForRestoredDbMsgsTransactor=M;g.createUnstoredDbContentFromProtobufObject=R;g.decodeProtobufArray=X;g.decodeDecryptedMessageProtobuf=Y;g.handleProtobufsRestore=a;g.writeReceiverFetchInfosToTb=$}),98);
__d("MAWEBUnstoredDbMsgUtils",["EBLogger","MAWHandleEBRestoreWithHIM","MAWHandleEchoProtobufsRestoreApi","MAWMessageSortOrderUtils","WAJids"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=d("EBLogger").EBLogger.tags(["restore","MAWEBUnstoredDbMsgUtils"]);function a(a,b,c,e){var f=c!=null?c:b!=null?d("WAJids").unsafeCoerceToChatJid(b):void 0;if(f==null){j.mustfix("threadId and chatJid are both null - cannot convert protobuf to unstoredDbMsg");return[]}return d("MAWHandleEchoProtobufsRestoreApi").decodeProtobufArray(a,e,void 0,new Set(),new Set(),new Map(),new Map(),new Map(),!0).map(function(a){var b;if((a==null||(b=a.metadata)==null?void 0:b.messageId)!=null)try{var c=d("MAWHandleEchoProtobufsRestoreApi").createUnstoredDbContentFromProtobufObject(a,f,e,new Map(),void 0);if(c!=null&&c.unstoredDbContent.unstoredDbMsg!=null){c=c.unstoredDbContent.unstoredDbMsg;var g=d("MAWMessageSortOrderUtils").generateAuthoritativeMessageSortOrder(c);c.sortOrderMs=g;return c}}catch(b){j.MUSTFIX(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Failed to convert protobuf to unstored db message: type: "," error: ",""])),a.msgType,b.message)}return null}).filter(Boolean)}function b(a,b){return d("MAWHandleEBRestoreWithHIM").convertEchoMessages(a,b).map(function(a){var b;if(a==null||a.length===0||((b=a[0].decodedMsg)==null?void 0:b.unstoredDbMsg)==null){j!=null&&j.MUSTFIX(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Failed to convert echo message to unstored db message"])));return null}return(b=a[0].decodedMsg)==null?void 0:b.unstoredDbMsg}).filter(Boolean)}g.getUnstoredDbMsgFromProtobuf=a;g.getUnstoredDbMsgFromEcho=b}),98);
__d("MAWFTSIsMessageValidForSearch",["MAWMsgType"],(function(a,b,c,d,e,f,g){"use strict";function h(a){return a.ephemeralSetting!=null&&a.ephemeralSetting.ephemeralExpirationInSec>0}function a(a){var b=a.msgContent,c=a.sortOrderMs,e=a.type;b=b==null?void 0:b.content;if(b==null||c==null)return null;if(e!==d("MAWMsgType").MSG_TYPE.TEXT&&e!==d("MAWMsgType").MSG_TYPE.XMA)return null;return h(a)?null:{content:b,sortOrderMs:c}}g.verifyMessageValidity=a}),98);
__d("WACryptoAesGcm",["WABinary","WACryptoDependencies"],(function(a,b,c,d,e,f,g){"use strict";async function a(a,b,c,e,f){f===void 0&&(f=16);b={name:"AES-GCM",iv:i(b),tagLength:f*8};e!=null&&(b.additionalData=i(e));return d("WACryptoDependencies").getCrypto().subtle.encrypt(b,await h(a),c)}async function b(a,b,c,e,f){f===void 0&&(f=16);b={name:"AES-GCM",iv:i(b),tagLength:f*8};e!=null&&(b.additionalData=i(e));return d("WACryptoDependencies").getCrypto().subtle.decrypt(b,await h(a),c)}function h(a){return d("WACryptoDependencies").getCrypto().subtle.importKey("raw",a,"AES-GCM",!1,["encrypt","decrypt"])}function i(a){if(a instanceof Uint8Array)return a;if(typeof a==="string"){var b=new(d("WABinary").Binary)();b.writeString(a);return b.readByteArrayView()}return new Uint8Array(a)}g.gcmEncrypt=a;g.gcmDecrypt=b}),98);
__d("WAUseCaseSecret",["$InternalEnum","WABinary","WACryptoHkdf"],(function(a,b,c,d,e,f,g){"use strict";c=b("$InternalEnum")({POLL_VOTE:"Poll Vote",ENC_REACTION:"Enc Reaction",ENC_COMMENT:"Enc Comment",REPORT_TOKEN:"Report Token",EVENT_RESPONSE:"Event Response",EVENT_EDIT_ENCRYPTED:"Event Edit"});var h=32;function a(a){var b=a.messageSecret,c=a.stanzaId,e=a.parentMsgOriginalSender,f=a.modificationSender;a=a.modificationType;c=d("WABinary").Binary.build(c,e,f,a).readBuffer();return d("WACryptoHkdf").extractAndExpand(b instanceof ArrayBuffer?new Uint8Array(b):b,c,h)}g.UseCaseSecretModificationType=c;g.createUseCaseSecret=a}),98);
__d("MAWGroupPollsDualEncryptionUtils",["MAWDbPoll","WABase64","WAConsumerApplication.pb","WACryptoAesGcm","WACryptoSha256","WAResultOrError","WAUseCaseSecret","decodeProtobuf","encodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";async function h(a,b,c){if(a.encIv==null||a.encPayload==null)return d("WAResultOrError").makeError("invalid_poll_enc_value");var e=a.encIv;a=a.encPayload;try{b=await d("WACryptoAesGcm").gcmDecrypt(b,e,a,c);return d("WAResultOrError").makeResult(b)}catch(a){return d("WAResultOrError").DEPRECATED_makeError("decryption_error",a)}}async function i(a,b,c){try{var e=self.crypto.getRandomValues(new Uint8Array(12));b=await d("WACryptoAesGcm").gcmEncrypt(b,e,a,c);return d("WAResultOrError").makeResult({encIv:e.buffer,encPayload:b})}catch(a){return d("WAResultOrError").DEPRECATED_makeError("encryption_error",a)}}function j(a,b){a=a+"\0"+b;return new TextEncoder().encode(a).buffer}async function a(a,b){var c=b.pollCreationMessageKey,e=b.pollCreationSenderJid,f=b.pollCreationStanzaId,g=b.pollUpdateSenderJid;b=b.pollUpdateStanzaId;c=await d("WAUseCaseSecret").createUseCaseSecret({messageSecret:c,modificationSender:g,modificationType:d("WAUseCaseSecret").UseCaseSecretModificationType.POLL_VOTE,parentMsgOriginalSender:e,stanzaId:f});e=j(b,g);f=d("encodeProtobuf").encodeProtobuf(d("WAConsumerApplication.pb").ConsumerApplication$PollVoteMessageSpec,a).readBuffer();return i(f,c,e)}async function b(a,b){var c=b.pollCreationMessageKey,e=b.pollCreationSenderJid,f=b.pollCreationStanzaId,g=b.pollUpdateSenderJid;b=b.pollUpdateStanzaId;c=await d("WAUseCaseSecret").createUseCaseSecret({messageSecret:c,modificationSender:g,modificationType:d("WAUseCaseSecret").UseCaseSecretModificationType.POLL_VOTE,parentMsgOriginalSender:e,stanzaId:f});e=j(b,g);f=await h(a,c,e);if(!f.success)return f;try{return d("WAResultOrError").makeResult(d("decodeProtobuf").decodeProtobuf(d("WAConsumerApplication.pb").ConsumerApplication$PollVoteMessageSpec,f.value))}catch(a){return d("WAResultOrError").DEPRECATED_makeError("protobuf_decode_error",a)}}async function c(a,b){var c=b.pollCreationMessageKey,e=b.pollCreationSenderJid,f=b.pollCreationStanzaId,g=b.pollUpdateSenderJid;b=b.pollUpdateStanzaId;c=await d("WAUseCaseSecret").createUseCaseSecret({messageSecret:c,modificationSender:g,modificationType:d("WAUseCaseSecret").UseCaseSecretModificationType.POLL_VOTE,parentMsgOriginalSender:e,stanzaId:f});e=j(b,g);f=d("encodeProtobuf").encodeProtobuf(d("WAConsumerApplication.pb").ConsumerApplication$PollAddOptionMessageSpec,a).readBuffer();return i(f,c,e)}async function e(a,b){var c=b.pollCreationMessageKey,e=b.pollCreationSenderJid,f=b.pollCreationStanzaId,g=b.pollUpdateSenderJid;b=b.pollUpdateStanzaId;c=await d("WAUseCaseSecret").createUseCaseSecret({messageSecret:c,modificationSender:g,modificationType:d("WAUseCaseSecret").UseCaseSecretModificationType.POLL_VOTE,parentMsgOriginalSender:e,stanzaId:f});e=j(b,g);f=await h(a,c,e);if(!f.success)return f;try{return d("WAResultOrError").makeResult(d("decodeProtobuf").decodeProtobuf(d("WAConsumerApplication.pb").ConsumerApplication$PollAddOptionMessageSpec,f.value))}catch(a){return d("WAResultOrError").DEPRECATED_makeError("protobuf_decode_error",a)}}async function f(a){a=await d("WACryptoSha256").sha256(new TextEncoder("utf8").encode(a));return k(a)}function k(a){return d("MAWDbPoll").convertStringToOptionHash(d("WABase64").encodeB64(a))}g.encryptGroupPollVote=a;g.decryptGroupPollVote=b;g.encryptGroupPollAddOption=c;g.decryptGroupPollAddOption=e;g.getHashForOptionName=f;g.getBase64EncodedHash=k}),98);/*FB_PKG_DELIM*/
__d("FBIconAccountSwitcherFilled12.svg.react",["XPlatReactSVG","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){return i.jsxs(d("XPlatReactSVG").Svg,babelHelpers["extends"]({viewBox:"0 0 12 13",width:"1em",height:"1em",fill:"currentColor",title:a.title},a,{children:[a.children!=null&&i.jsx(d("XPlatReactSVG").Defs,{children:a.children}),i.jsx(d("XPlatReactSVG").G,{fillRule:"evenodd",transform:"translate(-450 -1073)",children:i.jsxs(d("XPlatReactSVG").G,{children:[i.jsx(d("XPlatReactSVG").Path,{d:"m104.68 920.76-1.467-1.1a.2.2 0 0 1 0-.32l1.468-1.1a.2.2 0 0 1 .32.159v2.202a.2.2 0 0 1-.32.16",transform:"translate(354 155.5)"}),i.jsx(d("XPlatReactSVG").Path,{fillRule:"nonzero",d:"M104.5 920h1.5a1 1 0 0 1 1 1v.5a.5.5 0 0 0 1 0v-.5a2 2 0 0 0-2-2h-1.5a.5.5 0 0 0 0 1z",transform:"translate(354 155.5)"}),i.jsx(d("XPlatReactSVG").Path,{d:"m99.32 927.24 1.467 1.1a.2.2 0 0 1 0 .32l-1.468 1.1a.2.2 0 0 1-.32-.159V927.4a.2.2 0 0 1 .32-.16",transform:"translate(354 155.5)"}),i.jsx(d("XPlatReactSVG").Path,{fillRule:"nonzero",d:"M99.5 928H98a1 1 0 0 1-1-1v-.5a.5.5 0 0 0-1 0v.5a2 2 0 0 0 2 2h1.5a.5.5 0 0 0 0-1z",transform:"translate(354 155.5)"}),i.jsx(d("XPlatReactSVG").Path,{d:"M106 924.75c0 .69-.448 1.25-1 1.25s-1-.56-1-1.25.285-1.25 1-1.25c.715 0 1 .56 1 1.25",transform:"translate(354 155.5)"}),i.jsx(d("XPlatReactSVG").Path,{fillRule:"nonzero",d:"M106.5 924.75c0 .945-.644 1.75-1.5 1.75s-1.5-.805-1.5-1.75c0-1.016.521-1.75 1.5-1.75s1.5.734 1.5 1.75zm-1 0c0-.523-.162-.75-.5-.75-.338 0-.5.227-.5.75 0 .436.252.75.5.75s.5-.314.5-.75z",transform:"translate(354 155.5)"}),i.jsx(d("XPlatReactSVG").Path,{d:"M107.03 929.5h-4.06a.471.471 0 0 1-.47-.47c0-.841.688-1.53 1.53-1.53h1.94c.842 0 1.53.688 1.53 1.53a.47.47 0 0 1-.47.47",transform:"translate(354 155.5)"}),i.jsx(d("XPlatReactSVG").Path,{fillRule:"nonzero",d:"M107.03 930h-4.06a.971.971 0 0 1-.97-.97c0-1.118.912-2.03 2.03-2.03h1.94c1.118 0 2.03.912 2.03 2.03a.97.97 0 0 1-.97.97zm-.036-1.075a1.035 1.035 0 0 0-1.024-.925h-1.94c-.555 0-1.013.448-1.03 1h4l-.006-.075z",transform:"translate(354 155.5)"}),i.jsx(d("XPlatReactSVG").Path,{d:"M100 919.75c0 .69-.448 1.25-1 1.25s-1-.56-1-1.25.285-1.25 1-1.25c.715 0 1 .56 1 1.25",transform:"translate(354 155.5)"}),i.jsx(d("XPlatReactSVG").Path,{fillRule:"nonzero",d:"M100.5 919.75c0 .945-.644 1.75-1.5 1.75s-1.5-.805-1.5-1.75c0-1.016.521-1.75 1.5-1.75s1.5.734 1.5 1.75zm-1 0c0-.523-.162-.75-.5-.75-.338 0-.5.227-.5.75 0 .436.252.75.5.75s.5-.314.5-.75z",transform:"translate(354 155.5)"}),i.jsx(d("XPlatReactSVG").Path,{d:"M101.03 924.5h-4.06a.471.471 0 0 1-.47-.47c0-.841.688-1.53 1.53-1.53h1.94c.842 0 1.53.688 1.53 1.53a.47.47 0 0 1-.47.47",transform:"translate(354 155.5)"}),i.jsx(d("XPlatReactSVG").Path,{fillRule:"nonzero",d:"M101.03 925h-4.06a.971.971 0 0 1-.97-.97c0-1.118.912-2.03 2.03-2.03h1.94c1.118 0 2.03.912 2.03 2.03a.97.97 0 0 1-.97.97zm-.036-1.075A1.035 1.035 0 0 0 99.97 923h-1.94c-.555 0-1.013.448-1.03 1h4l-.006-.075z",transform:"translate(354 155.5)"})]})})]}))}a.displayName=a.name+" [from "+f.id+"]";a._isSVG=!0;b=a;g["default"]=b}),98);
__d("FBIconAppGroupsOutline20.svg.react",["XPlatReactSVG","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){return i.jsxs(d("XPlatReactSVG").Svg,babelHelpers["extends"]({viewBox:"0 0 20 20",width:"1em",height:"1em",fill:"currentColor",title:a.title},a,{children:[a.children!=null&&i.jsx(d("XPlatReactSVG").Defs,{children:a.children}),i.jsx(d("XPlatReactSVG").G,{fillRule:"evenodd",transform:"translate(-446 -398)",children:i.jsxs(d("XPlatReactSVG").G,{children:[i.jsx(d("XPlatReactSVG").Path,{fillRule:"nonzero",d:"M114.5 204.5c0 5.523-4.477 10-10 10s-10-4.477-10-10 4.477-10 10-10 10 4.477 10 10zm-1.5 0a8.5 8.5 0 1 0-17 0 8.5 8.5 0 0 0 17 0z",transform:"translate(351.5 203.5)"}),i.jsx(d("XPlatReactSVG").Path,{d:"M110 208h.243c.693 0 1.257-.525 1.257-1.172 0-1.284-1.105-2.328-2.462-2.328-.444 0-.022.5-.022.5.462.696.734 1.529.734 2.424v.344s-.039.232.25.232m-11 0h-.243c-.693 0-1.257-.525-1.257-1.172 0-1.284 1.105-2.328 2.462-2.328.444 0 .022.5.022.5a4.364 4.364 0 0 0-.734 2.424v.344s.039.232-.25.232m2.625-5.875c0-.988-.54-1.625-1.375-1.625s-1.375.637-1.375 1.625c0 .896.617 1.625 1.375 1.625s1.375-.729 1.375-1.625m8.5 0c0-.988-.54-1.625-1.375-1.625s-1.375.637-1.375 1.625c0 .896.617 1.625 1.375 1.625s1.375-.729 1.375-1.625m-4.826 2.375h-1.598c-1.627 0-2.951 1.311-2.951 2.924v.344c0 .68.558 1.232 1.243 1.232h5.014c.685 0 1.243-.552 1.243-1.232v-.344c0-1.613-1.324-2.924-2.95-2.924m1.2-3.75c0-1.388-.766-2.25-2-2.25s-2 .862-2 2.25c0 1.24.897 2.25 2 2.25s2-1.01 2-2.25",transform:"translate(351.5 203.5)"})]})})]}))}a.displayName=a.name+" [from "+f.id+"]";a._isSVG=!0;b=a;g["default"]=b}),98);
__d("FBIconFriendConfirmFilled12.svg.react",["XPlatReactSVG","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){return i.jsxs(d("XPlatReactSVG").Svg,babelHelpers["extends"]({viewBox:"0 0 12 13",width:"1em",height:"1em",fill:"currentColor",title:a.title},a,{children:[a.children!=null&&i.jsx(d("XPlatReactSVG").Defs,{children:a.children}),i.jsx(d("XPlatReactSVG").G,{fillRule:"evenodd",transform:"translate(-450 -1073)",children:i.jsxs(d("XPlatReactSVG").G,{children:[i.jsx(d("XPlatReactSVG").Path,{d:"M102.5 920.25c0 1.242-.895 2.25-2 2.25s-2-1.008-2-2.25.572-2.25 2-2.25 2 1.008 2 2.25",transform:"translate(354.5 156)"}),i.jsx(d("XPlatReactSVG").Path,{fillRule:"nonzero",d:"M103 920.25c0 1.506-1.105 2.75-2.5 2.75s-2.5-1.244-2.5-2.75c0-1.638.878-2.75 2.5-2.75 1.622 0 2.5 1.112 2.5 2.75zm-1 0c0-1.13-.489-1.75-1.5-1.75-1.011 0-1.5.62-1.5 1.75 0 .979.686 1.75 1.5 1.75s1.5-.771 1.5-1.75z",transform:"translate(354.5 156)"}),i.jsx(d("XPlatReactSVG").Path,{d:"M104.064 929h-7.129a.938.938 0 0 1-.935-.936v-.515a3.058 3.058 0 0 1 3.049-3.049h2.902a3.058 3.058 0 0 1 3.049 3.049v.515a.938.938 0 0 1-.936.936",transform:"translate(354.5 156)"}),i.jsx(d("XPlatReactSVG").Path,{fillRule:"nonzero",d:"M104.064 929.5h-7.129c-.79 0-1.435-.645-1.435-1.436v-.515A3.558 3.558 0 0 1 99.049 924h2.902a3.558 3.558 0 0 1 3.549 3.549v.515c0 .791-.645 1.436-1.436 1.436zm0-1a.438.438 0 0 0 .436-.436v-.515c0-1.4-1.148-2.549-2.549-2.549h-2.902a2.558 2.558 0 0 0-2.55 2.549l.001.515c0 .239.197.436.435.436h7.13zm.29-7.354a.5.5 0 1 0-.708.708l1 1a.5.5 0 0 0 .708 0l2-2a.5.5 0 1 0-.708-.708L105 921.793l-.646-.647z",transform:"translate(354.5 156)"})]})})]}))}a.displayName=a.name+" [from "+f.id+"]";a._isSVG=!0;b=a;g["default"]=b}),98);
__d("FBIconQuestionChatFilled12.svg.react",["XPlatReactSVG","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){return i.jsxs(d("XPlatReactSVG").Svg,babelHelpers["extends"]({viewBox:"0 0 12 13",width:"1em",height:"1em",fill:"currentColor",title:a.title},a,{children:[a.children!=null&&i.jsx(d("XPlatReactSVG").Defs,{children:a.children}),i.jsx(d("XPlatReactSVG").G,{fillRule:"evenodd",transform:"translate(-450 -1073)",children:i.jsx(d("XPlatReactSVG").Path,{d:"M456.743 1080.355v.312a.75.75 0 0 1-1.5 0v-.95a.75.75 0 0 1 .75-.75c.555 0 1.007-.428 1.007-.955 0-.535-.449-.97-1-.97-.551 0-1 .435-1 .97a.75.75 0 1 1-1.5 0c0-1.362 1.122-2.47 2.5-2.47 1.379 0 2.5 1.108 2.5 2.47 0 1.099-.74 2.03-1.757 2.343m-.743 3.103a.897.897 0 1 1 .002-1.793.897.897 0 0 1-.002 1.793m0-9.958a6 6 0 0 0-5.144 9.09l-.856 2.91 3.064-.766A6 6 0 1 0 456 1073.5"})})]}))}a.displayName=a.name+" [from "+f.id+"]";a._isSVG=!0;b=a;g["default"]=b}),98);
__d("LSFetchDiscoverableChatsPersonalInboxInfo",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return d[0]=new c.Map(),d[0].set("thread_key",a[0]),d[1]=c.toJSON(d[0]),c.storedProcedure(b("LSIssueNewTask"),"fetch_discoverable_chats_personal_inbox_info",c.i64.cast([0,110019]),d[1],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxFetchDiscoverableChatsPersonalInboxInfoStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSFetchDiscoverableChatsPersonalInboxInfoStoredProcedure",["LSFetchDiscoverableChatsPersonalInboxInfo","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSFetchDiscoverableChatsPersonalInboxInfo"),e.threadKey);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSHideBroadcastChannelFromPersonalInbox",["LSIssueNewTaskWithExtraOperations"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return d[0]=new c.Map(),d[0].set("thread_id",a[0]),d[0].set("entry_point",""),d[1]=c.toJSON(d[0]),c.storedProcedure(b("LSIssueNewTaskWithExtraOperations"),"hide_broadcast_channel_from_personal_inbox",c.i64.cast([0,110018]),d[1],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),void 0,c.i64.cast([0,0]))},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxHideBroadcastChannelFromPersonalInboxStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSHideBroadcastChannelFromPersonalInboxStoredProcedure",["LSHideBroadcastChannelFromPersonalInbox","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSHideBroadcastChannelFromPersonalInbox"),e.threadId);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSOptimisticSetLimitSharing",["LSArrayGetObjectAt","LSDeserializeFromJsonIntoDictionaryV2.nop","LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(a,e){var f=a.done;a=a.value;return f?d[0]=void 0:(e=a.item,c.sequence([function(a){return d[10]=e.metadata,d[10]!==void 0?c.sequence([function(a){return c.nativeOperation(b("LSDeserializeFromJsonIntoDictionaryV2.nop"),d[10]).then(function(a){return a=a,d[11]=a[0],a})},function(a){return d[12]=new c.Map(),d[40]="theme_fbid",d[13]=d[11].get(d[40]),d[13]!==void 0?(d[13]!==void 0?d[60]=c.i64.from_string(d[13]):d[60]=void 0,d[12].set(d[40],d[60])):0,d[41]="cannot_reply_reason",d[14]=d[11].get(d[41]),d[14]!==void 0?d[12].set(d[41],d[14]):0,d[42]="message_sound",d[15]=d[11].get(d[42]),c.i64.neq(d[15],void 0)?d[12].set(d[42],d[15]):0,d[43]="magic_words",d[16]=d[11].get(d[43]),d[16]?d[17]=!1:d[17]=!0,d[17]?c.resolve():c.sequence([function(a){return d[16]?d[60]=!1:d[60]=!0,d[60]?c.resolve(d[61]=void 0):c.sequence([function(a){return d[62]=c.createArray(),d[63]=c.i64.of_int32(d[16].length),c.i64.gt(d[63],c.i64.cast([0,0]))?c.loopAsync(d[63],function(a){return d[64]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[16],d[64]).then(function(a){return a=a,d[65]=a[0],d[66]=a[1],a})},function(a){return d[67]=new c.Map(),d[72]="magic_word",d[68]=d[65].get(d[72]),d[68]!==void 0?d[67].set(d[72],d[68]):0,d[73]="creation_timestamp_ms",d[69]=d[65].get(d[73]),c.i64.neq(d[69],void 0)?d[67].set(d[73],d[69]):0,d[74]="emoji_string",d[70]=d[65].get(d[74]),d[70]!==void 0?d[67].set(d[74],d[70]):0,d[75]="selection_type",d[71]=d[65].get(d[75]),c.i64.neq(d[71],void 0)?d[67].set(d[75],d[71]):0,d[76]=(d[62].push(d[67]),d[62])}])}):c.resolve()},function(a){return d[61]=d[62]}])},function(a){return d[12].set(d[43],d[61])}])},function(a){return d[44]="is_typing_indicator_disabled",d[18]=d[11].get(d[44]),c.i64.neq(d[18],void 0)?d[12].set(d[44],d[18]):0,d[45]="pinned_messages",d[19]=d[11].get(d[45]),d[19]?d[20]=!1:d[20]=!0,d[20]?c.resolve():c.sequence([function(a){return d[19]?d[60]=!1:d[60]=!0,d[60]?c.resolve(d[61]=void 0):c.sequence([function(a){return d[62]=c.createArray(),d[63]=c.i64.of_int32(d[19].length),c.i64.gt(d[63],c.i64.cast([0,0]))?c.loopAsync(d[63],function(a){return d[64]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[19],d[64]).then(function(a){return a=a,d[65]=a[0],d[66]=a[1],a})},function(a){return d[67]=new c.Map(),d[71]="message_otid",d[68]=d[65].get(d[71]),d[68]!==void 0?d[67].set(d[71],d[68]):0,d[72]="actor_user_fbid",d[69]=d[65].get(d[72]),d[69]!==void 0?d[67].set(d[72],c.i64.from_string(d[69])):0,d[73]="creation_timestamp_ms",d[70]=d[65].get(d[73]),d[70]!==void 0?d[67].set(d[73],c.i64.from_string(d[70])):0,d[74]=(d[62].push(d[67]),d[62])}])}):c.resolve()},function(a){return d[61]=d[62]}])},function(a){return d[12].set(d[45],d[61])}])},function(a){return d[46]="ttlc_message_type",d[21]=d[11].get(d[46]),d[21]?d[22]=!1:d[22]=!0,d[22]?0:(d[21]?d[60]=!1:d[60]=!0,d[60]?d[61]=void 0:(d[62]=new c.Map(),d[66]="enabled_ttlc_message_type",d[63]=d[21].get(d[66]),d[63]?d[64]=!1:d[64]=!0,d[64]?0:(d[63]?d[68]=!1:d[68]=!0,d[68]?d[69]=void 0:(d[70]=new c.Map(),d[86]="text",d[71]=d[63].get(d[86]),d[71]!==void 0?d[70].set(d[86],d[71]):0,d[87]="clip",d[72]=d[63].get(d[87]),d[72]!==void 0?d[70].set(d[87],d[72]):0,d[88]="reel_share",d[73]=d[63].get(d[88]),d[73]!==void 0?d[70].set(d[88],d[73]):0,d[89]="media_share",d[74]=d[63].get(d[89]),d[74]!==void 0?d[70].set(d[89],d[74]):0,d[90]="story_share",d[75]=d[63].get(d[90]),d[75]!==void 0?d[70].set(d[90],d[75]):0,d[91]="link",d[76]=d[63].get(d[91]),d[76]!==void 0?d[70].set(d[91],d[76]):0,d[92]="generic_xma",d[77]=d[63].get(d[92]),d[77]!==void 0?d[70].set(d[92],d[77]):0,d[93]="profile",d[78]=d[63].get(d[93]),d[78]!==void 0?d[70].set(d[93],d[78]):0,d[94]="image",d[79]=d[63].get(d[94]),d[79]!==void 0?d[70].set(d[94],d[79]):0,d[95]="video",d[80]=d[63].get(d[95]),d[80]!==void 0?d[70].set(d[95],d[80]):0,d[96]="gif",d[81]=d[63].get(d[96]),d[81]!==void 0?d[70].set(d[96],d[81]):0,d[97]="raven",d[82]=d[63].get(d[97]),d[82]!==void 0?d[70].set(d[97],d[82]):0,d[98]="collection",d[83]=d[63].get(d[98]),d[83]!==void 0?d[70].set(d[98],d[83]):0,d[99]="calling",d[84]=d[63].get(d[99]),d[84]!==void 0?d[70].set(d[99],d[84]):0,d[100]="rest_of_msg_type",d[85]=d[63].get(d[100]),d[85]!==void 0?d[70].set(d[100],d[85]):0,d[69]=d[70]),d[62].set(d[66],d[69])),d[67]="is_ttlc_enabled",d[65]=d[21].get(d[67]),d[65]!==void 0?d[62].set(d[67],d[65]):0,d[61]=d[62]),d[12].set(d[46],d[61])),d[47]="call_link_id",d[23]=d[11].get(d[47]),d[23]!==void 0?(d[23]!==void 0?d[60]=c.i64.from_string(d[23]):d[60]=void 0,d[12].set(d[47],d[60])):0,d[48]="marketplace_trust_signal_data",d[24]=d[11].get(d[48]),d[24]?d[25]=!1:d[25]=!0,d[25]?0:(d[24]?d[60]=!1:d[60]=!0,d[60]?d[61]=void 0:(d[62]=new c.Map(),d[67]="ratings",d[63]=d[24].get(d[67]),d[63]?d[64]=!1:d[64]=!0,d[64]?0:(d[63]?d[69]=!1:d[69]=!0,d[69]?d[70]=void 0:(d[71]=new c.Map(),d[74]="rating_average",d[72]=d[63].get(d[74]),d[72]!==void 0?d[71].set(d[74],d[72]):0,d[75]="rating_count",d[73]=d[63].get(d[75]),c.i64.neq(d[73],void 0)?d[71].set(d[75],d[73]):0,d[70]=d[71]),d[62].set(d[67],d[70])),d[68]="responsiveness",d[65]=d[24].get(d[68]),d[65]?d[66]=!1:d[66]=!0,d[66]?0:(d[65]?d[69]=!1:d[69]=!0,d[69]?d[70]=void 0:(d[71]=new c.Map(),d[75]="buyer_avg_response_time",d[72]=d[65].get(d[75]),d[72]!==void 0?d[71].set(d[75],d[72]):0,d[76]="buyer_response_rate",d[73]=d[65].get(d[76]),d[73]!==void 0?d[71].set(d[76],d[73]):0,d[77]="buyer_responsiveness_level",d[74]=d[65].get(d[77]),c.i64.neq(d[74],void 0)?d[71].set(d[77],d[74]):0,d[70]=d[71]),d[62].set(d[68],d[70])),d[61]=d[62]),d[12].set(d[48],d[61])),d[49]="message_ephemerality_setting",d[26]=d[11].get(d[49]),d[26]?d[27]=!1:d[27]=!0,d[27]?0:(d[26]?d[60]=!1:d[60]=!0,d[60]?d[61]=void 0:(d[62]=new c.Map(),d[65]="ephemerality_type",d[63]=d[26].get(d[65]),c.i64.neq(d[63],void 0)?d[62].set(d[65],d[63]):0,d[66]="ephemeral_options_duration_in_sec",d[64]=d[26].get(d[66]),d[64]!==void 0?(d[64]!==void 0?d[67]=c.i64.from_string(d[64]):d[67]=void 0,d[62].set(d[66],d[67])):0,d[61]=d[62]),d[12].set(d[49],d[61])),d[50]="is_ai_initiated_messaging_enabled",d[28]=d[11].get(d[50]),d[28]!==void 0?d[12].set(d[50],d[28]):0,d[51]="is_secret_conversation_for_deprecation",d[29]=d[11].get(d[51]),d[29]!==void 0?d[12].set(d[51],d[29]):0,d[52]="is_limit_sharing_enabled",d[30]=d[11].get(d[52]),d[30]!==void 0?d[12].set(d[52],d[30]):0,d[53]="first_eb_message_timestamp_ms",d[31]=d[11].get(d[53]),c.i64.neq(d[31],void 0)?d[12].set(d[53],d[31]):0,d[54]="eb_message_timestamp_type",d[32]=d[11].get(d[54]),d[32]?d[33]=!1:d[33]=!0,d[33]?c.resolve():c.sequence([function(a){return d[32]?d[60]=!1:d[60]=!0,d[60]?c.resolve(d[61]=void 0):c.sequence([function(a){return d[62]=c.createArray(),d[63]=c.i64.of_int32(d[32].length),c.i64.gt(d[63],c.i64.cast([0,0]))?c.loopAsync(d[63],function(a){return d[64]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[32],d[64]).then(function(a){return a=a,d[65]=a[0],d[66]=a[1],a})},function(a){return d[67]=new c.Map(),d[70]="first_eb_message_timestamp_ms_long",d[68]=d[65].get(d[70]),d[68]!==void 0?(d[68]!==void 0?d[72]=c.i64.from_string(d[68]):d[72]=void 0,d[67].set(d[70],d[72])):0,d[71]="timestamp_status",d[69]=d[65].get(d[71]),c.i64.neq(d[69],void 0)?d[67].set(d[71],d[69]):0,d[72]=(d[62].push(d[67]),d[62])}])}):c.resolve()},function(a){return d[61]=d[62]}])},function(a){return d[12].set(d[54],d[61])}])},function(a){return d[55]="thread_initiator_id",d[34]=d[11].get(d[55]),d[34]!==void 0?d[12].set(d[55],d[34]):0,d[56]="is_phone_connection",d[35]=d[11].get(d[56]),d[35]!==void 0?d[12].set(d[56],d[35]):0,d[57]="is_hidden_in_spam_folder",d[36]=d[11].get(d[57]),d[36]!==void 0?d[12].set(d[57],d[36]):0,d[58]="cc_deprecation_composer_block",d[37]=d[11].get(d[58]),d[37]?d[38]=!1:d[38]=!0,d[38]?0:(d[37]?d[60]=!1:d[60]=!0,d[60]?d[61]=void 0:(d[62]=new c.Map(),d[69]="title",d[63]=d[37].get(d[69]),d[63]!==void 0?d[62].set(d[69],d[63]):0,d[70]="pause_text",d[64]=d[37].get(d[70]),d[64]!==void 0?d[62].set(d[70],d[64]):0,d[71]="learn_more_text",d[65]=d[37].get(d[71]),d[65]!==void 0?d[62].set(d[71],d[65]):0,d[72]="learn_more_url",d[66]=d[37].get(d[72]),d[66]!==void 0?d[62].set(d[72],d[66]):0,d[73]="cta_url",d[67]=d[37].get(d[73]),d[67]!==void 0?d[62].set(d[73],d[67]):0,d[74]="cta_text",d[68]=d[37].get(d[74]),d[68]!==void 0?d[62].set(d[74],d[68]):0,d[61]=d[62]),d[12].set(d[58],d[61])),d[59]="dating_interest_type",d[39]=d[11].get(d[59]),d[39]!==void 0?d[12].set(d[59],d[39]):0,d[9]=d[12]}]):c.resolve((d[11]=new c.Map(),d[9]=d[11]))},function(a){return d[0]=d[9]}]))})},function(e){return d[0]?d[2]=!1:d[2]=!0,d[2]?0:d[0].set("is_limit_sharing_enabled",a[1]),d[0]?d[3]=!1:d[3]=!0,d[3]?c.resolve(d[4]=void 0):c.sequence([function(a){return d[9]=new c.Map(),d[38]="theme_fbid",d[10]=d[0].get(d[38]),c.i64.neq(d[10],void 0)?(c.i64.neq(d[10],void 0)?d[58]=c.i64.to_string(d[10]):d[58]=void 0,d[9].set(d[38],d[58])):0,d[39]="cannot_reply_reason",d[11]=d[0].get(d[39]),d[11]!==void 0?d[9].set(d[39],d[11]):0,d[40]="message_sound",d[12]=d[0].get(d[40]),c.i64.neq(d[12],void 0)?d[9].set(d[40],d[12]):0,d[41]="magic_words",d[13]=d[0].get(d[41]),d[13]?d[14]=!1:d[14]=!0,d[14]?c.resolve():c.sequence([function(a){return d[13]?d[58]=!1:d[58]=!0,d[58]?c.resolve(d[59]=void 0):c.sequence([function(a){return d[61]=c.createArray(),d[62]=c.i64.of_int32(d[13].length),c.i64.gt(d[62],c.i64.cast([0,0]))?c.loopAsync(d[62],function(a){return d[63]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[13],d[63]).then(function(a){return a=a,d[64]=a[0],d[65]=a[1],a})},function(a){return d[66]=new c.Map(),d[71]="magic_word",d[67]=d[64].get(d[71]),d[67]!==void 0?d[66].set(d[71],d[67]):0,d[72]="creation_timestamp_ms",d[68]=d[64].get(d[72]),c.i64.neq(d[68],void 0)?d[66].set(d[72],d[68]):0,d[73]="emoji_string",d[69]=d[64].get(d[73]),d[69]!==void 0?d[66].set(d[73],d[69]):0,d[74]="selection_type",d[70]=d[64].get(d[74]),c.i64.neq(d[70],void 0)?d[66].set(d[74],d[70]):0,d[75]=(d[61].push(d[66]),d[61])}])}):c.resolve()},function(a){return d[59]=d[61]}])},function(a){return d[60]=c.i64.of_int32(d[59].length),c.i64.neq(d[60],c.i64.cast([0,0]))?d[9].set(d[41],d[59]):0}])},function(a){return d[42]="is_typing_indicator_disabled",d[15]=d[0].get(d[42]),c.i64.neq(d[15],void 0)?d[9].set(d[42],d[15]):0,d[43]="pinned_messages",d[16]=d[0].get(d[43]),d[16]?d[17]=!1:d[17]=!0,d[17]?c.resolve():c.sequence([function(a){return d[16]?d[58]=!1:d[58]=!0,d[58]?c.resolve(d[59]=void 0):c.sequence([function(a){return d[61]=c.createArray(),d[62]=c.i64.of_int32(d[16].length),c.i64.gt(d[62],c.i64.cast([0,0]))?c.loopAsync(d[62],function(a){return d[63]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[16],d[63]).then(function(a){return a=a,d[64]=a[0],d[65]=a[1],a})},function(a){return d[66]=new c.Map(),d[70]="message_otid",d[67]=d[64].get(d[70]),d[67]!==void 0?d[66].set(d[70],d[67]):0,d[71]="actor_user_fbid",d[68]=d[64].get(d[71]),c.i64.neq(d[68],void 0)?d[66].set(d[71],c.i64.to_string(d[68])):0,d[72]="creation_timestamp_ms",d[69]=d[64].get(d[72]),c.i64.neq(d[69],void 0)?d[66].set(d[72],c.i64.to_string(d[69])):0,d[73]=(d[61].push(d[66]),d[61])}])}):c.resolve()},function(a){return d[59]=d[61]}])},function(a){return d[60]=c.i64.of_int32(d[59].length),c.i64.neq(d[60],c.i64.cast([0,0]))?d[9].set(d[43],d[59]):0}])},function(a){return d[44]="ttlc_message_type",d[18]=d[0].get(d[44]),d[18]?d[19]=!1:d[19]=!0,d[19]?0:(d[18]?d[58]=!1:d[58]=!0,d[58]?d[59]=void 0:(d[62]=new c.Map(),d[66]="enabled_ttlc_message_type",d[63]=d[18].get(d[66]),d[63]?d[64]=!1:d[64]=!0,d[64]?0:(d[63]?d[68]=!1:d[68]=!0,d[68]?d[69]=void 0:(d[72]=new c.Map(),d[88]="text",d[73]=d[63].get(d[88]),d[73]!==void 0?d[72].set(d[88],d[73]):0,d[89]="clip",d[74]=d[63].get(d[89]),d[74]!==void 0?d[72].set(d[89],d[74]):0,d[90]="reel_share",d[75]=d[63].get(d[90]),d[75]!==void 0?d[72].set(d[90],d[75]):0,d[91]="media_share",d[76]=d[63].get(d[91]),d[76]!==void 0?d[72].set(d[91],d[76]):0,d[92]="story_share",d[77]=d[63].get(d[92]),d[77]!==void 0?d[72].set(d[92],d[77]):0,d[93]="link",d[78]=d[63].get(d[93]),d[78]!==void 0?d[72].set(d[93],d[78]):0,d[94]="generic_xma",d[79]=d[63].get(d[94]),d[79]!==void 0?d[72].set(d[94],d[79]):0,d[95]="profile",d[80]=d[63].get(d[95]),d[80]!==void 0?d[72].set(d[95],d[80]):0,d[96]="image",d[81]=d[63].get(d[96]),d[81]!==void 0?d[72].set(d[96],d[81]):0,d[97]="video",d[82]=d[63].get(d[97]),d[82]!==void 0?d[72].set(d[97],d[82]):0,d[98]="gif",d[83]=d[63].get(d[98]),d[83]!==void 0?d[72].set(d[98],d[83]):0,d[99]="raven",d[84]=d[63].get(d[99]),d[84]!==void 0?d[72].set(d[99],d[84]):0,d[100]="collection",d[85]=d[63].get(d[100]),d[85]!==void 0?d[72].set(d[100],d[85]):0,d[101]="calling",d[86]=d[63].get(d[101]),d[86]!==void 0?d[72].set(d[101],d[86]):0,d[102]="rest_of_msg_type",d[87]=d[63].get(d[102]),d[87]!==void 0?d[72].set(d[102],d[87]):0,d[69]=d[72]),d[70]=d[69].keys(),d[71]=c.i64.of_int32(d[70].length),c.i64.neq(d[71],c.i64.cast([0,0]))?d[62].set(d[66],d[69]):0),d[67]="is_ttlc_enabled",d[65]=d[18].get(d[67]),d[65]!==void 0?d[62].set(d[67],d[65]):0,d[59]=d[62]),d[60]=d[59].keys(),d[61]=c.i64.of_int32(d[60].length),c.i64.neq(d[61],c.i64.cast([0,0]))?d[9].set(d[44],d[59]):0),d[45]="call_link_id",d[20]=d[0].get(d[45]),c.i64.neq(d[20],void 0)?(c.i64.neq(d[20],void 0)?d[58]=c.i64.to_string(d[20]):d[58]=void 0,d[9].set(d[45],d[58])):0,d[46]="marketplace_trust_signal_data",d[21]=d[0].get(d[46]),d[21]?d[22]=!1:d[22]=!0,d[22]?0:(d[21]?d[58]=!1:d[58]=!0,d[58]?d[59]=void 0:(d[62]=new c.Map(),d[67]="ratings",d[63]=d[21].get(d[67]),d[63]?d[64]=!1:d[64]=!0,d[64]?0:(d[63]?d[69]=!1:d[69]=!0,d[69]?d[70]=void 0:(d[73]=new c.Map(),d[76]="rating_average",d[74]=d[63].get(d[76]),d[74]!==void 0?d[73].set(d[76],d[74]):0,d[77]="rating_count",d[75]=d[63].get(d[77]),c.i64.neq(d[75],void 0)?d[73].set(d[77],d[75]):0,d[70]=d[73]),d[71]=d[70].keys(),d[72]=c.i64.of_int32(d[71].length),c.i64.neq(d[72],c.i64.cast([0,0]))?d[62].set(d[67],d[70]):0),d[68]="responsiveness",d[65]=d[21].get(d[68]),d[65]?d[66]=!1:d[66]=!0,d[66]?0:(d[65]?d[69]=!1:d[69]=!0,d[69]?d[70]=void 0:(d[73]=new c.Map(),d[77]="buyer_avg_response_time",d[74]=d[65].get(d[77]),d[74]!==void 0?d[73].set(d[77],d[74]):0,d[78]="buyer_response_rate",d[75]=d[65].get(d[78]),d[75]!==void 0?d[73].set(d[78],d[75]):0,d[79]="buyer_responsiveness_level",d[76]=d[65].get(d[79]),c.i64.neq(d[76],void 0)?d[73].set(d[79],d[76]):0,d[70]=d[73]),d[71]=d[70].keys(),d[72]=c.i64.of_int32(d[71].length),c.i64.neq(d[72],c.i64.cast([0,0]))?d[62].set(d[68],d[70]):0),d[59]=d[62]),d[60]=d[59].keys(),d[61]=c.i64.of_int32(d[60].length),c.i64.neq(d[61],c.i64.cast([0,0]))?d[9].set(d[46],d[59]):0),d[47]="message_ephemerality_setting",d[23]=d[0].get(d[47]),d[23]?d[24]=!1:d[24]=!0,d[24]?0:(d[23]?d[58]=!1:d[58]=!0,d[58]?d[59]=void 0:(d[62]=new c.Map(),d[65]="ephemerality_type",d[63]=d[23].get(d[65]),c.i64.neq(d[63],void 0)?d[62].set(d[65],d[63]):0,d[66]="ephemeral_options_duration_in_sec",d[64]=d[23].get(d[66]),c.i64.neq(d[64],void 0)?(c.i64.neq(d[64],void 0)?d[67]=c.i64.to_string(d[64]):d[67]=void 0,d[62].set(d[66],d[67])):0,d[59]=d[62]),d[60]=d[59].keys(),d[61]=c.i64.of_int32(d[60].length),c.i64.neq(d[61],c.i64.cast([0,0]))?d[9].set(d[47],d[59]):0),d[48]="is_ai_initiated_messaging_enabled",d[25]=d[0].get(d[48]),d[25]!==void 0?d[9].set(d[48],d[25]):0,d[49]="is_secret_conversation_for_deprecation",d[26]=d[0].get(d[49]),d[26]!==void 0?d[9].set(d[49],d[26]):0,d[50]="is_limit_sharing_enabled",d[27]=d[0].get(d[50]),d[27]!==void 0?d[9].set(d[50],d[27]):0,d[51]="first_eb_message_timestamp_ms",d[28]=d[0].get(d[51]),c.i64.neq(d[28],void 0)?d[9].set(d[51],d[28]):0,d[52]="eb_message_timestamp_type",d[29]=d[0].get(d[52]),d[29]?d[30]=!1:d[30]=!0,d[30]?c.resolve():c.sequence([function(a){return d[29]?d[58]=!1:d[58]=!0,d[58]?c.resolve(d[59]=void 0):c.sequence([function(a){return d[61]=c.createArray(),d[62]=c.i64.of_int32(d[29].length),c.i64.gt(d[62],c.i64.cast([0,0]))?c.loopAsync(d[62],function(a){return d[63]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[29],d[63]).then(function(a){return a=a,d[64]=a[0],d[65]=a[1],a})},function(a){return d[66]=new c.Map(),d[69]="first_eb_message_timestamp_ms_long",d[67]=d[64].get(d[69]),c.i64.neq(d[67],void 0)?(c.i64.neq(d[67],void 0)?d[71]=c.i64.to_string(d[67]):d[71]=void 0,d[66].set(d[69],d[71])):0,d[70]="timestamp_status",d[68]=d[64].get(d[70]),c.i64.neq(d[68],void 0)?d[66].set(d[70],d[68]):0,d[71]=(d[61].push(d[66]),d[61])}])}):c.resolve()},function(a){return d[59]=d[61]}])},function(a){return d[60]=c.i64.of_int32(d[59].length),c.i64.neq(d[60],c.i64.cast([0,0]))?d[9].set(d[52],d[59]):0}])},function(a){return d[53]="thread_initiator_id",d[31]=d[0].get(d[53]),d[31]!==void 0?d[9].set(d[53],d[31]):0,d[54]="is_phone_connection",d[32]=d[0].get(d[54]),d[32]!==void 0?d[9].set(d[54],d[32]):0,d[55]="is_hidden_in_spam_folder",d[33]=d[0].get(d[55]),d[33]!==void 0?d[9].set(d[55],d[33]):0,d[56]="cc_deprecation_composer_block",d[34]=d[0].get(d[56]),d[34]?d[35]=!1:d[35]=!0,d[35]?0:(d[34]?d[58]=!1:d[58]=!0,d[58]?d[59]=void 0:(d[62]=new c.Map(),d[69]="title",d[63]=d[34].get(d[69]),d[63]!==void 0?d[62].set(d[69],d[63]):0,d[70]="pause_text",d[64]=d[34].get(d[70]),d[64]!==void 0?d[62].set(d[70],d[64]):0,d[71]="learn_more_text",d[65]=d[34].get(d[71]),d[65]!==void 0?d[62].set(d[71],d[65]):0,d[72]="learn_more_url",d[66]=d[34].get(d[72]),d[66]!==void 0?d[62].set(d[72],d[66]):0,d[73]="cta_url",d[67]=d[34].get(d[73]),d[67]!==void 0?d[62].set(d[73],d[67]):0,d[74]="cta_text",d[68]=d[34].get(d[74]),d[68]!==void 0?d[62].set(d[74],d[68]):0,d[59]=d[62]),d[60]=d[59].keys(),d[61]=c.i64.of_int32(d[60].length),c.i64.neq(d[61],c.i64.cast([0,0]))?d[9].set(d[56],d[59]):0),d[57]="dating_interest_type",d[36]=d[0].get(d[57]),d[36]!==void 0?d[9].set(d[57],d[36]):0,d[37]=c.toJSON(d[9]),d[4]=d[37]}])},function(b){return c.forEach(c.db.table(9).fetch([[[a[0]]]]),function(a){var b=a.update;a.item;return b({metadata:d[4]})})},function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?d[5]=c.i64.cast([0,1]):(b=a.item,d[10]=b.syncGroup,c.i64.neq(d[10],void 0)?d[9]=d[10]:d[9]=c.i64.cast([0,1]),d[5]=d[9])})},function(e){return d[7]=new c.Map(),d[7].set("thread_key",a[0]),d[7].set("is_limit_sharing_enabled",a[1]),d[7].set("sync_group",d[5]),d[8]=c.toJSON(d[7]),c.storedProcedure(b("LSIssueNewTask"),"limit_sharing_setting",c.i64.cast([0,210002]),d[8],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxOptimisticSetLimitSharingStoredProcedure";a.__tables__=["threads"];e.exports=a}),null);
__d("LSOptimisticSetLimitSharingStoredProcedure",["LSOptimisticSetLimitSharing","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSOptimisticSetLimitSharing"),e.threadKey,e.isLimitSharingEnabled,e.syncGroup);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSShowBroadcastChannelInPersonalInbox",["LSIssueNewTaskWithExtraOperations"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return d[0]=new c.Map(),d[0].set("thread_id",a[0]),d[0].set("entry_point",""),d[1]=c.toJSON(d[0]),c.storedProcedure(b("LSIssueNewTaskWithExtraOperations"),"show_broadcast_channel_in_personal_inbox",c.i64.cast([0,110017]),d[1],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),void 0,c.i64.cast([0,0]))},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxShowBroadcastChannelInPersonalInboxStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSShowBroadcastChannelInPersonalInboxStoredProcedure",["LSShowBroadcastChannelInPersonalInbox","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSShowBroadcastChannelInPersonalInbox"),e.threadId);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("MAWGalleryItemStateHandlerContentWrapper.react",["CometHeroHoldTrigger.react","FBLogger","I64","LSIntEnum","MAWClientMediaStatusUtils","MAWMediaDownloadStatusUIStateType","MWV2AttachmentLoadingPlaceholder.react","MessagingAttachmentType","cr:9386","cr:9387","gkx","react","react-compiler-runtime","useEmptyFunction","useMAWMaybeAutoTriggerDownload","useMAWMediaDownloadManualRetry"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=k||c("react"),m=(h||(h=d("react"))).useEffect,n=(e=b("cr:9386"))!=null?e:c("useEmptyFunction"),o=(f=b("cr:9387"))!=null?f:c("useEmptyFunction"),p={loadingPlaceholder:{borderStartStartRadius:"x15mokao",borderStartEndRadius:"x1ga7v0g",borderEndEndRadius:"x16uus16",borderEndStartRadius:"xbiv7yw",$$css:!0}};function a(a){var b,e,f=d("react-compiler-runtime").c(10),g=a.dbAttachment,h=a.descriptionForLogging,i=a.errorComponentRenderer,j=a.errorWithBlurComponentRenderer,k=a.mediaRenderQpl,r=a.placeholderHeight,s=a.placeholderWidth;a=a.successfulComponentRenderer;var t=c("useMAWMediaDownloadManualRetry")(g,k);b=(b=n(g,k))!=null?b:{};b=b.downloadStatus;e=(e=o(g,k))!=null?e:{};var u=e.status;e=e.uiState;var v=c("gkx")("8105")?e:b;c("useMAWMaybeAutoTriggerDownload")({attachment:g,downloadStatusV2:u!=null?d("MAWClientMediaStatusUtils").getMAWMediaStatus(u):null,downloadType:q(g)?"preview":"fullsizeAndPreview",mediaRenderQpl:k,triggerUIView:"gallery"});m(function(){var a={string:{call_site:h,download_status_ui_state:v}};k==null||k.addPoint("render-gallery-item-state-handler-content-wrapper-"+(v!=null?v:"null"),a);bb33:switch(v){case"non_retryable_error":case"retryable_error":case"non_retryable_error_with_preview":case"retryable_error_with_preview":k==null||k.endFail(v,a);break bb33;case null:case"downloaded":case"loading":break bb33;default:k==null||k.endFail("unknown_state",{string:{unknown_state_value:v}})}},[v,k]);f[0]!==k||f[1]!==r||f[2]!==s?(e=function(a,b){return l.jsxs(l.Fragment,{children:[l.jsx(c("MWV2AttachmentLoadingPlaceholder.react"),{descriptionForLogging:a,height:r,mediaRenderQpl:k,width:s,xstyle:p.loadingPlaceholder}),!b&&l.jsx(c("CometHeroHoldTrigger.react"),{description:a,hold:!0})]})},f[0]=k,f[1]=r,f[2]=s,f[3]=e):e=f[3];b=e;u=d("MAWMediaDownloadStatusUIStateType").isRetryableErrorState(v);switch(v){case null:case"loading":return b(h+".MAWGalleryItemStateHandlerContentWrapper.NoMedia",!1);case"non_retryable_error":case"retryable_error":return i(u,t);case"non_retryable_error_with_preview":case"retryable_error_with_preview":return j==null?i(u,t):j(u,t);case"downloaded":f[4]!==b||f[5]!==a?(g=a(b),f[4]=b,f[5]=a,f[6]=g):g=f[6];return g;default:c("FBLogger")("messenger_web_media").mustfix("[MAW Attachment Content] Unknown MediaDownloadStatusUIState %s",v);e=h+".MAWGalleryItemStateHandlerContentWrapper.UnknownState";f[7]!==b||f[8]!==e?(i=b(e,!1),f[7]=b,f[8]=e,f[9]=i):i=f[9];return i}}function q(a){return(i||(i=d("I64"))).equal(a.attachmentType,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(i||(i=d("I64"))).equal(a.attachmentType,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))}g["default"]=a}),98);
__d("MWInboxInfoSharedContentFilePreview.react",["fbt","MDSSvgDocumentCompleteIcon.react","MWChatMessageId","MWXCircleButton.react","MWXIconExclamationMarkCircle","MWXIconRefreshAlt","MWXIconStrict.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(a){var b=d("react-compiler-runtime").c(8),e=a.isError,f=a.isRetryableError,g=a.messageID;a=a.onRetry;if(e===!0){b[0]===Symbol["for"]("react.memo_cache_sentinel")?(e={className:"x6s0dn4 xgx9qek x1c9tyrk xeusxvb x1pahc9y x1ertn4p x78zum5 x10w6t97 xl56j7k x1td3qas"},b[0]=e):e=b[0];b[1]!==f||b[2]!==a?(e=j.jsx("div",babelHelpers["extends"]({},e,{children:f===!0?j.jsx(c("MWXCircleButton.react"),{color:"primary",icon:c("MWXIconRefreshAlt"),label:h._(/*BTDS*/"Retry"),onPress:a,size:24,type:"normal"}):j.jsx("div",{children:j.jsx(c("MWXIconStrict.react"),{color:"primary",icon:c("MWXIconExclamationMarkCircle"),size:20})})})),b[1]=f,b[2]=a,b[3]=e):e=b[3];return e}b[4]!==g?(f=g!=null?d("MWChatMessageId").getMessageId(g):void 0,b[4]=g,b[5]=f):f=b[5];a=f;b[6]!==a?(e=a==null?null:j.jsx(c("MDSSvgDocumentCompleteIcon.react"),{color:"primary",size:24}),b[6]=a,b[7]=e):e=b[7];return e}g["default"]=a}),226);
__d("MWMediaGalleryRenderQpl",["MWMediaRenderQplUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("MWMediaRenderQplUtils").useCommonMediaRenderQplForAttachment(a,b,"gallery_view")}g.useMediaGalleryRenderQpl=a}),98);
__d("MWV2SecureFileAttachmentErrorGalleryPlaceholder.react",["fbt","BaseMiddot.react","MWFileUtils","MWInboxInfoSharedContentFilePreview.react","MWXLink.react","MWXRow.react","MWXRowItem.react","MWXText.react","MWXTextPairing.react","MWXTooltip.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react")),k=i.useEffect,l={contentRowItem:{paddingTop:"xz9dl7a",paddingInlineEnd:"xpdmqnj",paddingBottom:"xsag5q8",paddingInlineStart:"x1g0dm76",$$css:!0},fileRow:{marginTop:"xdj266r",marginInlineEnd:"x14z9mp",marginBottom:"xat24cr",marginInlineStart:"x1lziwak",paddingTop:"xexx8yu",paddingInlineEnd:"xyri2b",paddingBottom:"x18d9i69",paddingInlineStart:"x1c1uobl",$$css:!0},iconRowItem:{backgroundColor:"xlhe6ec",borderStartStartRadius:"x1obq294",borderStartEndRadius:"x5a5i1n",borderEndEndRadius:"xde0f50",borderEndStartRadius:"x15x8krk",height:"xdd8jsf",overflowX:"x6ikm8r",overflowY:"x10wlt62",paddingTop:"x889kno",paddingInlineEnd:"x2vl965",paddingBottom:"x1a8lsjc",paddingInlineStart:"xe2zdcy",width:"xvni27",$$css:!0}};function a(a){var b,e=d("react-compiler-runtime").c(28),f=a.file,g=a.isRetryableError,i=a.mediaRenderQpl;a=a.onRetry;b=(b=f.filename)!=null?b:d("MWFileUtils").PLACEHOLDER_FILENAME;var m;e[0]!==b?(m=b.toString(),e[0]=b,e[1]=m):m=e[1];b=m;e[2]!==f?(m=d("MWFileUtils").getFileSize(f),e[2]=f,e[3]=m):m=e[3];f=m;var n;e[4]!==g||e[5]!==i?(m=function(){i==null||i.addPoint("render-file-error-placeholder",{bool:{is_retryable_error:g}})},n=[i,g],e[4]=g,e[5]=i,e[6]=m,e[7]=n):(m=e[6],n=e[7]);k(m,n);e[8]===Symbol["for"]("react.memo_cache_sentinel")?(m=h._(/*BTDS*/"Couldn't download"),e[8]=m):m=e[8];e[9]===Symbol["for"]("react.memo_cache_sentinel")?(n=h._(/*BTDS*/"Couldn't download"),e[9]=n):n=e[9];var o;e[10]!==g||e[11]!==a?(o=g&&j.jsxs(j.Fragment,{children:[j.jsx(c("BaseMiddot.react"),{}),j.jsx(c("MWXLink.react"),{onClick:a,weight_DEPRECATED:"medium",children:h._(/*BTDS*/"Retry")})]}),e[10]=g,e[11]=a,e[12]=o):o=e[12];e[13]!==o?(n=j.jsxs(c("MWXText.react"),{color:"tooltip",type:"meta4",children:[n,o]}),e[13]=o,e[14]=n):n=e[14];e[15]===Symbol["for"]("react.memo_cache_sentinel")?(o={className:"x6s0dn4 x78zum5 x87ps6o"},e[15]=o):o=e[15];var p;e[16]!==g||e[17]!==a?(p=j.jsx(c("MWXRowItem.react"),{verticalAlign:"center",xstyle:l.iconRowItem,children:j.jsx(c("MWInboxInfoSharedContentFilePreview.react"),{isError:!0,isRetryableError:g,onRetry:a})}),e[16]=g,e[17]=a,e[18]=p):p=e[18];e[19]!==b||e[20]!==f?(a=j.jsx(c("MWXRowItem.react"),{expanding:!0,xstyle:l.contentRowItem,children:j.jsx(c("MWXTextPairing.react"),{body:f,bodyColor:"disabled",bodyLineLimit:1,headline:b,headlineColor:"disabled",headlineLineLimit:3,level:4})}),e[19]=b,e[20]=f,e[21]=a):a=e[21];e[22]!==p||e[23]!==a?(b=j.jsx("div",babelHelpers["extends"]({},o,{children:j.jsxs(c("MWXRow.react"),{expanding:!0,verticalAlign:"center",xstyle:l.fileRow,children:[p,a]})})),e[22]=p,e[23]=a,e[24]=b):b=e[24];e[25]!==b||e[26]!==n?(f=j.jsx(c("MWXTooltip.react"),{label:m,tooltip:n,children:b}),e[25]=b,e[26]=n,e[27]=f):f=e[27];return f}g["default"]=a}),226);
__d("MAWSecureInboxInfoSharedContentFile.react",["CometPlaceholder.react","MAWFilePressable.react","MAWGalleryItemStateHandlerContentWrapper.react","MWInboxInfoSharedContentFilePreview.react","MWMediaGalleryRenderQpl","MWV2AttachmentErrorPlaceholderV2.react","MWV2SecureFileAttachmentErrorGalleryPlaceholder.react","MWXRow.react","MWXRowItem.react","MWXTextPairing.react","MediaDownloadStatusIconSize","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j=72,k=350,l={contentRowItem:{paddingTop:"xz9dl7a",paddingInlineEnd:"xpdmqnj",paddingBottom:"xsag5q8",paddingInlineStart:"x1g0dm76",$$css:!0},errorPlaceholder:{borderStartStartRadius:"x12l2aii",borderStartEndRadius:"x1mbk4o",borderEndEndRadius:"x14vvt0a",borderEndStartRadius:"x1w3ol1v",$$css:!0},fileRow:{marginTop:"xdj266r",marginInlineEnd:"x14z9mp",marginBottom:"xat24cr",marginInlineStart:"x1lziwak",paddingTop:"xexx8yu",paddingInlineEnd:"xyri2b",paddingBottom:"x18d9i69",paddingInlineStart:"x1c1uobl",$$css:!0},iconRowItem:{backgroundColor:"xlhe6ec",borderStartStartRadius:"x1obq294",borderStartEndRadius:"x5a5i1n",borderEndEndRadius:"xde0f50",borderEndStartRadius:"x15x8krk",height:"xdd8jsf",overflowX:"x6ikm8r",overflowY:"x10wlt62",paddingTop:"xyinxu5",paddingInlineEnd:"x1pic42t",paddingBottom:"x1g2khh7",paddingInlineStart:"x1onr9mi",width:"xvni27",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(12),e=a.file,f=a.onPress;a=a.threadType;var g=d("MWMediaGalleryRenderQpl").useMediaGalleryRenderQpl(e,a);b[0]!==e||b[1]!==g?(a=function(a,b){return i.jsx(c("MWV2SecureFileAttachmentErrorGalleryPlaceholder.react"),{file:e,isRetryableError:a,mediaRenderQpl:g,onRetry:b})},b[0]=e,b[1]=g,b[2]=a):a=b[2];a=a;var h;b[3]!==e||b[4]!==g||b[5]!==f?(h=function(a){return i.jsx(c("CometPlaceholder.react"),{fallback:a("MAWSecureInboxInfoSharedContentFileV2.Suspense",!0),name:"MAWSecureInboxInfoSharedContentFileV2.Suspense",children:i.jsx(m,{file:e,mediaRenderQpl:g,onPress:f})})},b[3]=e,b[4]=g,b[5]=f,b[6]=h):h=b[6];h=h;var l;b[7]!==a||b[8]!==e||b[9]!==g||b[10]!==h?(l=i.jsx(c("MAWGalleryItemStateHandlerContentWrapper.react"),{dbAttachment:e,descriptionForLogging:"MAWSecureInboxInfoSharedContentFileV2",errorComponentRenderer:a,mediaRenderQpl:g,placeholderHeight:j,placeholderWidth:k,successfulComponentRenderer:h}),b[7]=a,b[8]=e,b[9]=g,b[10]=h,b[11]=l):l=b[11];return l}function m(a){var b=d("react-compiler-runtime").c(8),e=a.file,f=a.mediaRenderQpl;a=a.onPress;var g;b[0]!==e||b[1]!==f?(g=function(){return i.jsx(c("MWV2AttachmentErrorPlaceholderV2.react"),{attachment:e,height:j,iconSize:c("MediaDownloadStatusIconSize").Large,isRetryableError:!1,mediaRenderQpl:f,width:k,xstyle:l.errorPlaceholder})},b[0]=e,b[1]=f,b[2]=g):g=b[2];var h;b[3]!==e||b[4]!==f||b[5]!==a||b[6]!==g?(h=i.jsx(c("MAWFilePressable.react"),{entrypoint:"inbox_info_v1",file:e,mediaRenderQpl:f,onPress:a,renderUnsupportedAttachment:g,children:n}),b[3]=e,b[4]=f,b[5]=a,b[6]=g,b[7]=h):h=b[7];return h}function n(a){var b=a.filename,d=a.messageID;a=a.size;return i.jsxs(c("MWXRow.react"),{expanding:!0,paddingTop:0,verticalAlign:"center",xstyle:l.fileRow,children:[i.jsx(c("MWXRowItem.react"),{xstyle:l.iconRowItem,children:i.jsx(c("MWInboxInfoSharedContentFilePreview.react"),{messageID:d})}),i.jsx(c("MWXRowItem.react"),{expanding:!0,xstyle:l.contentRowItem,children:i.jsx(c("MWXTextPairing.react"),{body:a,bodyColor:"secondary",headline:b,headlineLineLimit:1,level:4})})]})}n.displayName=n.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWSharedContentCommonFbt",["fbt"],(function(a,b,c,d,e,f,g,h){"use strict";a=h._(/*BTDS*/"If you can't find the media you're looking for, try using the Messenger mobile app.");g.armadilloMediaGalleryMissingMediaNoticeFbt=a}),226);
__d("MWInboxInfoSharedContentEmptyTab.react",["fbt","LSMessagingThreadTypeUtil","LSThreadTitle.react","MWSharedContentCommonFbt","MWXColumnItem.react","MWXText.react","ReQL","ReQLSuspense","deferredLoadComponent","react","react-compiler-runtime","requireDeferred","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||d("react"),l=c("deferredLoadComponent")(c("requireDeferred")("MWInboxMediaGalleryEBRestoreUpsell.react").__setRef("MWInboxInfoSharedContentEmptyTab.react"));function m(a){switch(a){case"media":return"Photos and videos";case"files":return"Files";case"links":return"Links"}}function n(a,b,e){var f=d("LSMessagingThreadTypeUtil").isArmadilloSecure(e.threadType);f=f&&b==="media";if(f&&!a)return d("MWSharedContentCommonFbt").armadilloMediaGalleryMissingMediaNoticeFbt;f=m(b);if(d("LSMessagingThreadTypeUtil").isDiscoverableChannel(e.threadType))return h._(/*BTDS*/"_j{\"Photos and videos\":\"Photos and videos shared in this channel will appear here.\",\"Files\":\"Files shared in this channel will appear here.\",\"Links\":\"Links shared in this channel will appear here.\"}",[h._enum(f,{"Photos and videos":"Photos and videos",Files:"Files",Links:"Links"})]);return d("LSMessagingThreadTypeUtil").isOneToOne(e.threadType)?h._(/*BTDS*/"_j{\"Photos and videos\":\"Photos and videos that you exchange with {name} will appear here.\",\"Files\":\"Files that you exchange with {name} will appear here.\",\"Links\":\"Links that you exchange with {name} will appear here.\"}",[h._enum(f,{"Photos and videos":"Photos and videos",Files:"Files",Links:"Links"}),h._param("name",k.jsx(c("LSThreadTitle.react"),{thread:e}))]):h._(/*BTDS*/"_j{\"Photos and videos\":\"Photos and videos that you exchange with this group will appear here.\",\"Files\":\"Files that you exchange with this group will appear here.\",\"Links\":\"Links that you exchange with this group will appear here.\"}",[h._enum(f,{"Photos and videos":"Photos and videos",Files:"Files",Links:"Links"})])}function a(a){var b=d("react-compiler-runtime").c(32),e=a.backupState,g=a.contentType,j=a.threadKey,m=(i||(i=c("useReStore")))();b[0]!==m.tables.threads||b[1]!==j?(a=function(){return d("ReQL").fromTableAscending(m.tables.threads,["threadType","threadKey","threadName"]).getKeyRange(j)},b[0]=m.tables.threads,b[1]=j,b[2]=a):a=b[2];var o;b[3]!==m||b[4]!==j?(o=[m,j],b[3]=m,b[4]=j,b[5]=o):o=b[5];a=d("ReQLSuspense").useFirst(a,o,f.id+":117");if(a==null)return null;var p;if(b[6]!==g||b[7]!==a){o=d("LSMessagingThreadTypeUtil").isArmadilloSecure(a.threadType);var q=o&&g==="media";o=o&&g==="files";q=q||o;b[11]!==g?(o=h._(/*BTDS*/"_j{\"media\":\"No media\",\"files\":\"No files\",\"links\":\"No links\"}",[h._enum(g,{media:"media",files:"files",links:"links"})]),b[11]=g,b[12]=o):o=b[12];o=o;p=n(q,g,a);b[6]=g;b[7]=a;b[8]=o;b[9]=q;b[10]=p}else o=b[8],q=b[9],p=b[10];a=p;p=e===4;b[13]!==q?(e={0:{className:"x1g7c3p3 x1n2onr6"},1:{className:"xy8btvn x1n2onr6"}}[!!q<<0],b[13]=q,b[14]=e):e=b[14];var r;b[15]===Symbol["for"]("react.memo_cache_sentinel")?(r={className:"xr1yuqi x11t971q x4ii5y1 xvc5jky xwib8y2"},b[15]=r):r=b[15];b[16]!==o||b[17]!==q?(r=k.jsx("div",babelHelpers["extends"]({},r,{children:q?k.jsx(c("MWXText.react"),{align:"center",color:"primary",type:"headlineEmphasized4",children:o}):k.jsx(c("MWXText.react"),{align:"center",color:"secondary",type:"body2",children:o})})),b[16]=o,b[17]=q,b[18]=r):r=b[18];b[19]===Symbol["for"]("react.memo_cache_sentinel")?(o={className:"xr1yuqi x11t971q x4ii5y1 xvc5jky xtxm24l x1y1aw1k xyri2b xwib8y2 x1c1uobl"},b[19]=o):o=b[19];var s=q?"body4":"body3";b[20]!==a||b[21]!==s?(o=k.jsx("div",babelHelpers["extends"]({},o,{children:k.jsx(c("MWXText.react"),{align:"center",color:"secondary",type:s,children:a})})),b[20]=a,b[21]=s,b[22]=o):o=b[22];b[23]!==g||b[24]!==p||b[25]!==q?(a=q&&p&&k.jsx(c("MWXColumnItem.react"),{align:"center",paddingTop:12,paddingVertical:16,children:p&&k.jsx(l,{contentType:g})}),b[23]=g,b[24]=p,b[25]=q,b[26]=a):a=b[26];b[27]!==a||b[28]!==e||b[29]!==r||b[30]!==o?(s=k.jsxs("div",babelHelpers["extends"]({},e,{children:[r,o,a]})),b[27]=a,b[28]=e,b[29]=r,b[30]=o,b[31]=s):s=b[31];return s}g["default"]=a}),226);
__d("MWInboxInfoSharedContentFile.react",["fbt","I64","MWFilePressable.react","MWInboxInfoSharedContentFilePreview.react","MWXRow.react","MWXRowItem.react","MWXTextPairing.react","formatFileSize","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=i||d("react"),l={contentRowItem:{paddingTop:"xz9dl7a",paddingInlineEnd:"xpdmqnj",paddingBottom:"xsag5q8",paddingInlineStart:"x1g0dm76",$$css:!0},filePressable:{overflowX:"x6ikm8r",overflowY:"x10wlt62",$$css:!0},fileRow:{marginTop:"xdj266r",marginInlineEnd:"x14z9mp",marginBottom:"xat24cr",marginInlineStart:"x1lziwak",paddingTop:"xexx8yu",paddingInlineEnd:"xyri2b",paddingBottom:"x18d9i69",paddingInlineStart:"x1c1uobl",$$css:!0},iconRowItem:{backgroundColor:"xlhe6ec",borderStartStartRadius:"x1obq294",borderStartEndRadius:"x5a5i1n",borderEndEndRadius:"xde0f50",borderEndStartRadius:"x15x8krk",height:"xdd8jsf",overflowX:"x6ikm8r",overflowY:"x10wlt62",paddingTop:"xyinxu5",paddingInlineEnd:"x1pic42t",paddingBottom:"x1g2khh7",paddingInlineStart:"x1onr9mi",width:"xvni27",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(18),e=a.attachmentID,f=a.fileName,g=a.fileSize,i=a.messageID,m=a.onPress;a=a.url;var n;b[0]!==f?(n=f!=null?f:h._(/*BTDS*/"File"),b[0]=f,b[1]=n):n=b[1];f=n;if(b[2]!==g){n=g!=null?(j||(j=d("I64"))).to_int32(g):void 0;n=n!=null?c("formatFileSize")(n):null;b[2]=g;b[3]=n}else n=b[3];g=n;b[4]!==i?(n=k.jsx(c("MWXRowItem.react"),{xstyle:l.iconRowItem,children:k.jsx(c("MWInboxInfoSharedContentFilePreview.react"),{messageID:i})}),b[4]=i,b[5]=n):n=b[5];var o;b[6]!==g||b[7]!==f?(o=k.jsx(c("MWXRowItem.react"),{expanding:!0,xstyle:l.contentRowItem,children:k.jsx(c("MWXTextPairing.react"),{body:g,bodyColor:"secondary",headline:f,headlineLineLimit:1,level:4})}),b[6]=g,b[7]=f,b[8]=o):o=b[8];b[9]!==n||b[10]!==o?(g=k.jsxs(c("MWXRow.react"),{expanding:!0,paddingTop:0,verticalAlign:"center",xstyle:l.fileRow,children:[n,o]}),b[9]=n,b[10]=o,b[11]=g):g=b[11];b[12]!==e||b[13]!==i||b[14]!==m||b[15]!==g||b[16]!==a?(f=k.jsx(c("MWFilePressable.react"),{attachmentID:e,entryPoint:"inbox_info_v1",mediaRenderQpl:null,messageID:i,onPress:m,url:a,xstyle:l.filePressable,children:g}),b[12]=e,b[13]=i,b[14]=m,b[15]=g,b[16]=a,b[17]=f):f=b[17];return f}g["default"]=a}),226);
__d("MWInboxInfoSharedContentTabWithFooter.react",["MWXColumn.react","MWXColumnItem.react","MWXScrollableArea.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j={content:{flexShrink:"xs83m0k",overflowX:"x6ikm8r",overflowY:"x10wlt62",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(8),e=a.children,f=a.footer;a=a.shouldShowFooter;var g;b[0]!==e?(g=i.jsx(c("MWXColumnItem.react"),{xstyle:j.content,children:i.jsx(c("MWXScrollableArea.react"),{expanding:!0,children:i.jsx("div",{children:e})})}),b[0]=e,b[1]=g):g=b[1];b[2]!==f||b[3]!==a?(e=a?i.jsx(c("MWXColumnItem.react"),{paddingHorizontal:0,paddingVertical:8,children:f}):null,b[2]=f,b[3]=a,b[4]=e):e=b[4];b[5]!==g||b[6]!==e?(f=i.jsxs(c("MWXColumn.react"),{expanding:!0,children:[g,e]}),b[5]=g,b[6]=e,b[7]=f):f=b[7];return f}g["default"]=a}),98);
__d("MWInboxInfoSharedContentTheme",[],(function(a,b,c,d,e,f){"use strict";a={divider:"var(--hover-overlay)"};b={divider:"var(--hover-overlay)"};c={dark:b,light:a,type:"VARIABLES"};f.config=c}),66);
__d("MWXColumnHideable.react",["cr:3062","cr:3064","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h=["ref"],i,j=i||d("react");function a(a){var c=d("react-compiler-runtime").c(9),e,f;c[0]!==a?(f=a.ref,e=babelHelpers.objectWithoutPropertiesLoose(a,h),c[0]=a,c[1]=e,c[2]=f):(e=c[1],f=c[2]);if(b("cr:3062")!=null){c[3]!==e||c[4]!==f?(a=j.jsx(b("cr:3062"),babelHelpers["extends"]({},e,{ref:f})),c[3]=e,c[4]=f,c[5]=a):a=c[5];return a}if(b("cr:3064")!=null){c[6]!==e||c[7]!==f?(a=j.jsx(b("cr:3064"),babelHelpers["extends"]({},e,{ref:f})),c[6]=e,c[7]=f,c[8]=a):a=c[8];return a}return null}g["default"]=a}),98);
__d("MWInboxInfoFileGallery.react",["BaseTheme.react","CometErrorBoundary.react","CometInfiniteScrollTrigger.react","FDSProgressIndicator.react","I64","LSMediaUrlAttachment","LSMessagingThreadTypeUtil","MAWSecureInboxInfoSharedContentFile.react","MWChatMessageId","MWInboxInfoSharedContentEmptyTab.react","MWInboxInfoSharedContentFile.react","MWInboxInfoSharedContentTabWithFooter.react","MWInboxInfoSharedContentTheme","MWXColumnHideable.react","MWXColumnItem.react","MessengerWebUXLogger","deferredLoadComponent","react","react-compiler-runtime","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=["threadKey"],i,j,k=i||d("react"),l=c("deferredLoadComponent")(c("requireDeferred")("MWInboxMediaGalleryEBRestoreUpsell.react").__setRef("MWInboxInfoFileGallery.react")),m=c("deferredLoadComponent")(c("requireDeferred")("MWInboxMediaGalleryEBRestoreSyncBanner.react").__setRef("MWInboxInfoFileGallery.react")),n={progressIndicator:{display:"x78zum5",justifyContent:"xl56j7k",marginTop:"x1xmf6yo",paddingTop:"x123j3cw",paddingInlineEnd:"x1gabggj",paddingBottom:"xs9asl8",paddingInlineStart:"xaso8d8",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(17),e=a.backupState,f=a.files,g=a.hasMore,i=a.isRestoringFromEB,j=a.threadType,l,m;b[0]!==a?(m=a.threadKey,l=babelHelpers.objectWithoutPropertiesLoose(a,h),b[0]=a,b[1]=l,b[2]=m):(l=b[1],m=b[2]);b[3]!==m||b[4]!==j?(a={eventName:"file_gallery_rendered",threadKey:m,threadType:j},b[3]=m,b[4]=j,b[5]=a):a=b[5];j=c("MessengerWebUXLogger").useImpressionLoggerRef(a);b[6]===Symbol["for"]("react.memo_cache_sentinel")?(a={className:"x78zum5 xdt5ytf x1iyjqo2 xs83m0k x2lwn1j xf7dkkf xv54qhq"},b[6]=a):a=b[6];var n;b[7]!==l||b[8]!==e||b[9]!==f.length||b[10]!==g||b[11]!==i||b[12]!==m?(n=f.length===0&&!g&&i!==!0?k.jsx(c("MWInboxInfoSharedContentEmptyTab.react"),{backupState:e,contentType:"files",threadKey:m}):k.jsx(o,babelHelpers["extends"]({isRestoringFromEB:i},l,{backupState:e,threadKey:m})),b[7]=l,b[8]=e,b[9]=f.length,b[10]=g,b[11]=i,b[12]=m,b[13]=n):n=b[13];b[14]!==j||b[15]!==n?(l=k.jsx("div",babelHelpers["extends"]({},a,{ref:j,children:n})),b[14]=j,b[15]=n,b[16]=l):l=b[16];return l}function o(a){var b=d("react-compiler-runtime").c(32),e=a.backupState,f=a.files,g=a.hasMore,h=a.isLoading,i=a.isRestoringFromEB,o=a.onLoadMore,q=a.onPressFile,r=a.threadKey,s=a.threadType;a=e===4;b[0]!==s?(e=d("LSMessagingThreadTypeUtil").isArmadilloSecure(s),b[0]=s,b[1]=e):e=b[1];var t=e,u=c("MessengerWebUXLogger").useInteractionLogger();b[2]!==a||b[3]!==i||b[4]!==t?(e=t===!0&&k.jsxs(k.Fragment,{children:[a&&k.jsx(c("CometErrorBoundary.react"),{fallback:p,children:k.jsx(l,{contentType:"files"})}),i===!0&&k.jsx(m,{contentType:"files"})]}),b[2]=a,b[3]=i,b[4]=t,b[5]=e):e=b[5];a=f.length===0&&i===!0;if(b[6]!==f||b[7]!==t||b[8]!==u||b[9]!==q||b[10]!==r||b[11]!==s){b[13]!==t||b[14]!==u||b[15]!==q||b[16]!==r||b[17]!==s?(i=function(a){if(t&&(j||(j=d("I64"))).equal(a.threadKey,r))return k.jsx(c("MWXColumnItem.react"),{children:k.jsx(c("MAWSecureInboxInfoSharedContentFile.react"),{file:a,onPress:function(){u==null||u({eventName:"open_file_from_gallery",threadType:s})},threadType:s})},a.messageId);else return k.jsx(c("MWXColumnItem.react"),{children:k.jsx(c("MWInboxInfoSharedContentFile.react"),{attachmentID:a.attachmentFbid,fileName:a.filename,fileSize:a.filesize,messageID:d("MWChatMessageId").makeSent((j||(j=d("I64"))).to_string(a.threadKey),a.messageId,j.to_string(a.timestampMs)),onPress:function(){u==null||u({eventName:"open_file_from_gallery",threadType:s}),q!=null&&q()},url:d("LSMediaUrlAttachment").playableUrl(a)},a.attachmentFbid)},a.attachmentFbid)},b[13]=t,b[14]=u,b[15]=q,b[16]=r,b[17]=s,b[18]=i):i=b[18];i=f.map(i);b[6]=f;b[7]=t;b[8]=u;b[9]=q;b[10]=r;b[11]=s;b[12]=i}else i=b[12];b[19]===Symbol["for"]("react.memo_cache_sentinel")?(f=k.jsx(c("FDSProgressIndicator.react"),{size:"default"}),b[19]=f):f=b[19];b[20]!==g||b[21]!==h||b[22]!==o?(f=k.jsx(c("MWXColumnItem.react"),{children:k.jsx(c("CometInfiniteScrollTrigger.react"),{hasMore:g,isLoading:h,onLoadMore:o,xstyle:n.progressIndicator,children:f})},"infinite_scroll_trigger"),b[20]=g,b[21]=h,b[22]=o,b[23]=f):f=b[23];b[24]!==a||b[25]!==i||b[26]!==f?(g=k.jsx(c("BaseTheme.react"),{config:d("MWInboxInfoSharedContentTheme").config,children:k.jsxs(c("MWXColumnHideable.react"),{hasDividers:!0,hidden:a,paddingVertical:8,spacing:20,children:[i,f]})}),b[24]=a,b[25]=i,b[26]=f,b[27]=g):g=b[27];b[28]!==t||b[29]!==e||b[30]!==g?(h=k.jsx(c("MWInboxInfoSharedContentTabWithFooter.react"),{footer:e,shouldShowFooter:t,children:g}),b[28]=t,b[29]=e,b[30]=g,b[31]=h):h=b[31];return h}function p(){return null}g["default"]=a}),98);
__d("useMAWLoadMoreCutoverThreadFileAttachments",["MAWDbMsg","MWSharedAttachmentsSectionHooks","gkx","react","react-compiler-runtime","useLoadMoreThreadSharedAttachments.react","useMAWLoadMoreThreadSharedAttachments","useMWMediaLoadingQplLogger"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(a,b,e,f,g,h,j){var k=d("react-compiler-runtime").c(55),l=d("MWSharedAttachmentsSectionHooks").useQueryFileAttachments(a),m=l[0],n=l[1],o=l[2],p=l[3];l=l[4];var q;k[0]!==(o==null?void 0:o.lastLoadedMessageId)?(q=(o==null?void 0:o.lastLoadedMessageId)!=null?d("MAWDbMsg").toMsgId(o==null?void 0:o.lastLoadedMessageId):void 0,k[0]=o==null?void 0:o.lastLoadedMessageId,k[1]=q):q=k[1];q=q;var r=l!=null?l:!0,s;k[2]!==f||k[3]!==e?(s={entrypoint:f,threadType:e},k[2]=f,k[3]=e,k[4]=s):s=k[4];var t=c("useMWMediaLoadingQplLogger")(s);k[5]!==t?(f=function(){t.logLoadMediaStart({isCutoverThread:!0,isPreCutoverMedia:!1})},k[5]=t,k[6]=f):f=k[6];e=f;s=q!=null?q:void 0;k[7]!==e||k[8]!==t?(f=babelHelpers["extends"]({},t,{logLoadMediaStart:e}),k[7]=e,k[8]=t,k[9]=f):f=k[9];k[10]!==l||k[11]!==g||k[12]!==p||k[13]!==j||k[14]!==a||k[15]!==s||k[16]!==f?(q={earliestLoadedMediaMessageId:s,hasMoreBefore:l,mediaGalleryGroup:g,minTimestampMs:p,pageSize:j,qplLogger:f,threadKey:a},k[10]=l,k[11]=g,k[12]=p,k[13]=j,k[14]=a,k[15]=s,k[16]=f,k[17]=q):q=k[17];e=c("useMAWLoadMoreThreadSharedAttachments")(q);l=d("MWSharedAttachmentsSectionHooks").useQueryFileAttachments(b);g=l[0];p=l[2];j=l[4];a=j!=null?j:c("gkx")("6241");k[18]!==t?(s=function(){t.logLoadMediaStart({isCutoverThread:!0,isPreCutoverMedia:!0})},k[18]=t,k[19]=s):s=k[19];f=s;q=c("useLoadMoreThreadSharedAttachments.react")(n,b,f);k[20]!==o||k[21]!==m||k[22]!==r||k[23]!==e||k[24]!==t.logLoadMediaCancel||k[25]!==t.logLoadMediaSuccess?(l={attachmentsRange:o,hasMore:r,loadMore:e,logLoadMediaCancel:t.logLoadMediaCancel,logLoadMediaSuccess:t.logLoadMediaSuccess,media:m},k[20]=o,k[21]=m,k[22]=r,k[23]=e,k[24]=t.logLoadMediaCancel,k[25]=t.logLoadMediaSuccess,k[26]=l):l=k[26];j=d("MWSharedAttachmentsSectionHooks").useLoader(l);s=j[0];n=j[1];b=j[2];f=r||s;k[27]!==p||k[28]!==g||k[29]!==a||k[30]!==q||k[31]!==t.logLoadMediaCancel||k[32]!==t.logLoadMediaSuccess||k[33]!==f?(o={attachmentsRange:p,hasMore:a,loadMore:q,logLoadMediaCancel:t.logLoadMediaCancel,logLoadMediaSuccess:t.logLoadMediaSuccess,media:g,skipInitialLoad:f},k[27]=p,k[28]=g,k[29]=a,k[30]=q,k[31]=t.logLoadMediaCancel,k[32]=t.logLoadMediaSuccess,k[33]=f,k[34]=o):o=k[34];e=d("MWSharedAttachmentsSectionHooks").useLoader(o);l=e[0];j=e[1];p=e[2];if(r||s||h===!0){k[35]!==b||k[36]!==m||k[37]!==r||k[38]!==s||k[39]!==n?(q={attachments:m,completedFirstLoad:b,hasMore:r,isLoadingMore:s,onLoadMore:n},k[35]=b,k[36]=m,k[37]=r,k[38]=s,k[39]=n,k[40]=q):q=k[40];return q}else if(a||l){k[41]!==g||k[42]!==m?(f=m.concat(g),k[41]=g,k[42]=m,k[43]=f):f=k[43];k[44]!==p||k[45]!==a||k[46]!==l||k[47]!==j||k[48]!==f?(o={attachments:f,completedFirstLoad:p,hasMore:a,isLoadingMore:l,onLoadMore:j},k[44]=p,k[45]=a,k[46]=l,k[47]=j,k[48]=f,k[49]=o):o=k[49];return o}else{k[50]!==g||k[51]!==m?(e=m.concat(g),k[50]=g,k[51]=m,k[52]=e):e=k[52];k[53]!==e?(h={attachments:e,completedFirstLoad:!0,hasMore:!1,isLoadingMore:!1,onLoadMore:i},k[53]=e,k[54]=h):h=k[54];return h}}function i(){}g["default"]=a}),98);
__d("useMAWResetAttachmensRangeOnUnmount",["I64","Int64Hooks","LSIntEnum","ReQL","promiseDone","react-compiler-runtime","useAsyncReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,b){var e=d("react-compiler-runtime").c(5),f=c("useAsyncReStore")(),g,h;e[0]!==f||e[1]!==b||e[2]!==a?(g=function(){return function(){c("promiseDone")(j(f,a,b))}},h=[f,a,b],e[0]=f,e[1]=b,e[2]=a,e[3]=g,e[4]=h):(g=e[3],h=e[4]);d("Int64Hooks").useEffectInt64(g,h)}async function j(a,b,c){var e=await a,g=(h||(h=d("LSIntEnum"))).ofNumber(c);return e.runInTransaction(async function(a){var c=await d("ReQL").firstAsync(d("ReQL").fromTableDescending(e.tables.attachments_ranges_v2__generated).getKeyRange(b).filter(function(a){return(i||(i=d("I64"))).equal(a.mediaGroup,g)}));c!=null&&await a.attachments_ranges_v2__generated.delete(b,g,c.minTimestampMs)},"readwrite","ui",void 0,f.id+":53")}g.default=a}),98);
__d("useMWInboxInfoSharedTabRestoreLoop",["I64","MWEBEntrypointsKillswitch.enum","MWMediaRestoreQplUtils","MWMediaRestoreStatus","MWMessageSearchStatusTypes","react","react-compiler-runtime","useMWEBBackupState","useMWInboxMediaRestoreLoop","useMWMediaGalleryRestoreStatus"],(function(a,b,c,d,e,f,g){"use strict";var h,i;b=h||d("react");var j=b.useEffect;b.useMemo;function a(a){var b=d("react-compiler-runtime").c(19),e=a.selectedTab;a=a.thread;var f=a.threadKey;a=a.threadType;var g=e==="media",h=e==="files";b[0]!==f||b[1]!==a?(e={threadKey:f,threadType:a},b[0]=f,b[1]=a,b[2]=e):e=b[2];var k=c("useMWInboxMediaRestoreLoop")(e);b[3]===Symbol["for"]("react.memo_cache_sentinel")?(e={entrypoint:c("MWEBEntrypointsKillswitch.enum").MEDIA_GALLERY_RESTORE},b[3]=e):e=b[3];var l=c("useMWEBBackupState")(e);b[4]!==f||b[5]!==a?(e={threadKey:f,threadType:a},b[4]=f,b[5]=a,b[6]=e):e=b[6];var m=c("useMWMediaGalleryRestoreStatus")(e);a=m===d("MWMessageSearchStatusTypes").RestoreStatus.IN_PROGRESS;b[7]===Symbol["for"]("react.memo_cache_sentinel")?(e=d("MWMediaRestoreQplUtils").createMediaRestoreLoadAllQPLFlow(),b[7]=e):e=b[7];e=e;var n=e,o;b[8]!==l||b[9]!==k||b[10]!==h||b[11]!==g||b[12]!==m||b[13]!==f?(e=function(){if(l===3&&(g||h)){m===d("MWMessageSearchStatusTypes").RestoreStatus.NOT_RUNNING&&(n.start(),(k==null?void 0:k.onEBOnboarded)&&(k==null?void 0:k.onEBOnboarded()));if(m===d("MWMessageSearchStatusTypes").RestoreStatus.COMPLETE){var a=d("MWMediaRestoreStatus").getRestoreStatus(),b=a.mediaCount,c=a.messageCount;a=a.threadId;a!=null&&(i||(i=d("I64"))).equal(f,a)&&n.addAnnotations({"int":{media_count:b,message_count:c}});n.endSuccess()}}},o=[l,k,h,g,n,m,f],b[8]=l,b[9]=k,b[10]=h,b[11]=g,b[12]=m,b[13]=f,b[14]=e,b[15]=o):(e=b[14],o=b[15]);j(e,o);b[16]!==l||b[17]!==a?(e={backupState:l,isRestoringFromEB:a},b[16]=l,b[17]=a,b[18]=e):e=b[18];return e}g["default"]=a}),98);
__d("MAWCutoverInboxInfoSharedFilesTab.react",["FBLogger","I64","LSThreadMediaGalleryGroup","MAWThreadCutover","MWInboxInfoFileGallery.react","justknobx","react","react-compiler-runtime","useMAWLoadMoreCutoverThreadFileAttachments","useMAWResetAttachmensRangeOnUnmount","useMWInboxInfoSharedTabRestoreLoop"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||(h=d("react"));b=h;var k=b.useEffect,l=b.useRef;function a(a){var b=d("react-compiler-runtime").c(18),e=a.onFirstLoadedMedia,f=a.secureThreadKey;a=a.threadType;var g;b[0]!==f||b[1]!==a?(g={selectedTab:"files",thread:{threadKey:f,threadType:a}},b[0]=f,b[1]=a,b[2]=g):g=b[2];g=c("useMWInboxInfoSharedTabRestoreLoop")(g);var h=g.backupState;g=g.isRestoringFromEB;var m=d("MAWThreadCutover").useGetCutoverOpenThreadKey(f);m==null&&c("FBLogger")("messenger_web_media").mustfix("Cutover open thread key is null for secure thread key: %s",(i||(i=d("I64"))).to_string(f));var n;b[3]===Symbol["for"]("react.memo_cache_sentinel")?(n=c("justknobx")._("1132"),b[3]=n):n=b[3];m=c("useMAWLoadMoreCutoverThreadFileAttachments")(f,m!=null?m:(i||(i=d("I64"))).zero,a,"file_gallery",c("LSThreadMediaGalleryGroup").FILES_ONLY,g,n);var o=m.attachments,p=m.completedFirstLoad;n=m.hasMore;var q=m.isLoadingMore;m=m.onLoadMore;var r=l(!1),s,t;b[4]!==o||b[5]!==p||b[6]!==e?(s=function(){r.current===!1&&p===!0&&(r.current=!0,e(o))},t=[p,o,e],b[4]=o,b[5]=p,b[6]=e,b[7]=s,b[8]=t):(s=b[7],t=b[8]);k(s,t);c("useMAWResetAttachmensRangeOnUnmount")(f,c("LSThreadMediaGalleryGroup").FILES_ONLY);b[9]!==o||b[10]!==h||b[11]!==n||b[12]!==q||b[13]!==g||b[14]!==m||b[15]!==f||b[16]!==a?(s=j.jsx(c("MWInboxInfoFileGallery.react"),{backupState:h,files:o,hasMore:n,isLoading:q,isRestoringFromEB:g,onLoadMore:m,threadKey:f,threadType:a}),b[9]=o,b[10]=h,b[11]=n,b[12]=q,b[13]=g,b[14]=m,b[15]=f,b[16]=a,b[17]=s):s=b[17];return s}g["default"]=a}),98);
__d("MWInboxInfoPhotoGalleryItemThumbnailContent.react",["FDSImageCover.react","I64","LSIntEnum","MWMediaGalleryVideoThumbnail.react","MWThumbnailDurationPill","MWVideoPlayerPlayButton.react","MWXImage.react","MessagingAttachmentType","gkx","justknobx","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=h||d("react"),l=1e6,m=1e3,n={videoThumbnailPlayIcon:{insetInlineStart:"xbudbmw",left:null,right:null,position:"x10l6tqk",top:"xwa60dl",transform:"x11lhmoz",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(21),e=a.attachment,f=a.fallbackVideoUrl,g=a.mediaRenderQpl;a=a.previewUrl;var h=(i||(i=d("I64"))).equal(e.attachmentType,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO));if(h){h=(i||(i=d("I64"))).to_float((h=e.playableDurationMs)!=null?h:(i||(i=d("I64"))).zero);h=Math.round(h/(c("justknobx")._("3228")&&h>=l?Math.pow(m,2):m));var o;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(o=c("gkx")("8622")?k.jsx(c("MWVideoPlayerPlayButton.react"),{isVisible:!0,size:"SMALL"}):k.jsx(c("MWXImage.react"),{src:"/images/video/play_48dp.png",xstyle:n.videoThumbnailPlayIcon}),b[0]=o):o=b[0];o=o;var p;b[1]!==h?(p=h>0?k.jsx(c("MWThumbnailDurationPill"),{spacing:"TIGHT",videoDuration:h}):null,b[1]=h,b[2]=p):p=b[2];h=p;b[3]===Symbol["for"]("react.memo_cache_sentinel")?(p={className:"x1rg5ohu x5yr21d xl1xv1r x1n2onr6 xh8yej3"},b[3]=p):p=b[3];f=f!=null?f:"";var q;b[4]!==e.filename||b[5]!==g||b[6]!==a||b[7]!==f?(q=k.jsx(c("MWMediaGalleryVideoThumbnail.react"),{alt:e.filename,fallbackVideoUrl:f,mediaRenderQpl:g,previewUrl:a}),b[4]=e.filename,b[5]=g,b[6]=a,b[7]=f,b[8]=q):q=b[8];f=c("gkx")("8622")===!0?h===null&&o:o;b[9]!==q||b[10]!==f||b[11]!==h?(o=k.jsxs("div",babelHelpers["extends"]({},p,{children:[q,f,h]})),b[9]=q,b[10]=f,b[11]=h,b[12]=o):o=b[12];return o}q=(p=e.filename)!=null?p:"";b[13]!==g?(f=function(){return g==null?void 0:g.endFail("load-image-error")},h=function(){return g==null?void 0:g.endSuccess()},b[13]=g,b[14]=f,b[15]=h):(f=b[14],h=b[15]);b[16]!==a||b[17]!==q||b[18]!==f||b[19]!==h?(o=k.jsx(c("FDSImageCover.react"),{alt:q,onError:f,onLoad:h,src:a}),b[16]=a,b[17]=q,b[18]=f,b[19]=h,b[20]=o):o=b[20];return o}g["default"]=a}),98);
__d("MAWInboxInfoPhotoGalleryItem.react",["fbt","CometPlaceholder.react","I64","JSResourceForInteraction","LSIntEnum","LSMessagingThreadTypeUtil","MAWGalleryItemStateHandlerContentWrapper.react","MAWSecureVideoInvalidAttachment.react","MAWSecureVideoUnsupportedCodecAttachment.react","MWInboxInfoPhotoGalleryItemThumbnailContent.react","MWMediaGalleryRenderQpl","MWMediaRenderQplUtils","MWMessageListMediaPressableContainer.react","MWV2AttachmentErrorPlaceholderV2.react","MWV2AttachmentErrorPlaceholderWithBlurImage.react","MWV2AttachmentRetriableErrorPlaceholderWithBlurImage.react","MediaDownloadStatusIconSize","MessagingAttachmentType","MessengerWebUXLogger","cr:9386","cr:9387","gkx","react","react-compiler-runtime","useEmptyFunction","useMWMediaViewerOpenQPLLogger","useMWV2MediaViewerURL","useMWXLazyDialog","useShouldShowPlaybackErrorFallback","useShouldShowUnsupportedCodecFallback"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l=i||d("react"),m=(e=b("cr:9386"))!=null?e:c("useEmptyFunction"),n=(f=b("cr:9387"))!=null?f:c("useEmptyFunction"),o=512,p=512,q={attachmentContainer:{height:"x5yr21d",$$css:!0},errorPlaceholder:{borderStartStartRadius:"x15mokao",borderStartEndRadius:"x1ga7v0g",borderEndEndRadius:"x16uus16",borderEndStartRadius:"xbiv7yw",$$css:!0}};function a(a){var b,e=d("react-compiler-runtime").c(30),f=a.attachment,g=a.getPlayableUrl,h=a.getPreviewUrl,i=a.navigateToRouteForMediaViewer,j=a.onPress,k=a.threadType,s=d("MWMediaGalleryRenderQpl").useMediaGalleryRenderQpl(f,k);a=(a=m(f,s))!=null?a:{};a=a.downloadStatus;b=(b=n(f,s))!=null?b:{};b=b.uiState;b=c("gkx")("8105")?b:a;s.addAnnotations({string:{downloadStatus:b}});b=(a=c("useShouldShowPlaybackErrorFallback")(f,s))!=null?a:!1;a=(a=c("useShouldShowUnsupportedCodecFallback")(f,s))!=null?a:!1;if(b){e[0]!==f||e[1]!==s?(b=l.jsx(c("MAWSecureVideoInvalidAttachment.react"),{attachment:f,connectBottom:!1,connectTop:!1,height:o,iconSize:c("MediaDownloadStatusIconSize").Small,mediaRenderQpl:s,outgoing:!1,width:p,withTooltip:!0,xstyle:q.errorPlaceholder}),e[0]=f,e[1]=s,e[2]=b):b=e[2];return b}if(a){b=h!=null?h:g;e[3]!==f||e[4]!==g||e[5]!==s||e[6]!==b?(a=l.jsx(c("MAWSecureVideoUnsupportedCodecAttachment.react"),{connectBottom:!1,connectTop:!1,dbAttachment:f,getPlayableUrl:g,getPreviewUrl:b,height:o,iconSize:c("MediaDownloadStatusIconSize").Small,mediaRenderQpl:s,message:void 0,outgoing:!1,width:p,withTooltip:!0,xstyle:q.errorPlaceholder}),e[3]=f,e[4]=g,e[5]=s,e[6]=b,e[7]=a):a=e[7];return a}e[8]!==f||e[9]!==s?(b=function(a,b){return l.jsx(c("MWV2AttachmentErrorPlaceholderV2.react"),{attachment:f,connectBottom:!1,connectTop:!1,hasAppAttribution:f.attributionAppName!=null,height:o,iconSize:c("MediaDownloadStatusIconSize").Small,isRetryableError:a,mediaRenderQpl:s,onRetry:b,outgoing:!1,width:p,withTooltip:!0,xstyle:q.errorPlaceholder})},e[8]=f,e[9]=s,e[10]=b):b=e[10];var t=b;e[11]!==f||e[12]!==h||e[13]!==s?(a=function(a,b){return a?l.jsx(c("MWV2AttachmentRetriableErrorPlaceholderWithBlurImage.react"),{connectBottom:!1,connectTop:!1,dbAttachment:f,getPreviewUrl:h,height:o,iconSize:c("MediaDownloadStatusIconSize").Small,isGroupedImage:!1,mediaRenderQpl:s,message:void 0,onRetry:b,outgoing:!1,width:p,withTooltip:!0,xstyle:q.errorPlaceholder}):l.jsx(c("MWV2AttachmentErrorPlaceholderWithBlurImage.react"),{connectBottom:!1,connectTop:!1,dbAttachment:f,getPreviewUrl:h,height:o,iconSize:c("MediaDownloadStatusIconSize").Small,isGroupedImage:!1,mediaRenderQpl:s,message:void 0,outgoing:!1,width:p,withTooltip:!0,xstyle:q.errorPlaceholder})},e[11]=f,e[12]=h,e[13]=s,e[14]=a):a=e[14];b=a;e[15]!==f||e[16]!==t||e[17]!==g||e[18]!==h||e[19]!==s||e[20]!==i||e[21]!==j||e[22]!==k?(a=function(a){return l.jsx(c("CometPlaceholder.react"),{fallback:a("MAWInboxInfoPhotoGalleryItem.Suspense",!0),name:"MAWInboxInfoPhotoGalleryItem.Suspense",children:l.jsx(r,{attachment:f,getPlayableUrl:g,getPreviewUrl:h,mediaRenderQpl:s,navigateToRouteForMediaViewer:i,onPress:j,renderUnsupportedAttachment:function(){return t(!1)},threadType:k})})},e[15]=f,e[16]=t,e[17]=g,e[18]=h,e[19]=s,e[20]=i,e[21]=j,e[22]=k,e[23]=a):a=e[23];a=a;var u;e[24]!==f||e[25]!==t||e[26]!==b||e[27]!==s||e[28]!==a?(u=l.jsx(c("MAWGalleryItemStateHandlerContentWrapper.react"),{dbAttachment:f,descriptionForLogging:"MAWInboxInfoPhotoGalleryItem",errorComponentRenderer:t,errorWithBlurComponentRenderer:b,mediaRenderQpl:s,placeholderHeight:o,placeholderWidth:p,successfulComponentRenderer:a}),e[24]=f,e[25]=t,e[26]=b,e[27]=s,e[28]=a,e[29]=u):u=e[29];return u}function r(a){var b=d("react-compiler-runtime").c(52),e=a.attachment,f=a.getPlayableUrl,g=a.getPreviewUrl,i=a.mediaRenderQpl,m=a.navigateToRouteForMediaViewer,n=a.onPress,o=a.renderUnsupportedAttachment,p=a.threadType;b[0]!==e.attachmentType?(a=(j||(j=d("I64"))).equal(e.attachmentType,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE)),b[0]=e.attachmentType,b[1]=a):a=b[1];a=a;if(b[2]!==e||b[3]!==f||b[4]!==g||b[5]!==a||b[6]!==i){var r;r=a?(r=f(e,"MWInboxInfoPhotoGalleryItem",i))!=null?r:"":(r=g(e,"MWInboxInfoPhotoGalleryItem",i))!=null?r:"";b[2]=e;b[3]=f;b[4]=g;b[5]=a;b[6]=i;b[7]=r}else r=b[7];g=r;b[8]!==e||b[9]!==f||b[10]!==i||b[11]!==g?(a=Boolean(g)?void 0:f(e,"MWInboxInfoPhotoGalleryItem",i),b[8]=e,b[9]=f,b[10]=i,b[11]=g,b[12]=a):a=b[12];r=a;f=c("useMWV2MediaViewerURL")(e);b[13]===Symbol["for"]("react.memo_cache_sentinel")?(a=c("JSResourceForInteraction")("MWV2MediaViewer.react").__setRef("MAWInboxInfoPhotoGalleryItem.react"),b[13]=a):a=b[13];a=c("useMWXLazyDialog")(a);var t=a[0],u=a[1];b[14]!==e.attachmentType?(a=(j||(j=d("I64"))).equal(e.attachmentType,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO)),b[14]=e.attachmentType,b[15]=a):a=b[15];a=a;var v=d("useMWMediaViewerOpenQPLLogger").useMWMediaViewerOpenQPLLogger(),w=c("MessengerWebUXLogger").useInteractionLogger();if(g==null||g.length===0){if(!a){i==null||i.endFail("empty_preview_url");if(b[16]!==e||b[17]!==o){var x;x=(x=o==null?void 0:o(e))!=null?x:null;b[16]=e;b[17]=o;b[18]=x}else x=b[18];return x}if(r==null||r.length===0){i==null||i.endFail("empty_video_preview_and_playable_url");if(b[19]!==e||b[20]!==o){x=(x=o==null?void 0:o(e))!=null?x:null;b[19]=e;b[20]=o;b[21]=x}else x=b[21];return x}}b[22]!==m||b[23]!==g||b[24]!==f?(o=m?{passthroughProps:{origSrc:g},url:f}:void 0,b[22]=m,b[23]=g,b[24]=f,b[25]=o):o=b[25];x=o;b[26]!==a?(f=a?h._(/*BTDS*/"Open Video"):h._(/*BTDS*/"Open photo"),b[26]=a,b[27]=f):f=b[27];o=f;b[28]!==m||b[29]!==u?(a=function(){if(!m)return u()},b[28]=m,b[29]=u,b[30]=a):a=b[30];b[31]!==e||b[32]!==w||b[33]!==v||b[34]!==m||b[35]!==n||b[36]!==t||b[37]!==p?(f=function(){v.startFlow({attachmentType:d("MWMediaRenderQplUtils").getAttachmentTypeStringFromEnum(e.attachmentType),entryPoint:"media_gallery",isSecure:d("LSMessagingThreadTypeUtil").isArmadilloSecure(p)});w==null||w({eventName:"open_media_viewer_from_gallery",extraData:{attachmentType:d("MWMediaRenderQplUtils").getAttachmentTypeStringFromEnum(e.attachmentType)},threadType:p});n!=null&&n(e);if(!m)return t({attachment:e},s)},b[31]=e,b[32]=w,b[33]=v,b[34]=m,b[35]=n,b[36]=t,b[37]=p,b[38]=f):f=b[38];var y;b[39]!==e||b[40]!==i||b[41]!==r||b[42]!==g?(y=l.jsx(c("MWInboxInfoPhotoGalleryItemThumbnailContent.react"),{attachment:e,fallbackVideoUrl:r,mediaRenderQpl:i,previewUrl:g}),b[39]=e,b[40]=i,b[41]=r,b[42]=g,b[43]=y):y=b[43];b[44]!==o||b[45]!==e||b[46]!==x||b[47]!==i||b[48]!==y||b[49]!==a||b[50]!==f?(r=l.jsx(c("MWMessageListMediaPressableContainer.react"),{ariaLabel:o,attachment:e,linkProps_:x,mediaRenderQpl:i,onHoverIn:a,onPress:f,overlayDisabled:!0,testid:void 0,xstyle:q.attachmentContainer,children:y}),b[44]=o,b[45]=e,b[46]=x,b[47]=i,b[48]=y,b[49]=a,b[50]=f,b[51]=r):r=b[51];return r}function s(){}g["default"]=a}),226);
__d("MWInboxInfoPhotoGalleryItem.react",["fbt","CometHeroHoldTrigger.react","CometPlaceholder.react","I64","JSResourceForInteraction","LSIntEnum","LSMessagingThreadTypeUtil","MWInboxInfoPhotoGalleryItemThumbnailContent.react","MWMediaGalleryRenderQpl","MWMediaRenderQplUtils","MWMessageListMediaPressableContainer.react","MWV2AttachmentErrorPlaceholder.react","MWV2AttachmentLoadingPlaceholder.react","MessagingAttachmentType","MessengerWebUXLogger","cr:9386","cr:9387","gkx","react","react-compiler-runtime","useEmptyFunction","useMWMediaViewerOpenQPLLogger","useMWV2MediaViewerURL","useMWXLazyDialog"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l=i||d("react"),m=(e=b("cr:9386"))!=null?e:c("useEmptyFunction"),n=(e=b("cr:9387"))!=null?e:c("useEmptyFunction"),o={attachmentContainer:{height:"x5yr21d",$$css:!0},errorPlaceholder:{borderStartStartRadius:"x15mokao",borderStartEndRadius:"x1ga7v0g",borderEndEndRadius:"x16uus16",borderEndStartRadius:"xbiv7yw",$$css:!0},loadingPlaceholder:{borderStartStartRadius:"x15mokao",borderStartEndRadius:"x1ga7v0g",borderEndEndRadius:"x16uus16",borderEndStartRadius:"xbiv7yw",$$css:!0}};function a(a){var b,e=d("react-compiler-runtime").c(21),f=a.attachment,g=a.getPlayableUrl,h=a.getPreviewUrl,i=a.navigateToRouteForMediaViewer,j=a.onPress;a=a.threadType;var k=d("MWMediaGalleryRenderQpl").useMediaGalleryRenderQpl(f,a),r;e[0]!==a?(r=d("LSMessagingThreadTypeUtil").isArmadilloSecure(a),e[0]=a,e[1]=r):r=e[1];r=r;var s=r?f:null;b=(b=m(s,k))!=null?b:{};b=b.downloadStatus;s=(s=n(s,k))!=null?s:{};s=s.uiState;s=c("gkx")("8105")?s:b;k.addAnnotations({string:{downloadStatus:s}});if(f.hasMedia===!1){k==null||k.addPoint("loading_has_media_false");e[2]!==k?(b=l.jsx(c("MWV2AttachmentLoadingPlaceholder.react"),{descriptionForLogging:"MWInboxInfoPhotoGalleryItem.NoMedia",height:512,mediaRenderQpl:k,width:512,xstyle:o.loadingPlaceholder}),e[2]=k,e[3]=b):b=e[3];e[4]===Symbol["for"]("react.memo_cache_sentinel")?(s=l.jsx(c("CometHeroHoldTrigger.react"),{description:"MWInboxInfoPhotoGalleryItem.NoMedia",hold:!0}),e[4]=s):s=e[4];e[5]!==b?(s=l.jsxs(l.Fragment,{children:[b,s]}),e[5]=b,e[6]=s):s=e[6];return s}b=p;e[7]!==k?(s=l.jsx(c("MWV2AttachmentLoadingPlaceholder.react"),{descriptionForLogging:"MWInboxInfoPhotoGalleryItem.Suspense",height:512,mediaRenderQpl:k,width:512,xstyle:o.loadingPlaceholder}),e[7]=k,e[8]=s):s=e[8];e[9]!==f||e[10]!==g||e[11]!==h||e[12]!==r||e[13]!==k||e[14]!==i||e[15]!==j||e[16]!==a?(b=l.jsx(q,{attachment:f,getPlayableUrl:g,getPreviewUrl:h,isSecure:r,mediaRenderQpl:k,navigateToRouteForMediaViewer:i,onPress:j,renderUnsupportedAttachment:b,threadType:a}),e[9]=f,e[10]=g,e[11]=h,e[12]=r,e[13]=k,e[14]=i,e[15]=j,e[16]=a,e[17]=b):b=e[17];e[18]!==s||e[19]!==b?(f=l.jsx(c("CometPlaceholder.react"),{fallback:s,name:"MWInboxInfoPhotoGalleryItem.Suspense",children:b}),e[18]=s,e[19]=b,e[20]=f):f=e[20];return f}function p(a){return l.jsx(c("MWV2AttachmentErrorPlaceholder.react"),{height:512,width:512,xstyle:o.errorPlaceholder})}p.displayName=p.name+" [from "+f.id+"]";function q(a){var b=d("react-compiler-runtime").c(49),e=a.attachment,f=a.getPlayableUrl,g=a.getPreviewUrl,i=a.isSecure,m=a.mediaRenderQpl,n=a.navigateToRouteForMediaViewer,p=a.onPress,q=a.renderUnsupportedAttachment,s=a.threadType;if(b[0]!==e||b[1]!==g||b[2]!==m){a=(a=g(e,"MWInboxInfoPhotoGalleryItem",m))!=null?a:"";b[0]=e;b[1]=g;b[2]=m;b[3]=a}else a=b[3];g=a;b[4]!==e||b[5]!==f||b[6]!==m||b[7]!==g?(a=Boolean(g)?void 0:f(e,"MWInboxInfoPhotoGalleryItem",m),b[4]=e,b[5]=f,b[6]=m,b[7]=g,b[8]=a):a=b[8];f=a;a=c("useMWV2MediaViewerURL")(e);var t;b[9]===Symbol["for"]("react.memo_cache_sentinel")?(t=c("JSResourceForInteraction")("MWV2MediaViewer.react").__setRef("MWInboxInfoPhotoGalleryItem.react"),b[9]=t):t=b[9];t=c("useMWXLazyDialog")(t);var u=t[0],v=t[1];b[10]!==e.attachmentType?(t=(j||(j=d("I64"))).equal(e.attachmentType,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO)),b[10]=e.attachmentType,b[11]=t):t=b[11];t=t;var w=d("useMWMediaViewerOpenQPLLogger").useMWMediaViewerOpenQPLLogger(),x=c("MessengerWebUXLogger").useInteractionLogger();if(g==null||g.length===0){if(!t){m==null||m.endFail("empty_preview_url");if(b[12]!==e||b[13]!==q){var y;y=(y=q==null?void 0:q(e))!=null?y:null;b[12]=e;b[13]=q;b[14]=y}else y=b[14];return y}if(f==null||f.length===0){m==null||m.endFail("empty_video_preview_and_playable_url");if(b[15]!==e||b[16]!==q){y=(y=q==null?void 0:q(e))!=null?y:null;b[15]=e;b[16]=q;b[17]=y}else y=b[17];return y}}b[18]!==n||b[19]!==g||b[20]!==a?(q=n?{passthroughProps:{origSrc:g},url:a}:void 0,b[18]=n,b[19]=g,b[20]=a,b[21]=q):q=b[21];y=q;b[22]!==t?(a=t?h._(/*BTDS*/"Open Video"):h._(/*BTDS*/"Open photo"),b[22]=t,b[23]=a):a=b[23];q=a;b[24]!==n||b[25]!==v?(t=function(){if(!n)return v()},b[24]=n,b[25]=v,b[26]=t):t=b[26];b[27]!==e||b[28]!==i||b[29]!==x||b[30]!==w||b[31]!==n||b[32]!==p||b[33]!==u||b[34]!==s?(a=function(){w.startFlow({attachmentType:d("MWMediaRenderQplUtils").getAttachmentTypeStringFromEnum(e.attachmentType),entryPoint:"media_gallery",isSecure:i});x==null||x({eventName:"open_media_viewer_from_gallery",extraData:{attachmentType:d("MWMediaRenderQplUtils").getAttachmentTypeStringFromEnum(e.attachmentType)},threadType:s});p!=null&&p(e);if(!n)return u({attachment:e},r)},b[27]=e,b[28]=i,b[29]=x,b[30]=w,b[31]=n,b[32]=p,b[33]=u,b[34]=s,b[35]=a):a=b[35];var z;b[36]!==e||b[37]!==m||b[38]!==f||b[39]!==g?(z=l.jsx(c("MWInboxInfoPhotoGalleryItemThumbnailContent.react"),{attachment:e,fallbackVideoUrl:f,mediaRenderQpl:m,previewUrl:g}),b[36]=e,b[37]=m,b[38]=f,b[39]=g,b[40]=z):z=b[40];b[41]!==q||b[42]!==e||b[43]!==y||b[44]!==m||b[45]!==t||b[46]!==a||b[47]!==z?(f=l.jsx(c("MWMessageListMediaPressableContainer.react"),{ariaLabel:q,attachment:e,linkProps_:y,mediaRenderQpl:m,onHoverIn:t,onPress:a,overlayDisabled:!0,testid:void 0,xstyle:o.attachmentContainer,children:z}),b[41]=q,b[42]=e,b[43]=y,b[44]=m,b[45]=t,b[46]=a,b[47]=z,b[48]=f):f=b[48];return f}function r(){}g["default"]=a}),226);
__d("MWXColumnItemHideable.react",["cr:3372","cr:4207","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h=["ref"],i,j=i||d("react");function a(a){var c=d("react-compiler-runtime").c(9),e,f;c[0]!==a?(f=a.ref,e=babelHelpers.objectWithoutPropertiesLoose(a,h),c[0]=a,c[1]=e,c[2]=f):(e=c[1],f=c[2]);if(b("cr:3372")!=null){c[3]!==e||c[4]!==f?(a=j.jsx(b("cr:3372"),babelHelpers["extends"]({},e,{ref:f})),c[3]=e,c[4]=f,c[5]=a):a=c[5];return a}if(b("cr:4207")!=null){c[6]!==e||c[7]!==f?(a=j.jsx(b("cr:4207"),babelHelpers["extends"]({},e,{ref:f})),c[6]=e,c[7]=f,c[8]=a):a=c[8];return a}return null}g["default"]=a}),98);
__d("MWInboxInfoPhotoGallery.react",["CometErrorBoundary.react","CometInfiniteScrollTrigger.react","CometPhotoGrid.react","FDSProgressIndicator.react","I64","LSMessagingThreadTypeUtil","MAWInboxInfoPhotoGalleryItem.react","MAWMediaGalleryEBTaggingUtils","MWInboxInfoPhotoGalleryItem.react","MWInboxInfoSharedContentEmptyTab.react","MWInboxInfoSharedContentTabWithFooter.react","MWSharedContentCommonFbt","MWXColumn.react","MWXColumnItem.react","MWXColumnItemHideable.react","MWXText.react","MessengerWebUXLogger","cr:8625","deferredLoadComponent","formatDate","gkx","react","react-compiler-runtime","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=["threadKey"],i,j,k=i||(i=d("react"));e=i;var l=e.Fragment,m=e.useMemo,n=e.useState,o=c("deferredLoadComponent")(c("requireDeferred")("MWInboxMediaGalleryEBRestoreUpsell.react").__setRef("MWInboxInfoPhotoGallery.react")),p=c("deferredLoadComponent")(c("requireDeferred")("MWInboxMediaGalleryEBRestoreSyncBanner.react").__setRef("MWInboxInfoPhotoGallery.react")),q={dateHeader:{marginBottom:"xod5an3",$$css:!0},photoGridSpacingNormalizer:{marginTop:"xr9ek0c",marginInlineEnd:"xnnr8r",marginBottom:"xjpr12u",marginInlineStart:"xwklpps",$$css:!0},progressRingContainer:{display:"x78zum5",justifyContent:"xl56j7k",marginTop:"x1xmf6yo",paddingTop:"x123j3cw",paddingInlineEnd:"x1gabggj",paddingBottom:"xs9asl8",paddingInlineStart:"xaso8d8",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(18),e=a.backupState,f=a.hasMore,g=a.isLoading,i=a.isRestoringFromEB,j=a.media,l=a.threadType,m,n;b[0]!==a?(n=a.threadKey,m=babelHelpers.objectWithoutPropertiesLoose(a,h),b[0]=a,b[1]=m,b[2]=n):(m=b[1],n=b[2]);b[3]!==n||b[4]!==l?(a={eventName:"media_gallery_rendered",threadKey:n,threadType:l},b[3]=n,b[4]=l,b[5]=a):a=b[5];l=c("MessengerWebUXLogger").useImpressionLoggerRef(a);b[6]===Symbol["for"]("react.memo_cache_sentinel")?(a={className:"x78zum5 xdt5ytf x1iyjqo2 xs83m0k x2lwn1j x6ikm8r x10wlt62 xf7dkkf xv54qhq"},b[6]=a):a=b[6];var o;b[7]!==m||b[8]!==e||b[9]!==f||b[10]!==g||b[11]!==i||b[12]!==j.length||b[13]!==n?(o=j.length>0||f||g||i===!0?k.jsx(r,babelHelpers["extends"]({isRestoringFromEB:i,threadKey:n},m,{backupState:e,navigateToRouteForMediaViewer:!1})):k.jsx(c("MWInboxInfoSharedContentEmptyTab.react"),{backupState:e,contentType:"media",threadKey:n}),b[7]=m,b[8]=e,b[9]=f,b[10]=g,b[11]=i,b[12]=j.length,b[13]=n,b[14]=o):o=b[14];b[15]!==l||b[16]!==o?(m=k.jsx("div",babelHelpers["extends"]({},a,{ref:l,children:o})),b[15]=l,b[16]=o,b[17]=m):m=b[17];return m}function r(a){var b=a.backupState,e=a.getPlayableUrl,f=a.getPreviewUrl,g=a.hasMore,h=a.isBackButtonPressed;h=h===void 0?!1:h;var i=a.isLoading,l=a.isRestoringFromEB,r=a.media,t=a.navigateToRouteForMediaViewer,u=t===void 0?!0:t;t=a.onLoadMore;var v=a.onPressMedia,w=a.threadKey,x=a.threadType;a=a.uniformGrid;var y=a===void 0?!0:a;a=b===4;var z=d("LSMessagingThreadTypeUtil").isArmadilloSecure(x);b=z&&d("MAWMediaGalleryEBTaggingUtils").isMediaGalleryEBTaggingRestoreEnabled();b=z||b;var A=n(!1),B=A[0],C=A[1],D=m(function(){return r.reduce(function(a,b){var e=new Date((j||(j=d("I64"))).to_float(b.timestampMs));e=c("formatDate")(e,{allOtherTimes:"F Y",thisYear:"F"});if(!a.has(e))a.set(e,[b]);else{(e=a.get(e))==null||e.push(b)}return a},new Map())},[r]);return k.jsx(c("MWInboxInfoSharedContentTabWithFooter.react"),{footer:b?k.jsxs(k.Fragment,{children:[a&&k.jsx(c("CometErrorBoundary.react"),{fallback:function(){return null},children:k.jsx(o,{contentType:"media"})}),l===!0&&k.jsx(p,{contentType:"media"})]}):k.jsx(c("MWXText.react"),{align:"center",color:"tertiary",type:"meta3",children:d("MWSharedContentCommonFbt").armadilloMediaGalleryMissingMediaNoticeFbt}),shouldShowFooter:(b||r.length>0)&&z&&!h,children:k.jsxs(c("MWXColumnItemHideable.react"),{hidden:r.length===0&&l===!0,paddingHorizontal:4,paddingVertical:4,children:[k.jsx("div",{onContextMenu:c("gkx")("7066")?function(a){a.altKey&&(a.preventDefault(),C(!B))}:void 0,style:q.photoGridSpacingNormalizer,title:c("gkx")("7066")&&!B?"alt + right click to show attachments debug buttons":void 0,children:k.jsx(c("MWXColumn.react"),{spacing:16,children:Array.from(D.keys()).map(function(a,b){var d;d=(d=D.get(a))!=null?d:[];return k.jsxs(c("MWXColumnItem.react"),{children:[k.jsx(c("MWXColumnItem.react"),{xstyle:q.dateHeader,children:k.jsx(c("MWXText.react"),{color:"primary",type:"headlineEmphasized3",children:a})}),k.jsx(s,{getPlayableUrl:e,getPreviewUrl:f,isSecureThread:z,media:d,navigateToRouteForMediaViewer:u,onPressMedia:v,showDebugger:B,threadKey:w,threadType:x,uniformGrid:y})]},b)})})}),k.jsx(c("CometInfiniteScrollTrigger.react"),{hasMore:g,isLoading:i,onLoadMore:t,scrollMargin:16,xstyle:q.progressRingContainer,children:k.jsx(c("FDSProgressIndicator.react"),{size:"default"})})]})})}r.displayName=r.name+" [from "+f.id+"]";function s(a){var e=d("react-compiler-runtime").c(22),f=a.getPlayableUrl,g=a.getPreviewUrl,h=a.isSecureThread,i=a.media,m=a.navigateToRouteForMediaViewer,n=a.onPressMedia,o=a.showDebugger,p=a.threadKey,q=a.threadType;a=a.uniformGrid;var r=m===void 0?!0:m;if(e[0]!==f||e[1]!==g||e[2]!==h||e[3]!==i||e[4]!==r||e[5]!==n||e[6]!==o||e[7]!==p||e[8]!==q){e[10]!==f||e[11]!==g||e[12]!==h||e[13]!==r||e[14]!==n||e[15]!==o||e[16]!==p||e[17]!==q?(m=function(a){var e=function(){if(h&&(j||(j=d("I64"))).equal(a.threadKey,p)&&c("MAWInboxInfoPhotoGalleryItem.react")!=null)return k.jsx(c("MAWInboxInfoPhotoGalleryItem.react"),{attachment:a,getPlayableUrl:f,getPreviewUrl:g,navigateToRouteForMediaViewer:r,onPress:n,threadType:q});else return k.jsx(c("MWInboxInfoPhotoGalleryItem.react"),{attachment:a,getPlayableUrl:f,getPreviewUrl:g,navigateToRouteForMediaViewer:r,onPress:n,threadType:q})};return k.jsxs(l,{children:[e(),b("cr:8625")&&o?k.jsx(b("cr:8625"),{attachment:a}):null]},a.attachmentFbid+a.messageId)},e[10]=f,e[11]=g,e[12]=h,e[13]=r,e[14]=n,e[15]=o,e[16]=p,e[17]=q,e[18]=m):m=e[18];m=i.map(m);e[0]=f;e[1]=g;e[2]=h;e[3]=i;e[4]=r;e[5]=n;e[6]=o;e[7]=p;e[8]=q;e[9]=m}else m=e[9];e[19]!==m||e[20]!==a?(i=k.jsx(c("CometPhotoGrid.react"),{uniformGrid:a,children:m}),e[19]=m,e[20]=a,e[21]=i):i=e[21];return i}g["default"]=a}),98);
__d("useMWMaybeInboxInfoSharedTabRestoreLoop",["cr:20240","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var c=d("react-compiler-runtime").c(6),e=a.selectedTab;a=a.thread;var f;c[0]!==e||c[1]!==a?(f={selectedTab:e,thread:a},c[0]=e,c[1]=a,c[2]=f):f=c[2];e=b("cr:20240")(f);a=e.backupState;f=e.isRestoringFromEB;e=Boolean(f);c[3]!==a||c[4]!==e?(f={backupState:a,isRestoringFromEB:e},c[3]=a,c[4]=e,c[5]=f):f=c[5];return f}g["default"]=a}),98);
__d("MAWCutoverInboxInfoSharedMediaTab.react",["FBLogger","I64","LSThreadMediaGalleryGroup","MAWThreadCutover","MWInboxInfoPhotoGallery.react","justknobx","react","react-compiler-runtime","recoverableViolation","useMAWLoadMoreCutoverThreadSharedAttachments","useMAWResetAttachmensRangeOnUnmount","useMWMaybeInboxInfoSharedTabRestoreLoop","useMWV2MediaViewerOpenPlayableUrl","useMWV2MediaViewerOpenPreviewUrl","useMWV2MediaViewerSecurePlayableUrl_CausesSuspense","useMWV2MediaViewerSecurePreviewUrl_CausesSuspense"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||(h=d("react"));b=h;b.useCallback;var k=b.useEffect,l=b.useRef;function a(a){var b=d("react-compiler-runtime").c(28),e=a.isBackButtonPressed,f=a.onFirstLoadedMedia,g=a.secureThreadKey;a=a.threadType;var h=d("MAWThreadCutover").useGetCutoverOpenThreadKey(g);h==null&&c("FBLogger")("messenger_web_media").mustfix("Cutover open thread key is null for secure thread key: %s",(i||(i=d("I64"))).to_string(g));var m;b[0]!==g||b[1]!==a?(m={selectedTab:"media",thread:{threadKey:g,threadType:a}},b[0]=g,b[1]=a,b[2]=m):m=b[2];m=c("useMWMaybeInboxInfoSharedTabRestoreLoop")(m);var n=m.backupState;m=m.isRestoringFromEB;var o;b[3]===Symbol["for"]("react.memo_cache_sentinel")?(o={entrypoint:"media_gallery"},b[3]=o):o=b[3];var p;b[4]===Symbol["for"]("react.memo_cache_sentinel")?(p=c("justknobx")._("1132"),b[4]=p):p=b[4];h=c("useMAWLoadMoreCutoverThreadSharedAttachments")(g,h!=null?h:(i||(i=d("I64"))).zero,a,o,c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS,m,p);var q=h.attachments,r=h.completedFirstLoad;o=h.hasMore;p=h.isLoadingMore;h=h.onLoadMore;var s=l(!1),t,u;b[5]!==q||b[6]!==r||b[7]!==f?(t=function(){s.current===!1&&r===!0&&(s.current=!0,f(q))},u=[r,q,f],b[5]=q,b[6]=r,b[7]=f,b[8]=t,b[9]=u):(t=b[8],u=b[9]);k(t,u);var v=c("useMWV2MediaViewerOpenPreviewUrl")(),w=c("useMWV2MediaViewerOpenPlayableUrl")(),x=c("useMWV2MediaViewerSecurePreviewUrl_CausesSuspense")(),y=c("useMWV2MediaViewerSecurePlayableUrl_CausesSuspense")();b[10]!==v||b[11]!==x?(t=function(a,b,d){if(a.transportKey==="FBBroker"||a.transportKey==="FBLegacyBroker"){var e;e=(e=v(a,b))!=null?e:"";e===""&&c("FBLogger")("messenger_web_media").mustfix("Cutover Shared Media Gallery open media previewUrl is an empty string");return e}a=(e=x(a,b,d))!=null?e:"";a===""&&c("recoverableViolation")("Cutover Shared Media Gallery secure media previewUrl is an empty string","messenger_web_media",void 0,{trackOnly:!0});return a},b[10]=v,b[11]=x,b[12]=t):t=b[12];u=t;b[13]!==w||b[14]!==y?(t=function(a,b,c){if(a.transportKey==="FBBroker"||a.transportKey==="FBLegacyBroker"){var d;return(d=w(a,b))!=null?d:""}return(d=y(a,b,c))!=null?d:""},b[13]=w,b[14]=y,b[15]=t):t=b[15];t=t;c("useMAWResetAttachmensRangeOnUnmount")(g,c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS);var z;b[16]!==q||b[17]!==n||b[18]!==t||b[19]!==u||b[20]!==o||b[21]!==e||b[22]!==p||b[23]!==m||b[24]!==h||b[25]!==g||b[26]!==a?(z=j.jsx(c("MWInboxInfoPhotoGallery.react"),{backupState:n,getPlayableUrl:t,getPreviewUrl:u,hasMore:o,isBackButtonPressed:e,isLoading:p,isRestoringFromEB:m,media:q,navigateToRouteForMediaViewer:!1,onLoadMore:h,threadKey:g,threadType:a}),b[16]=q,b[17]=n,b[18]=t,b[19]=u,b[20]=o,b[21]=e,b[22]=p,b[23]=m,b[24]=h,b[25]=g,b[26]=a,b[27]=z):z=b[27];return z}g["default"]=a}),98);
__d("MAWSecureInboxInfoSharedFilesTab.react",["LSThreadMediaGalleryGroup","MAWDbMsg","MWInboxInfoFileGallery.react","MWSharedAttachmentsSectionHooks","justknobx","react","react-compiler-runtime","useMAWLoadMoreThreadSharedAttachments","useMAWResetAttachmensRangeOnUnmount","useMWInboxInfoSharedTabRestoreLoop","useMWMediaLoadingQplLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useEffect,k=b.useRef;function a(a){var b=d("react-compiler-runtime").c(35),e=a.onFirstLoadedMedia;a=a.thread;var f;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(f={removeUnsentMessages:!1},b[0]=f):f=b[0];f=d("MWSharedAttachmentsSectionHooks").useQueryFileAttachments(a.threadKey,f);var g=f[0],h=f[2],l=f[3];f=f[4];var m;b[1]!==a?(m={selectedTab:"files",thread:a},b[1]=a,b[2]=m):m=b[2];m=c("useMWInboxInfoSharedTabRestoreLoop")(m);var n=m.backupState;m=m.isRestoringFromEB;var o=f!=null?f:!0,p;b[3]!==(h==null?void 0:h.lastLoadedMessageId)?(p=(h==null?void 0:h.lastLoadedMessageId)!=null?d("MAWDbMsg").toMsgId(h==null?void 0:h.lastLoadedMessageId):void 0,b[3]=h==null?void 0:h.lastLoadedMessageId,b[4]=p):p=b[4];p=p;var q;b[5]!==a.threadType?(q={entrypoint:"file_gallery",threadType:a.threadType},b[5]=a.threadType,b[6]=q):q=b[6];q=c("useMWMediaLoadingQplLogger")(q);p=p!=null?p:void 0;var r;b[7]===Symbol["for"]("react.memo_cache_sentinel")?(r=c("justknobx")._("1132"),b[7]=r):r=b[7];b[8]!==f||b[9]!==l||b[10]!==q||b[11]!==p||b[12]!==a.threadKey?(r={earliestLoadedMediaMessageId:p,hasMoreBefore:f,mediaGalleryGroup:c("LSThreadMediaGalleryGroup").FILES_ONLY,minTimestampMs:l,pageSize:r,qplLogger:q,threadKey:a.threadKey},b[8]=f,b[9]=l,b[10]=q,b[11]=p,b[12]=a.threadKey,b[13]=r):r=b[13];f=c("useMAWLoadMoreThreadSharedAttachments")(r);var s=k(!1);b[14]!==h||b[15]!==g||b[16]!==o||b[17]!==f||b[18]!==q.logLoadMediaCancel||b[19]!==q.logLoadMediaSuccess?(l={attachmentsRange:h,hasMore:o,loadMore:f,logLoadMediaCancel:q.logLoadMediaCancel,logLoadMediaSuccess:q.logLoadMediaSuccess,media:g},b[14]=h,b[15]=g,b[16]=o,b[17]=f,b[18]=q.logLoadMediaCancel,b[19]=q.logLoadMediaSuccess,b[20]=l):l=b[20];p=d("MWSharedAttachmentsSectionHooks").useLoader(l);r=p[0];h=p[1];var t=p[2];c("useMAWResetAttachmensRangeOnUnmount")(a.threadKey,c("LSThreadMediaGalleryGroup").FILES_ONLY);b[21]!==t||b[22]!==g||b[23]!==e?(f=function(){s.current===!1&&t===!0&&(s.current=!0,e(g))},q=[t,g,e],b[21]=t,b[22]=g,b[23]=e,b[24]=q,b[25]=f):(q=b[24],f=b[25]);j(f,q);b[26]!==n||b[27]!==g||b[28]!==o||b[29]!==r||b[30]!==m||b[31]!==h||b[32]!==a.threadKey||b[33]!==a.threadType?(l=i.jsx(c("MWInboxInfoFileGallery.react"),{backupState:n,files:g,hasMore:o,isLoading:r,isRestoringFromEB:m,onLoadMore:h,threadKey:a.threadKey,threadType:a.threadType}),b[26]=n,b[27]=g,b[28]=o,b[29]=r,b[30]=m,b[31]=h,b[32]=a.threadKey,b[33]=a.threadType,b[34]=l):l=b[34];return l}g["default"]=a}),98);
__d("MWInboxInfoListItem.react",["MWXColumnItem.react","MWXPressable.react","MWXRow.react","MWXRowItem.react","MWXTextPairing.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useMemo;var j={containerRow:{marginTop:"xdj266r",marginInlineEnd:"x14z9mp",marginBottom:"xat24cr",marginInlineStart:"x1lziwak",paddingTop:"xexx8yu",paddingInlineEnd:"xyri2b",paddingBottom:"x18d9i69",paddingInlineStart:"x1c1uobl",$$css:!0},contentItem:{paddingTop:"xz9dl7a",paddingInlineEnd:"xpdmqnj",paddingBottom:"xsag5q8",paddingInlineStart:"x1g0dm76",$$css:!0},mediaItem:{alignItems:"x6s0dn4",backgroundColor:"xlhe6ec",borderStartStartRadius:"x1obq294",borderStartEndRadius:"x5a5i1n",borderEndEndRadius:"xde0f50",borderEndStartRadius:"x15x8krk",display:"x78zum5",height:"xdd8jsf",justifyContent:"xl56j7k",overflowX:"x6ikm8r",overflowY:"x10wlt62",paddingTop:"xexx8yu",paddingInlineEnd:"xyri2b",paddingBottom:"x18d9i69",paddingInlineStart:"x1c1uobl",width:"xvni27",$$css:!0},pressable:{overflowX:"x6ikm8r",overflowY:"x10wlt62",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(14),e=a.mediaElement,f=a.onPress,g=a.subtitle,h=a.title;a=a.url;var l;b[0]!==a?(l={target:"_blank",url:a},b[0]=a,b[1]=l):l=b[1];a=l;l=a;b[2]!==e?(a=i.jsx(c("MWXRowItem.react"),{xstyle:j.mediaItem,children:e}),b[2]=e,b[3]=a):a=b[3];b[4]!==g||b[5]!==h?(e=i.jsx(c("MWXRowItem.react"),{expanding:!0,xstyle:j.contentItem,children:i.jsx(c("MWXTextPairing.react"),{body:g,bodyColor:"secondary",headline:h,headlineLineLimit:1,level:4})}),b[4]=g,b[5]=h,b[6]=e):e=b[6];b[7]!==a||b[8]!==e?(g=i.jsxs(c("MWXRow.react"),{expanding:!0,verticalAlign:"center",xstyle:j.containerRow,children:[a,e]}),b[7]=a,b[8]=e,b[9]=g):g=b[9];b[10]!==l||b[11]!==f||b[12]!==g?(h=i.jsx(c("MWXColumnItem.react"),{children:i.jsx(c("MWXPressable.react"),{display:"inline",linkProps:l,onPress:f,overlayDisabled:!0,xstyle:k,children:g})}),b[10]=l,b[11]=f,b[12]=g,b[13]=h):h=b[13];return h}function k(){return[j.pressable]}g.MWInboxInfoListItem=a}),98);
__d("isValidHttpURL",[],(function(a,b,c,d,e,f){"use strict";var g=/^http(s)?:\/\/(([\w-]+\.)+(xn--[\w-]+|\w+)|\[([\da-f]{0,4}:)*(?:[\da-f]{1,4}|(?:(?:\d{1,3}\.){3}\d{1,3}))\])(:[0-9]+)?([/\?].*)?$/i,h=/^https:\/\/(([\w-]+\.)+(xn--[\w-]+|\w+)|\[([\da-f]{0,4}:)*(?:[\da-f]{1,4}|(?:(?:\d{1,3}\.){3}\d{1,3}))\])(:[0-9]+)?([/\?].*)?$/i;function a(a,b){b===void 0&&(b=!1);return a.match(b?h:g)!==null}f["default"]=a}),66);
__d("MWInboxInfoSharedLink.react",["CometPlaceholder.react","FDSImageCover.react","LSMediaUrlAttachment","MWInboxInfoListItem.react","MWMediaGalleryRenderQpl","MWV2AttachmentLoadingPlaceholder.react","MWXIconLink","MWXIconStrict.react","ReQL","ReQLSuspense","isValidHttpURL","react","react-compiler-runtime","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||(i=d("react")),k=i.useEffect,l=60,m=350,n={loadingPlaceholder:{borderStartStartRadius:"x1obq294",borderStartEndRadius:"x5a5i1n",borderEndEndRadius:"xde0f50",borderEndStartRadius:"x15x8krk",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(9),e=a.attachment,f=a.onPress;a=a.threadType;a=d("MWMediaGalleryRenderQpl").useMediaGalleryRenderQpl(e,a);var g;b[0]!==a?(g=j.jsx(c("MWV2AttachmentLoadingPlaceholder.react"),{descriptionForLogging:"MWInboxInfoSharedLink.Suspense",height:l,mediaRenderQpl:a,width:m,xstyle:n.loadingPlaceholder}),b[0]=a,b[1]=g):g=b[1];var h;b[2]!==e||b[3]!==a||b[4]!==f?(h=j.jsx(o,{attachment:e,mediaRenderQpl:a,onPress:f}),b[2]=e,b[3]=a,b[4]=f,b[5]=h):h=b[5];b[6]!==g||b[7]!==h?(e=j.jsx(c("CometPlaceholder.react"),{fallback:g,name:"MWInboxInfoSharedLink.Suspense",children:h}),b[6]=g,b[7]=h,b[8]=e):e=b[8];return e}function o(a){var b=d("react-compiler-runtime").c(24),e=a.attachment,g=a.mediaRenderQpl;a=a.onPress;var i=(h||(h=c("useReStore")))(),l,m;b[0]!==e.defaultCtaId||b[1]!==i?(l=function(){var a=e.defaultCtaId;return a!=null?d("ReQL").fromTableAscending(i.tables.attachment_ctas).getKeyRange(a):d("ReQL").empty()},m=[i,e.defaultCtaId],b[0]=e.defaultCtaId,b[1]=i,b[2]=l,b[3]=m):(l=b[2],m=b[3]);l=d("ReQLSuspense").useFirst(l,m,f.id+":78");b[4]!==e?(m=d("LSMediaUrlAttachment").previewUrl(e),b[4]=e,b[5]=m):m=b[5];var n=m;b[6]!==e?(m=d("LSMediaUrlAttachment").faviconUrl(e),b[6]=e,b[7]=m):m=b[7];var o=m,p;b[8]!==o||b[9]!==g||b[10]!==n?(m=function(){n==null&&o==null&&(g==null||g.endSuccess())},p=[n,o,g],b[8]=o,b[9]=g,b[10]=n,b[11]=m,b[12]=p):(m=b[11],p=b[12]);k(m,p);m=l==null?void 0:l.actionUrl;p=e.defaultCtaType==="xma_web_url"||c("isValidHttpURL")(m!=null?m:"");if(m==null||!p)return null;p=(l=e.titleText)!=null?l:m;l=(l=e.accessibilitySummaryText)!=null?l:p;var q;b[13]!==l||b[14]!==o||b[15]!==g||b[16]!==n?(q=n!=null?j.jsx(c("FDSImageCover.react"),{alt:l,onError:function(){return g==null?void 0:g.endFail("load-image-error")},onLoad:function(){return g==null?void 0:g.endSuccess()},src:n}):o!=null?j.jsx(c("FDSImageCover.react"),{alt:l,onError:function(){return g==null?void 0:g.endFail("load-image-error")},onLoad:function(){return g==null?void 0:g.endSuccess()},src:o}):j.jsx(c("MWXIconStrict.react"),{color:"primary",icon:c("MWXIconLink"),size:16}),b[13]=l,b[14]=o,b[15]=g,b[16]=n,b[17]=q):q=b[17];l=q;q=(q=e.subtitleText)!=null?q:"";var r;b[18]!==a||b[19]!==l||b[20]!==q||b[21]!==p||b[22]!==m?(r=j.jsx(d("MWInboxInfoListItem.react").MWInboxInfoListItem,{mediaElement:l,onPress:a,subtitle:q,title:p,url:m}),b[18]=a,b[19]=l,b[20]=q,b[21]=p,b[22]=m,b[23]=r):r=b[23];return r}g["default"]=a}),98);
__d("MAWSecureInboxInfoSharedLinksTab.react",["BaseTheme.react","CometInfiniteScrollTrigger.react","FDSProgressIndicator.react","LSThreadMediaGalleryGroup","MWInboxInfoSharedContentEmptyTab.react","MWInboxInfoSharedContentTheme","MWInboxInfoSharedLink.react","MWSharedAttachmentsSectionHooks","MWXColumn.react","MWXColumnItem.react","emptyFunction","justknobx","react","react-compiler-runtime","useMAWLoadMoreThreadSharedAttachments","useMAWResetAttachmensRangeOnUnmount"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j={progressIndicator:{display:"x78zum5",justifyContent:"xl56j7k",marginTop:"x1xmf6yo",paddingTop:"x123j3cw",paddingInlineEnd:"x1gabggj",paddingBottom:"xs9asl8",paddingInlineStart:"xaso8d8",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(26),e=a.thread;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(a={removeUnsentMessages:!0},b[0]=a):a=b[0];a=d("MWSharedAttachmentsSectionHooks").useQueryLinkAttachments(e.threadKey,a);var f=a[0],g=a[2],h=a[3];a=a[4];var k=a!=null?a:!1,l;b[1]===Symbol["for"]("react.memo_cache_sentinel")?(l=c("justknobx")._("1132"),b[1]=l):l=b[1];b[2]!==a||b[3]!==h||b[4]!==e.threadKey?(l={hasMoreBefore:a,mediaGalleryGroup:c("LSThreadMediaGalleryGroup").LINKS,minTimestampMs:h,pageSize:l,threadKey:e.threadKey},b[2]=a,b[3]=h,b[4]=e.threadKey,b[5]=l):l=b[5];a=c("useMAWLoadMoreThreadSharedAttachments")(l);b[6]!==f||b[7]!==g||b[8]!==k||b[9]!==a?(h={attachmentsRange:g,hasMore:k,loadMore:a,media:f},b[6]=f,b[7]=g,b[8]=k,b[9]=a,b[10]=h):h=b[10];l=d("MWSharedAttachmentsSectionHooks").useLoader(h);g=l[0];a=l[1];c("useMAWResetAttachmensRangeOnUnmount")(e.threadKey,c("LSThreadMediaGalleryGroup").LINKS);if(f.length===0&&!k){b[11]!==e.threadKey?(h=i.jsx(c("MWInboxInfoSharedContentEmptyTab.react"),{contentType:"links",threadKey:e.threadKey}),b[11]=e.threadKey,b[12]=h):h=b[12];return h}if(b[13]!==f||b[14]!==e.threadType){b[16]!==e.threadType?(l=function(a){return i.jsx(c("MWXColumnItem.react"),{children:i.jsx(c("MWInboxInfoSharedLink.react"),{attachment:a,onPress:c("emptyFunction"),threadType:e.threadType})},a.messageId)},b[16]=e.threadType,b[17]=l):l=b[17];h=f.map(l);b[13]=f;b[14]=e.threadType;b[15]=h}else h=b[15];b[18]===Symbol["for"]("react.memo_cache_sentinel")?(l=i.jsx(c("FDSProgressIndicator.react"),{size:"default"}),b[18]=l):l=b[18];b[19]!==k||b[20]!==g||b[21]!==a?(f=i.jsx(c("MWXColumnItem.react"),{children:i.jsx(c("CometInfiniteScrollTrigger.react"),{hasMore:k,isLoading:g,onLoadMore:a,xstyle:j.progressIndicator,children:l})},"infinite_scroll_trigger"),b[19]=k,b[20]=g,b[21]=a,b[22]=f):f=b[22];b[23]!==h||b[24]!==f?(l=i.jsx(c("BaseTheme.react"),{config:d("MWInboxInfoSharedContentTheme").config,children:i.jsxs(c("MWXColumn.react"),{hasDividers:!0,paddingHorizontal:16,paddingVertical:8,spacing:20,children:[h,f]})}),b[23]=h,b[24]=f,b[25]=l):l=b[25];return l}g["default"]=a}),98);
__d("MAWSecureInboxInfoSharedMediaTab.react",["LSThreadMediaGalleryGroup","MAWDbMsg","MWInboxInfoPhotoGallery.react","MWSharedAttachmentsSectionHooks","justknobx","react","react-compiler-runtime","recoverableViolation","useMAWLoadMoreThreadSharedAttachments","useMAWQuerySecureMediaAttachments","useMAWResetAttachmensRangeOnUnmount","useMWMaybeInboxInfoSharedTabRestoreLoop","useMWMediaLoadingQplLogger","useMWV2MediaViewerSecurePlayableUrl_CausesSuspense","useMWV2MediaViewerSecurePreviewUrl_CausesSuspense"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useCallback;var j=b.useEffect,k=b.useRef;function a(a){var b=d("react-compiler-runtime").c(39),e=a.isBackButtonPressed,f=a.onFirstLoadedMedia;a=a.thread;var g;b[0]!==a?(g={selectedTab:"media",thread:a},b[0]=a,b[1]=g):g=b[1];g=c("useMWMaybeInboxInfoSharedTabRestoreLoop")(g);var h=g.backupState;g=g.isRestoringFromEB;var l=k(!1),m=c("useMAWQuerySecureMediaAttachments")(a.threadKey),n=m[0],o=m[2],p=m[3];m=m[4];var q=m!=null?m:!0,r;b[2]!==(o==null?void 0:o.lastLoadedMessageId)?(r=(o==null?void 0:o.lastLoadedMessageId)!=null?d("MAWDbMsg").toMsgId(o==null?void 0:o.lastLoadedMessageId):void 0,b[2]=o==null?void 0:o.lastLoadedMessageId,b[3]=r):r=b[3];r=r;var s;b[4]!==a.threadType?(s={entrypoint:"media_gallery",threadType:a.threadType},b[4]=a.threadType,b[5]=s):s=b[5];s=c("useMWMediaLoadingQplLogger")(s);r=r!=null?r:void 0;var t;b[6]===Symbol["for"]("react.memo_cache_sentinel")?(t=c("justknobx")._("1132"),b[6]=t):t=b[6];b[7]!==m||b[8]!==p||b[9]!==s||b[10]!==r||b[11]!==a.threadKey?(t={earliestLoadedMediaMessageId:r,hasMoreBefore:m,mediaGalleryGroup:c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS,minTimestampMs:p,pageSize:t,qplLogger:s,threadKey:a.threadKey},b[7]=m,b[8]=p,b[9]=s,b[10]=r,b[11]=a.threadKey,b[12]=t):t=b[12];m=c("useMAWLoadMoreThreadSharedAttachments")(t);b[13]!==o||b[14]!==q||b[15]!==m||b[16]!==n||b[17]!==s.logLoadMediaCancel||b[18]!==s.logLoadMediaSuccess?(p={attachmentsRange:o,hasMore:q,loadMore:m,logLoadMediaCancel:s.logLoadMediaCancel,logLoadMediaSuccess:s.logLoadMediaSuccess,media:n},b[13]=o,b[14]=q,b[15]=m,b[16]=n,b[17]=s.logLoadMediaCancel,b[18]=s.logLoadMediaSuccess,b[19]=p):p=b[19];r=d("MWSharedAttachmentsSectionHooks").useLoader(p);t=r[0];o=r[1];var u=r[2];b[20]!==u||b[21]!==n||b[22]!==f?(m=function(){l.current===!1&&u===!0&&(l.current=!0,f(n))},s=[u,n,f],b[20]=u,b[21]=n,b[22]=f,b[23]=m,b[24]=s):(m=b[23],s=b[24]);j(m,s);var v=c("useMWV2MediaViewerSecurePreviewUrl_CausesSuspense")();p=c("useMWV2MediaViewerSecurePlayableUrl_CausesSuspense")();b[25]!==v?(r=function(a,b,d){a=v(a,b,d);a===""&&c("recoverableViolation")("MAW Shared Media Gallery previewUrl is an empty string","messenger_web_media",void 0,{trackOnly:!0});return a},b[25]=v,b[26]=r):r=b[26];m=r;c("useMAWResetAttachmensRangeOnUnmount")(a.threadKey,c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS);b[27]!==h||b[28]!==p||b[29]!==m||b[30]!==q||b[31]!==e||b[32]!==t||b[33]!==g||b[34]!==n||b[35]!==o||b[36]!==a.threadKey||b[37]!==a.threadType?(s=i.jsx(c("MWInboxInfoPhotoGallery.react"),{backupState:h,getPlayableUrl:p,getPreviewUrl:m,hasMore:q,isBackButtonPressed:e,isLoading:t,isRestoringFromEB:g,media:n,navigateToRouteForMediaViewer:!1,onLoadMore:o,threadKey:a.threadKey,threadType:a.threadType}),b[27]=h,b[28]=p,b[29]=m,b[30]=q,b[31]=e,b[32]=t,b[33]=g,b[34]=n,b[35]=o,b[36]=a.threadKey,b[37]=a.threadType,b[38]=s):s=b[38];return s}g["default"]=a}),98);
__d("MWAddMemberToGroupListCell.react",["fbt","MWXIconForListCell.react","MWXIconFriendGenericAdd","MWXListCellPressable.react","MWXText.react","react","react-compiler-runtime","useMWAddParticipantDialog"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(a){var b=d("react-compiler-runtime").c(11),e=a.testid;a=a.thread;var f=c("useMWAddParticipantDialog")(a.threadKey,a.threadType),g;b[0]!==a.threadKey||b[1]!==a.threadType?(g={eventName:"open_add_members_dialog",threadKey:a.threadKey,threadType:a.threadType},b[0]=a.threadKey,b[1]=a.threadType,b[2]=g):g=b[2];a=g;b[3]===Symbol["for"]("react.memo_cache_sentinel")?(g=j.jsx(c("MWXIconForListCell.react"),{icon:c("MWXIconFriendGenericAdd"),size:"large"}),b[3]=g):g=b[3];var i;b[4]===Symbol["for"]("react.memo_cache_sentinel")?(i=j.jsx(c("MWXText.react"),{type:"headline4",children:h._(/*BTDS*/"Add people")}),b[4]=i):i=b[4];var k;b[5]!==f?(k=function(){return f()},b[5]=f,b[6]=k):k=b[6];b[7]!==a||b[8]!==k||b[9]!==e?(g=j.jsx(c("MWXListCellPressable.react"),{addOnStart:g,content:i,loggingEvent:a,onPress:k,size:"medium",testid:void 0}),b[7]=a,b[8]=k,b[9]=e,b[10]=g):g=b[10];return g}g["default"]=a}),226);
__d("MWXIconQuestionChat",["MWXSvgIcon","SVGIcon","cr:22451","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=d("MWXSvgIcon").mwxSvgIcon(d("SVGIcon").svgIcon(b("cr:22451")),c("gkx")("23219"));g["default"]=a}),98);
__d("MWBroadcastChannelBestPracticesMenuItem.react",["fbt","Int64Hooks","MWBroadcastChannelBestPracticesContent.react","MWInboxInfoButton.react","MWInboxInfoPanelContext.react","MWXIconForListCell.react","MWXIconQuestionChat","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react")),k=i.useEffect;function a(a){var b=a.pushPage,e=a.thread;a=h._(/*BTDS*/"Best practices");var f=d("MWInboxInfoPanelContext.react").useMWInboxInfoPanelContext(),g=f.navToBestPracticesRef,i=d("Int64Hooks").useCallbackInt64(function(){g.current=!1,b(function(a){a=a.onReturn;return j.jsx(c("MWBroadcastChannelBestPracticesContent.react"),{onReturn:a,thread:e})})},[g,b,e]);k(function(){g.current===!0&&i()},[g,i]);return j.jsx(c("MWInboxInfoButton.react"),{addOnStart:j.jsx(c("MWXIconForListCell.react"),{icon:c("MWXIconQuestionChat")}),label:a,onPress:function(){i()}})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("MWCMInboxInfoGroupCopyLinkButton.react",["fbt","CurrentEnvironment","LSThreadBitOffset","MWCMChannelLinkShareTrigger.react","MWCMShortLinkShare.react","MWInboxInfoButton.react","MWPBumpEntityKey","MWXIconForListCell.react","MWXIconMenuItemLink","mwCMisStandAloneCommunity","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react"),k=h._(/*BTDS*/"Copy link"),l=h._(/*BTDS*/"Invite community members to join this chat");function a(a){var b=d("react-compiler-runtime").c(4),e=a.folder;a=a.thread;var f=d("LSThreadBitOffset").has(124,a),g=c("CurrentEnvironment").facebookdotcom;if(f&&g&&!c("mwCMisStandAloneCommunity")(e==null?void 0:e.communityType)){b[0]!==a.threadKey?(f=j.jsx(c("MWCMChannelLinkShareTrigger.react"),{threadKey:a.threadKey,children:n}),b[0]=a.threadKey,b[1]=f):f=b[1];return f}b[2]!==a?(g=j.jsx(c("MWCMShortLinkShare.react"),{thread:a,children:m}),b[2]=a,b[3]=g):g=b[3];return g}function m(a,b){return j.jsx(c("MWInboxInfoButton.react"),{addOnStart:j.jsx(c("MWXIconForListCell.react"),{icon:c("MWXIconMenuItemLink")}),label:k,onPress:function(){d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.infobar","copy_link"),b()},subLabel:l})}m.displayName=m.name+" [from "+f.id+"]";function n(a){return j.jsx(c("MWInboxInfoButton.react"),{addOnStart:j.jsx(c("MWXIconForListCell.react"),{icon:c("MWXIconMenuItemLink")}),label:k,onPress:a,subLabel:l})}n.displayName=n.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("MWCMInboxInfoGroupEventsButton.react",["fbt","GroupsCometChatsEngagementLogger","I64","MWInboxInfoButton.react","MWXIconCalendar","MWXIconForListCell.react","ReQL","ReQLSuspense","deferredLoadComponent","react","react-compiler-runtime","requireDeferredForDisplay","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l=j||d("react"),m=c("deferredLoadComponent")(c("requireDeferredForDisplay")("MWInboxInfoEventsListSection.react").__setRef("MWCMInboxInfoGroupEventsButton.react"));function n(a,b){return function(){d("GroupsCometChatsEngagementLogger").log({action:"tap",client_extras:{entry_point:"inbox"},event:"render_event_list",parent_surface:"thread_view",source:"event_button",surface:"thread_settings",thread_id:(k||(k=d("I64"))).to_string(b)}),a(function(a){a=a.onReturn;return l.jsx(m,{loggingParentSurface:"thread_settings",loggingSource:"event_button",onReturn:a,threadKey:b})})}}function a(a){var b=d("react-compiler-runtime").c(20),e=a.pushPage,g=a.threadKey,j=(i||(i=c("useReStore")))();b[0]===Symbol["for"]("react.memo_cache_sentinel")?(a=h._(/*BTDS*/"Events"),b[0]=a):a=b[0];a=a;var k;b[1]!==j.tables.cm_channel_events||b[2]!==j.tables.fb_events||b[3]!==g?(k=function(){return d("ReQL").fromTableAscending(j.tables.cm_channel_events.index("eventsInThread")).getKeyRange(g).map(function(a){return d("ReQLSuspense").first(d("ReQL").fromTableAscending(j.tables.fb_events).getKeyRange(a.eventId),f.id+":75")})},b[1]=j.tables.cm_channel_events,b[2]=j.tables.fb_events,b[3]=g,b[4]=k):k=b[4];var m;b[5]!==j||b[6]!==g?(m=[j,g],b[5]=j,b[6]=g,b[7]=m):m=b[7];k=d("ReQLSuspense").useArray(k,m,f.id+":70");b[8]!==k?(m=k.filter(o),b[8]=k,b[9]=m):m=b[9];m=m.length;var p;b[10]!==e||b[11]!==g?(p=n(e,g),b[10]=e,b[11]=g,b[12]=p):p=b[12];e=p;p=m!=null&&m>0;var q;b[13]!==p||b[14]!==m?(q=p?h._(/*BTDS*/"_j{\"*\":\"{Number of upcoming events} upcoming events\",\"_1\":\"{Number of upcoming events} upcoming event\"}",[h._plural(m),h._param("Number of upcoming events",m)]):void 0,b[13]=p,b[14]=m,b[15]=q):q=b[15];p=q;b[16]!==p||b[17]!==k.length||b[18]!==e?(m=k.length>0?l.jsx(c("MWInboxInfoButton.react"),{addOnStart:l.jsx(c("MWXIconForListCell.react"),{icon:c("MWXIconCalendar")}),label:a,onPress:e,subLabel:p}):null,b[16]=p,b[17]=k.length,b[18]=e,b[19]=m):m=b[19];return m}function o(a){return(a==null?void 0:a.startTimeMs)!=null?(k||(k=d("I64"))).to_float(a.startTimeMs)>Date.now():!1}g["default"]=a}),226);
__d("MWXIconMenuItemAppGroups",["MWXSvgIcon","SVGIcon","cr:22539","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=d("MWXSvgIcon").mwxSvgMenuItemIcon(d("SVGIcon").svgIcon(b("cr:22539")),c("gkx")("23219"));g["default"]=a}),98);
__d("MWCMInboxInfoGroupLink.react",["fbt","CurrentEnvironment","I64","MWInboxInfoButton.react","MWXIconForListCell.react","MWXIconMenuItemAppGroups","XCometGroupLandingControllerRouteBuilder","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=i||d("react");function a(a){var b=d("react-compiler-runtime").c(8);a=a.folder;var e=a.fbGroupId;a=a.name;e="https://www.facebook.com"+c("XCometGroupLandingControllerRouteBuilder").buildURL({group_id:(j||(j=d("I64"))).to_string(e)});var f=c("CurrentEnvironment").messengerdotcom?"_blank":"_self",g;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(g=k.jsx(c("MWXIconForListCell.react"),{icon:c("MWXIconMenuItemAppGroups")}),b[0]=g):g=b[0];var i;b[1]!==a?(i=h._(/*BTDS*/"Go to {facebook group name}",[h._param("facebook group name",a)]),b[1]=a,b[2]=i):i=b[2];b[3]!==e?(a={target:f,url:e},b[3]=e,b[4]=a):a=b[4];b[5]!==i||b[6]!==a?(f=k.jsx(c("MWInboxInfoButton.react"),{addOnStart:g,label:i,linkProps:a}),b[5]=i,b[6]=a,b[7]=f):f=b[7];return f}g["default"]=a}),226);
__d("MWCMInboxInfoMemberList.react",["fbt","I64","LSIntEnum","LSMessagingThreadTypeUtil","MWGroupMembershipListItemWrapper","MWLSGroupMembershipDialog.entrypoint","MWLSGroupMembershipMemberList.react","MWMemberListGlimmer.react","MWPBumpEntityKey","MWParticipantsForBroadcastChannelUtils","MWXIconForListCell.react","MWXIconGroup","MWXListCellPressable.react","MWXText.react","ReQL","ReQLSuspense","pageID","promiseDone","react","react-compiler-runtime","useCommunityMembers","useMWXEntryPointDialog","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l,m=j||(j=d("react")),n=j.useEffect,o="inbox_info_member_list_"+c("pageID"),p="member_list_profile_sheet_source_"+c("pageID"),q=(l||(l=d("I64"))).of_int32(7);function a(a){var b=d("react-compiler-runtime").c(56),e=a.folder,g=a.thread,j=(i||(i=c("useReStore")))(),k=e==null?g.threadKey:e.folderId;b[0]!==k||b[1]!==g?(a={communityIdOrThreadKey:k,requestId:o,source:q,thread:g},b[0]=k,b[1]=g,b[2]=a):a=b[2];d("useCommunityMembers").useFetchCommunityMembers(a);b[3]!==k||b[4]!==j.tables.community_members?(a=function(){return d("ReQL").fromTableAscending(j.tables.community_members.index("communitySource")).getKeyRange(k,q,o).take(15)},b[3]=k,b[4]=j.tables.community_members,b[5]=a):a=b[5];var u;b[6]!==k||b[7]!==j?(u=[j,k],b[6]=k,b[7]=j,b[8]=u):u=b[8];var v=d("ReQLSuspense").useArray(a,u,f.id+":92");d("MWParticipantsForBroadcastChannelUtils").useFetchBroadcastChannelMembers(g,0);b[9]!==j.tables.discoverable_chat_participants||b[10]!==g.threadKey?(a=function(){return d("ReQL").fromTableAscending(j.tables.discoverable_chat_participants).getKeyRange(g.threadKey).filter(t).take(15)},b[9]=j.tables.discoverable_chat_participants,b[10]=g.threadKey,b[11]=a):a=b[11];b[12]!==j||b[13]!==g.threadKey?(u=[j,g.threadKey],b[12]=j,b[13]=g.threadKey,b[14]=u):u=b[14];a=d("ReQLSuspense").useArray(a,u,f.id+":104");var w=d("useCommunityMembers").useClearMemberList(),x=d("useCommunityMembers").useClearMemberList(14),y=d("MWParticipantsForBroadcastChannelUtils").useClearBroadcastChannelParticipantsList();b[15]!==g.threadKey?(u=(l||(l=d("I64"))).to_string(g.threadKey),b[15]=g.threadKey,b[16]=u):u=b[16];u=u;var z;b[17]!==g.threadType?(z=d("LSMessagingThreadTypeUtil").isDiscoverablePublicBroadcastChannel(g.threadType),b[17]=g.threadType,b[18]=z):z=b[18];z=z;var A;b[19]!==a||b[20]!==v||b[21]!==z?(A=z?a.map(s):v.map(r),b[19]=a,b[20]=v,b[21]=z,b[22]=A):A=b[22];a=A;b[23]!==y||b[24]!==w||b[25]!==x?(z=function(){c("promiseDone")(w(o));c("promiseDone")(x(p));c("promiseDone")(y());return function(){c("promiseDone")(w(o)),c("promiseDone")(x(p)),c("promiseDone")(y())}},b[23]=y,b[24]=w,b[25]=x,b[26]=z):z=b[26];b[27]!==y||b[28]!==w||b[29]!==x||b[30]!==u?(A=[u,w,y,x],b[27]=y,b[28]=w,b[29]=x,b[30]=u,b[31]=A):A=b[31];n(z,A);b[32]!==v.length?(u=function(){v.length>0&&d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.cm.member_list","community_members_loaded")},z=[v.length],b[32]=v.length,b[33]=u,b[34]=z):(u=b[33],z=b[34]);n(u,z);b[35]!==e?(A={folder:e},b[35]=e,b[36]=A):A=b[36];var B=A;if(b[37]!==(e==null?void 0:e.fbGroupId)){z=(l||(l=d("I64"))).to_string((u=e==null?void 0:e.fbGroupId)!=null?u:(l||(l=d("I64"))).zero);b[37]=e==null?void 0:e.fbGroupId;b[38]=z}else z=b[38];b[39]!==z?(A={groupID:z},b[39]=z,b[40]=A):A=b[40];u=c("useMWXEntryPointDialog")(c("MWLSGroupMembershipDialog.entrypoint"),A);var C=u[0];b[41]!==B||b[42]!==C?(z=function(){return C(B)},b[41]=B,b[42]=C,b[43]=z):z=b[43];var D=z;if(a.length===0){b[44]===Symbol["for"]("react.memo_cache_sentinel")?(A=m.jsx(c("MWMemberListGlimmer.react"),{}),b[44]=A):A=b[44];return A}b[45]!==e||b[46]!==a||b[47]!==g?(u=m.jsx(c("MWLSGroupMembershipMemberList.react"),{disableScroll:!0,doSortParticipants:!1,folder:e,participantsAndContacts:a,showAdmodIndicator:!0,showAdmodsOnly:!1,showHostsOnly:!1,showInvitedByViewerOnly:!1,thread:g}),b[45]=e,b[46]=a,b[47]=g,b[48]=u):u=b[48];b[49]===Symbol["for"]("react.memo_cache_sentinel")?(z=m.jsx("div",babelHelpers["extends"]({className:"x6s0dn4 xljulmy x1c9tyrk xeusxvb x1pahc9y x1ertn4p x78zum5 xc9qbxq xl56j7k x14qfxbe"},{children:m.jsx(c("MWXIconForListCell.react"),{hasBackground:!1,icon:c("MWXIconGroup"),size:"medium"})})),b[49]=z):z=b[49];b[50]===Symbol["for"]("react.memo_cache_sentinel")?(A=m.jsx(c("MWXText.react"),{type:"headline4",children:h._(/*BTDS*/"See all")}),b[50]=A):A=b[50];b[51]!==D?(e=m.jsx(c("MWXListCellPressable.react"),{addOnStart:z,content:A,onPress:function(a){d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.cm.member_list","see_all"),D()},size:"medium"}),b[51]=D,b[52]=e):e=b[52];b[53]!==u||b[54]!==e?(a=m.jsxs(m.Fragment,{children:[u,e]}),b[53]=u,b[54]=e,b[55]=a):a=b[55];return a}function r(a){return d("MWGroupMembershipListItemWrapper").tToRE({tag:"CommunityMember",value:a})}function s(a){return d("MWGroupMembershipListItemWrapper").tToRE({tag:"BroadcastChannelParticipant",value:a})}function t(a){return(l||(l=d("I64"))).equal(a.source,(k||(k=d("LSIntEnum"))).ofNumber(0))}g["default"]=a}),226);
__d("MWXIconFriendGenericCheckmark",["MWXSvgIcon","SVGIcon","cr:22342","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=d("MWXSvgIcon").mwxSvgIcon(d("SVGIcon").svgIcon(b("cr:22342")),c("gkx")("23219"));g["default"]=a}),98);
__d("MWCMInboxInfoMemberRequests.react",["fbt","Int64Hooks","MWCMRequestToJoinUtils","MWInboxInfoButton.react","MWInboxInfoMemberRequestsPushPage.react","MWXIconForListCell.react","MWXIconFriendGenericCheckmark","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(a){var b=d("react-compiler-runtime").c(13),e=a.pushPage,f=a.thread,g;b[0]!==e||b[1]!==f.threadKey?(a=function(a){if(e!=null)return e(function(b){return j.jsx(c("MWInboxInfoMemberRequestsPushPage.react"),{onReturn:b.onReturn,parentSurface:a,threadKey:f.threadKey})})},g=[e,f.threadKey],b[0]=e,b[1]=f.threadKey,b[2]=a,b[3]=g):(a=b[2],g=b[3]);var i=d("Int64Hooks").useCallbackInt64(a,g);b[4]!==f?(a=d("MWCMRequestToJoinUtils").memberRequestsMenuItemSubtitle(f),b[4]=f,b[5]=a):a=b[5];g=a;var k;b[6]===Symbol["for"]("react.memo_cache_sentinel")?(a=j.jsx(c("MWXIconForListCell.react"),{icon:c("MWXIconFriendGenericCheckmark")}),k=h._(/*BTDS*/"Member requests"),b[6]=a,b[7]=k):(a=b[6],k=b[7]);var l;b[8]!==i?(l=function(){return i()},b[8]=i,b[9]=l):l=b[9];b[10]!==g||b[11]!==l?(a=j.jsx(c("MWInboxInfoButton.react"),{addOnStart:a,label:k,onPress:l,subLabel:g}),b[10]=g,b[11]=l,b[12]=a):a=b[12];return a}g["default"]=a}),226);
__d("MWCMSubthreadlistMenuItem.react",["fbt","I64","MWInboxInfoButton.react","MWInboxInfoPanelContext.react","MWXIconForListCell.react","MWXIconMenuItemThread","ReQL","ReQLSuspense","intlSummarizeNumber","react","react-compiler-runtime","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l=k||d("react");function a(a){var b=d("react-compiler-runtime").c(8),e=a.threadKey,g=(i||(i=c("useReStore")))();a=(a=d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableAscending(g.tables.threads,["subthreadCount"]).getKeyRange(e)},[g,e],f.id+":29"))==null?void 0:a.subthreadCount;a=a!=null?"("+c("intlSummarizeNumber")((j||(j=d("I64"))).to_int32(a))+")":"";var k;b[0]!==a?(k=h._(/*BTDS*/"Sidechats {subthread_count}",[h._param("subthread_count",a)]),b[0]=a,b[1]=k):k=b[1];a=k;k=d("MWInboxInfoPanelContext.react").useMWInboxInfoPanelContext();var m=k.setShowSubthreadList;b[2]===Symbol["for"]("react.memo_cache_sentinel")?(k=l.jsx(c("MWXIconForListCell.react"),{icon:c("MWXIconMenuItemThread")}),b[2]=k):k=b[2];var n;b[3]!==m?(n=function(){m(!0)},b[3]=m,b[4]=n):n=b[4];b[5]!==n||b[6]!==a?(k=l.jsx(c("MWInboxInfoButton.react"),{addOnStart:k,label:a,onPress:n}),b[5]=n,b[6]=a,b[7]=k):k=b[7];return k}g["default"]=a}),226);
__d("MWChannelsPersonalInboxOptInPage.react",["fbt","CometPlaceholder.react","Int64Hooks","LSFactory","LSFetchDiscoverableChatsPersonalInboxInfoStoredProcedure","LSHideBroadcastChannelFromPersonalInboxStoredProcedure","LSShowBroadcastChannelInPersonalInboxStoredProcedure","Locale","MWAdminForBroadcastChannelUtils","MWLogBroadcastChannelFalcoEvent","MWXCircleButton.react","MWXColumn.react","MWXColumnItem.react","MWXGlimmer.react","MWXIconArrowLeft","MWXIconArrowRight","MWXListCell.react","MWXProfilePhoto.react","MWXRow.react","MWXRowItem.react","MWXSwitch.react","MWXText.react","MWXTextPairing.react","MWXThreadThemeColor","ReQL","ReQLSuspense","getLSMediaContactProfilePictureUrl","promiseDone","react","react-compiler-runtime","useReStore","useSinglePartialViewImpression"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||(j=d("react"));b=j;b.useCallback;var l=b.useId,m=b.useState,n={glimmerBase:{borderStartStartRadius:"xaur0o6",borderStartEndRadius:"x124ains",borderEndEndRadius:"x1ojmjj",borderEndStartRadius:"xj6tauk",marginInlineStart:"xdwrcjd",marginTop:"x1xmf6yo",$$css:!0},glimmerIcon:{height:"xc9qbxq",width:"x14qfxbe",$$css:!0},glimmerLabel:{height:"x17rw0jw",width:"x1dz1jew",$$css:!0}};function o(a){var b=d("react-compiler-runtime").c(34),e=a.channelCreator,g=a.personalInboxInfo,j=a.threadKey;a=m(g.isShownInPersonalInbox);var n=a[0],o=a[1];a=l();var p=(i||(i=c("useReStore")))(),q;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(q=h._(/*BTDS*/"Show channel in inbox"),b[0]=q):q=b[0];q=q;var r;b[1]!==p||b[2]!==j?(r=function(a){c("promiseDone")(a?p.runInTransaction(function(a){return c("LSShowBroadcastChannelInPersonalInboxStoredProcedure")(c("LSFactory")(a),{threadId:j})},"readwrite",void 0,void 0,f.id+":93"):p.runInTransaction(function(a){return c("LSHideBroadcastChannelFromPersonalInboxStoredProcedure")(c("LSFactory")(a),{threadId:j})},"readwrite",void 0,void 0,f.id+":101"),function(){o(a)})},b[1]=p,b[2]=j,b[3]=r):r=b[3];var s=r,t;b[4]!==j?(r=function(){d("MWLogBroadcastChannelFalcoEvent").logBroadcastChannelFalcoEvent({action:2,event:276,parentSurface:11,source:62,surface:16,threadFbid:j})},t=[j],b[4]=j,b[5]=r,b[6]=t):(r=b[5],t=b[6]);r=d("Int64Hooks").useCallbackInt64(r,t);b[7]!==r?(t={onImpressionStart:r},b[7]=r,b[8]=t):t=b[8];r=c("useSinglePartialViewImpression")(t);b[9]!==n||b[10]!==s?(t=function(){s(!n)},b[9]=n,b[10]=s,b[11]=t):t=b[11];var u;b[12]!==a||b[13]!==n||b[14]!==t?(u=k.jsx(c("MWXSwitch.react"),{"aria-describedby":a,"aria-label":q,onValueChange:t,size:"small",value:n}),b[12]=a,b[13]=n,b[14]=t,b[15]=u):u=b[15];b[16]!==e?(a=c("getLSMediaContactProfilePictureUrl")(e),b[16]=e,b[17]=a):a=b[17];b[18]!==a?(t=k.jsx(c("MWXProfilePhoto.react"),{size:36,source:{uri:a}}),b[18]=a,b[19]=t):t=b[19];b[20]===Symbol["for"]("react.memo_cache_sentinel")?(a=k.jsx(c("MWXTextPairing.react"),{headline:k.jsx(c("MWXText.react"),{type:"headline4",children:q}),level:4}),b[20]=a):a=b[20];b[21]!==r||b[22]!==u||b[23]!==t?(q=k.jsx(c("MWXRow.react"),{children:k.jsx(c("MWXRowItem.react"),{expanding:!0,children:k.jsx(c("MWXListCell.react"),{addOnEnd:u,addOnEndVerticalAlign:"center",addOnStart:t,content:a,ref:r,size:"large"})})}),b[21]=r,b[22]=u,b[23]=t,b[24]=q):q=b[24];b[25]===Symbol["for"]("react.memo_cache_sentinel")?(a={className:"x135b78x x11lfxj5"},b[25]=a):a=b[25];b[26]!==e.name||b[27]!==g.actingAccountName?(r=h._(/*BTDS*/"You can message as {page_name} while logged into {acting_account_name} on Messenger.",[h._param("page_name",e.name),h._param("acting_account_name",g.actingAccountName)]),b[26]=e.name,b[27]=g.actingAccountName,b[28]=r):r=b[28];b[29]!==r?(u=k.jsx(c("MWXRow.react"),{paddingHorizontal:16,paddingVertical:16,children:k.jsx(c("MWXRowItem.react"),{children:k.jsx("div",babelHelpers["extends"]({},a,{children:k.jsx(c("MWXText.react"),{color:"tertiary",type:"body4",children:r})}))})}),b[29]=r,b[30]=u):u=b[30];b[31]!==q||b[32]!==u?(t=k.jsxs(k.Fragment,{children:[q,u]}),b[31]=q,b[32]=u,b[33]=t):t=b[33];return t}function a(a){var b=d("react-compiler-runtime").c(24),e=a.onReturn,g=a.threadKey,j=(i||(i=c("useReStore")))();a=d("MWAdminForBroadcastChannelUtils").useFetchBroadcastChannelCreator(g);var l,m;b[0]!==j||b[1]!==g?(l=function(){c("promiseDone")(j.runInTransaction(function(a){return c("LSFetchDiscoverableChatsPersonalInboxInfoStoredProcedure")(c("LSFactory")(a),{threadKey:g})},"readwrite",void 0,void 0,f.id+":201"))},m=[j,g],b[0]=j,b[1]=g,b[2]=l,b[3]=m):(l=b[2],m=b[3]);d("Int64Hooks").useEffectInt64(l,m);b[4]!==j.tables.discoverable_chats_personal_inbox_info||b[5]!==g?(l=function(){return d("ReQL").fromTableAscending(j.tables.discoverable_chats_personal_inbox_info).getKeyRange(g)},b[4]=j.tables.discoverable_chats_personal_inbox_info,b[5]=g,b[6]=l):l=b[6];b[7]!==j||b[8]!==g?(m=[j,g],b[7]=j,b[8]=g,b[9]=m):m=b[9];l=d("ReQLSuspense").useFirst(l,m,f.id+":212");b[10]===Symbol["for"]("react.memo_cache_sentinel")?(m=d("MWXThreadThemeColor").mwxThreadThemeColor("var(--mwp-header-button-color)"),b[10]=m):m=b[10];var p;b[11]===Symbol["for"]("react.memo_cache_sentinel")?(p=h._(/*BTDS*/"Back"),b[11]=p):p=b[11];b[12]!==e?(m=k.jsx(c("MWXRowItem.react"),{children:k.jsx(c("MWXCircleButton.react"),{color:m,icon:d("Locale").isRTL()?c("MWXIconArrowRight"):c("MWXIconArrowLeft"),label:p,onPress:e,size:32,type:"deemphasized"})}),b[12]=e,b[13]=m):m=b[13];b[14]===Symbol["for"]("react.memo_cache_sentinel")?(p=k.jsx(c("MWXRowItem.react"),{children:k.jsx(c("MWXText.react"),{type:"headlineEmphasized2",children:h._(/*BTDS*/"Message from main profile")})}),b[14]=p):p=b[14];b[15]!==m?(e=k.jsx(c("MWXColumnItem.react"),{children:k.jsxs(c("MWXRow.react"),{align:"start",verticalAlign:"center",children:[m,p]})}),b[15]=m,b[16]=e):e=b[16];b[17]!==a||b[18]!==l||b[19]!==g?(p=k.jsx(c("MWXColumnItem.react"),{children:k.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MWChannelsPersonalInboxOptInPage",children:a!=null&&l!=null?k.jsx(o,{channelCreator:a,personalInboxInfo:l,threadKey:g}):k.jsxs(c("MWXRow.react"),{align:"center",expanding:!0,paddingHorizontal:16,paddingVertical:20,verticalAlign:"center",children:[k.jsx(c("MWXRowItem.react"),{children:k.jsx(c("MWXGlimmer.react"),{index:0,xstyle:[n.glimmerIcon,n.glimmerBase]})}),k.jsx(c("MWXRowItem.react"),{expanding:!0,children:k.jsx(c("MWXGlimmer.react"),{index:1,xstyle:[n.glimmerLabel,n.glimmerBase]})})]})})}),b[17]=a,b[18]=l,b[19]=g,b[20]=p):p=b[20];b[21]!==p||b[22]!==e?(m=k.jsxs(c("MWXColumn.react"),{expanding:!0,children:[e,p]}),b[21]=p,b[22]=e,b[23]=m):m=b[23];return m}g["default"]=a}),226);
__d("MWEncryptedBackupsThreadListNux_query.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[{kind:"RootArgument",name:"__relay_internal__pv__MWEBNewUserOnboardingShouldLoadUpsellsrelayprovider"}],kind:"Fragment",metadata:null,name:"MWEncryptedBackupsThreadListNux_query",selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"xfb_backup",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"useMWEncryptedBackupsGetVirtualDevicesPreloaded_xfbEncryptedBackup"},{alias:null,args:[{kind:"Literal",name:"family_device_id",value:""}],kind:"ScalarField",name:"has_otc_eligible_devices",storageKey:'has_otc_eligible_devices(family_device_id:"")'}],storageKey:null},{kind:"RequiredField",field:{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerDefaultEncryptedBackup",kind:"LinkedField",name:"messenger_default_encrypted_backup",plural:!1,selections:[{alias:null,args:null,concreteType:"VestaGetUserInfoResponse",kind:"LinkedField",name:"vesta_user_info",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"useMWChatEncryptedBackupsVestaUserInfo_vestaGetUserInfoResponse"}],storageKey:null}],storageKey:null},{condition:"__relay_internal__pv__MWEBNewUserOnboardingShouldLoadUpsellsrelayprovider",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"if_viewer_can_see_messenger_eb_new_user_onboarding_upsells",plural:!1,selections:[{args:null,documentName:"MWEncryptedBackupsThreadListNux_query",fragmentName:"MWEBNewUserOnboardingThreadListUpsellWrapper_viewer",fragmentPropName:"viewer",kind:"ModuleImport"}],storageKey:null}]}],storageKey:null},action:"THROW",path:"viewer"},{kind:"Defer",selections:[{args:null,kind:"FragmentSpread",name:"MWEncryptedBackupsThreadListRestoreQPWrapperDeferred_query"}]}],type:"Query",abstractKey:null};e.exports=a}),null);
__d("MWEncryptedBackupsThreadListNux.react",["CometPlaceholder.react","CometRelay","JSResourceForInteraction","MWChatEncryptedBackupsQPLSource.enum","MWEBEntrypointsKillswitch.enum","MWEBMobileOnboardingEligibility","MWEBVestaUserInfoContext.react","MWEBVirtualDevicesContextProvider.react","MWEncryptedBackupsThreadListNux_query.graphql","MWEncryptedBackupsThreadListQPWrapper.react","cr:10269","cr:20045","cr:2046","react","react-compiler-runtime","useMWChatEncryptedBackupsVestaUserInfo","useMWEBBackupState","useMWEncryptedBackupsGetVirtualDevicesPreloaded"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||(i=d("react"));i.useMemo;var k=d("MWEBMobileOnboardingEligibility").requireMobileOnboardingIfEligible(c("JSResourceForInteraction")("MWEBMobileOnboardingQPBannerWrapper.react").__setRef("MWEncryptedBackupsThreadListNux.react"));function l(a){var e,f,g,i=d("react-compiler-runtime").c(22),k=a.children;a=a.fragmentKey;a=d("CometRelay").useFragment(h!==void 0?h:h=b("MWEncryptedBackupsThreadListNux_query.graphql"),a);var l;i[0]===Symbol["for"]("react.memo_cache_sentinel")?(l={entrypoint:c("MWEBEntrypointsKillswitch.enum").INBOX_THREADLIST},i[0]=l):l=i[0];l=c("useMWEBBackupState")(l);e=(e=a.viewer.messenger_default_encrypted_backup)==null?void 0:e.vesta_user_info;var n;i[1]!==e?(n={vestaGetUserInfoResponse$key:e},i[1]=e,i[2]=n):n=i[2];e=c("useMWChatEncryptedBackupsVestaUserInfo")(n);i[3]!==e.attemptsRemaining||i[4]!==e.loginTimeoutRemainingSecs?(n={attemptsRemaining:e.attemptsRemaining,loginTimeoutRemainingSecs:e.loginTimeoutRemainingSecs,vestaClientID:null},i[3]=e.attemptsRemaining,i[4]=e.loginTimeoutRemainingSecs,i[5]=n):n=i[5];e=n;n=e;e=a==null?void 0:a.xfb_backup;var o;i[6]!==e?(o={encryptedBackup:e},i[6]=e,i[7]=o):o=i[7];e=c("useMWEncryptedBackupsGetVirtualDevicesPreloaded")(o);o=e.getVirtualDevices;i[8]!==o?(e=o(),i[8]=o,i[9]=e):e=i[9];o=e;e=o.offlineDevicesCount;o=o.vestaClientID;f=(f=a==null||(g=a.xfb_backup)==null?void 0:g.has_otc_eligible_devices)!=null?f:void 0;var p;i[10]!==l||i[11]!==k||i[12]!==a?(p=j.jsx(m,{backupState:l,children:k,fragment:a}),i[10]=l,i[11]=k,i[12]=a,i[13]=p):p=i[13];i[14]!==p||i[15]!==n?(l=j.jsx(d("MWEBVestaUserInfoContext.react").MWEBVestaUserInfoContext.Provider,{value:n,children:p}),i[14]=p,i[15]=n,i[16]=l):l=i[16];i[17]!==e||i[18]!==l||i[19]!==f||i[20]!==o?(k=j.jsx(c("MWEBVirtualDevicesContextProvider.react"),{hasOtcEligibleDevicesInitialValue:f,offlineDevicesCountInitialValue:e,vestaClientIDInitialValue:o,children:l}),i[17]=e,i[18]=l,i[19]=f,i[20]=o,i[21]=k):k=i[21];return k}function m(a){var e=d("react-compiler-runtime").c(8),f=a.backupState,g=a.children;a=a.fragment;switch(f){case 4:e[0]!==g||e[1]!==a?(f=b("cr:2046")!=null?j.jsx(b("cr:2046"),{fragmentKey:a,trigger:d("MWEncryptedBackupsThreadListQPWrapper.react").MWEncryptedBackupsQPTrigger.THREAD_LIST,children:g}):g,e[0]=g,e[1]=a,e[2]=f):f=e[2];return f;case 1:return null;case 2:e[3]!==g?(f=b("cr:20045")?j.jsx(b("cr:20045"),{source:c("MWChatEncryptedBackupsQPLSource.enum").INBOX_THREADLIST_QP,children:g}):g,e[3]=g,e[4]=f):f=e[4];f=f;var h;e[5]!==f||e[6]!==a.viewer.if_viewer_can_see_messenger_eb_new_user_onboarding_upsells?(h=a.viewer.if_viewer_can_see_messenger_eb_new_user_onboarding_upsells?j.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MWEncryptedBackupsJewelNuxWrapper.OnboardingThreadListQP",children:j.jsx(d("CometRelay").MatchContainer,{match:a.viewer.if_viewer_can_see_messenger_eb_new_user_onboarding_upsells,props:{bannerSource:c("MWChatEncryptedBackupsQPLSource.enum").INBOX_THREADLIST_PERSISTENT_BANNER,children:f,qpSource:c("MWChatEncryptedBackupsQPLSource.enum").INBOX_THREADLIST_ONBOARDING_QP}})}):b("cr:10269")?j.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MWEncryptedBackupsThreadListNux.OnboardingThreadListQP",children:j.jsx(b("cr:10269"),{source:c("MWChatEncryptedBackupsQPLSource.enum").INBOX_THREADLIST_QP,children:f})}):j.jsx(k,{fallback:f,props:{children:f,source:c("MWChatEncryptedBackupsQPLSource.enum").INBOX_THREADLIST_ONBOARDING_QP,trigger:d("MWEncryptedBackupsThreadListQPWrapper.react").MWEncryptedBackupsQPTrigger.THREAD_LIST}}),e[5]=f,e[6]=a.viewer.if_viewer_can_see_messenger_eb_new_user_onboarding_upsells,e[7]=h):h=e[7];return h;default:return g}}function a(a){var b=d("react-compiler-runtime").c(3),e=a.children;a=a.fragmentKey;var f;b[0]!==e||b[1]!==a?(f=j.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MWEncryptedBackupsThreadListNux.Query",children:j.jsx(l,{fragmentKey:a,children:e})}),b[0]=e,b[1]=a,b[2]=f):f=b[2];return f}g["default"]=a}),98);
__d("MWFDSAccountSwitch.svg.react",["cr:21518"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:21518")}),98);
__d("MWFDSFriendGenericCheckmark.svg.react",["cr:21666"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:21666")}),98);
__d("MWFDSMenuItemAppGroups.svg.react",["cr:21829"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:21829")}),98);
__d("MWFDSQuestionChat.svg.react",["FBIconQuestionChatFilled12.svg.react"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("FBIconQuestionChatFilled12.svg.react")}),98);
__d("MWLSMemberAddModes",[],(function(a,b,c,d,e,f){"use strict";a=0;b=1;c=Object.freeze({ADMINS_ONLY:a,ALL_MEMBERS:b});f.MemberAddModes=c}),66);
__d("MWGroupOptionsSection.react",["fbt","JSResourceForInteraction","MWLSMemberAddModes","MWXIconForListCell.react","MWXIconFriendGenericAdd","MWXListCellPressable.react","MWXText.react","MWXTextPairing.react","emptyFunction","react","react-compiler-runtime","useMWXLazyDialog"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;var k=b.useEffect,l=b.useState,m=c("JSResourceForInteraction")("MWLSWhoCanAddMembersDialog.react").__setRef("MWGroupOptionsSection.react"),n=h._(/*BTDS*/"Who can add people");function a(a){var b=d("react-compiler-runtime").c(23),e=a.renderingTracker,f=a.thread;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(a={mode:"admin_add",title:h._(/*BTDS*/"Admins only")},b[0]=a):a=b[0];b[1]===Symbol["for"]("react.memo_cache_sentinel")?(a=[a,{mode:"all_member_add",title:h._(/*BTDS*/"All Members")}],b[1]=a):a=b[1];var g=a,i=o;a=(a=f.needsAdminApprovalForNewParticipant)!=null?a:!1;var p;b[2]!==a?(p=i(a),b[2]=a,b[3]=p):p=b[3];a=l(p);var q=a[0],r=a[1];b[4]!==f.needsAdminApprovalForNewParticipant?(p=function(){var a;r(i((a=f.needsAdminApprovalForNewParticipant)!=null?a:!1))},a=[f.needsAdminApprovalForNewParticipant],b[4]=f.needsAdminApprovalForNewParticipant,b[5]=p,b[6]=a):(p=b[5],a=b[6]);k(p,a);p=c("useMWXLazyDialog")(m);var s=p[0];b[7]!==e||b[8]!==q||b[9]!==s||b[10]!==f?(a=function(){if(f==null)return;s({renderingTracker:e,selectedMemberMode:q,thread:f,whoCanAddMembersOptions:g},c("emptyFunction"))},b[7]=e,b[8]=q,b[9]=s,b[10]=f,b[11]=a):a=b[11];var t=a;b[12]===Symbol["for"]("react.memo_cache_sentinel")?(p=j.jsx(c("MWXIconForListCell.react"),{icon:c("MWXIconFriendGenericAdd"),size:"large"}),b[12]=p):p=b[12];a=g[q];var u;b[13]!==a.title?(u=j.jsx(c("MWXText.react"),{color:"secondary",type:"body4",children:a.title}),b[13]=a.title,b[14]=u):u=b[14];b[15]===Symbol["for"]("react.memo_cache_sentinel")?(a=j.jsx(c("MWXText.react"),{type:"headline4",children:n}),b[15]=a):a=b[15];b[16]!==u?(a=j.jsx(c("MWXTextPairing.react"),{body:u,headline:a,level:4}),b[16]=u,b[17]=a):a=b[17];b[18]!==t?(u=function(){return t()},b[18]=t,b[19]=u):u=b[19];b[20]!==a||b[21]!==u?(p=j.jsx(c("MWXListCellPressable.react"),{addOnStart:p,content:a,onPress:u,size:"medium",testid:void 0}),b[20]=a,b[21]=u,b[22]=p):p=b[22];return p}function o(a){return a===!0?d("MWLSMemberAddModes").MemberAddModes.ADMINS_ONLY:d("MWLSMemberAddModes").MemberAddModes.ALL_MEMBERS}g["default"]=a}),226);
__d("MWInboxInfoChannelCreatorProfileLink.react",["fbt","CometPageVerificationIcon.react","CurrentEnvironment","I64","LSContactBitOffset","MWAdminForBroadcastChannelUtils","MWXListCellPressable.react","MWXProfilePhoto.react","MWXText.react","MWXTextPairing.react","XCometProfileControllerRouteBuilder","getLSMediaContactProfilePictureUrl","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=i||d("react"),l={creatorBadge:{display:"xt0psk2",marginInlineStart:"xdwrcjd",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(24);a=a.threadKey;a=d("MWAdminForBroadcastChannelUtils").useFetchBroadcastChannelCreator(a);if(a==null)return null;if(b[0]!==a.id){var e;e=(e=c("XCometProfileControllerRouteBuilder").buildUri({id:(j||(j=d("I64"))).to_string(a.id)}).setDomain("www.facebook.com"))==null||(e=e.setProtocol("https"))==null?void 0:e.toString();b[0]=a.id;b[1]=e}else e=b[1];e=e;var f=c("CurrentEnvironment").messengerdotcom?"_blank":"_self",g;b[2]!==a?(g=d("LSContactBitOffset").has(23,a!=null?a:{}),b[2]=a,b[3]=g):g=b[3];g=g;var i;b[4]!==a?(i=c("getLSMediaContactProfilePictureUrl")(a),b[4]=a,b[5]=i):i=b[5];var m;b[6]!==i?(m=k.jsx(c("MWXProfilePhoto.react"),{size:36,source:{uri:i}}),b[6]=i,b[7]=m):m=b[7];b[8]!==a.name?(i=k.jsx(c("MWXText.react"),{type:"headline4",children:a.name}),b[8]=a.name,b[9]=i):i=b[9];b[10]!==g?(a=g?k.jsx(c("CometPageVerificationIcon.react"),{size:"small",verificationBadge:"BLUE_VERIFIED",xstyle:l.creatorBadge}):null,b[10]=g,b[11]=a):a=b[11];b[12]!==i||b[13]!==a?(g=k.jsxs(k.Fragment,{children:[i,a]}),b[12]=i,b[13]=a,b[14]=g):g=b[14];b[15]===Symbol["for"]("react.memo_cache_sentinel")?(i=h._(/*BTDS*/"_j[\"Channel admin\",\"91d783db2fb886ee4801ae5e0a86e04c\",1]"),b[15]=i):i=b[15];b[16]!==g?(a=k.jsx(c("MWXTextPairing.react"),{headline:g,level:4,meta:i}),b[16]=g,b[17]=a):a=b[17];b[18]!==e?(i={target:f,url:e},b[18]=e,b[19]=i):i=b[19];b[20]!==i||b[21]!==m||b[22]!==a?(g=k.jsx(c("MWXListCellPressable.react"),{addOnStart:m,addOnStartVerticalAlign:"top",content:a,linkProps:i,size:"medium"}),b[20]=i,b[21]=m,b[22]=a,b[23]=g):g=b[23];return g}g["default"]=a}),226);
__d("MWXIconAccountSwitch",["MWXSvgIcon","SVGIcon","cr:22171","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=d("MWXSvgIcon").mwxSvgIcon(d("SVGIcon").svgIcon(b("cr:22171")),c("gkx")("23219"));g["default"]=a}),98);
__d("MWInboxInfoChannelPersonalInboxOptIn.react",["fbt","Int64Hooks","MWChannelsPersonalInboxOptInPage.react","MWInboxInfoButton.react","MWXIconAccountSwitch","MWXIconForListCell.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(a){var b=d("react-compiler-runtime").c(8),e=a.pushPage,f=a.thread,g;b[0]!==e||b[1]!==f.threadKey?(a=function(){return e(function(a){return j.jsx(c("MWChannelsPersonalInboxOptInPage.react"),{onReturn:a.onReturn,threadKey:f.threadKey})})},g=[e,f.threadKey],b[0]=e,b[1]=f.threadKey,b[2]=a,b[3]=g):(a=b[2],g=b[3]);var i=d("Int64Hooks").useCallbackInt64(a,g);b[4]===Symbol["for"]("react.memo_cache_sentinel")?(a=j.jsx(c("MWXIconForListCell.react"),{icon:c("MWXIconAccountSwitch")}),g=h._(/*BTDS*/"Message from main profile"),b[4]=a,b[5]=g):(a=b[4],g=b[5]);b[6]!==i?(a=j.jsx(c("MWInboxInfoButton.react"),{addOnStart:a,label:g,onPress:function(){return i()},subLabel:void 0}),b[6]=i,b[7]=a):a=b[7];return a}g["default"]=a}),226);
__d("MWInboxInfoEventsListSection.react",["fbt","GroupsCometChatsEngagementLogger","I64","LSCommunityBitOffset","MWCMGetValidId","MWInboxInfoSubPageHeader.react","MWLSThread","MWXButton.react","MWXCircleButton.react","MWXColumn.react","MWXColumnItem.react","MWXIconAppFacebook","MWXImage.react","MWXListCellPressable.react","MWXScrollableArea.react","MWXTextPairing.react","ReQL","ReQLSuspense","XCometEventCreateControllerRouteBuilder","XCometEventPermalinkControllerRouteBuilder","formatDate","react","react-compiler-runtime","useCommunityFolder","useGroupsCometChatsEngagementImpressionLogger","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l=j||(j=d("react"));b=j;var m=b.useCallback,n=b.useRef,o={eventImage:{borderStartStartRadius:"x1rgw4pv",borderStartEndRadius:"x1vjm0to",borderEndEndRadius:"xnqoqkk",borderEndStartRadius:"x16lu3ki",marginInlineEnd:"xbmvrgn",$$css:!0}};function p(a){var b=d("react-compiler-runtime").c(34),e=a.commonLoggingData;a=a.event;var f=a.eventId,g=a.eventName,i=a.eventPictureUrl,j=a.eventPictureUrlFallback,m=a.numGoingUsers,n=a.numInterestedUsers;a=a.startTimeMs;var p;b[0]!==m?(p=(k||(k=d("I64"))).to_string(m),b[0]=m,b[1]=p):p=b[1];m=p;p=(k||(k=d("I64"))).to_string(n);n=i!=null?i:j;if(b[2]!==a){i=a!=null?(k||(k=d("I64"))).to_float(a):0;j=new Date(i);var q=c("formatDate")(j,"M d");j=c("formatDate")(j,"g:ia");q=h._(/*BTDS*/"{Event start day} at {Event start time}",[h._param("Event start day",q),h._param("Event start time",j)]);b[2]=a;b[3]=i;b[4]=q}else i=b[3],q=b[4];j=q;a=i<=Date.now()&&i!==0;b[5]!==m?(q=h._(/*BTDS*/"_j{\"*\":\"{number} went\",\"_1\":\"1 went\"}",[h._plural(Number(m),"number")]),b[5]=m,b[6]=q):q=b[6];i=q;if(b[7]!==a||b[8]!==m||b[9]!==p||b[10]!==i){q=h._(/*BTDS*/"_j{\"*\":\"{number} going\",\"_1\":\"1 going\"}",[h._plural(Number(m),"number")]);var r=h._(/*BTDS*/"_j{\"*\":\"{number} interested\",\"_1\":\"1 interested\"}",[h._plural(Number(p),"number")]);q=a?i:q.toString()+" \u2022\xa0"+r.toString();b[7]=a;b[8]=m;b[9]=p;b[10]=i;b[11]=q}else q=b[11];r=q;if(b[12]!==f){m=(a=c("XCometEventPermalinkControllerRouteBuilder").buildUri({event_id:(k||(k=d("I64"))).to_string(f)}).setProtocol("https"))==null||(a=a.setDomain("www.facebook.com"))==null?void 0:a.toString();b[12]=f;b[13]=m}else m=b[13];p=m;b[14]!==r||b[15]!==g||b[16]!==j?(i=l.jsx(c("MWXTextPairing.react"),{body:j,bodyColor:"secondary",bodyLineLimit:2,headline:g,level:4,meta:r}),b[14]=r,b[15]=g,b[16]=j,b[17]=i):i=b[17];q=i;b[18]!==n?(a=l.jsx(c("MWXImage.react"),{height:50,src:n,xstyle:o.eventImage}),b[18]=n,b[19]=a):a=b[19];m=a;b[20]===Symbol["for"]("react.memo_cache_sentinel")?(r=h._(/*BTDS*/"Go to Facebook event"),b[20]=r):r=b[20];b[21]!==p?(g={target:"_blank",url:p},b[21]=p,b[22]=g):g=b[22];b[23]!==e||b[24]!==f?(j=function(){d("GroupsCometChatsEngagementLogger").log(babelHelpers["extends"]({},e,{action:"tap",client_extras:{event_id:(k||(k=d("I64"))).to_string(f)},event:"transition_to_fb_group",parent_surface:"thread_view",source:"event_row",surface:"unknown"}))},b[23]=e,b[24]=f,b[25]=j):j=b[25];b[26]!==g||b[27]!==j?(i=l.jsx(c("MWXCircleButton.react"),{icon:c("MWXIconAppFacebook"),label:r,linkProps:g,onPress:j,size:40}),b[26]=g,b[27]=j,b[28]=i):i=b[28];n="mwcm-event-row-"+k.to_string(f);b[29]!==q||b[30]!==m||b[31]!==i||b[32]!==n?(a=l.jsx(c("MWXListCellPressable.react"),{addOnEnd:i,addOnStart:m,content:q,size:"medium",testid:void 0}),b[29]=q,b[30]=m,b[31]=i,b[32]=n,b[33]=a):a=b[33];return a}function q(a){a=Array.from(a).sort(function(a,b){var c;if((k||(k=d("I64"))).lt((c=a==null?void 0:a.startTimeMs)!=null?c:(k||(k=d("I64"))).zero,(c=b==null?void 0:b.startTimeMs)!=null?c:(k||(k=d("I64"))).zero))return-1;return(k||(k=d("I64"))).gt((c=a==null?void 0:a.startTimeMs)!=null?c:(k||(k=d("I64"))).zero,(a=b==null?void 0:b.startTimeMs)!=null?a:(k||(k=d("I64"))).zero)?1:0});var b=[],c=[];a.forEach(function(a){if(a==null)return a;var e=a.startTimeMs!=null?(k||(k=d("I64"))).to_float(a.startTimeMs):-1;e=e<=Date.now()&&e!==-1;e?b.push(a):c.push(a)});return c.concat(b)}function a(a){var b=a.loggingParentSurface,e=a.loggingSource,g=a.onReturn,j=a.threadKey,o=(i||(i=c("useReStore")))();a=d("MWLSThread").useThreadExn(j);var r=c("useCommunityFolder")(a),s=d("ReQLSuspense").useArray(function(){return d("ReQL").fromTableAscending(o.tables.cm_channel_events.index("eventsInThread")).getKeyRange(j).map(function(a){return d("ReQLSuspense").first(d("ReQL").fromTableAscending(o.tables.fb_events).getKeyRange(a.eventId),f.id+":239")})},[o,j],f.id+":234"),t=r!=null&&d("LSCommunityBitOffset").has(52,r),u=n(!1),v=m(function(){u.current=!0;return g()},[g]),w=h._(/*BTDS*/"Events");t=!u.current&&t;a=(a=c("XCometEventCreateControllerRouteBuilder").buildUri({group_id:r!=null?(k||(k=d("I64"))).to_string(r.fbGroupId):void 0,group_thread_id:(k||(k=d("I64"))).to_string(a.threadKey)}).setProtocol("https"))==null||(a=a.setDomain("www.facebook.com"))==null?void 0:a.toString();var x={group_id:d("MWCMGetValidId").MWCMHasValidFbGroupId(r==null?void 0:r.fbGroupId)?(k||(k=d("I64"))).to_string(r.fbGroupId):null,surface:"event_list",thread_id:(k||(k=d("I64"))).to_string(j)};r=q(s);s=c("useGroupsCometChatsEngagementImpressionLogger")(babelHelpers["extends"]({},x,{client_extras:{event_id_list:r.map(function(a){return(k||(k=d("I64"))).to_string(a.eventId)}).join(",")},event:"event_list_rendered",parent_surface:b,source:e}));return l.jsxs("div",babelHelpers["extends"]({className:"x78zum5 x1r8uery xdt5ytf x1iyjqo2 xs83m0k x2lwn1j"},{children:[l.jsx(c("MWInboxInfoSubPageHeader.react"),{onPressBack:v,title:w}),l.jsx("div",babelHelpers["extends"]({className:"x78zum5 xdt5ytf xs83m0k x2lwn1j"},{children:l.jsx(c("MWXScrollableArea.react"),{expanding:!0,children:l.jsx(c("MWXColumn.react"),{hasDividers:!1,paddingHorizontal:8,ref:s,spacing:20,children:r.map(function(a){return l.jsx(c("MWXColumnItem.react"),{children:l.jsx(p,{commonLoggingData:x,event:a})},(k||(k=d("I64"))).to_string(a.eventId))})})})})),t&&l.jsx("div",babelHelpers["extends"]({className:"xyamay9 x1l90r2v xf7dkkf xv54qhq"},{children:l.jsx(c("MWXButton.react"),{label:h._(/*BTDS*/"Create new event"),linkProps:{target:"_blank",url:a},onPress:function(){d("GroupsCometChatsEngagementLogger").log(babelHelpers["extends"]({},x,{action:"tap",event:"create_event_clicked",parent_surface:"thread_settings",source:"create_new_event_button"}))},type:"secondary"})}))]}))}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("MWInboxInfoViewArchivedOpenThread.react",["fbt","I64","LSMessagingThreadTypeUtil","MAWThreadCutover","MWInboxInfoButton.react","MWXIconForListCell.react","MWXIconMessage","react","react-compiler-runtime","requireDeferred","useMWEntrypoint","useMWRedirectToOpenThreadOfDualThread"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=i||d("react"),l=c("requireDeferred")("MessageThreadEventsFalcoEvent").__setRef("MWInboxInfoViewArchivedOpenThread.react"),m=h._(/*BTDS*/"View archived messages");function a(a){var b=d("react-compiler-runtime").c(10);a=a.thread;var e=a.threadKey,f=a.threadType,g=d("MAWThreadCutover").useIsCutoverSecureThread(e),h=c("useMWRedirectToOpenThreadOfDualThread")(e),i=c("useMWEntrypoint")();b[0]!==f?(a=d("LSMessagingThreadTypeUtil").isArmadilloSecure(f),b[0]=f,b[1]=a):a=b[1];var n=a;b[2]===Symbol["for"]("react.memo_cache_sentinel")?(a=k.jsx(c("MWXIconForListCell.react"),{icon:c("MWXIconMessage")}),b[2]=a):a=b[2];b[3]!==i||b[4]!==g||b[5]!==n||b[6]!==h||b[7]!==e||b[8]!==f?(a=k.jsx(c("MWInboxInfoButton.react"),{addOnStart:a,label:m,onPress:function(){l.onReady(function(a){return a.log(function(){return{entry_point:i,event_type:"secret_conversation_post_cutover_thread_detail_entry_point_click_event",is_cutover:g,thread_id:(j||(j=d("I64"))).to_string(e),thread_type:j.to_string(f),transport_type:n?"ACT":"MI"}})}),h()},testid:void 0}),b[3]=i,b[4]=g,b[5]=n,b[6]=h,b[7]=e,b[8]=f,b[9]=a):a=b[9];return a}g["default"]=a}),226);
__d("MWInboxInfoViewPinnedMessages.react",["fbt","JSResourceForInteraction","LSMessagingThreadTypeUtil","MWBroadcastChannelLoggingShapes","MWInboxInfoButton.react","MWLogBroadcastChannelFalcoEvent","MWPBumpEntityKey","MWXIconForListCell.react","MWXIconPushpin","react","react-compiler-runtime","useMWXLazyDialog"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react"),k=h._(/*BTDS*/"View pinned messages"),l=c("JSResourceForInteraction")("MWPinnedMessagesDialog.react").__setRef("MWInboxInfoViewPinnedMessages.react");function a(a){var b=d("react-compiler-runtime").c(13),e=a.thread;a=c("useMWXLazyDialog")(l);var f=a[0];b[0]!==e.threadKey||b[1]!==e.threadType?(a={eventName:"open_view_pinned_messages_dialog",threadKey:e.threadKey,threadType:e.threadType},b[0]=e.threadKey,b[1]=e.threadType,b[2]=a):a=b[2];a=a;var g;b[3]!==e.threadType?(g=d("LSMessagingThreadTypeUtil").isDiscoverablePublicBroadcastChannel(e.threadType),b[3]=e.threadType,b[4]=g):g=b[4];var h=g;b[5]===Symbol["for"]("react.memo_cache_sentinel")?(g=j.jsx(c("MWXIconForListCell.react"),{icon:c("MWXIconPushpin")}),b[5]=g):g=b[5];var i;b[6]!==h||b[7]!==f||b[8]!==e.threadKey?(i=function(){d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw.infobar","view_pinned_messages"),h&&d("MWLogBroadcastChannelFalcoEvent").logBroadcastChannelFalcoEvent(babelHelpers["extends"]({},d("MWBroadcastChannelLoggingShapes").VIEW_PINNED_MESSAGES_FROM_THREAD_DETAIL,{threadFbid:e.threadKey})),f({threadKey:e.threadKey})},b[6]=h,b[7]=f,b[8]=e.threadKey,b[9]=i):i=b[9];b[10]!==a||b[11]!==i?(g=j.jsx(c("MWInboxInfoButton.react"),{addOnStart:g,label:k,loggingEvent:a,onPress:i,testid:void 0}),b[10]=a,b[11]=i,b[12]=g):g=b[12];return g}g["default"]=a}),226);
__d("MWInboxInfoGroupInfoSection.react",["LSCommunityBitOffset","MWBroadcastChannelBestPracticesMenuItem.react","MWCMInboxInfoGroupEventsButton.react","MWCMInboxInfoGroupLink.react","MWCMInboxInfoMemberRequests.react","MWCMSubthreadlistMenuItem.react","MWInboxInfoChannelCreatorProfileLink.react","MWInboxInfoChannelPersonalInboxOptIn.react","MWInboxInfoViewArchivedOpenThread.react","MWInboxInfoViewPinnedMessages.react","MWPActor.react","cr:10951","cr:3773","gkx","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var e=d("react-compiler-runtime").c(59),f=a.pushPage,g=a.thread;a=a.utilities;var h=a.folder,k=a.inviteLink,l=a.isAdmin,m=a.isChannel,n=a.isSMCC,o=a.shouldShowPinnedMessagesLink,p=a.shouldShowViewArchivedOpenThread,q=a.showCMMemberRequestsMenuItem,r=a.showPublicChatMemberRequests;a=a.showSubthreadListButton;var s;e[0]!==l||e[1]!==m?(s=m&&l&&d("MWPActor.react").isAPPlus(),e[0]=l,e[1]=m,e[2]=s):s=e[2];s=s;var t;e[3]!==l||e[4]!==m?(t=m&&l&&d("MWPActor.react").isPromode(),e[3]=l,e[4]=m,e[5]=t):t=e[5];l=t;e[6]!==m||e[7]!==g?(t=m?i.jsx(c("MWInboxInfoChannelCreatorProfileLink.react"),{threadKey:g.threadKey},"creator-profile"):null,e[6]=m,e[7]=g,e[8]=t):t=e[8];e[9]!==s||e[10]!==f||e[11]!==g?(m=s?i.jsx(c("MWInboxInfoChannelPersonalInboxOptIn.react"),{pushPage:f,thread:g},"channel-personal-inbox"):null,e[9]=s,e[10]=f,e[11]=g,e[12]=m):m=e[12];var u;e[13]!==h?(u=h!=null&&d("LSCommunityBitOffset").has(3,h)?i.jsx(c("MWCMInboxInfoGroupLink.react"),{folder:h},"group-link"):null,e[13]=h,e[14]=u):u=e[14];var v;e[15]!==a||e[16]!==g?(v=a?i.jsx(c("MWCMSubthreadlistMenuItem.react"),{threadKey:g.threadKey},"subthreads-button"):null,e[15]=a,e[16]=g,e[17]=v):v=e[17];a=k!=null?k:null;e[18]!==h||e[19]!==n||e[20]!==f||e[21]!==g?(k=h!=null&&!n?i.jsx(c("MWCMInboxInfoGroupEventsButton.react"),{pushPage:f,threadKey:g.threadKey},"events-button"):null,e[18]=h,e[19]=n,e[20]=f,e[21]=g,e[22]=k):k=e[22];e[23]!==o||e[24]!==g?(h=o?i.jsx(c("MWInboxInfoViewPinnedMessages.react"),{thread:g},"pin"):null,e[23]=o,e[24]=g,e[25]=h):h=e[25];e[26]!==p||e[27]!==g?(n=p?i.jsx(c("MWInboxInfoViewArchivedOpenThread.react"),{thread:g},"archived-open-thread"):null,e[26]=p,e[27]=g,e[28]=n):n=e[28];e[29]!==f||e[30]!==r||e[31]!==g?(o=r&&b("cr:3773")!=null?i.jsx(b("cr:3773"),{pushPage:f,thread:g},"reqs"):null,e[29]=f,e[30]=r,e[31]=g,e[32]=o):o=e[32];e[33]!==f||e[34]!==q||e[35]!==g?(p=q?i.jsx(c("MWCMInboxInfoMemberRequests.react"),{pushPage:f,thread:g},"cm-member-requests"):null,e[33]=f,e[34]=q,e[35]=g,e[36]=p):p=e[36];e[37]!==s||e[38]!==l||e[39]!==g?(r=(s||l)&&b("cr:10951")!=null&&!c("gkx")("23433")?i.jsx(b("cr:10951"),{threadKey:g.threadKey},"channel-insights"):null,e[37]=s,e[38]=l,e[39]=g,e[40]=r):r=e[40];e[41]!==s||e[42]!==l||e[43]!==f||e[44]!==g?(q=s||l?i.jsx(c("MWBroadcastChannelBestPracticesMenuItem.react"),{pushPage:f,thread:g},"channel-best-practices"):null,e[41]=s,e[42]=l,e[43]=f,e[44]=g,e[45]=q):q=e[45];e[46]!==n||e[47]!==o||e[48]!==p||e[49]!==r||e[50]!==q||e[51]!==t||e[52]!==m||e[53]!==u||e[54]!==v||e[55]!==a||e[56]!==k||e[57]!==h?(s=[t,m,u,v,a,k,h,n,o,p,r,q],e[46]=n,e[47]=o,e[48]=p,e[49]=r,e[50]=q,e[51]=t,e[52]=m,e[53]=u,e[54]=v,e[55]=a,e[56]=k,e[57]=h,e[58]=s):s=e[58];l=s;f=l.some(j);return f?l:null}function j(a){return a!=null}g["default"]=a}),98);
__d("MWInboxInfoLimitSharingPage.react",["fbt","FBLogger","I64","Int64Hooks","LSFactory","LSMessagingThreadTypeUtil","LSOptimisticSetLimitSharingStoredProcedure","MWInboxInfoSubPageHeader.react","MWXColumn.react","MWXColumnItem.react","MWXLink.react","MWXListCell.react","MWXSwitch.react","MWXText.react","MWXTextPairing.react","coerceMessagingThreadTypeToLSThreadType","promiseDone","react","react-compiler-runtime","requireDeferred","useJSON","useReStore","useSinglePartialViewImpression","useThreadMetadata"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l=k||(k=d("react")),m=k.useId,n=c("requireDeferred")("MessagingAiAgentInteractionsFalcoEvent").__setRef("MWInboxInfoLimitSharingPage.react");function a(a){var b=d("react-compiler-runtime").c(43),e=a.onReturn,g=a.thread;a=m();var k=(i||(i=c("useReStore")))(),o=c("useThreadMetadata")(g.threadKey),p;b[0]!==g.threadType?(p=d("LSMessagingThreadTypeUtil").isArmadilloSecure(g.threadType),b[0]=g.threadType,b[1]=p):p=b[1];var q=p,r;b[2]!==q||b[3]!==g.threadKey||b[4]!==g.threadType?(p=function(){n.onReady(function(a){return a.log(function(){return{action_type:1,is_e2ee:q,thread_id:(j||(j=d("I64"))).to_string(g.threadKey),thread_type:c("coerceMessagingThreadTypeToLSThreadType")(g.threadType),view_name:80}})})},r=[q,g.threadKey,g.threadType],b[2]=q,b[3]=g.threadKey,b[4]=g.threadType,b[5]=p,b[6]=r):(p=b[5],r=b[6]);p=d("Int64Hooks").useCallbackInt64(p,r);b[7]!==p?(r={onImpressionEnd:p},b[7]=p,b[8]=r):r=b[8];p=c("useSinglePartialViewImpression")(r);o=(r=c("useJSON")(o!=null?o:"{}"))!=null?r:[];o==null&&c("FBLogger")("cm_web").mustfix("Thread metadata can't be null");var s=o==null?void 0:o.is_limit_sharing_enabled;b[9]!==k||b[10]!==s||b[11]!==q||b[12]!==g.threadKey||b[13]!==g.threadType?(r=function(){n.onReady(function(a){return a.log(function(){return{action_type:0,is_e2ee:q,selected_item:s?"MESSAGE_PERMISSIONS_OFF":"MESSAGE_PERMISSIONS_ON",thread_id:(j||(j=d("I64"))).to_string(g.threadKey),thread_type:c("coerceMessagingThreadTypeToLSThreadType")(g.threadType),view_name:80}})}),c("promiseDone")(k.runInTransaction(function(a){return c("LSOptimisticSetLimitSharingStoredProcedure")(c("LSFactory")(a),{isLimitSharingEnabled:!s,threadKey:g.threadKey})},"readwrite",void 0,void 0,f.id+":110"))},b[9]=k,b[10]=s,b[11]=q,b[12]=g.threadKey,b[13]=g.threadType,b[14]=r):r=b[14];var t=r;b[15]===Symbol["for"]("react.memo_cache_sentinel")?(o=h._(/*BTDS*/"Message permissions"),b[15]=o):o=b[15];b[16]!==e?(r=l.jsx(c("MWXColumnItem.react"),{children:l.jsx(c("MWInboxInfoSubPageHeader.react"),{onPressBack:e,title:o})}),b[16]=e,b[17]=r):r=b[17];b[18]!==t?(o=function(){return t()},b[18]=t,b[19]=o):o=b[19];e=!s;var u;b[20]!==a||b[21]!==e||b[22]!==o?(u=l.jsx(c("MWXSwitch.react"),{"aria-labelledby":a,onClick:o,value:e}),b[20]=a,b[21]=e,b[22]=o,b[23]=u):u=b[23];b[24]===Symbol["for"]("react.memo_cache_sentinel")?(e=h._(/*BTDS*/"Allow message sharing"),b[24]=e):e=b[24];b[25]===Symbol["for"]("react.memo_cache_sentinel")?(o=h._(/*BTDS*/"Everyone in this chat can share messages with Meta AI or auto-save photos. These features are not available on some versions of Messenger."),b[25]=o):o=b[25];var v;b[26]!==q||b[27]!==g.threadKey||b[28]!==g.threadType?(v=function(){n.onReady(function(a){return a.log(function(){return{action_type:0,is_e2ee:q,selected_item:"MESSAGE_PERMISSIONS_LEARN_MORE",thread_id:(j||(j=d("I64"))).to_string(g.threadKey),thread_type:c("coerceMessagingThreadTypeToLSThreadType")(g.threadType),view_name:80}})})},b[26]=q,b[27]=g.threadKey,b[28]=g.threadType,b[29]=v):v=b[29];var w;b[30]===Symbol["for"]("react.memo_cache_sentinel")?(w=h._(/*BTDS*/"Learn more"),b[30]=w):w=b[30];b[31]!==v?(o=l.jsxs(c("MWXText.react"),{color:"secondary",type:"body4",children:[o," ",l.jsx(c("MWXLink.react"),{color_DEPRECATED:"blueLink",href:"https://www.facebook.com/help/messenger-app/2016594885417423?ref=ipl",onClick:v,target:"_blank",children:w})]}),b[31]=v,b[32]=o):o=b[32];b[33]!==a||b[34]!==o?(w=l.jsx(c("MWXTextPairing.react"),{headline:e,headlineId:a,level:4,meta:o}),b[33]=a,b[34]=o,b[35]=w):w=b[35];b[36]!==u||b[37]!==w?(v=l.jsx(c("MWXColumnItem.react"),{paddingHorizontal:16,children:l.jsx(c("MWXColumnItem.react"),{children:l.jsx(c("MWXListCell.react"),{addOnEnd:u,addOnEndVerticalAlign:"top",content:w})})}),b[36]=u,b[37]=w,b[38]=v):v=b[38];b[39]!==p||b[40]!==v||b[41]!==r?(e=l.jsxs(c("MWXColumn.react"),{ref:p,spacing:12,children:[r,v]}),b[39]=p,b[40]=v,b[41]=r,b[42]=e):e=b[42];return e}g["default"]=a}),226);
__d("MWInboxInfoMemberList.react",["fbt","LSMessagingThreadTypeUtil","MWAddMemberToGroupListCell.react","MWGroupLimitContainer.react","MWGroupMembershipListItem","MWLSGroupMembershipMemberList.react","MWPParticipantsAndContactsForThread_DO_NOT_USE_THIS_WILL_KILL_PERFORMANCE","MWXListCell.react","MWXText.react","canMWAddMemberToGroupThread","isFeatureLimitEnabled","mwCMIsAnyCMThread","react","react-compiler-runtime","useIsReadOnlyFeatureLimitedWithThreadType","withCometPlaceholder"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function k(a){var b=d("react-compiler-runtime").c(6);a=a.thread;var e;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(e=j.jsx(c("MWXListCell.react"),{content:j.jsx(c("MWXText.react"),{color:"secondary",testid:void 0,type:"body4",children:h._(/*BTDS*/"You've reached the maximum number of members. To add another, please remove someone from the group.")}),size:"medium"}),b[0]=e):e=b[0];var f;b[1]!==a?(f=j.jsx(c("MWAddMemberToGroupListCell.react"),{thread:a}),b[1]=a,b[2]=f):f=b[2];b[3]!==f||b[4]!==a?(e=j.jsx(c("MWGroupLimitContainer.react"),{groupLimitReachedContent:e,thread:a,children:f}),b[3]=f,b[4]=a,b[5]=e):e=b[5];return e}function a(a){var b=d("react-compiler-runtime").c(15);a=a.thread;var e=d("LSMessagingThreadTypeUtil").isArmadilloSecure(a.threadType);e=c("useIsReadOnlyFeatureLimitedWithThreadType")(a.threadType)&&(!e||c("isFeatureLimitEnabled")());var f;b[0]!==e||b[1]!==a?(f=c("canMWAddMemberToGroupThread")(a,e),b[0]=e,b[1]=a,b[2]=f):f=b[2];e=f;f=d("MWPParticipantsAndContactsForThread_DO_NOT_USE_THIS_WILL_KILL_PERFORMANCE").useValue(a);var g=!c("mwCMIsAnyCMThread")(a.threadType),h;b[3]!==f?(h=f.map(l),b[3]=f,b[4]=h):h=b[4];b[5]!==g||b[6]!==h||b[7]!==a?(f=j.jsx(c("MWLSGroupMembershipMemberList.react"),{disableScroll:!0,participantsAndContacts:h,showAdmodIndicator:g,showAdmodsOnly:!1,showHostsOnly:!1,showInvitedByViewerOnly:!1,thread:a}),b[5]=g,b[6]=h,b[7]=a,b[8]=f):f=b[8];b[9]!==e||b[10]!==a?(g=e?j.jsx(k,{thread:a}):null,b[9]=e,b[10]=a,b[11]=g):g=b[11];b[12]!==f||b[13]!==g?(h=j.jsxs(j.Fragment,{children:[f,g]}),b[12]=f,b[13]=g,b[14]=h):h=b[14];return h}function l(a){var b=a[0];a=a[1];return{contact:a,participant:b,type:d("MWGroupMembershipListItem").MWGroupMembershipMemberTypes.ParticipantAndContact}}b=d("withCometPlaceholder").withCometPlaceholder(a,null,"MWInboxInfoMemberListInternal");g["default"]=b}),226);
__d("MWInboxInfoMemberRequests.react",["fbt","Int64Hooks","MWInboxInfoButton.react","MWInboxInfoMemberRequestsPushPage.react","MWXIconForListCell.react","MWXIconFriendGenericCheckmark","ReQL","ReQLSuspense","react","react-compiler-runtime","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||d("react");function a(a){var b=d("react-compiler-runtime").c(19),e=a.pushPage,g=a.thread,j=(i||(i=c("useReStore")))();b[0]!==j.tables.group_membership_approval_requests||b[1]!==g.threadKey?(a=function(){return d("ReQL").fromTableAscending(j.tables.group_membership_approval_requests,[]).getKeyRange(g.threadKey)},b[0]=j.tables.group_membership_approval_requests,b[1]=g.threadKey,b[2]=a):a=b[2];var l;b[3]!==j||b[4]!==g.threadKey?(l=[j,g.threadKey],b[3]=j,b[4]=g.threadKey,b[5]=l):l=b[5];a=d("ReQLSuspense").useArray(a,l,f.id+":37");l=a.length;var m;b[6]!==e||b[7]!==g.threadKey?(a=function(a){if(e!=null)return e(function(b){return k.jsx(c("MWInboxInfoMemberRequestsPushPage.react"),{onReturn:b.onReturn,parentSurface:a,threadKey:g.threadKey})})},m=[e,g.threadKey],b[6]=e,b[7]=g.threadKey,b[8]=a,b[9]=m):(a=b[8],m=b[9]);var n=d("Int64Hooks").useCallbackInt64(a,m);b[10]===Symbol["for"]("react.memo_cache_sentinel")?(a=k.jsx(c("MWXIconForListCell.react"),{icon:c("MWXIconFriendGenericCheckmark")}),m=h._(/*BTDS*/"Member requests"),b[10]=a,b[11]=m):(a=b[10],m=b[11]);var o;b[12]!==n?(o=function(){return n()},b[12]=n,b[13]=o):o=b[13];var p;b[14]!==l?(p=l>0?h._(/*BTDS*/"_j{\"*\":\"{number} people want to join\",\"_1\":\"1 person wants to join\"}",[h._plural(l,"number")]):void 0,b[14]=l,b[15]=p):p=b[15];b[16]!==o||b[17]!==p?(l=k.jsx(c("MWInboxInfoButton.react"),{addOnStart:a,label:m,onPress:o,subLabel:p}),b[16]=o,b[17]=p,b[18]=l):l=b[18];return l}g["default"]=a}),226);
__d("MWInboxInfoReadReceiptsPage.react",["fbt","MWInboxInfoSubPageHeader.react","MWXColumn.react","MWXColumnItem.react","MWXListCell.react","MWXSwitch.react","MWXText.react","MWXTextPairing.react","react","react-compiler-runtime","useMWReadReceiptsPropsForThread"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react")),k=i.useId;function a(a){var b=d("react-compiler-runtime").c(22),e=a.onReturn;a=a.threadKey;a=c("useMWReadReceiptsPropsForThread")(a);var f=a.content,g=a.isReadReceiptsDisabled,i=a.onClick;a=k();var l;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(l=h._(/*BTDS*/"Read receipts"),b[0]=l):l=b[0];b[1]!==e?(l=j.jsx(c("MWXColumnItem.react"),{children:j.jsx(c("MWInboxInfoSubPageHeader.react"),{onPressBack:e,title:l})}),b[1]=e,b[2]=l):l=b[2];b[3]!==g||b[4]!==i?(e=function(){return i(!g)},b[3]=g,b[4]=i,b[5]=e):e=b[5];var m=!g,n;b[6]!==a||b[7]!==e||b[8]!==m?(n=j.jsx(c("MWXSwitch.react"),{"aria-labelledby":a,onClick:e,value:m}),b[6]=a,b[7]=e,b[8]=m,b[9]=n):n=b[9];b[10]===Symbol["for"]("react.memo_cache_sentinel")?(e=h._(/*BTDS*/"Show read receipts"),b[10]=e):e=b[10];b[11]!==f?(m=j.jsx(c("MWXText.react"),{color:"secondary",type:"body4",children:f}),b[11]=f,b[12]=m):m=b[12];b[13]!==a||b[14]!==m?(f=j.jsx(c("MWXTextPairing.react"),{headline:e,headlineId:a,level:4,meta:m}),b[13]=a,b[14]=m,b[15]=f):f=b[15];b[16]!==n||b[17]!==f?(e=j.jsx(c("MWXColumnItem.react"),{paddingHorizontal:16,children:j.jsx(c("MWXColumnItem.react"),{children:j.jsx(c("MWXListCell.react"),{addOnEnd:n,addOnEndVerticalAlign:"top",content:f})})}),b[16]=n,b[17]=f,b[18]=e):e=b[18];b[19]!==l||b[20]!==e?(a=j.jsxs(c("MWXColumn.react"),{spacing:12,children:[l,e]}),b[19]=l,b[20]=e,b[21]=a):a=b[21];return a}g["default"]=a}),226);
__d("MWInboxInfoSharedContentLogger",["$InternalEnum","I64","LSIntEnum","MessengerWebEventsFalcoEvent"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=b("$InternalEnum").Mirrored(["FilesTab","LinksTab","MediaTab","ThreadDetails"]);function k(a,b){var c=a.threadKey;a=a.threadType;c=(h||(h=d("I64"))).to_string(c);var e=b||!(h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(2))?null:c;b=b||!(h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(1))?null:c;return[e,b]}function l(a){switch(a){case j.FilesTab:return"files_tab";case j.LinksTab:return"links_tab";case j.MediaTab:return"media_tab";case j.ThreadDetails:return"thread_details"}}function m(a){return c("MessengerWebEventsFalcoEvent").log(a)}function a(a,b,c){var d=l(b);b=k(a,c);var e=b[0],f=b[1];m(function(){return{entry_point:d,event_name:"shared_file_click","interface":"Web Chat",is_secured:c,other_user_fbid:f,thread_fbid:e}})}function e(a,b,c){var d=l(b);b=k(a,c);var e=b[0],f=b[1];m(function(){return{entry_point:d,event_name:"shared_media_click","interface":"Web Chat",is_secured:c,other_user_fbid:f,thread_fbid:e}})}function f(a,b,c){var d=l(b);b=k(a,c);var e=b[0],f=b[1];m(function(){return{entry_point:d,event_name:"shared_link_click","interface":"Web Chat",is_secured:c,other_user_fbid:f,thread_fbid:e}})}g.SharedContentEntrypoint=j;g.getWebEntrypoint=l;g.logFilePress=a;g.logMediaPress=e;g.logLinkPress=f}),98);
__d("MWInboxInfoSharedContentFilesTab.react",["MWInboxInfoFileGallery.react","MWInboxInfoSharedContentLogger","MWSharedAttachmentsSectionHooks","react","react-compiler-runtime","useLoadMoreThreadSharedAttachments.react","useMWMediaLoadingQplLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useCallback;var j=b.useEffect,k=b.useRef;function a(a){var b=d("react-compiler-runtime").c(25),e=a.isSecureThread,f=a.onFirstLoadedMedia,g=a.thread;a=d("MWSharedAttachmentsSectionHooks").useQueryFileAttachments(g.threadKey);var h=a[0],l=a[1],m=a[2];a=a[4];var n=k(!1),o;b[0]!==g.threadType?(o={entrypoint:"file_gallery",threadType:g.threadType},b[0]=g.threadType,b[1]=o):o=b[1];o=c("useMWMediaLoadingQplLogger")(o);l=c("useLoadMoreThreadSharedAttachments.react")(l,g.threadKey,o.logLoadMediaStart);var p=a!=null?a:!0,q;b[2]!==m||b[3]!==h||b[4]!==l||b[5]!==o.logLoadMediaCancel||b[6]!==o.logLoadMediaSuccess||b[7]!==p?(q={attachmentsRange:m,hasMore:p,loadMore:l,logLoadMediaCancel:o.logLoadMediaCancel,logLoadMediaSuccess:o.logLoadMediaSuccess,media:h},b[2]=m,b[3]=h,b[4]=l,b[5]=o.logLoadMediaCancel,b[6]=o.logLoadMediaSuccess,b[7]=p,b[8]=q):q=b[8];m=d("MWSharedAttachmentsSectionHooks").useLoader(q);l=m[0];o=m[1];var r=m[2];b[9]!==r||b[10]!==h||b[11]!==f?(p=function(){n.current===!1&&r===!0&&(n.current=!0,f(h))},q=[r,h,f],b[9]=r,b[10]=h,b[11]=f,b[12]=p,b[13]=q):(p=b[12],q=b[13]);j(p,q);b[14]!==e||b[15]!==g?(m=function(){d("MWInboxInfoSharedContentLogger").logFilePress(g,d("MWInboxInfoSharedContentLogger").SharedContentEntrypoint.FilesTab,e)},b[14]=e,b[15]=g,b[16]=m):m=b[16];p=m;q=a!=null?a:!0;b[17]!==h||b[18]!==l||b[19]!==o||b[20]!==p||b[21]!==q||b[22]!==g.threadKey||b[23]!==g.threadType?(m=i.jsx(c("MWInboxInfoFileGallery.react"),{files:h,hasMore:q,isLoading:l,onLoadMore:o,onPressFile:p,threadKey:g.threadKey,threadType:g.threadType}),b[17]=h,b[18]=l,b[19]=o,b[20]=p,b[21]=q,b[22]=g.threadKey,b[23]=g.threadType,b[24]=m):m=b[24];return m}g["default"]=a}),98);
__d("MWInboxInfoSharedLinks.react",["BaseTheme.react","CometInfiniteScrollTrigger.react","FDSProgressIndicator.react","MWInboxInfoSharedContentEmptyTab.react","MWInboxInfoSharedContentTheme","MWInboxInfoSharedLink.react","MWXColumn.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j={progressIndicator:{display:"x78zum5",justifyContent:"xl56j7k",marginBottom:"x1e56ztr",marginTop:"x1xmf6yo",paddingTop:"x123j3cw",paddingInlineEnd:"x1gabggj",paddingBottom:"xs9asl8",paddingInlineStart:"xaso8d8",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(17),e=a.hasMore,f=a.isLoading,g=a.links,h=a.onLoadMore,k=a.onPressLink,l=a.thread;if(g.length===0&&!f&&!e){b[0]!==l.threadKey?(a=i.jsx(c("MWInboxInfoSharedContentEmptyTab.react"),{contentType:"links",threadKey:l.threadKey}),b[0]=l.threadKey,b[1]=a):a=b[1];return a}else{if(b[2]!==g||b[3]!==k||b[4]!==l){b[6]!==k||b[7]!==l?(a=function(a){return i.jsx(c("MWInboxInfoSharedLink.react"),{attachment:a,onPress:k,threadType:l.threadType},a.attachmentFbid)},b[6]=k,b[7]=l,b[8]=a):a=b[8];a=g.map(a);b[2]=g;b[3]=k;b[4]=l;b[5]=a}else a=b[5];b[9]===Symbol["for"]("react.memo_cache_sentinel")?(g=i.jsx(c("FDSProgressIndicator.react"),{size:"default"}),b[9]=g):g=b[9];b[10]!==e||b[11]!==f||b[12]!==h?(g=i.jsx(c("CometInfiniteScrollTrigger.react"),{hasMore:e,isLoading:f,onLoadMore:h,xstyle:j.progressIndicator,children:g}),b[10]=e,b[11]=f,b[12]=h,b[13]=g):g=b[13];b[14]!==a||b[15]!==g?(e=i.jsx(c("BaseTheme.react"),{config:d("MWInboxInfoSharedContentTheme").config,children:i.jsxs(c("MWXColumn.react"),{hasDividers:!0,paddingHorizontal:16,spacing:20,children:[a,g]})}),b[14]=a,b[15]=g,b[16]=e):e=b[16];return e}}g["default"]=a}),98);
__d("MWInboxInfoSharedLinksSection.react",["MWInboxInfoSharedContentLogger","MWInboxInfoSharedLinks.react","MWSharedAttachmentsSectionHooks","react","react-compiler-runtime","useLoadMoreThreadSharedAttachments.react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useCallback;var j=b.useEffect,k=b.useRef;function a(a){var b=d("react-compiler-runtime").c(23),e=a.isSecureThread,f=a.onFirstLoadedMedia,g=a.thread;a=d("MWSharedAttachmentsSectionHooks").useQueryLinkAttachments(g.threadKey);var h=a[0],l=a[1],m=a[2];a=a[4];var n=c("useLoadMoreThreadSharedAttachments.react")(l,g.threadKey),o=k(!1),p;b[0]!==n?(l=function(){n()},p=[n],b[0]=n,b[1]=l,b[2]=p):(l=b[1],p=b[2]);j(l,p);l=a!=null?a:!0;b[3]!==m||b[4]!==h||b[5]!==n||b[6]!==l?(p={attachmentsRange:m,hasMore:l,loadMore:n,media:h},b[3]=m,b[4]=h,b[5]=n,b[6]=l,b[7]=p):p=b[7];m=d("MWSharedAttachmentsSectionHooks").useLoader(p);l=m[0];p=m[1];var q=m[2],r;b[8]!==q||b[9]!==h||b[10]!==f?(m=function(){o.current===!1&&q===!0&&(o.current=!0,f(h))},r=[q,h,f],b[8]=q,b[9]=h,b[10]=f,b[11]=m,b[12]=r):(m=b[11],r=b[12]);j(m,r);b[13]!==e||b[14]!==g?(m=function(){d("MWInboxInfoSharedContentLogger").logLinkPress(g,d("MWInboxInfoSharedContentLogger").SharedContentEntrypoint.LinksTab,e)},b[13]=e,b[14]=g,b[15]=m):m=b[15];r=m;m=a!=null?a:!0;b[16]!==l||b[17]!==h||b[18]!==p||b[19]!==r||b[20]!==m||b[21]!==g?(a=i.jsx(c("MWInboxInfoSharedLinks.react"),{hasMore:m,isLoading:l,links:h,onLoadMore:p,onPressLink:r,thread:g}),b[16]=l,b[17]=h,b[18]=p,b[19]=r,b[20]=m,b[21]=g,b[22]=a):a=b[22];return a}g["default"]=a}),98);
__d("MWInboxInfoSharedMediaTab.react",["MWInboxInfoPhotoGallery.react","MWInboxInfoSharedContentLogger","MWSharedAttachmentsSectionHooks","react","react-compiler-runtime","useLoadMoreThreadSharedAttachments.react","useMWMediaLoadingQplLogger","useMWV2MediaViewerOpenPlayableUrl","useMWV2MediaViewerOpenPreviewUrl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useCallback;var j=b.useEffect,k=b.useRef;function a(a){var b=d("react-compiler-runtime").c(29),e=a.isSecureThread,f=a.onFirstLoadedMedia,g=a.thread,h=k(!1);a=d("MWSharedAttachmentsSectionHooks").useQueryMediaAttachments(g.threadKey);var l=a[0],m=a[1],n=a[2];a=a[4];a=a===void 0?!0:a;var o;b[0]!==g.threadType?(o={entrypoint:"media_gallery",threadType:g.threadType},b[0]=g.threadType,b[1]=o):o=b[1];o=c("useMWMediaLoadingQplLogger")(o);m=c("useLoadMoreThreadSharedAttachments.react")(m,g.threadKey,o.logLoadMediaStart);var p;b[2]!==n||b[3]!==a||b[4]!==m||b[5]!==l||b[6]!==o.logLoadMediaCancel||b[7]!==o.logLoadMediaSuccess?(p={attachmentsRange:n,hasMore:a,loadMore:m,logLoadMediaCancel:o.logLoadMediaCancel,logLoadMediaSuccess:o.logLoadMediaSuccess,media:l},b[2]=n,b[3]=a,b[4]=m,b[5]=l,b[6]=o.logLoadMediaCancel,b[7]=o.logLoadMediaSuccess,b[8]=p):p=b[8];n=d("MWSharedAttachmentsSectionHooks").useLoader(p);m=n[0];o=n[1];var q=n[2];b[9]!==q||b[10]!==l||b[11]!==f?(p=function(){h.current===!1&&q===!0&&(h.current=!0,f(l))},n=[q,l,f],b[9]=q,b[10]=l,b[11]=f,b[12]=p,b[13]=n):(p=b[12],n=b[13]);j(p,n);var r=c("useMWV2MediaViewerOpenPreviewUrl")();p=c("useMWV2MediaViewerOpenPlayableUrl")();b[14]!==r?(n=function(a,b,c){return(c=r(a,b))!=null?c:""},b[14]=r,b[15]=n):n=b[15];n=n;var s;b[16]!==e||b[17]!==g?(s=function(){d("MWInboxInfoSharedContentLogger").logMediaPress(g,d("MWInboxInfoSharedContentLogger").SharedContentEntrypoint.MediaTab,e)},b[16]=e,b[17]=g,b[18]=s):s=b[18];s=s;var t;b[19]!==p||b[20]!==n||b[21]!==a||b[22]!==m||b[23]!==l||b[24]!==o||b[25]!==s||b[26]!==g.threadKey||b[27]!==g.threadType?(t=i.jsx(c("MWInboxInfoPhotoGallery.react"),{getPlayableUrl:p,getPreviewUrl:n,hasMore:a,isLoading:m,media:l,onLoadMore:o,onPressMedia:s,threadKey:g.threadKey,threadType:g.threadType}),b[19]=p,b[20]=n,b[21]=a,b[22]=m,b[23]=l,b[24]=o,b[25]=s,b[26]=g.threadKey,b[27]=g.threadType,b[28]=t):t=b[28];return t}g["default"]=a}),98);
__d("MWInboxInfoSharedTabContent.react",["MAWCutoverInboxInfoSharedFilesTab.react","MAWCutoverInboxInfoSharedMediaTab.react","MAWSecureInboxInfoSharedFilesTab.react","MAWSecureInboxInfoSharedLinksTab.react","MAWSecureInboxInfoSharedMediaTab.react","MWInboxInfoSharedContentFilesTab.react","MWInboxInfoSharedLinksSection.react","MWInboxInfoSharedMediaTab.react","MWXScrollableArea.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(16),c=a.isBackButtonPressed,e=a.isCutoverThread,f=a.isSecureThread,g=a.onFirstLoadedMedia,h=a.selectedTab,j=a.sharedLinksEnabled;a=a.thread;switch(h){case"media":b[0]!==c||b[1]!==e||b[2]!==f||b[3]!==g||b[4]!==a?(h=i.jsx(k,{isBackButtonPressed:c,isCutoverThread:e,isSecureThread:f,onFirstLoadedMedia:g,thread:a}),b[0]=c,b[1]=e,b[2]=f,b[3]=g,b[4]=a,b[5]=h):h=b[5];return h;case"files":b[6]!==e||b[7]!==f||b[8]!==g||b[9]!==a?(c=i.jsx(l,{isCutoverThread:e,isSecureThread:f,onFirstLoadedMedia:g,thread:a}),b[6]=e,b[7]=f,b[8]=g,b[9]=a,b[10]=c):c=b[10];return c;case"links":b[11]!==f||b[12]!==g||b[13]!==j||b[14]!==a?(h=i.jsx(m,{isSecureThread:f,onFirstLoadedMedia:g,sharedLinksEnabled:j,thread:a}),b[11]=f,b[12]=g,b[13]=j,b[14]=a,b[15]=h):h=b[15];return h}return null}function j(a){var b=d("react-compiler-runtime").c(6),e=a.isSecureThread,f=a.onFirstLoadedMedia,g=a.sharedLinksEnabled;a=a.thread;if(!g)return null;if(e){b[0]!==a?(g=i.jsx(c("MAWSecureInboxInfoSharedLinksTab.react"),{thread:a}),b[0]=a,b[1]=g):g=b[1];return g}b[2]!==e||b[3]!==f||b[4]!==a?(g=i.jsx(c("MWInboxInfoSharedLinksSection.react"),{isSecureThread:e,onFirstLoadedMedia:f,thread:a}),b[2]=e,b[3]=f,b[4]=a,b[5]=g):g=b[5];return g}function k(a){var b=d("react-compiler-runtime").c(13),e=a.isBackButtonPressed,f=a.isCutoverThread,g=a.isSecureThread,h=a.onFirstLoadedMedia;a=a.thread;if(f){b[0]!==e||b[1]!==h||b[2]!==a.threadKey||b[3]!==a.threadType?(f=i.jsx(c("MAWCutoverInboxInfoSharedMediaTab.react"),{isBackButtonPressed:e,onFirstLoadedMedia:h,secureThreadKey:a.threadKey,threadType:a.threadType}),b[0]=e,b[1]=h,b[2]=a.threadKey,b[3]=a.threadType,b[4]=f):f=b[4];return f}if(g){b[5]!==e||b[6]!==h||b[7]!==a?(f=i.jsx(c("MAWSecureInboxInfoSharedMediaTab.react"),{isBackButtonPressed:e,onFirstLoadedMedia:h,thread:a}),b[5]=e,b[6]=h,b[7]=a,b[8]=f):f=b[8];return f}b[9]!==g||b[10]!==h||b[11]!==a?(e=i.jsx(c("MWInboxInfoSharedMediaTab.react"),{isSecureThread:g,onFirstLoadedMedia:h,thread:a}),b[9]=g,b[10]=h,b[11]=a,b[12]=e):e=b[12];return e}function l(a){var b=d("react-compiler-runtime").c(11),e=a.isCutoverThread,f=a.isSecureThread,g=a.onFirstLoadedMedia;a=a.thread;if(e&&c("MAWCutoverInboxInfoSharedFilesTab.react")!=null){b[0]!==g||b[1]!==a.threadKey||b[2]!==a.threadType?(e=i.jsx(c("MAWCutoverInboxInfoSharedFilesTab.react"),{onFirstLoadedMedia:g,secureThreadKey:a.threadKey,threadType:a.threadType}),b[0]=g,b[1]=a.threadKey,b[2]=a.threadType,b[3]=e):e=b[3];return e}if(f){b[4]!==g||b[5]!==a?(e=i.jsx(c("MAWSecureInboxInfoSharedFilesTab.react"),{onFirstLoadedMedia:g,thread:a}),b[4]=g,b[5]=a,b[6]=e):e=b[6];return e}b[7]!==f||b[8]!==g||b[9]!==a?(e=i.jsx(c("MWInboxInfoSharedContentFilesTab.react"),{isSecureThread:f,onFirstLoadedMedia:g,thread:a}),b[7]=f,b[8]=g,b[9]=a,b[10]=e):e=b[10];return e}function m(a){var b=d("react-compiler-runtime").c(5),e=a.isSecureThread,f=a.onFirstLoadedMedia,g=a.sharedLinksEnabled;a=a.thread;var h;b[0]!==e||b[1]!==f||b[2]!==g||b[3]!==a?(h=i.jsx(c("MWXScrollableArea.react"),{expanding:!0,children:i.jsx(j,{isSecureThread:e,onFirstLoadedMedia:f,sharedLinksEnabled:g,thread:a})}),b[0]=e,b[1]=f,b[2]=g,b[3]=a,b[4]=h):h=b[4];return h}g["default"]=a}),98);
__d("MWInboxInfoSharedContent.react",["fbt","MWInboxInfoSharedTabContent.react","MWInboxInfoSubPageHeader.react","MWXColumn.react","MWXColumnItem.react","MWXTabs.react","MessengerWebUXLogger","react","usePrevious","withCometPlaceholder"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;var k=b.useCallback,l=b.useMemo,m=b.useRef,n=b.useState,o={root:{flexBasis:"x1r8uery",flexGrow:"x1iyjqo2",minHeight:"x2lwn1j",$$css:!0}};function p(a,b,c){var d,e;switch(a){case"media":e="mw_shared_media_tab";d=h._(/*BTDS*/"Media");break;case"files":e="mw_shared_files_tab";d=h._(/*BTDS*/"Files");break;case"links":e="mw_shared_links_tab";d=h._(/*BTDS*/"Links");break}return{label:d!=null?d:"",onPress:function(){return c(a)},selected:b===a,testid:e!=null?e:""}}function a(a){var b=a.initialTab,d=a.isCutoverThread,e=a.isSecureThread,f=a.onReturn,g=a.sharedLinksEnabled,i=a.thread,q=l(function(){return["media","files"].concat(g?"links":[])},[g]);a=n(b!=null?b:q[0]);var r=a[0],s=a[1],t=c("usePrevious")(r),u=m(new Set()),v=c("MessengerWebUXLogger").useInteractionLogger();b=k(function(a){var b,c;if(t==null)b="thread_details";else switch(t){case"media":b="media_tab";break;case"files":b="files_tab";break;case"links":b="links_tab";break;default:b="thread_details";break}a=a.length;u.current.add(r);switch(r){case"media":c="open_media_tab";break;case"files":c="open_files_tab";break;case"links":c="open_links_tab";break;default:c="open_media_tab";break}v==null||v({entryPoint:b,eventName:c,extraData:{isCutoverThread:d.toString(),numAttachments:a.toString()},threadKey:i.threadKey,threadType:i.threadType})},[t,i,r,u,v,d]);a=l(function(){return q.map(function(a){return p(a,r,s)})},[q,r]);var w=n(!1),x=w[0],y=w[1];w=k(function(){y(!0);return f()},[f]);return j.jsxs(c("MWXColumn.react"),{spacing:12,xstyle:o.root,children:[j.jsx(c("MWXColumnItem.react"),{children:j.jsx(c("MWInboxInfoSubPageHeader.react"),{onPressBack:w,title:g?h._(/*BTDS*/"Media, files and links"):h._(/*BTDS*/"Media and files")})}),j.jsx(c("MWXColumnItem.react"),{paddingHorizontal:16,children:j.jsx(c("MWXTabs.react"),{tabs:a})}),j.jsx(c("MWXColumnItem.react"),{expanding:!0,children:j.jsx(c("MWInboxInfoSharedTabContent.react"),{isBackButtonPressed:x,isCutoverThread:d,isSecureThread:e,onFirstLoadedMedia:b,selectedTab:r,sharedLinksEnabled:g,thread:i})})]})}a.displayName=a.name+" [from "+f.id+"]";e=d("withCometPlaceholder").withCometPlaceholder(a,null,"MWInboxInfoSharedContent");g["default"]=e}),226);
__d("MWInfoMemberListWrapper.react",["LSMessagingThreadTypeUtil","MWCMInboxInfoMemberList.react","MWInboxInfoMemberList.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(10),e=a.folder,f=a.isCMThread;a=a.thread;var g;b[0]!==a.threadType?(g=d("LSMessagingThreadTypeUtil").isJoinedSocialChannelV2(a.threadType),b[0]=a.threadType,b[1]=g):g=b[1];g=g;var h;b[2]!==a.threadType?(h=d("LSMessagingThreadTypeUtil").isDiscoverablePublicBroadcastChannel(a.threadType),b[2]=a.threadType,b[3]=h):h=b[3];h=h;var j;b[4]!==e||b[5]!==f||b[6]!==h||b[7]!==g||b[8]!==a?(j=c("MWCMInboxInfoMemberList.react")==null||!(e!=null&&f)&&!g&&!h?i.jsx(c("MWInboxInfoMemberList.react"),{thread:a}):i.jsx(c("MWCMInboxInfoMemberList.react"),{folder:e,thread:a}),b[4]=e,b[5]=f,b[6]=h,b[7]=g,b[8]=a,b[9]=j):j=b[9];return j}g["default"]=a}),98);/*FB_PKG_DELIM*/
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("core-util-is-1.0.2",[],(function(a,b,c,d,e,f){"use strict";var g={},h={exports:g};function i(){function a(a){return Array.isArray?Array.isArray(a):p(a)==="[object Array]"}g.isArray=a;function b(a){return typeof a==="boolean"}g.isBoolean=b;function c(a){return a===null}g.isNull=c;function d(a){return a==null}g.isNullOrUndefined=d;function e(a){return typeof a==="number"}g.isNumber=e;function f(a){return typeof a==="string"}g.isString=f;function h(a){return typeof a==="symbol"}g.isSymbol=h;function i(a){return a===void 0}g.isUndefined=i;function j(a){return p(a)==="[object RegExp]"}g.isRegExp=j;function k(a){return typeof a==="object"&&a!==null}g.isObject=k;function l(a){return p(a)==="[object Date]"}g.isDate=l;function m(a){return p(a)==="[object Error]"||a instanceof Error}g.isError=m;function n(a){return typeof a==="function"}g.isFunction=n;function o(a){return a===null||typeof a==="boolean"||typeof a==="number"||typeof a==="string"||typeof a==="symbol"||typeof a==="undefined"}g.isPrimitive=o;g.isBuffer=Buffer.isBuffer;function p(a){return Object.prototype.toString.call(a)}}var j=!1;function k(){j||(j=!0,i());return h.exports}function a(a){switch(a){case void 0:return k()}}e.exports=a}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("file-saver-2.0.2",[],(function(a,b,c,d,e,f){"use strict";var g={},h={exports:g};function i(){(function(a,b){"undefined"!=typeof g?b():(b(),a.FileSaver={exports:{}}.exports)})(this,function(){function b(b,a){return"undefined"==typeof a?a={autoBom:!1}:"object"!=typeof a&&(!1,a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(b.type)?new Blob(["\ufeff",b],{type:b.type}):b}function c(a,b,c){var d=new XMLHttpRequest;d.open("GET",a),d.responseType="blob",d.onload=function(){g(d.response,b,c)},d.onerror=function(){},d.send()}function d(b){var a=new XMLHttpRequest;a.open("HEAD",b,!1);try{a.send()}catch(a){}return 200<=a.status&&299>=a.status}function e(b){try{b.dispatchEvent(new MouseEvent("click"))}catch(c){var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),b.dispatchEvent(a)}}var f="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof a&&a.global===a?a:void 0,g=f.saveAs||("object"!=typeof window||window!==f?function(){}:"download"in HTMLAnchorElement.prototype?function(a,b,g){var h=f.URL||f.webkitURL,i=document.createElement("a");b=b||a.name||"download",i.download=b,i.rel="noopener","string"==typeof a?(i.href=a,i.origin===location.origin?e(i):d(i.href)?c(a,b,g):e(i,i.target="_blank")):(i.href=h.createObjectURL(a),setTimeout(function(){h.revokeObjectURL(i.href)},4e4),setTimeout(function(){e(i)},0))}:"msSaveOrOpenBlob"in navigator?function(a,f,g){if(f=f||a.name||"download","string"!=typeof a)navigator.msSaveOrOpenBlob(b(a,g),f);else if(d(a))c(a,f,g);else{var h=document.createElement("a");h.href=a,h.target="_blank",setTimeout(function(){e(h)})}}:function(e,a,b,d){if(d=d||open("","_blank"),d&&(d.document.title=d.document.body.innerText="downloading..."),"string"==typeof e)return c(e,a,b);a="application/octet-stream"===e.type;b=/constructor/i.test(f.HTMLElement)||f.safari;var g=/CriOS\/[\d]+/.test(navigator.userAgent);if((g||a&&b)&&"object"==typeof FileReader){var h=new FileReader;h.onloadend=function(){var a=h.result;a=g?a:a.replace(/^data:[^;]*;/,"data:attachment/file;"),d?d.location.href=a:location=a,d=null},h.readAsDataURL(e)}else{var i=f.URL||f.webkitURL,j=i.createObjectURL(e);d?d.location=j:location.href=j,d=null,setTimeout(function(){i.revokeObjectURL(j)},4e4)}});f.saveAs=g.saveAs=g,"undefined"!=typeof h&&(h.exports=g)})}var j=!1;function k(){j||(j=!0,i());return h.exports}function b(a){switch(a){case void 0:return k()}}e.exports=b}),null);
__d("file-saver",["file-saver-2.0.2"],(function(a,b,c,d,e,f){e.exports=b("file-saver-2.0.2")()}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("immediate-3.0.6",[],(function(a,b,c,d,e,f){"use strict";c={};var g={exports:c};function h(){var b=a.MutationObserver||a.WebKitMutationObserver,c;if(process.browser)if(b){var d=0;b=new b(j);var e=a.document.createTextNode("");b.observe(e,{characterData:!0});c=function(){e.data=d=++d%2}}else if(!a.setImmediate&&typeof a.MessageChannel!=="undefined"){var f=new a.MessageChannel();f.port1.onmessage=j;c=function(){f.port2.postMessage(0)}}else"document"in a&&"onreadystatechange"in a.document.createElement("script")?c=function(){var b=a.document.createElement("script");b.onreadystatechange=function(){j(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null};a.document.documentElement.appendChild(b)}:c=function(){setTimeout(j,0)};else c=function(){process.nextTick(j)};var h,i=[];function j(){h=!0;var a,b,c=i.length;while(c){b=i;i=[];a=-1;while(++a<c)b[a]();c=i.length}h=!1}g.exports=k;function k(a){i.push(a)===1&&!h&&c()}}var i=!1;function j(){i||(i=!0,h());return g.exports}function b(a){switch(a){case void 0:return j()}}e.exports=b}),null);
/**
 * License: https://www.facebook.com/legal/license/Hnt8PzozZpk/
 */
__d("inherits-2.0.3",[],(function(a,b,c,d,e,f){"use strict";b={};var g={exports:b};function h(){typeof Object.create==="function"?g.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:g.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype;a.prototype=new c();a.prototype.constructor=a}}var i=!1;function j(){i||(i=!0,h());return g.exports}c={};var k={exports:c};function l(){try{var a={};if(typeof a.inherits!=="function")throw"";k.exports=a.inherits}catch(a){k.exports=j()}}var m=!1;function n(){m||(m=!0,l());return k.exports}function a(a){switch(a){case void 0:return n()}}e.exports=a}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("isarray-1.0.0",[],(function(a,b,c,d,e,f){"use strict";b={};var g={exports:b};function h(){var a={}.toString;g.exports=Array.isArray||function(b){return a.call(b)=="[object Array]"}}var i=!1;function j(){i||(i=!0,h());return g.exports}function a(a){switch(a){case void 0:return j()}}e.exports=a}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("lie-3.3.0",["immediate-3.0.6"],(function(a,b,c,d,e,f){"use strict";function a(a){return a&&typeof a==="object"&&"default"in a?a["default"]:a}var g=a(b("immediate-3.0.6"));d={};var h={exports:d};function i(){var a=g();function b(){}var c={},d=["REJECTED"],e=["FULFILLED"],f=["PENDING"];if(!process.browser)var i=["UNHANDLED"];h.exports=j;function j(a){if(typeof a!=="function")throw new TypeError("resolver must be a function");this.state=f;this.queue=[];this.outcome=void 0;process.browser||(this.handled=i);a!==b&&n(this,a)}j.prototype["finally"]=function(c){if(typeof c!=="function")return this;var d=this.constructor;return this.then(a,b);function a(a){function b(){return a}return d.resolve(c()).then(b)}function b(a){function b(){throw a}return d.resolve(c()).then(b)}};j.prototype["catch"]=function(a){return this.then(null,a)};j.prototype.then=function(a,c){if(typeof a!=="function"&&this.state===e||typeof c!=="function"&&this.state===d)return this;var g=new this.constructor(b);process.browser||this.handled===i&&(this.handled=null);if(this.state!==f){var h=this.state===e?a:c;l(g,h,this.outcome)}else this.queue.push(new k(g,a,c));return g};function k(a,b,c){this.promise=a,typeof b==="function"&&(this.onFulfilled=b,this.callFulfilled=this.otherCallFulfilled),typeof c==="function"&&(this.onRejected=c,this.callRejected=this.otherCallRejected)}k.prototype.callFulfilled=function(a){c.resolve(this.promise,a)};k.prototype.otherCallFulfilled=function(a){l(this.promise,this.onFulfilled,a)};k.prototype.callRejected=function(a){c.reject(this.promise,a)};k.prototype.otherCallRejected=function(a){l(this.promise,this.onRejected,a)};function l(b,d,e){a(function(){var a;try{a=d(e)}catch(a){return c.reject(b,a)}a===b?c.reject(b,new TypeError("Cannot resolve promise with itself")):c.resolve(b,a)})}c.resolve=function(a,b){var d=o(m,b);if(d.status==="error")return c.reject(a,d.value);d=d.value;if(d)n(a,d);else{a.state=e;a.outcome=b;d=-1;var f=a.queue.length;while(++d<f)a.queue[d].callFulfilled(b)}return a};c.reject=function(b,c){b.state=d;b.outcome=c;process.browser||b.handled===i&&a(function(){b.handled===i&&process.emit("unhandledRejection",c,b)});var e=-1,f=b.queue.length;while(++e<f)b.queue[e].callRejected(c);return b};function m(a){var b=a&&a.then;if(a&&(typeof a==="object"||typeof a==="function")&&typeof b==="function")return function(){b.apply(a,arguments)}}function n(a,b){var d=!1;function e(b){if(d)return;d=!0;c.reject(a,b)}function f(b){if(d)return;d=!0;c.resolve(a,b)}function g(){b(f,e)}g=o(g);g.status==="error"&&e(g.value)}function o(a,b){var c={};try{c.value=a(b),c.status="success"}catch(a){c.status="error",c.value=a}return c}j.resolve=p;function p(a){return a instanceof this?a:c.resolve(new this(b),a)}j.reject=q;function q(a){var d=new this(b);return c.reject(d,a)}j.all=r;function r(a){var d=this;if(Object.prototype.toString.call(a)!=="[object Array]")return this.reject(new TypeError("must be an array"));var e=a.length,f=!1;if(!e)return this.resolve([]);var g=new Array(e),h=0,i=-1,j=new this(b);while(++i<e)k(a[i],i);return j;function k(b,a){d.resolve(b).then(i,function(a){f||(f=!0,c.reject(j,a))});function i(b){g[a]=b,++h===e&&!f&&(f=!0,c.resolve(j,g))}}}j.race=s;function s(a){var d=this;if(Object.prototype.toString.call(a)!=="[object Array]")return this.reject(new TypeError("must be an array"));var e=a.length,f=!1;if(!e)return this.resolve([]);var g=-1,h=new this(b);while(++g<e)i(a[g]);return h;function i(a){d.resolve(a).then(function(a){f||(f=!0,c.resolve(h,a))},function(a){f||(f=!0,c.reject(h,a))})}}}var j=!1;function k(){j||(j=!0,i());return h.exports}function c(a){switch(a){case void 0:return k()}}e.exports=c}),null);
/**
 * License: https://www.facebook.com/legal/license/cr2jmG-CdKo/
 */
__d("pako-1.0.8",[],(function(a,b,c,d,e,f){"use strict";var g={},h={exports:g};function i(){var a=typeof Uint8Array!=="undefined"&&typeof Uint16Array!=="undefined"&&typeof Int32Array!=="undefined";function b(a,b){return Object.prototype.hasOwnProperty.call(a,b)}g.assign=function(a){var c=Array.prototype.slice.call(arguments,1);while(c.length){var d=c.shift();if(!d)continue;if(typeof d!=="object")throw new TypeError(d+"must be non-object");for(var e in d)b(d,e)&&(a[e]=d[e])}return a};g.shrinkBuf=function(a,b){if(a.length===b)return a;if(a.subarray)return a.subarray(0,b);a.length=b;return a};var c={arraySet:function(a,b,c,d,e){if(b.subarray&&a.subarray){a.set(b.subarray(c,c+d),e);return}for(var f=0;f<d;f++)a[e+f]=b[c+f]},flattenChunks:function(a){var b,c,d,e,f;d=0;for(b=0,c=a.length;b<c;b++)d+=a[b].length;d=new Uint8Array(d);e=0;for(b=0,c=a.length;b<c;b++)f=a[b],d.set(f,e),e+=f.length;return d}},d={arraySet:function(a,b,c,d,e){for(var f=0;f<d;f++)a[e+f]=b[c+f]},flattenChunks:function(a){return[].concat.apply([],a)}};g.setTyped=function(a){a?(g.Buf8=Uint8Array,g.Buf16=Uint16Array,g.Buf32=Int32Array,g.assign(g,c)):(g.Buf8=Array,g.Buf16=Array,g.Buf32=Array,g.assign(g,d))};g.setTyped(a)}var j=!1;function k(){j||(j=!0,i());return h.exports}var l={},m={exports:l};function n(){var a=k(),b=4,c=0,d=1,e=2;function f(a){var b=a.length;while(--b>=0)a[b]=0}var g=0,h=1,i=2,j=3,m=258,n=29,o=256,p=o+1+n,q=30,r=19,aa=2*p+1,s=15,t=16,u=7,v=256,w=16,x=17,y=18,z=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],A=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ba=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ca=512,C=new Array((p+2)*2);f(C);var da=new Array(q*2);f(da);var D=new Array(ca);f(D);var ea=new Array(m-j+1);f(ea);var fa=new Array(n);f(fa);var E=new Array(q);f(E);function ga(a,b,c,d,e){this.static_tree=a,this.extra_bits=b,this.extra_base=c,this.elems=d,this.max_length=e,this.has_stree=a&&a.length}var ha,F,G;function H(a,b){this.dyn_tree=a,this.max_code=0,this.stat_desc=b}function ia(a){return a<256?D[a]:D[256+(a>>>7)]}function ja(a,b){a.pending_buf[a.pending++]=b&255,a.pending_buf[a.pending++]=b>>>8&255}function I(a,b,c){a.bi_valid>t-c?(a.bi_buf|=b<<a.bi_valid&65535,ja(a,a.bi_buf),a.bi_buf=b>>t-a.bi_valid,a.bi_valid+=c-t):(a.bi_buf|=b<<a.bi_valid&65535,a.bi_valid+=c)}function J(a,b,c){I(a,c[b*2],c[b*2+1])}function ka(a,b){var c=0;do c|=a&1,a>>>=1,c<<=1;while(--b>0);return c>>>1}function la(a){a.bi_valid===16?(ja(a,a.bi_buf),a.bi_buf=0,a.bi_valid=0):a.bi_valid>=8&&(a.pending_buf[a.pending++]=a.bi_buf&255,a.bi_buf>>=8,a.bi_valid-=8)}function ma(a,b){var c=b.dyn_tree,d=b.max_code,e=b.stat_desc.static_tree,f=b.stat_desc.has_stree,g=b.stat_desc.extra_bits,h=b.stat_desc.extra_base;b=b.stat_desc.max_length;var i,j,k,l,m,n=0;for(k=0;k<=s;k++)a.bl_count[k]=0;c[a.heap[a.heap_max]*2+1]=0;for(i=a.heap_max+1;i<aa;i++){j=a.heap[i];k=c[c[j*2+1]*2+1]+1;k>b&&(k=b,n++);c[j*2+1]=k;if(j>d)continue;a.bl_count[k]++;l=0;j>=h&&(l=g[j-h]);m=c[j*2];a.opt_len+=m*(k+l);f&&(a.static_len+=m*(e[j*2+1]+l))}if(n===0)return;do{k=b-1;while(a.bl_count[k]===0)k--;a.bl_count[k]--;a.bl_count[k+1]+=2;a.bl_count[b]--;n-=2}while(n>0);for(k=b;k!==0;k--){j=a.bl_count[k];while(j!==0){m=a.heap[--i];if(m>d)continue;c[m*2+1]!==k&&(a.opt_len+=(k-c[m*2+1])*c[m*2],c[m*2+1]=k);j--}}}function na(a,b,c){var d=new Array(s+1),e=0,f;for(f=1;f<=s;f++)d[f]=e=e+c[f-1]<<1;for(f=0;f<=b;f++){c=a[f*2+1];if(c===0)continue;a[f*2]=ka(d[c]++,c)}}function K(){var a,b,c,d=new Array(s+1);b=0;for(c=0;c<n-1;c++){fa[c]=b;for(a=0;a<1<<z[c];a++)ea[b++]=c}ea[b-1]=c;b=0;for(c=0;c<16;c++){E[c]=b;for(a=0;a<1<<A[c];a++)D[b++]=c}b>>=7;for(;c<q;c++){E[c]=b<<7;for(a=0;a<1<<A[c]-7;a++)D[256+b++]=c}for(c=0;c<=s;c++)d[c]=0;a=0;while(a<=143)C[a*2+1]=8,a++,d[8]++;while(a<=255)C[a*2+1]=9,a++,d[9]++;while(a<=279)C[a*2+1]=7,a++,d[7]++;while(a<=287)C[a*2+1]=8,a++,d[8]++;na(C,p+1,d);for(a=0;a<q;a++)da[a*2+1]=5,da[a*2]=ka(a,5);ha=new ga(C,z,o+1,p,s);F=new ga(da,A,0,q,s);G=new ga(new Array(0),B,0,r,u)}function oa(a){var b;for(b=0;b<p;b++)a.dyn_ltree[b*2]=0;for(b=0;b<q;b++)a.dyn_dtree[b*2]=0;for(b=0;b<r;b++)a.bl_tree[b*2]=0;a.dyn_ltree[v*2]=1;a.opt_len=a.static_len=0;a.last_lit=a.matches=0}function L(a){a.bi_valid>8?ja(a,a.bi_buf):a.bi_valid>0&&(a.pending_buf[a.pending++]=a.bi_buf),a.bi_buf=0,a.bi_valid=0}function pa(b,c,d,e){L(b),e&&(ja(b,d),ja(b,~d)),a.arraySet(b.pending_buf,b.window,c,d,b.pending),b.pending+=d}function qa(a,b,c,d){var e=b*2,f=c*2;return a[e]<a[f]||a[e]===a[f]&&d[b]<=d[c]}function M(a,b,c){var d=a.heap[c],e=c<<1;while(e<=a.heap_len){e<a.heap_len&&qa(b,a.heap[e+1],a.heap[e],a.depth)&&e++;if(qa(b,d,a.heap[e],a.depth))break;a.heap[c]=a.heap[e];c=e;e<<=1}a.heap[c]=d}function ra(a,b,c){var d,e,f=0,g,h;if(a.last_lit!==0)do d=a.pending_buf[a.d_buf+f*2]<<8|a.pending_buf[a.d_buf+f*2+1],e=a.pending_buf[a.l_buf+f],f++,d===0?J(a,e,b):(g=ea[e],J(a,g+o+1,b),h=z[g],h!==0&&(e-=fa[g],I(a,e,h)),d--,g=ia(d),J(a,g,c),h=A[g],h!==0&&(d-=E[g],I(a,d,h)));while(f<a.last_lit);J(a,v,b)}function N(a,b){var c=b.dyn_tree,d=b.stat_desc.static_tree,e=b.stat_desc.has_stree,f=b.stat_desc.elems,g,h=-1,i;a.heap_len=0;a.heap_max=aa;for(g=0;g<f;g++)c[g*2]!==0?(a.heap[++a.heap_len]=h=g,a.depth[g]=0):c[g*2+1]=0;while(a.heap_len<2)i=a.heap[++a.heap_len]=h<2?++h:0,c[i*2]=1,a.depth[i]=0,a.opt_len--,e&&(a.static_len-=d[i*2+1]);b.max_code=h;for(g=a.heap_len>>1;g>=1;g--)M(a,c,g);i=f;do g=a.heap[1],a.heap[1]=a.heap[a.heap_len--],M(a,c,1),e=a.heap[1],a.heap[--a.heap_max]=g,a.heap[--a.heap_max]=e,c[i*2]=c[g*2]+c[e*2],a.depth[i]=(a.depth[g]>=a.depth[e]?a.depth[g]:a.depth[e])+1,c[g*2+1]=c[e*2+1]=i,a.heap[1]=i++,M(a,c,1);while(a.heap_len>=2);a.heap[--a.heap_max]=a.heap[1];ma(a,b);na(c,h,a.bl_count)}function O(a,b,c){var d,e=-1,f,g=b[0*2+1],h=0,i=7,j=4;g===0&&(i=138,j=3);b[(c+1)*2+1]=65535;for(d=0;d<=c;d++){f=g;g=b[(d+1)*2+1];if(++h<i&&f===g)continue;else h<j?a.bl_tree[f*2]+=h:f!==0?(f!==e&&a.bl_tree[f*2]++,a.bl_tree[w*2]++):h<=10?a.bl_tree[x*2]++:a.bl_tree[y*2]++;h=0;e=f;g===0?(i=138,j=3):f===g?(i=6,j=3):(i=7,j=4)}}function P(a,b,c){var d,e=-1,f,g=b[0*2+1],h=0,i=7,j=4;g===0&&(i=138,j=3);for(d=0;d<=c;d++){f=g;g=b[(d+1)*2+1];if(++h<i&&f===g)continue;else if(h<j)do J(a,f,a.bl_tree);while(--h!==0);else f!==0?(f!==e&&(J(a,f,a.bl_tree),h--),J(a,w,a.bl_tree),I(a,h-3,2)):h<=10?(J(a,x,a.bl_tree),I(a,h-3,3)):(J(a,y,a.bl_tree),I(a,h-11,7));h=0;e=f;g===0?(i=138,j=3):f===g?(i=6,j=3):(i=7,j=4)}}function Q(a){var b;O(a,a.dyn_ltree,a.l_desc.max_code);O(a,a.dyn_dtree,a.d_desc.max_code);N(a,a.bl_desc);for(b=r-1;b>=3;b--)if(a.bl_tree[ba[b]*2+1]!==0)break;a.opt_len+=3*(b+1)+5+5+4;return b}function sa(a,b,c,d){var e;I(a,b-257,5);I(a,c-1,5);I(a,d-4,4);for(e=0;e<d;e++)I(a,a.bl_tree[ba[e]*2+1],3);P(a,a.dyn_ltree,b-1);P(a,a.dyn_dtree,c-1)}function R(a){var b=4093624447,e;for(e=0;e<=31;e++,b>>>=1)if(b&1&&a.dyn_ltree[e*2]!==0)return c;if(a.dyn_ltree[9*2]!==0||a.dyn_ltree[10*2]!==0||a.dyn_ltree[13*2]!==0)return d;for(e=32;e<o;e++)if(a.dyn_ltree[e*2]!==0)return d;return c}var ta=!1;function S(a){ta||(K(),ta=!0),a.l_desc=new H(a.dyn_ltree,ha),a.d_desc=new H(a.dyn_dtree,F),a.bl_desc=new H(a.bl_tree,G),a.bi_buf=0,a.bi_valid=0,oa(a)}function T(a,b,c,d){I(a,(g<<1)+(d?1:0),3),pa(a,b,c,!0)}function U(a){I(a,h<<1,3),J(a,v,C),la(a)}function V(a,c,d,f){var g,j,k=0;a.level>0?(a.strm.data_type===e&&(a.strm.data_type=R(a)),N(a,a.l_desc),N(a,a.d_desc),k=Q(a),g=a.opt_len+3+7>>>3,j=a.static_len+3+7>>>3,j<=g&&(g=j)):g=j=d+5;d+4<=g&&c!==-1?T(a,c,d,f):a.strategy===b||j===g?(I(a,(h<<1)+(f?1:0),3),ra(a,C,da)):(I(a,(i<<1)+(f?1:0),3),sa(a,a.l_desc.max_code+1,a.d_desc.max_code+1,k+1),ra(a,a.dyn_ltree,a.dyn_dtree));oa(a);f&&L(a)}function W(a,b,c){a.pending_buf[a.d_buf+a.last_lit*2]=b>>>8&255;a.pending_buf[a.d_buf+a.last_lit*2+1]=b&255;a.pending_buf[a.l_buf+a.last_lit]=c&255;a.last_lit++;b===0?a.dyn_ltree[c*2]++:(a.matches++,b--,a.dyn_ltree[(ea[c]+o+1)*2]++,a.dyn_dtree[ia(b)*2]++);return a.last_lit===a.lit_bufsize-1}l._tr_init=S;l._tr_stored_block=T;l._tr_flush_block=V;l._tr_tally=W;l._tr_align=U}var o=!1;function p(){o||(o=!0,n());return m.exports}b={};var q={exports:b};function r(){function a(a,b,c,d){var e=a&65535|0;a=a>>>16&65535|0;var f;while(c!==0){f=c>2e3?2e3:c;c-=f;do e=e+b[d++]|0,a=a+e|0;while(--f);e%=65521;a%=65521}return e|a<<16|0}q.exports=a}var aa=!1;function s(){aa||(aa=!0,r());return q.exports}c={};var t={exports:c};function u(){function a(){var a,b=[];for(var c=0;c<256;c++){a=c;for(var d=0;d<8;d++)a=a&1?3988292384^a>>>1:a>>>1;b[c]=a}return b}var b=a();function c(a,c,d,e){var f=b;d=e+d;a^=-1;for(e=e;e<d;e++)a=a>>>8^f[(a^c[e])&255];return a^-1}t.exports=c}var v=!1;function w(){v||(v=!0,u());return t.exports}d={};var x={exports:d};function y(){x.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}}var z=!1;function A(){z||(z=!0,y());return x.exports}var B={},ba={exports:B};function ca(){var a=k(),b=p(),c=s(),d=w(),e=A(),f=0,g=1,h=3,i=4,j=5,l=0,m=1,n=-2,o=-3,q=-5,r=-1,aa=1,t=2,u=3,v=4,x=0,y=2,z=8,ba=9,ca=15,C=8,da=29,D=256,ea=D+1+da,fa=30,E=19,ga=2*ea+1,ha=15,F=3,G=258,H=G+F+1,ia=32,ja=42,I=69,J=73,ka=91,la=103,ma=113,na=666,K=1,oa=2,L=3,pa=4,qa=3;function M(a,b){a.msg=e[b];return b}function ra(a){return(a<<1)-(a>4?9:0)}function N(a){var b=a.length;while(--b>=0)a[b]=0}function O(b){var c=b.state,d=c.pending;d>b.avail_out&&(d=b.avail_out);if(d===0)return;a.arraySet(b.output,c.pending_buf,c.pending_out,d,b.next_out);b.next_out+=d;c.pending_out+=d;b.total_out+=d;b.avail_out-=d;c.pending-=d;c.pending===0&&(c.pending_out=0)}function P(a,c){b._tr_flush_block(a,a.block_start>=0?a.block_start:-1,a.strstart-a.block_start,c),a.block_start=a.strstart,O(a.strm)}function Q(a,b){a.pending_buf[a.pending++]=b}function sa(a,b){a.pending_buf[a.pending++]=b>>>8&255,a.pending_buf[a.pending++]=b&255}function R(b,e,f,g){var h=b.avail_in;h>g&&(h=g);if(h===0)return 0;b.avail_in-=h;a.arraySet(e,b.input,b.next_in,h,f);b.state.wrap===1?b.adler=c(b.adler,e,h,f):b.state.wrap===2&&(b.adler=d(b.adler,e,h,f));b.next_in+=h;b.total_in+=h;return h}function ta(a,b){var c=a.max_chain_length,d=a.strstart,e,f=a.prev_length,g=a.nice_match,h=a.strstart>a.w_size-H?a.strstart-(a.w_size-H):0,i=a.window,j=a.w_mask,k=a.prev,l=a.strstart+G,m=i[d+f-1],n=i[d+f];a.prev_length>=a.good_match&&(c>>=2);g>a.lookahead&&(g=a.lookahead);do{e=b;if(i[e+f]!==n||i[e+f-1]!==m||i[e]!==i[d]||i[++e]!==i[d+1])continue;d+=2;e++;do;while(i[++d]===i[++e]&&i[++d]===i[++e]&&i[++d]===i[++e]&&i[++d]===i[++e]&&i[++d]===i[++e]&&i[++d]===i[++e]&&i[++d]===i[++e]&&i[++d]===i[++e]&&d<l);e=G-(l-d);d=l-G;if(e>f){a.match_start=b;f=e;if(e>=g)break;m=i[d+f-1];n=i[d+f]}}while((b=k[b&j])>h&&--c!==0);return f<=a.lookahead?f:a.lookahead}function S(b){var c=b.w_size,d,e,f,g;do{g=b.window_size-b.lookahead-b.strstart;if(b.strstart>=c+(c-H)){a.arraySet(b.window,b.window,c,c,0);b.match_start-=c;b.strstart-=c;b.block_start-=c;e=b.hash_size;d=e;do f=b.head[--d],b.head[d]=f>=c?f-c:0;while(--e);e=c;d=e;do f=b.prev[--d],b.prev[d]=f>=c?f-c:0;while(--e);g+=c}if(b.strm.avail_in===0)break;e=R(b.strm,b.window,b.strstart+b.lookahead,g);b.lookahead+=e;if(b.lookahead+b.insert>=F){f=b.strstart-b.insert;b.ins_h=b.window[f];b.ins_h=(b.ins_h<<b.hash_shift^b.window[f+1])&b.hash_mask;while(b.insert){b.ins_h=(b.ins_h<<b.hash_shift^b.window[f+F-1])&b.hash_mask;b.prev[f&b.w_mask]=b.head[b.ins_h];b.head[b.ins_h]=f;f++;b.insert--;if(b.lookahead+b.insert<F)break}}}while(b.lookahead<H&&b.strm.avail_in!==0)}function T(a,b){var c=65535;c>a.pending_buf_size-5&&(c=a.pending_buf_size-5);for(;;){if(a.lookahead<=1){S(a);if(a.lookahead===0&&b===f)return K;if(a.lookahead===0)break}a.strstart+=a.lookahead;a.lookahead=0;var d=a.block_start+c;if(a.strstart===0||a.strstart>=d){a.lookahead=a.strstart-d;a.strstart=d;P(a,!1);if(a.strm.avail_out===0)return K}if(a.strstart-a.block_start>=a.w_size-H){P(a,!1);if(a.strm.avail_out===0)return K}}a.insert=0;if(b===i){P(a,!0);return a.strm.avail_out===0?L:pa}if(a.strstart>a.block_start){P(a,!1);if(a.strm.avail_out===0)return K}return K}function U(a,c){var d;for(;;){if(a.lookahead<H){S(a);if(a.lookahead<H&&c===f)return K;if(a.lookahead===0)break}d=0;a.lookahead>=F&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+F-1])&a.hash_mask,d=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);d!==0&&a.strstart-d<=a.w_size-H&&(a.match_length=ta(a,d));if(a.match_length>=F){d=b._tr_tally(a,a.strstart-a.match_start,a.match_length-F);a.lookahead-=a.match_length;if(a.match_length<=a.max_lazy_match&&a.lookahead>=F){a.match_length--;do a.strstart++,a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+F-1])&a.hash_mask,a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart;while(--a.match_length!==0);a.strstart++}else a.strstart+=a.match_length,a.match_length=0,a.ins_h=a.window[a.strstart],a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+1])&a.hash_mask}else d=b._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++;if(d){P(a,!1);if(a.strm.avail_out===0)return K}}a.insert=a.strstart<F-1?a.strstart:F-1;if(c===i){P(a,!0);return a.strm.avail_out===0?L:pa}if(a.last_lit){P(a,!1);if(a.strm.avail_out===0)return K}return oa}function V(a,c){var d,e;for(;;){if(a.lookahead<H){S(a);if(a.lookahead<H&&c===f)return K;if(a.lookahead===0)break}d=0;a.lookahead>=F&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+F-1])&a.hash_mask,d=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);a.prev_length=a.match_length;a.prev_match=a.match_start;a.match_length=F-1;d!==0&&a.prev_length<a.max_lazy_match&&a.strstart-d<=a.w_size-H&&(a.match_length=ta(a,d),a.match_length<=5&&(a.strategy===aa||a.match_length===F&&a.strstart-a.match_start>4096)&&(a.match_length=F-1));if(a.prev_length>=F&&a.match_length<=a.prev_length){d=a.strstart+a.lookahead-F;e=b._tr_tally(a,a.strstart-1-a.prev_match,a.prev_length-F);a.lookahead-=a.prev_length-1;a.prev_length-=2;do++a.strstart<=d&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+F-1])&a.hash_mask,a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);while(--a.prev_length!==0);a.match_available=0;a.match_length=F-1;a.strstart++;if(e){P(a,!1);if(a.strm.avail_out===0)return K}}else if(a.match_available){e=b._tr_tally(a,0,a.window[a.strstart-1]);e&&P(a,!1);a.strstart++;a.lookahead--;if(a.strm.avail_out===0)return K}else a.match_available=1,a.strstart++,a.lookahead--}a.match_available&&(b._tr_tally(a,0,a.window[a.strstart-1]),a.match_available=0);a.insert=a.strstart<F-1?a.strstart:F-1;if(c===i){P(a,!0);return a.strm.avail_out===0?L:pa}if(a.last_lit){P(a,!1);if(a.strm.avail_out===0)return K}return oa}function W(a,c){var d,e,g,h=a.window;for(;;){if(a.lookahead<=G){S(a);if(a.lookahead<=G&&c===f)return K;if(a.lookahead===0)break}a.match_length=0;if(a.lookahead>=F&&a.strstart>0){e=a.strstart-1;d=h[e];if(d===h[++e]&&d===h[++e]&&d===h[++e]){g=a.strstart+G;do;while(d===h[++e]&&d===h[++e]&&d===h[++e]&&d===h[++e]&&d===h[++e]&&d===h[++e]&&d===h[++e]&&d===h[++e]&&e<g);a.match_length=G-(g-e);a.match_length>a.lookahead&&(a.match_length=a.lookahead)}}a.match_length>=F?(d=b._tr_tally(a,1,a.match_length-F),a.lookahead-=a.match_length,a.strstart+=a.match_length,a.match_length=0):(d=b._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++);if(d){P(a,!1);if(a.strm.avail_out===0)return K}}a.insert=0;if(c===i){P(a,!0);return a.strm.avail_out===0?L:pa}if(a.last_lit){P(a,!1);if(a.strm.avail_out===0)return K}return oa}function X(a,c){var d;for(;;){if(a.lookahead===0){S(a);if(a.lookahead===0){if(c===f)return K;break}}a.match_length=0;d=b._tr_tally(a,0,a.window[a.strstart]);a.lookahead--;a.strstart++;if(d){P(a,!1);if(a.strm.avail_out===0)return K}}a.insert=0;if(c===i){P(a,!0);return a.strm.avail_out===0?L:pa}if(a.last_lit){P(a,!1);if(a.strm.avail_out===0)return K}return oa}function ua(a,b,c,d,e){this.good_length=a,this.max_lazy=b,this.nice_length=c,this.max_chain=d,this.func=e}var va;va=[new ua(0,0,0,0,T),new ua(4,4,8,4,U),new ua(4,5,16,8,U),new ua(4,6,32,32,U),new ua(4,4,16,16,V),new ua(8,16,32,32,V),new ua(8,16,128,128,V),new ua(8,32,128,256,V),new ua(32,128,258,1024,V),new ua(32,258,258,4096,V)];function wa(a){a.window_size=2*a.w_size,N(a.head),a.max_lazy_match=va[a.level].max_lazy,a.good_match=va[a.level].good_length,a.nice_match=va[a.level].nice_length,a.max_chain_length=va[a.level].max_chain,a.strstart=0,a.block_start=0,a.lookahead=0,a.insert=0,a.match_length=a.prev_length=F-1,a.match_available=0,a.ins_h=0}function Y(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=z,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(ga*2),this.dyn_dtree=new a.Buf16((2*fa+1)*2),this.bl_tree=new a.Buf16((2*E+1)*2),N(this.dyn_ltree),N(this.dyn_dtree),N(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(ha+1),this.heap=new a.Buf16(2*ea+1),N(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*ea+1),N(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function xa(a){var c;if(!a||!a.state)return M(a,n);a.total_in=a.total_out=0;a.data_type=y;c=a.state;c.pending=0;c.pending_out=0;c.wrap<0&&(c.wrap=-c.wrap);c.status=c.wrap?ja:ma;a.adler=c.wrap===2?0:1;c.last_flush=f;b._tr_init(c);return l}function Z(a){var b=xa(a);b===l&&wa(a.state);return b}function $(a,b){if(!a||!a.state)return n;if(a.state.wrap!==2)return n;a.state.gzhead=b;return l}function ya(b,c,d,e,f,g){if(!b)return n;var h=1;c===r&&(c=6);e<0?(h=0,e=-e):e>15&&(h=2,e-=16);if(f<1||f>ba||d!==z||e<8||e>15||c<0||c>9||g<0||g>v)return M(b,n);e===8&&(e=9);var i=new Y();b.state=i;i.strm=b;i.wrap=h;i.gzhead=null;i.w_bits=e;i.w_size=1<<i.w_bits;i.w_mask=i.w_size-1;i.hash_bits=f+7;i.hash_size=1<<i.hash_bits;i.hash_mask=i.hash_size-1;i.hash_shift=~~((i.hash_bits+F-1)/F);i.window=new a.Buf8(i.w_size*2);i.head=new a.Buf16(i.hash_size);i.prev=new a.Buf16(i.w_size);i.lit_bufsize=1<<f+6;i.pending_buf_size=i.lit_bufsize*4;i.pending_buf=new a.Buf8(i.pending_buf_size);i.d_buf=1*i.lit_bufsize;i.l_buf=(1+2)*i.lit_bufsize;i.level=c;i.strategy=g;i.method=d;return Z(b)}function za(a,b){return ya(a,b,z,ca,C,x)}function Aa(a,c){var e,k;if(!a||!a.state||c>j||c<0)return a?M(a,n):n;k=a.state;if(!a.output||!a.input&&a.avail_in!==0||k.status===na&&c!==i)return M(a,a.avail_out===0?q:n);k.strm=a;e=k.last_flush;k.last_flush=c;if(k.status===ja)if(k.wrap===2)a.adler=0,Q(k,31),Q(k,139),Q(k,8),!k.gzhead?(Q(k,0),Q(k,0),Q(k,0),Q(k,0),Q(k,0),Q(k,k.level===9?2:k.strategy>=t||k.level<2?4:0),Q(k,qa),k.status=ma):(Q(k,(k.gzhead.text?1:0)+(k.gzhead.hcrc?2:0)+(k.gzhead.extra?4:0)+(k.gzhead.name?8:0)+(k.gzhead.comment?16:0)),Q(k,k.gzhead.time&255),Q(k,k.gzhead.time>>8&255),Q(k,k.gzhead.time>>16&255),Q(k,k.gzhead.time>>24&255),Q(k,k.level===9?2:k.strategy>=t||k.level<2?4:0),Q(k,k.gzhead.os&255),k.gzhead.extra&&k.gzhead.extra.length&&(Q(k,k.gzhead.extra.length&255),Q(k,k.gzhead.extra.length>>8&255)),k.gzhead.hcrc&&(a.adler=d(a.adler,k.pending_buf,k.pending,0)),k.gzindex=0,k.status=I);else{var o=z+(k.w_bits-8<<4)<<8,p;k.strategy>=t||k.level<2?p=0:k.level<6?p=1:k.level===6?p=2:p=3;o|=p<<6;k.strstart!==0&&(o|=ia);o+=31-o%31;k.status=ma;sa(k,o);k.strstart!==0&&(sa(k,a.adler>>>16),sa(k,a.adler&65535));a.adler=1}if(k.status===I)if(k.gzhead.extra){p=k.pending;while(k.gzindex<(k.gzhead.extra.length&65535)){if(k.pending===k.pending_buf_size){k.gzhead.hcrc&&k.pending>p&&(a.adler=d(a.adler,k.pending_buf,k.pending-p,p));O(a);p=k.pending;if(k.pending===k.pending_buf_size)break}Q(k,k.gzhead.extra[k.gzindex]&255);k.gzindex++}k.gzhead.hcrc&&k.pending>p&&(a.adler=d(a.adler,k.pending_buf,k.pending-p,p));k.gzindex===k.gzhead.extra.length&&(k.gzindex=0,k.status=J)}else k.status=J;if(k.status===J)if(k.gzhead.name){p=k.pending;do{if(k.pending===k.pending_buf_size){k.gzhead.hcrc&&k.pending>p&&(a.adler=d(a.adler,k.pending_buf,k.pending-p,p));O(a);p=k.pending;if(k.pending===k.pending_buf_size){o=1;break}}k.gzindex<k.gzhead.name.length?o=k.gzhead.name.charCodeAt(k.gzindex++)&255:o=0;Q(k,o)}while(o!==0);k.gzhead.hcrc&&k.pending>p&&(a.adler=d(a.adler,k.pending_buf,k.pending-p,p));o===0&&(k.gzindex=0,k.status=ka)}else k.status=ka;if(k.status===ka)if(k.gzhead.comment){p=k.pending;do{if(k.pending===k.pending_buf_size){k.gzhead.hcrc&&k.pending>p&&(a.adler=d(a.adler,k.pending_buf,k.pending-p,p));O(a);p=k.pending;if(k.pending===k.pending_buf_size){o=1;break}}k.gzindex<k.gzhead.comment.length?o=k.gzhead.comment.charCodeAt(k.gzindex++)&255:o=0;Q(k,o)}while(o!==0);k.gzhead.hcrc&&k.pending>p&&(a.adler=d(a.adler,k.pending_buf,k.pending-p,p));o===0&&(k.status=la)}else k.status=la;k.status===la&&(k.gzhead.hcrc?(k.pending+2>k.pending_buf_size&&O(a),k.pending+2<=k.pending_buf_size&&(Q(k,a.adler&255),Q(k,a.adler>>8&255),a.adler=0,k.status=ma)):k.status=ma);if(k.pending!==0){O(a);if(a.avail_out===0){k.last_flush=-1;return l}}else if(a.avail_in===0&&ra(c)<=ra(e)&&c!==i)return M(a,q);if(k.status===na&&a.avail_in!==0)return M(a,q);if(a.avail_in!==0||k.lookahead!==0||c!==f&&k.status!==na){p=k.strategy===t?X(k,c):k.strategy===u?W(k,c):va[k.level].func(k,c);(p===L||p===pa)&&(k.status=na);if(p===K||p===L){a.avail_out===0&&(k.last_flush=-1);return l}if(p===oa){c===g?b._tr_align(k):c!==j&&(b._tr_stored_block(k,0,0,!1),c===h&&(N(k.head),k.lookahead===0&&(k.strstart=0,k.block_start=0,k.insert=0)));O(a);if(a.avail_out===0){k.last_flush=-1;return l}}}if(c!==i)return l;if(k.wrap<=0)return m;k.wrap===2?(Q(k,a.adler&255),Q(k,a.adler>>8&255),Q(k,a.adler>>16&255),Q(k,a.adler>>24&255),Q(k,a.total_in&255),Q(k,a.total_in>>8&255),Q(k,a.total_in>>16&255),Q(k,a.total_in>>24&255)):(sa(k,a.adler>>>16),sa(k,a.adler&65535));O(a);k.wrap>0&&(k.wrap=-k.wrap);return k.pending!==0?l:m}function Ba(a){var b;if(!a||!a.state)return n;b=a.state.status;if(b!==ja&&b!==I&&b!==J&&b!==ka&&b!==la&&b!==ma&&b!==na)return M(a,n);a.state=null;return b===ma?M(a,o):l}function Ca(b,d){var e=d.length,f,g,h,i,j;if(!b||!b.state)return n;f=b.state;g=f.wrap;if(g===2||g===1&&f.status!==ja||f.lookahead)return n;g===1&&(b.adler=c(b.adler,d,e,0));f.wrap=0;e>=f.w_size&&(g===0&&(N(f.head),f.strstart=0,f.block_start=0,f.insert=0),j=new a.Buf8(f.w_size),a.arraySet(j,d,e-f.w_size,f.w_size,0),d=j,e=f.w_size);j=b.avail_in;h=b.next_in;i=b.input;b.avail_in=e;b.next_in=0;b.input=d;S(f);while(f.lookahead>=F){e=f.strstart;d=f.lookahead-(F-1);do f.ins_h=(f.ins_h<<f.hash_shift^f.window[e+F-1])&f.hash_mask,f.prev[e&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=e,e++;while(--d);f.strstart=e;f.lookahead=F-1;S(f)}f.strstart+=f.lookahead;f.block_start=f.strstart;f.insert=f.lookahead;f.lookahead=0;f.match_length=f.prev_length=F-1;f.match_available=0;b.next_in=h;b.input=i;b.avail_in=j;f.wrap=g;return l}B.deflateInit=za;B.deflateInit2=ya;B.deflateReset=Z;B.deflateResetKeep=xa;B.deflateSetHeader=$;B.deflate=Aa;B.deflateEnd=Ba;B.deflateSetDictionary=Ca;B.deflateInfo="pako deflate (from Nodeca project)"}var C=!1;function da(){C||(C=!0,ca());return ba.exports}var D={},ea={exports:D};function fa(){var a=k(),b=!0,c=!0;try{String.fromCharCode.apply(null,[0])}catch(a){b=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(a){c=!1}var d=new a.Buf8(256);for(var e=0;e<256;e++)d[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;d[254]=d[254]=1;D.string2buf=function(b){var c,d,e,f,g,h=b.length,i=0;for(f=0;f<h;f++)d=b.charCodeAt(f),(d&64512)===55296&&f+1<h&&(e=b.charCodeAt(f+1),(e&64512)===56320&&(d=65536+(d-55296<<10)+(e-56320),f++)),i+=d<128?1:d<2048?2:d<65536?3:4;c=new a.Buf8(i);for(g=0,f=0;g<i;f++)d=b.charCodeAt(f),(d&64512)===55296&&f+1<h&&(e=b.charCodeAt(f+1),(e&64512)===56320&&(d=65536+(d-55296<<10)+(e-56320),f++)),d<128?c[g++]=d:d<2048?(c[g++]=192|d>>>6,c[g++]=128|d&63):d<65536?(c[g++]=224|d>>>12,c[g++]=128|d>>>6&63,c[g++]=128|d&63):(c[g++]=240|d>>>18,c[g++]=128|d>>>12&63,c[g++]=128|d>>>6&63,c[g++]=128|d&63);return c};function f(d,e){if(e<65534&&(d.subarray&&c||!d.subarray&&b))return String.fromCharCode.apply(null,a.shrinkBuf(d,e));var f="";for(var g=0;g<e;g++)f+=String.fromCharCode(d[g]);return f}D.buf2binstring=function(a){return f(a,a.length)};D.binstring2buf=function(b){var c=new a.Buf8(b.length);for(var d=0,e=c.length;d<e;d++)c[d]=b.charCodeAt(d);return c};D.buf2string=function(a,b){var c,e,g,h;b=b||a.length;var i=new Array(b*2);for(e=0,c=0;c<b;){g=a[c++];if(g<128){i[e++]=g;continue}h=d[g];if(h>4){i[e++]=65533;c+=h-1;continue}g&=h===2?31:h===3?15:7;while(h>1&&c<b)g=g<<6|a[c++]&63,h--;if(h>1){i[e++]=65533;continue}g<65536?i[e++]=g:(g-=65536,i[e++]=55296|g>>10&1023,i[e++]=56320|g&1023)}return f(i,e)};D.utf8border=function(a,b){var c;b=b||a.length;b>a.length&&(b=a.length);c=b-1;while(c>=0&&(a[c]&192)===128)c--;if(c<0)return b;return c===0?b:c+d[a[c]]>b?c:b}}var E=!1;function ga(){E||(E=!0,fa());return ea.exports}f={};var ha={exports:f};function F(){function a(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}ha.exports=a}var G=!1;function H(){G||(G=!0,F());return ha.exports}var ia={},ja={exports:ia};function I(){var a=da(),b=k(),c=ga(),d=A(),e=H(),f=Object.prototype.toString,g=0,h=4,i=0,j=1,l=2,m=-1,n=0,o=8;function p(g){if(!(this instanceof p))return new p(g);this.options=b.assign({level:m,method:o,chunkSize:16384,windowBits:15,memLevel:8,strategy:n,to:""},g||{});g=this.options;g.raw&&g.windowBits>0?g.windowBits=-g.windowBits:g.gzip&&g.windowBits>0&&g.windowBits<16&&(g.windowBits+=16);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new e();this.strm.avail_out=0;var h=a.deflateInit2(this.strm,g.level,g.method,g.windowBits,g.memLevel,g.strategy);if(h!==i)throw new Error(d[h]);g.header&&a.deflateSetHeader(this.strm,g.header);if(g.dictionary){var j;typeof g.dictionary==="string"?j=c.string2buf(g.dictionary):f.call(g.dictionary)==="[object ArrayBuffer]"?j=new Uint8Array(g.dictionary):j=g.dictionary;h=a.deflateSetDictionary(this.strm,j);if(h!==i)throw new Error(d[h]);this._dict_set=!0}}p.prototype.push=function(d,e){var k=this.strm,m=this.options.chunkSize;if(this.ended)return!1;e=e===~~e?e:e===!0?h:g;typeof d==="string"?k.input=c.string2buf(d):f.call(d)==="[object ArrayBuffer]"?k.input=new Uint8Array(d):k.input=d;k.next_in=0;k.avail_in=k.input.length;do{k.avail_out===0&&(k.output=new b.Buf8(m),k.next_out=0,k.avail_out=m);d=a.deflate(k,e);if(d!==j&&d!==i){this.onEnd(d);this.ended=!0;return!1}(k.avail_out===0||k.avail_in===0&&(e===h||e===l))&&(this.options.to==="string"?this.onData(c.buf2binstring(b.shrinkBuf(k.output,k.next_out))):this.onData(b.shrinkBuf(k.output,k.next_out)))}while((k.avail_in>0||k.avail_out===0)&&d!==j);if(e===h){d=a.deflateEnd(this.strm);this.onEnd(d);this.ended=!0;return d===i}if(e===l){this.onEnd(i);k.avail_out=0;return!0}return!0};p.prototype.onData=function(a){this.chunks.push(a)};p.prototype.onEnd=function(a){a===i&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=b.flattenChunks(this.chunks)),this.chunks=[],this.err=a,this.msg=this.strm.msg};function q(a,b){b=new p(b);b.push(a,!0);if(b.err)throw b.msg||d[b.err];return b.result}function r(a,b){b=b||{};b.raw=!0;return q(a,b)}function aa(a,b){b=b||{};b.gzip=!0;return q(a,b)}ia.Deflate=p;ia.deflate=q;ia.deflateRaw=r;ia.gzip=aa}var J=!1;function ka(){J||(J=!0,I());return ja.exports}b={};var la={exports:b};function ma(){var a=30,b=12;la.exports=function(c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,aa,s,t,u,v,w,x,y,z,A;e=c.state;f=c.next_in;z=c.input;g=f+(c.avail_in-5);h=c.next_out;A=c.output;d=h-(d-c.avail_out);i=h+(c.avail_out-257);j=e.dmax;k=e.wsize;l=e.whave;m=e.wnext;n=e.window;o=e.hold;p=e.bits;q=e.lencode;r=e.distcode;aa=(1<<e.lenbits)-1;s=(1<<e.distbits)-1;top:do{p<15&&(o+=z[f++]<<p,p+=8,o+=z[f++]<<p,p+=8);t=q[o&aa];dolen:for(;;){u=t>>>24;o>>>=u;p-=u;u=t>>>16&255;if(u===0)A[h++]=t&65535;else if(u&16){v=t&65535;u&=15;u&&(p<u&&(o+=z[f++]<<p,p+=8),v+=o&(1<<u)-1,o>>>=u,p-=u);p<15&&(o+=z[f++]<<p,p+=8,o+=z[f++]<<p,p+=8);t=r[o&s];dodist:for(;;){u=t>>>24;o>>>=u;p-=u;u=t>>>16&255;if(u&16){w=t&65535;u&=15;p<u&&(o+=z[f++]<<p,p+=8,p<u&&(o+=z[f++]<<p,p+=8));w+=o&(1<<u)-1;if(w>j){c.msg="invalid distance too far back";e.mode=a;break top}o>>>=u;p-=u;u=h-d;if(w>u){u=w-u;if(u>l&&e.sane){c.msg="invalid distance too far back";e.mode=a;break top}x=0;y=n;if(m===0){x+=k-u;if(u<v){v-=u;do A[h++]=n[x++];while(--u);x=h-w;y=A}}else if(m<u){x+=k+m-u;u-=m;if(u<v){v-=u;do A[h++]=n[x++];while(--u);x=0;if(m<v){u=m;v-=u;do A[h++]=n[x++];while(--u);x=h-w;y=A}}}else{x+=m-u;if(u<v){v-=u;do A[h++]=n[x++];while(--u);x=h-w;y=A}}while(v>2)A[h++]=y[x++],A[h++]=y[x++],A[h++]=y[x++],v-=3;v&&(A[h++]=y[x++],v>1&&(A[h++]=y[x++]))}else{x=h-w;do A[h++]=A[x++],A[h++]=A[x++],A[h++]=A[x++],v-=3;while(v>2);v&&(A[h++]=A[x++],v>1&&(A[h++]=A[x++]))}}else if((u&64)===0){t=r[(t&65535)+(o&(1<<u)-1)];continue dodist}else{c.msg="invalid distance code";e.mode=a;break top}break}}else if((u&64)===0){t=q[(t&65535)+(o&(1<<u)-1)];continue dolen}else if(u&32){e.mode=b;break top}else{c.msg="invalid literal/length code";e.mode=a;break top}break}}while(f<g&&h<i);v=p>>3;f-=v;p-=v<<3;o&=(1<<p)-1;c.next_in=f;c.next_out=h;c.avail_in=f<g?5+(g-f):5-(f-g);c.avail_out=h<i?257+(i-h):257-(h-i);e.hold=o;e.bits=p;return}}var na=!1;function K(){na||(na=!0,ma());return la.exports}c={};var oa={exports:c};function L(){var a=k(),b=15,c=852,d=592,e=0,f=1,g=2,h=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],i=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],j=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],l=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];oa.exports=function(k,m,n,o,p,q,r,aa){var s=aa.bits,t,u,v,w,x,y,z,A,B,ba,ca,C,da,D,ea=0,fa,E=new a.Buf16(b+1),ga=new a.Buf16(b+1),ha=0,F,G,H;for(t=0;t<=b;t++)E[t]=0;for(u=0;u<o;u++)E[m[n+u]]++;s=s;for(w=b;w>=1;w--)if(E[w]!==0)break;s>w&&(s=w);if(w===0){p[q++]=1<<24|64<<16|0;p[q++]=1<<24|64<<16|0;aa.bits=1;return 0}for(v=1;v<w;v++)if(E[v]!==0)break;s<v&&(s=v);z=1;for(t=1;t<=b;t++){z<<=1;z-=E[t];if(z<0)return-1}if(z>0&&(k===e||w!==1))return-1;ga[1]=0;for(t=1;t<b;t++)ga[t+1]=ga[t]+E[t];for(u=0;u<o;u++)m[n+u]!==0&&(r[ga[m[n+u]]++]=u);k===e?(ga=o=r,fa=19):k===f?(ga=h,ea-=257,o=i,ha-=257,fa=256):(ga=j,o=l,fa=-1);B=0;u=0;t=v;D=q;x=s;y=0;C=-1;A=1<<s;da=A-1;if(k===f&&A>c||k===g&&A>d)return 1;for(;;){F=t-y;r[u]<fa?(G=0,H=r[u]):r[u]>fa?(G=o[ha+r[u]],H=ga[ea+r[u]]):(G=32+64,H=0);ba=1<<t-y;ca=1<<x;v=ca;do ca-=ba,p[D+(B>>y)+ca]=F<<24|G<<16|H|0;while(ca!==0);ba=1<<t-1;while(B&ba)ba>>=1;ba!==0?(B&=ba-1,B+=ba):B=0;u++;if(--E[t]===0){if(t===w)break;t=m[n+r[u]]}if(t>s&&(B&da)!==C){y===0&&(y=s);D+=v;x=t-y;z=1<<x;while(x+y<w){z-=E[x+y];if(z<=0)break;x++;z<<=1}A+=1<<x;if(k===f&&A>c||k===g&&A>d)return 1;C=B&da;p[C]=s<<24|x<<16|D-q|0}}B!==0&&(p[D+B]=t-y<<24|64<<16|0);aa.bits=s;return 0}}var pa=!1;function qa(){pa||(pa=!0,L());return oa.exports}var M={},ra={exports:M};function N(){var a=k(),b=s(),c=w(),d=K(),e=qa(),f=0,g=1,h=2,i=4,j=5,l=6,m=0,n=1,o=2,p=-2,q=-3,r=-4,aa=-5,t=8,u=1,v=2,x=3,y=4,z=5,A=6,B=7,ba=8,ca=9,C=10,da=11,D=12,ea=13,fa=14,E=15,ga=16,ha=17,F=18,G=19,H=20,ia=21,ja=22,I=23,J=24,ka=25,la=26,ma=27,na=28,oa=29,L=30,pa=31,ra=32,N=852,O=592,P=15,Q=P;function sa(a){return(a>>>24&255)+(a>>>8&65280)+((a&65280)<<8)+((a&255)<<24)}function R(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new a.Buf16(320),this.work=new a.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ta(b){var c;if(!b||!b.state)return p;c=b.state;b.total_in=b.total_out=c.total=0;b.msg="";c.wrap&&(b.adler=c.wrap&1);c.mode=u;c.last=0;c.havedict=0;c.dmax=32768;c.head=null;c.hold=0;c.bits=0;c.lencode=c.lendyn=new a.Buf32(N);c.distcode=c.distdyn=new a.Buf32(O);c.sane=1;c.back=-1;return m}function S(a){var b;if(!a||!a.state)return p;b=a.state;b.wsize=0;b.whave=0;b.wnext=0;return ta(a)}function T(a,b){var c,d;if(!a||!a.state)return p;d=a.state;b<0?(c=0,b=-b):(c=(b>>4)+1,b<48&&(b&=15));if(b&&(b<8||b>15))return p;d.window!==null&&d.wbits!==b&&(d.window=null);d.wrap=c;d.wbits=b;return S(a)}function U(a,b){var c;if(!a)return p;c=new R();a.state=c;c.window=null;c=T(a,b);c!==m&&(a.state=null);return c}function V(a){return U(a,Q)}var W=!0,X,ua;function va(b){if(W){var c;X=new a.Buf32(512);ua=new a.Buf32(32);c=0;while(c<144)b.lens[c++]=8;while(c<256)b.lens[c++]=9;while(c<280)b.lens[c++]=7;while(c<288)b.lens[c++]=8;e(g,b.lens,0,288,X,0,b.work,{bits:9});c=0;while(c<32)b.lens[c++]=5;e(h,b.lens,0,32,ua,0,b.work,{bits:5});W=!1}b.lencode=X;b.lenbits=9;b.distcode=ua;b.distbits=5}function wa(b,c,d,e){var f;b=b.state;b.window===null&&(b.wsize=1<<b.wbits,b.wnext=0,b.whave=0,b.window=new a.Buf8(b.wsize));e>=b.wsize?(a.arraySet(b.window,c,d-b.wsize,b.wsize,0),b.wnext=0,b.whave=b.wsize):(f=b.wsize-b.wnext,f>e&&(f=e),a.arraySet(b.window,c,d-e,f,b.wnext),e-=f,e?(a.arraySet(b.window,c,d-e,e,0),b.wnext=e,b.whave=b.wsize):(b.wnext+=f,b.wnext===b.wsize&&(b.wnext=0),b.whave<b.wsize&&(b.whave+=f)));return 0}function Y(k,s){var w,K,qa,M,N,O,P,Q,R,ta,S,T,U,V,W,X,ua,Y,xa,Z=new a.Buf8(4),$,ya,za=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!k||!k.state||!k.output||!k.input&&k.avail_in!==0)return p;w=k.state;w.mode===D&&(w.mode=ea);N=k.next_out;qa=k.output;P=k.avail_out;M=k.next_in;K=k.input;O=k.avail_in;Q=w.hold;R=w.bits;ta=O;S=P;xa=m;inf_leave:for(;;)switch(w.mode){case u:if(w.wrap===0){w.mode=ea;break}while(R<16){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}if(w.wrap&2&&Q===35615){w.check=0;Z[0]=Q&255;Z[1]=Q>>>8&255;w.check=c(w.check,Z,2,0);Q=0;R=0;w.mode=v;break}w.flags=0;w.head&&(w.head.done=!1);if(!(w.wrap&1)||(((Q&255)<<8)+(Q>>8))%31){k.msg="incorrect header check";w.mode=L;break}if((Q&15)!==t){k.msg="unknown compression method";w.mode=L;break}Q>>>=4;R-=4;Y=(Q&15)+8;if(w.wbits===0)w.wbits=Y;else if(Y>w.wbits){k.msg="invalid window size";w.mode=L;break}w.dmax=1<<Y;k.adler=w.check=1;w.mode=Q&512?C:D;Q=0;R=0;break;case v:while(R<16){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}w.flags=Q;if((w.flags&255)!==t){k.msg="unknown compression method";w.mode=L;break}if(w.flags&57344){k.msg="unknown header flags set";w.mode=L;break}w.head&&(w.head.text=Q>>8&1);w.flags&512&&(Z[0]=Q&255,Z[1]=Q>>>8&255,w.check=c(w.check,Z,2,0));Q=0;R=0;w.mode=x;case x:while(R<32){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}w.head&&(w.head.time=Q);w.flags&512&&(Z[0]=Q&255,Z[1]=Q>>>8&255,Z[2]=Q>>>16&255,Z[3]=Q>>>24&255,w.check=c(w.check,Z,4,0));Q=0;R=0;w.mode=y;case y:while(R<16){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}w.head&&(w.head.xflags=Q&255,w.head.os=Q>>8);w.flags&512&&(Z[0]=Q&255,Z[1]=Q>>>8&255,w.check=c(w.check,Z,2,0));Q=0;R=0;w.mode=z;case z:if(w.flags&1024){while(R<16){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}w.length=Q;w.head&&(w.head.extra_len=Q);w.flags&512&&(Z[0]=Q&255,Z[1]=Q>>>8&255,w.check=c(w.check,Z,2,0));Q=0;R=0}else w.head&&(w.head.extra=null);w.mode=A;case A:if(w.flags&1024){T=w.length;T>O&&(T=O);T&&(w.head&&(Y=w.head.extra_len-w.length,w.head.extra||(w.head.extra=new Array(w.head.extra_len)),a.arraySet(w.head.extra,K,M,T,Y)),w.flags&512&&(w.check=c(w.check,K,T,M)),O-=T,M+=T,w.length-=T);if(w.length)break inf_leave}w.length=0;w.mode=B;case B:if(w.flags&2048){if(O===0)break inf_leave;T=0;do Y=K[M+T++],w.head&&Y&&w.length<65536&&(w.head.name+=String.fromCharCode(Y));while(Y&&T<O);w.flags&512&&(w.check=c(w.check,K,T,M));O-=T;M+=T;if(Y)break inf_leave}else w.head&&(w.head.name=null);w.length=0;w.mode=ba;case ba:if(w.flags&4096){if(O===0)break inf_leave;T=0;do Y=K[M+T++],w.head&&Y&&w.length<65536&&(w.head.comment+=String.fromCharCode(Y));while(Y&&T<O);w.flags&512&&(w.check=c(w.check,K,T,M));O-=T;M+=T;if(Y)break inf_leave}else w.head&&(w.head.comment=null);w.mode=ca;case ca:if(w.flags&512){while(R<16){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}if(Q!==(w.check&65535)){k.msg="header crc mismatch";w.mode=L;break}Q=0;R=0}w.head&&(w.head.hcrc=w.flags>>9&1,w.head.done=!0);k.adler=w.check=0;w.mode=D;break;case C:while(R<32){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}k.adler=w.check=sa(Q);Q=0;R=0;w.mode=da;case da:if(w.havedict===0){k.next_out=N;k.avail_out=P;k.next_in=M;k.avail_in=O;w.hold=Q;w.bits=R;return o}k.adler=w.check=1;w.mode=D;case D:if(s===j||s===l)break inf_leave;case ea:if(w.last){Q>>>=R&7;R-=R&7;w.mode=ma;break}while(R<3){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}w.last=Q&1;Q>>>=1;R-=1;switch(Q&3){case 0:w.mode=fa;break;case 1:va(w);w.mode=H;if(s===l){Q>>>=2;R-=2;break inf_leave}break;case 2:w.mode=ha;break;case 3:k.msg="invalid block type",w.mode=L}Q>>>=2;R-=2;break;case fa:Q>>>=R&7;R-=R&7;while(R<32){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}if((Q&65535)!==(Q>>>16^65535)){k.msg="invalid stored block lengths";w.mode=L;break}w.length=Q&65535;Q=0;R=0;w.mode=E;if(s===l)break inf_leave;case E:w.mode=ga;case ga:T=w.length;if(T){T>O&&(T=O);T>P&&(T=P);if(T===0)break inf_leave;a.arraySet(qa,K,M,T,N);O-=T;M+=T;P-=T;N+=T;w.length-=T;break}w.mode=D;break;case ha:while(R<14){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}w.nlen=(Q&31)+257;Q>>>=5;R-=5;w.ndist=(Q&31)+1;Q>>>=5;R-=5;w.ncode=(Q&15)+4;Q>>>=4;R-=4;if(w.nlen>286||w.ndist>30){k.msg="too many length or distance symbols";w.mode=L;break}w.have=0;w.mode=F;case F:while(w.have<w.ncode){while(R<3){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}w.lens[za[w.have++]]=Q&7;Q>>>=3;R-=3}while(w.have<19)w.lens[za[w.have++]]=0;w.lencode=w.lendyn;w.lenbits=7;$={bits:w.lenbits};xa=e(f,w.lens,0,19,w.lencode,0,w.work,$);w.lenbits=$.bits;if(xa){k.msg="invalid code lengths set";w.mode=L;break}w.have=0;w.mode=G;case G:while(w.have<w.nlen+w.ndist){for(;;){U=w.lencode[Q&(1<<w.lenbits)-1];V=U>>>24;W=U>>>16&255;X=U&65535;if(V<=R)break;if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}if(X<16)Q>>>=V,R-=V,w.lens[w.have++]=X;else{if(X===16){ya=V+2;while(R<ya){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}Q>>>=V;R-=V;if(w.have===0){k.msg="invalid bit length repeat";w.mode=L;break}Y=w.lens[w.have-1];T=3+(Q&3);Q>>>=2;R-=2}else if(X===17){ya=V+3;while(R<ya){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}Q>>>=V;R-=V;Y=0;T=3+(Q&7);Q>>>=3;R-=3}else{ya=V+7;while(R<ya){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}Q>>>=V;R-=V;Y=0;T=11+(Q&127);Q>>>=7;R-=7}if(w.have+T>w.nlen+w.ndist){k.msg="invalid bit length repeat";w.mode=L;break}while(T--)w.lens[w.have++]=Y}}if(w.mode===L)break;if(w.lens[256]===0){k.msg="invalid code -- missing end-of-block";w.mode=L;break}w.lenbits=9;$={bits:w.lenbits};xa=e(g,w.lens,0,w.nlen,w.lencode,0,w.work,$);w.lenbits=$.bits;if(xa){k.msg="invalid literal/lengths set";w.mode=L;break}w.distbits=6;w.distcode=w.distdyn;$={bits:w.distbits};xa=e(h,w.lens,w.nlen,w.ndist,w.distcode,0,w.work,$);w.distbits=$.bits;if(xa){k.msg="invalid distances set";w.mode=L;break}w.mode=H;if(s===l)break inf_leave;case H:w.mode=ia;case ia:if(O>=6&&P>=258){k.next_out=N;k.avail_out=P;k.next_in=M;k.avail_in=O;w.hold=Q;w.bits=R;d(k,S);N=k.next_out;qa=k.output;P=k.avail_out;M=k.next_in;K=k.input;O=k.avail_in;Q=w.hold;R=w.bits;w.mode===D&&(w.back=-1);break}w.back=0;for(;;){U=w.lencode[Q&(1<<w.lenbits)-1];V=U>>>24;W=U>>>16&255;X=U&65535;if(V<=R)break;if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}if(W&&(W&240)===0){Y=V;$=W;ua=X;for(;;){U=w.lencode[ua+((Q&(1<<Y+$)-1)>>Y)];V=U>>>24;W=U>>>16&255;X=U&65535;if(Y+V<=R)break;if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}Q>>>=Y;R-=Y;w.back+=Y}Q>>>=V;R-=V;w.back+=V;w.length=X;if(W===0){w.mode=la;break}if(W&32){w.back=-1;w.mode=D;break}if(W&64){k.msg="invalid literal/length code";w.mode=L;break}w.extra=W&15;w.mode=ja;case ja:if(w.extra){ya=w.extra;while(R<ya){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}w.length+=Q&(1<<w.extra)-1;Q>>>=w.extra;R-=w.extra;w.back+=w.extra}w.was=w.length;w.mode=I;case I:for(;;){U=w.distcode[Q&(1<<w.distbits)-1];V=U>>>24;W=U>>>16&255;X=U&65535;if(V<=R)break;if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}if((W&240)===0){Y=V;$=W;ua=X;for(;;){U=w.distcode[ua+((Q&(1<<Y+$)-1)>>Y)];V=U>>>24;W=U>>>16&255;X=U&65535;if(Y+V<=R)break;if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}Q>>>=Y;R-=Y;w.back+=Y}Q>>>=V;R-=V;w.back+=V;if(W&64){k.msg="invalid distance code";w.mode=L;break}w.offset=X;w.extra=W&15;w.mode=J;case J:if(w.extra){ya=w.extra;while(R<ya){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}w.offset+=Q&(1<<w.extra)-1;Q>>>=w.extra;R-=w.extra;w.back+=w.extra}if(w.offset>w.dmax){k.msg="invalid distance too far back";w.mode=L;break}w.mode=ka;case ka:if(P===0)break inf_leave;T=S-P;if(w.offset>T){T=w.offset-T;if(T>w.whave&&w.sane){k.msg="invalid distance too far back";w.mode=L;break}T>w.wnext?(T-=w.wnext,U=w.wsize-T):U=w.wnext-T;T>w.length&&(T=w.length);$=w.window}else $=qa,U=N-w.offset,T=w.length;T>P&&(T=P);P-=T;w.length-=T;do qa[N++]=$[U++];while(--T);w.length===0&&(w.mode=ia);break;case la:if(P===0)break inf_leave;qa[N++]=w.length;P--;w.mode=ia;break;case ma:if(w.wrap){while(R<32){if(O===0)break inf_leave;O--;Q|=K[M++]<<R;R+=8}S-=P;k.total_out+=S;w.total+=S;S&&(k.adler=w.check=w.flags?c(w.check,qa,S,N-S):b(w.check,qa,S,N-S));S=P;if((w.flags?Q:sa(Q))!==w.check){k.msg="incorrect data check";w.mode=L;break}Q=0;R=0}w.mode=na;case na:if(w.wrap&&w.flags){while(R<32){if(O===0)break inf_leave;O--;Q+=K[M++]<<R;R+=8}if(Q!==(w.total&4294967295)){k.msg="incorrect length check";w.mode=L;break}Q=0;R=0}w.mode=oa;case oa:xa=n;break inf_leave;case L:xa=q;break inf_leave;case pa:return r;case ra:default:return p}k.next_out=N;k.avail_out=P;k.next_in=M;k.avail_in=O;w.hold=Q;w.bits=R;if((w.wsize||S!==k.avail_out&&w.mode<L&&(w.mode<ma||s!==i))&&wa(k,k.output,k.next_out,S-k.avail_out)){w.mode=pa;return r}ta-=k.avail_in;S-=k.avail_out;k.total_in+=ta;k.total_out+=S;w.total+=S;w.wrap&&S&&(k.adler=w.check=w.flags?c(w.check,qa,S,k.next_out-S):b(w.check,qa,S,k.next_out-S));k.data_type=w.bits+(w.last?64:0)+(w.mode===D?128:0)+(w.mode===H||w.mode===E?256:0);(ta===0&&S===0||s===i)&&xa===m&&(xa=aa);return xa}function xa(a){if(!a||!a.state)return p;var b=a.state;b.window&&(b.window=null);a.state=null;return m}function Z(a,b){if(!a||!a.state)return p;a=a.state;if((a.wrap&2)===0)return p;a.head=b;b.done=!1;return m}function $(a,c){var d=c.length,e,f;if(!a||!a.state)return p;e=a.state;if(e.wrap!==0&&e.mode!==da)return p;if(e.mode===da){f=1;f=b(f,c,d,0);if(f!==e.check)return q}f=wa(a,c,d,d);if(f){e.mode=pa;return r}e.havedict=1;return m}M.inflateReset=S;M.inflateReset2=T;M.inflateResetKeep=ta;M.inflateInit=V;M.inflateInit2=U;M.inflate=Y;M.inflateEnd=xa;M.inflateGetHeader=Z;M.inflateSetDictionary=$;M.inflateInfo="pako inflate (from Nodeca project)"}var O=!1;function P(){O||(O=!0,N());return ra.exports}d={};var Q={exports:d};function sa(){Q.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}}var R=!1;function ta(){R||(R=!0,sa());return Q.exports}f={};var S={exports:f};function T(){function a(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}S.exports=a}var U=!1;function V(){U||(U=!0,T());return S.exports}var W={},X={exports:W};function ua(){var a=P(),b=k(),c=ga(),d=ta(),e=A(),f=H(),g=V(),h=Object.prototype.toString;function i(j){if(!(this instanceof i))return new i(j);this.options=b.assign({chunkSize:16384,windowBits:0,to:""},j||{});var k=this.options;k.raw&&k.windowBits>=0&&k.windowBits<16&&(k.windowBits=-k.windowBits,k.windowBits===0&&(k.windowBits=-15));k.windowBits>=0&&k.windowBits<16&&!(j&&j.windowBits)&&(k.windowBits+=32);k.windowBits>15&&k.windowBits<48&&((k.windowBits&15)===0&&(k.windowBits|=15));this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new f();this.strm.avail_out=0;j=a.inflateInit2(this.strm,k.windowBits);if(j!==d.Z_OK)throw new Error(e[j]);this.header=new g();a.inflateGetHeader(this.strm,this.header);if(k.dictionary){typeof k.dictionary==="string"?k.dictionary=c.string2buf(k.dictionary):h.call(k.dictionary)==="[object ArrayBuffer]"&&(k.dictionary=new Uint8Array(k.dictionary));if(k.raw){j=a.inflateSetDictionary(this.strm,k.dictionary);if(j!==d.Z_OK)throw new Error(e[j])}}}i.prototype.push=function(e,f){var g=this.strm,i=this.options.chunkSize,j=this.options.dictionary,k,l,m,n=!1;if(this.ended)return!1;f=f===~~f?f:f===!0?d.Z_FINISH:d.Z_NO_FLUSH;typeof e==="string"?g.input=c.binstring2buf(e):h.call(e)==="[object ArrayBuffer]"?g.input=new Uint8Array(e):g.input=e;g.next_in=0;g.avail_in=g.input.length;do{g.avail_out===0&&(g.output=new b.Buf8(i),g.next_out=0,g.avail_out=i);e=a.inflate(g,d.Z_NO_FLUSH);e===d.Z_NEED_DICT&&j&&(e=a.inflateSetDictionary(this.strm,j));e===d.Z_BUF_ERROR&&n===!0&&(e=d.Z_OK,n=!1);if(e!==d.Z_STREAM_END&&e!==d.Z_OK){this.onEnd(e);this.ended=!0;return!1}g.next_out&&((g.avail_out===0||e===d.Z_STREAM_END||g.avail_in===0&&(f===d.Z_FINISH||f===d.Z_SYNC_FLUSH))&&(this.options.to==="string"?(k=c.utf8border(g.output,g.next_out),l=g.next_out-k,m=c.buf2string(g.output,k),g.next_out=l,g.avail_out=i-l,l&&b.arraySet(g.output,g.output,k,l,0),this.onData(m)):this.onData(b.shrinkBuf(g.output,g.next_out))));g.avail_in===0&&g.avail_out===0&&(n=!0)}while((g.avail_in>0||g.avail_out===0)&&e!==d.Z_STREAM_END);e===d.Z_STREAM_END&&(f=d.Z_FINISH);if(f===d.Z_FINISH){e=a.inflateEnd(this.strm);this.onEnd(e);this.ended=!0;return e===d.Z_OK}if(f===d.Z_SYNC_FLUSH){this.onEnd(d.Z_OK);g.avail_out=0;return!0}return!0};i.prototype.onData=function(a){this.chunks.push(a)};i.prototype.onEnd=function(a){a===d.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=b.flattenChunks(this.chunks)),this.chunks=[],this.err=a,this.msg=this.strm.msg};function j(a,b){b=new i(b);b.push(a,!0);if(b.err)throw b.msg||e[b.err];return b.result}function l(a,b){b=b||{};b.raw=!0;return j(a,b)}W.Inflate=i;W.inflate=j;W.inflateRaw=l;W.ungzip=j}var va=!1;function wa(){va||(va=!0,ua());return X.exports}b={};var Y={exports:b};function xa(){var a=k().assign,b=ka(),c=wa(),d=ta(),e={};a(e,b,c,d);Y.exports=e}var Z=!1;function $(){Z||(Z=!0,xa());return Y.exports}function a(a){switch(a){case void 0:return $()}}e.exports=a}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("process-nextick-args-2.0.0",[],(function(a,b,c,d,e,f){"use strict";b={};var g={exports:b};function h(){!process.version||process.version.indexOf("v0.")===0||process.version.indexOf("v1.")===0&&process.version.indexOf("v1.8.")!==0?g.exports={nextTick:a}:g.exports=process;function a(a,b,c,d){if(typeof a!=="function")throw new TypeError('"callback" argument must be a function');var e=arguments.length,f,g;switch(e){case 0:case 1:return process.nextTick(a);case 2:return process.nextTick(function(){a.call(null,b)});case 3:return process.nextTick(function(){a.call(null,b,c)});case 4:return process.nextTick(function(){a.call(null,b,c,d)});default:f=new Array(e-1);g=0;while(g<f.length)f[g++]=arguments[g];return process.nextTick(function(){a.apply(null,f)})}}}var i=!1;function j(){i||(i=!0,h());return g.exports}function a(a){switch(a){case void 0:return j()}}e.exports=a}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("safe-buffer-5.1.2",[],(function(a,b,c,d,e,f){"use strict";var g={},h={exports:g};function i(){var a={},b=a.Buffer;function c(a,b){for(var c in a)b[c]=a[c]}b.from&&b.alloc&&b.allocUnsafe&&b.allocUnsafeSlow?h.exports=a:(c(a,g),g.Buffer=d);function d(a,c,d){return b(a,c,d)}c(b,d);d.from=function(a,c,d){if(typeof a==="number")throw new TypeError("Argument must not be a number");return b(a,c,d)};d.alloc=function(a,c,d){if(typeof a!=="number")throw new TypeError("Argument must be a number");a=b(a);c!==void 0?typeof d==="string"?a.fill(c,d):a.fill(c):a.fill(0);return a};d.allocUnsafe=function(a){if(typeof a!=="number")throw new TypeError("Argument must be a number");return b(a)};d.allocUnsafeSlow=function(b){if(typeof b!=="number")throw new TypeError("Argument must be a number");return a.SlowBuffer(b)}}var j=!1;function k(){j||(j=!0,i());return h.exports}function a(a){switch(a){case void 0:return k()}}e.exports=a}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("util-deprecate-1.0.2",[],(function(a,b,c,d,e,f){"use strict";b={};var g={exports:b};function h(){g.exports={}.deprecate}var i=!1;function j(){i||(i=!0,h());return g.exports}function a(a){switch(a){case void 0:return j()}}e.exports=a}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("readable-stream-2.3.6",["safe-buffer-5.1.2","process-nextick-args-2.0.0","core-util-is-1.0.2","inherits-2.0.3","util-deprecate-1.0.2","isarray-1.0.0"],(function(a,b,c,d,e,f){"use strict";function c(a){return a&&typeof a==="object"&&"default"in a?a["default"]:a}var g=c(b("safe-buffer-5.1.2")),h=c(b("process-nextick-args-2.0.0")),i=c(b("core-util-is-1.0.2")),j=c(b("inherits-2.0.3")),k=c(b("util-deprecate-1.0.2")),l=c(b("isarray-1.0.0"));c={};var m={exports:c};function n(){m.exports={}}var o=!1;function p(){o||(o=!0,n());return m.exports}b={};var q={exports:b};function r(){function a(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var b=g().Buffer,c={};function d(a,b,c){a.copy(b,c)}q.exports=function(){function c(){a(this,c),this.head=null,this.tail=null,this.length=0}c.prototype.push=function(a){a={data:a,next:null};this.length>0?this.tail.next=a:this.head=a;this.tail=a;++this.length};c.prototype.unshift=function(a){a={data:a,next:this.head};this.length===0&&(this.tail=a);this.head=a;++this.length};c.prototype.shift=function(){if(this.length===0)return;var a=this.head.data;this.length===1?this.head=this.tail=null:this.head=this.head.next;--this.length;return a};c.prototype.clear=function(){this.head=this.tail=null,this.length=0};c.prototype.join=function(a){if(this.length===0)return"";var b=this.head,c=""+b.data;while(b=b.next)c+=a+b.data;return c};c.prototype.concat=function(a){if(this.length===0)return b.alloc(0);if(this.length===1)return this.head.data;a=b.allocUnsafe(a>>>0);var c=this.head,e=0;while(c)d(c.data,a,e),e+=c.data.length,c=c.next;return a};return c}();c&&c.inspect&&c.inspect.custom&&(q.exports.prototype[c.inspect.custom]=function(){var a=c.inspect({length:this.length});return this.constructor.name+" "+a})}var s=!1;function t(){s||(s=!0,r());return q.exports}c={};var u={exports:c};function v(){var a=h();function b(b,c){var e=this,f=this._readableState&&this._readableState.destroyed,g=this._writableState&&this._writableState.destroyed;if(f||g){c?c(b):b&&(!this._writableState||!this._writableState.errorEmitted)&&a.nextTick(d,this,b);return this}this._readableState&&(this._readableState.destroyed=!0);this._writableState&&(this._writableState.destroyed=!0);this._destroy(b||null,function(b){!c&&b?(a.nextTick(d,e,b),e._writableState&&(e._writableState.errorEmitted=!0)):c&&c(b)});return this}function c(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function d(a,b){a.emit("error",b)}u.exports={destroy:b,undestroy:c}}var w=!1;function x(){w||(w=!0,v());return u.exports}b={};var y={exports:b};function z(){var b=h();y.exports=w;function c(a){var b=this;this.next=null;this.entry=null;this.finish=function(){Q(b,a)}}var d=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:b.nextTick,e;w.WritableState=u;var f=i();f.inherits=j();var l={deprecate:k()},m=p(),n=g().Buffer,o=a.Uint8Array||function(){};function q(a){return n.from(a)}function r(a){return n.isBuffer(a)||a instanceof o}var s=x();f.inherits(w,m);function t(){}function u(a,b){e=e||F();a=a||{};var d=b instanceof e;this.objectMode=!!a.objectMode;d&&(this.objectMode=this.objectMode||!!a.writableObjectMode);var f=a.highWaterMark,g=a.writableHighWaterMark,h=this.objectMode?16:16*1024;f||f===0?this.highWaterMark=f:d&&(g||g===0)?this.highWaterMark=g:this.highWaterMark=h;this.highWaterMark=Math.floor(this.highWaterMark);this.finalCalled=!1;this.needDrain=!1;this.ending=!1;this.ended=!1;this.finished=!1;this.destroyed=!1;f=a.decodeStrings===!1;this.decodeStrings=!f;this.defaultEncoding=a.defaultEncoding||"utf8";this.length=0;this.writing=!1;this.corked=0;this.sync=!0;this.bufferProcessing=!1;this.onwrite=function(a){H(b,a)};this.writecb=null;this.writelen=0;this.bufferedRequest=null;this.lastBufferedRequest=null;this.pendingcb=0;this.prefinished=!1;this.errorEmitted=!1;this.bufferedRequestCount=0;this.corkedRequestsFree=new c(this)}u.prototype.getBuffer=function(){var a=this.bufferedRequest,b=[];while(a)b.push(a),a=a.next;return b};(function(){try{Object.defineProperty(u.prototype,"buffer",{get:l.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(a){}})();var v;typeof Symbol==="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]==="function"?(v=Function.prototype[Symbol.hasInstance],Object.defineProperty(w,Symbol.hasInstance,{value:function(a){if(v.call(this,a))return!0;return this!==w?!1:a&&a._writableState instanceof u}})):v=function(a){return a instanceof this};function w(a){e=e||F();if(!v.call(w,this)&&!(this instanceof e))return new w(a);this._writableState=new u(a,this);this.writable=!0;a&&(typeof a.write==="function"&&(this._write=a.write),typeof a.writev==="function"&&(this._writev=a.writev),typeof a.destroy==="function"&&(this._destroy=a.destroy),typeof a["final"]==="function"&&(this._final=a["final"]));m.call(this)}w.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function z(a,c){var d=new Error("write after end");a.emit("error",d);b.nextTick(c,d)}function A(a,c,d,e){var f=!0,g=!1;d===null?g=new TypeError("May not write null values to stream"):typeof d!=="string"&&d!==void 0&&!c.objectMode&&(g=new TypeError("Invalid non-string/buffer chunk"));g&&(a.emit("error",g),b.nextTick(e,g),f=!1);return f}w.prototype.write=function(a,b,c){var d=this._writableState,e=!1,f=!d.objectMode&&r(a);f&&!n.isBuffer(a)&&(a=q(a));typeof b==="function"&&(c=b,b=null);f?b="buffer":b||(b=d.defaultEncoding);typeof c!=="function"&&(c=t);d.ended?z(this,c):(f||A(this,d,a,c))&&(d.pendingcb++,e=C(this,d,f,a,b,c));return e};w.prototype.cork=function(){var a=this._writableState;a.corked++};w.prototype.uncork=function(){var a=this._writableState;a.corked&&(a.corked--,!a.writing&&!a.corked&&!a.finished&&!a.bufferProcessing&&a.bufferedRequest&&K(this,a))};w.prototype.setDefaultEncoding=function(a){typeof a==="string"&&(a=a.toLowerCase());if(!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((a+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+a);this._writableState.defaultEncoding=a;return this};function B(a,b,c){!a.objectMode&&a.decodeStrings!==!1&&typeof b==="string"&&(b=n.from(b,c));return b}Object.defineProperty(w.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function C(a,b,c,d,e,f){if(!c){var g=B(b,d,e);d!==g&&(c=!0,e="buffer",d=g)}g=b.objectMode?1:d.length;b.length+=g;var h=b.length<b.highWaterMark;h||(b.needDrain=!0);if(b.writing||b.corked){var i=b.lastBufferedRequest;b.lastBufferedRequest={chunk:d,encoding:e,isBuf:c,callback:f,next:null};i?i.next=b.lastBufferedRequest:b.bufferedRequest=b.lastBufferedRequest;b.bufferedRequestCount+=1}else D(a,b,!1,g,d,e,f);return h}function D(a,b,c,d,e,f,g){b.writelen=d,b.writecb=g,b.writing=!0,b.sync=!0,c?a._writev(e,b.onwrite):a._write(e,f,b.onwrite),b.sync=!1}function E(a,c,d,e,f){--c.pendingcb,d?(b.nextTick(f,e),b.nextTick(O,a,c),a._writableState.errorEmitted=!0,a.emit("error",e)):(f(e),a._writableState.errorEmitted=!0,a.emit("error",e),O(a,c))}function G(a){a.writing=!1,a.writecb=null,a.length-=a.writelen,a.writelen=0}function H(a,b){var c=a._writableState,e=c.sync,f=c.writecb;G(c);if(b)E(a,c,e,b,f);else{b=L(c);!b&&!c.corked&&!c.bufferProcessing&&c.bufferedRequest&&K(a,c);e?d(I,a,c,b,f):I(a,c,b,f)}}function I(a,b,c,d){c||J(a,b),b.pendingcb--,d(),O(a,b)}function J(a,b){b.length===0&&b.needDrain&&(b.needDrain=!1,a.emit("drain"))}function K(a,b){b.bufferProcessing=!0;var d=b.bufferedRequest;if(a._writev&&d&&d.next){var e=b.bufferedRequestCount;e=new Array(e);var f=b.corkedRequestsFree;f.entry=d;var g=0,h=!0;while(d)e[g]=d,d.isBuf||(h=!1),d=d.next,g+=1;e.allBuffers=h;D(a,b,!0,b.length,e,"",f.finish);b.pendingcb++;b.lastBufferedRequest=null;f.next?(b.corkedRequestsFree=f.next,f.next=null):b.corkedRequestsFree=new c(b);b.bufferedRequestCount=0}else{while(d){g=d.chunk;h=d.encoding;e=d.callback;f=b.objectMode?1:g.length;D(a,b,!1,f,g,h,e);d=d.next;b.bufferedRequestCount--;if(b.writing)break}d===null&&(b.lastBufferedRequest=null)}b.bufferedRequest=d;b.bufferProcessing=!1}w.prototype._write=function(a,b,c){c(new Error("_write() is not implemented"))};w.prototype._writev=null;w.prototype.end=function(a,b,c){var d=this._writableState;typeof a==="function"?(c=a,a=null,b=null):typeof b==="function"&&(c=b,b=null);a!==null&&a!==void 0&&this.write(a,b);d.corked&&(d.corked=1,this.uncork());!d.ending&&!d.finished&&P(this,d,c)};function L(a){return a.ending&&a.length===0&&a.bufferedRequest===null&&!a.finished&&!a.writing}function M(a,b){a._final(function(c){b.pendingcb--,c&&a.emit("error",c),b.prefinished=!0,a.emit("prefinish"),O(a,b)})}function N(a,c){!c.prefinished&&!c.finalCalled&&(typeof a._final==="function"?(c.pendingcb++,c.finalCalled=!0,b.nextTick(M,a,c)):(c.prefinished=!0,a.emit("prefinish")))}function O(a,b){var c=L(b);c&&(N(a,b),b.pendingcb===0&&(b.finished=!0,a.emit("finish")));return c}function P(a,c,d){c.ending=!0,O(a,c),d&&(c.finished?b.nextTick(d):a.once("finish",d)),c.ended=!0,a.writable=!1}function Q(a,b,c){var d=a.entry;a.entry=null;while(d){var e=d.callback;b.pendingcb--;e(c);d=d.next}b.corkedRequestsFree?b.corkedRequestsFree.next=a:b.corkedRequestsFree=a}Object.defineProperty(w.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(a){if(!this._writableState)return;this._writableState.destroyed=a}});w.prototype.destroy=s.destroy;w.prototype._undestroy=s.undestroy;w.prototype._destroy=function(a,b){this.end(),b(a)}}var A=!1;function B(){A||(A=!0,z());return y.exports}c={};var C={exports:c};function D(){var a=h(),b=Object.keys||function(a){var b=[];for(a in a)b.push(a);return b};C.exports=g;var c=i();c.inherits=j();var d=O(),e=B();c.inherits(g,d);c=b(e.prototype);for(b=0;b<c.length;b++){var f=c[b];g.prototype[f]||(g.prototype[f]=e.prototype[f])}function g(a){if(!(this instanceof g))return new g(a);d.call(this,a);e.call(this,a);a&&a.readable===!1&&(this.readable=!1);a&&a.writable===!1&&(this.writable=!1);this.allowHalfOpen=!0;a&&a.allowHalfOpen===!1&&(this.allowHalfOpen=!1);this.once("end",k)}Object.defineProperty(g.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function k(){if(this.allowHalfOpen||this._writableState.ended)return;a.nextTick(l,this)}function l(a){a.end()}Object.defineProperty(g.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(a){if(this._readableState===void 0||this._writableState===void 0)return;this._readableState.destroyed=a;this._writableState.destroyed=a}});g.prototype._destroy=function(b,c){this.push(null),this.end(),a.nextTick(c,b)}}var E=!1;function F(){E||(E=!0,D());return C.exports}var G={},H={exports:G};function I(){var a=g().Buffer,b=a.isEncoding||function(a){a=""+a;switch(a&&a.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function c(a){if(!a)return"utf8";var b;while(!0)switch(a){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return a;default:if(b)return;a=(""+a).toLowerCase();b=!0}}function d(d){var e=c(d);if(typeof e!=="string"&&(a.isEncoding===b||!b(d)))throw new Error("Unknown encoding: "+d);return e||d}G.StringDecoder=e;function e(b){this.encoding=d(b);var c;switch(this.encoding){case"utf16le":this.text=m;this.end=n;c=4;break;case"utf8":this.fillLast=j;c=4;break;case"base64":this.text=o;this.end=p;c=3;break;default:this.write=q;this.end=r;return}this.lastNeed=0;this.lastTotal=0;this.lastChar=a.allocUnsafe(c)}e.prototype.write=function(a){if(a.length===0)return"";var b,c;if(this.lastNeed){b=this.fillLast(a);if(b===void 0)return"";c=this.lastNeed;this.lastNeed=0}else c=0;return c<a.length?b?b+this.text(a,c):this.text(a,c):b||""};e.prototype.end=l;e.prototype.text=k;e.prototype.fillLast=function(a){if(this.lastNeed<=a.length){a.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed);return this.lastChar.toString(this.encoding,0,this.lastTotal)}a.copy(this.lastChar,this.lastTotal-this.lastNeed,0,a.length);this.lastNeed-=a.length};function f(a){if(a<=127)return 0;else if(a>>5===6)return 2;else if(a>>4===14)return 3;else if(a>>3===30)return 4;return a>>6===2?-1:-2}function h(a,b,c){var d=b.length-1;if(d<c)return 0;var e=f(b[d]);if(e>=0){e>0&&(a.lastNeed=e-1);return e}if(--d<c||e===-2)return 0;e=f(b[d]);if(e>=0){e>0&&(a.lastNeed=e-2);return e}if(--d<c||e===-2)return 0;e=f(b[d]);if(e>=0){e>0&&(e===2?e=0:a.lastNeed=e-3);return e}return 0}function i(a,b,c){if((b[0]&192)!==128){a.lastNeed=0;return"\ufffd"}if(a.lastNeed>1&&b.length>1){if((b[1]&192)!==128){a.lastNeed=1;return"\ufffd"}if(a.lastNeed>2&&b.length>2&&(b[2]&192)!==128){a.lastNeed=2;return"\ufffd"}}}function j(a){var b=this.lastTotal-this.lastNeed,c=i(this,a,b);if(c!==void 0)return c;if(this.lastNeed<=a.length){a.copy(this.lastChar,b,0,this.lastNeed);return this.lastChar.toString(this.encoding,0,this.lastTotal)}a.copy(this.lastChar,b,0,a.length);this.lastNeed-=a.length}function k(a,b){var c=h(this,a,b);if(!this.lastNeed)return a.toString("utf8",b);this.lastTotal=c;c=a.length-(c-this.lastNeed);a.copy(this.lastChar,0,c);return a.toString("utf8",b,c)}function l(a){a=a&&a.length?this.write(a):"";return this.lastNeed?a+"\ufffd":a}function m(a,b){if((a.length-b)%2===0){var c=a.toString("utf16le",b);if(c){var d=c.charCodeAt(c.length-1);if(d>=55296&&d<=56319){this.lastNeed=2;this.lastTotal=4;this.lastChar[0]=a[a.length-2];this.lastChar[1]=a[a.length-1];return c.slice(0,-1)}}return c}this.lastNeed=1;this.lastTotal=2;this.lastChar[0]=a[a.length-1];return a.toString("utf16le",b,a.length-1)}function n(a){a=a&&a.length?this.write(a):"";if(this.lastNeed){var b=this.lastTotal-this.lastNeed;return a+this.lastChar.toString("utf16le",0,b)}return a}function o(a,b){var c=(a.length-b)%3;if(c===0)return a.toString("base64",b);this.lastNeed=3-c;this.lastTotal=3;c===1?this.lastChar[0]=a[a.length-1]:(this.lastChar[0]=a[a.length-2],this.lastChar[1]=a[a.length-1]);return a.toString("base64",b,a.length-c)}function p(a){a=a&&a.length?this.write(a):"";return this.lastNeed?a+this.lastChar.toString("base64",0,3-this.lastNeed):a}function q(a){return a.toString(this.encoding)}function r(a){return a&&a.length?this.write(a):""}}var J=!1;function K(){J||(J=!0,I());return H.exports}b={};var L={exports:b};function M(){var b=h();L.exports=A;var c=l(),d;A.ReadableState=z;var e=function(a,b){return a.listeners(b).length},f=p(),k=g().Buffer,m=a.Uint8Array||function(){};function n(a){return k.from(a)}function o(a){return k.isBuffer(a)||a instanceof m}var q=i();q.inherits=j();var r={},s=void 0;r&&r.debuglog?s=r.debuglog("stream"):s=function(){};var u=t();r=x();var v;q.inherits(A,f);var w=["error","close","destroy","pause","resume"];function y(a,b,d){if(typeof a.prependListener==="function")return a.prependListener(b,d);!a._events||!a._events[b]?a.on(b,d):c(a._events[b])?a._events[b].unshift(d):a._events[b]=[d,a._events[b]]}function z(a,b){d=d||F();a=a||{};b=b instanceof d;this.objectMode=!!a.objectMode;b&&(this.objectMode=this.objectMode||!!a.readableObjectMode);var c=a.highWaterMark,e=a.readableHighWaterMark,f=this.objectMode?16:16*1024;c||c===0?this.highWaterMark=c:b&&(e||e===0)?this.highWaterMark=e:this.highWaterMark=f;this.highWaterMark=Math.floor(this.highWaterMark);this.buffer=new u();this.length=0;this.pipes=null;this.pipesCount=0;this.flowing=null;this.ended=!1;this.endEmitted=!1;this.reading=!1;this.sync=!0;this.needReadable=!1;this.emittedReadable=!1;this.readableListening=!1;this.resumeScheduled=!1;this.destroyed=!1;this.defaultEncoding=a.defaultEncoding||"utf8";this.awaitDrain=0;this.readingMore=!1;this.decoder=null;this.encoding=null;a.encoding&&(v||(v=K("/").StringDecoder),this.decoder=new v(a.encoding),this.encoding=a.encoding)}function A(a){d=d||F();if(!(this instanceof A))return new A(a);this._readableState=new z(a,this);this.readable=!0;a&&(typeof a.read==="function"&&(this._read=a.read),typeof a.destroy==="function"&&(this._destroy=a.destroy));f.call(this)}Object.defineProperty(A.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(a){if(!this._readableState)return;this._readableState.destroyed=a}});A.prototype.destroy=r.destroy;A.prototype._undestroy=r.undestroy;A.prototype._destroy=function(a,b){this.push(null),b(a)};A.prototype.push=function(a,b){var c=this._readableState,d;!c.objectMode?typeof a==="string"&&(b=b||c.defaultEncoding,b!==c.encoding&&(a=k.from(a,b),b=""),d=!0):d=!0;return B(this,a,b,!1,d)};A.prototype.unshift=function(a){return B(this,a,null,!0,!1)};function B(a,b,c,d,e){var f=a._readableState;if(b===null)f.reading=!1,J(a,f);else{var g;e||(g=D(f,b));g?a.emit("error",g):f.objectMode||b&&b.length>0?(typeof b!=="string"&&!f.objectMode&&Object.getPrototypeOf(b)!==k.prototype&&(b=n(b)),d?f.endEmitted?a.emit("error",new Error("stream.unshift() after end event")):C(a,f,b,!0):f.ended?a.emit("error",new Error("stream.push() after EOF")):(f.reading=!1,f.decoder&&!c?(b=f.decoder.write(b),f.objectMode||b.length!==0?C(a,f,b,!1):O(a,f)):C(a,f,b,!1))):d||(f.reading=!1)}return E(f)}function C(a,b,c,d){b.flowing&&b.length===0&&!b.sync?(a.emit("data",c),a.read(0)):(b.length+=b.objectMode?1:c.length,d?b.buffer.unshift(c):b.buffer.push(c),b.needReadable&&M(a)),O(a,b)}function D(a,b){var c;!o(b)&&typeof b!=="string"&&b!==void 0&&!a.objectMode&&(c=new TypeError("Invalid non-string/buffer chunk"));return c}function E(a){return!a.ended&&(a.needReadable||a.length<a.highWaterMark||a.length===0)}A.prototype.isPaused=function(){return this._readableState.flowing===!1};A.prototype.setEncoding=function(a){v||(v=K("/").StringDecoder);this._readableState.decoder=new v(a);this._readableState.encoding=a;return this};var G=8388608;function H(a){a>=G?a=G:(a--,a|=a>>>1,a|=a>>>2,a|=a>>>4,a|=a>>>8,a|=a>>>16,a++);return a}function I(a,b){if(a<=0||b.length===0&&b.ended)return 0;if(b.objectMode)return 1;if(a!==a)if(b.flowing&&b.length)return b.buffer.head.data.length;else return b.length;a>b.highWaterMark&&(b.highWaterMark=H(a));if(a<=b.length)return a;if(!b.ended){b.needReadable=!0;return 0}return b.length}A.prototype.read=function(a){s("read",a);a=parseInt(a,10);var b=this._readableState,c=a;a!==0&&(b.emittedReadable=!1);if(a===0&&b.needReadable&&(b.length>=b.highWaterMark||b.ended)){s("read: emitReadable",b.length,b.ended);b.length===0&&b.ended?Z(this):M(this);return null}a=I(a,b);if(a===0&&b.ended){b.length===0&&Z(this);return null}var d=b.needReadable;s("need readable",d);(b.length===0||b.length-a<b.highWaterMark)&&(d=!0,s("length less than watermark",d));b.ended||b.reading?(d=!1,s("reading or ended",d)):d&&(s("do read"),b.reading=!0,b.sync=!0,b.length===0&&(b.needReadable=!0),this._read(b.highWaterMark),b.sync=!1,b.reading||(a=I(c,b)));a>0?d=V(a,b):d=null;d===null?(b.needReadable=!0,a=0):b.length-=a;b.length===0&&(b.ended||(b.needReadable=!0),c!==a&&b.ended&&Z(this));d!==null&&this.emit("data",d);return d};function J(a,b){if(b.ended)return;if(b.decoder){var c=b.decoder.end();c&&c.length&&(b.buffer.push(c),b.length+=b.objectMode?1:c.length)}b.ended=!0;M(a)}function M(a){var c=a._readableState;c.needReadable=!1;c.emittedReadable||(s("emitReadable",c.flowing),c.emittedReadable=!0,c.sync?b.nextTick(N,a):N(a))}function N(a){s("emit readable"),a.emit("readable"),U(a)}function O(a,c){c.readingMore||(c.readingMore=!0,b.nextTick(P,a,c))}function P(a,b){var c=b.length;while(!b.reading&&!b.flowing&&!b.ended&&b.length<b.highWaterMark){s("maybeReadMore read 0");a.read(0);if(c===b.length)break;else c=b.length}b.readingMore=!1}A.prototype._read=function(a){this.emit("error",new Error("_read() is not implemented"))};A.prototype.pipe=function(a,c){var d=this,f=this._readableState;switch(f.pipesCount){case 0:f.pipes=a;break;case 1:f.pipes=[f.pipes,a];break;default:f.pipes.push(a);break}f.pipesCount+=1;s("pipe count=%d opts=%j",f.pipesCount,c);c=(!c||c.end!==!1)&&a!==process.stdout&&a!==process.stderr;c=c?h:q;f.endEmitted?b.nextTick(c):d.once("end",c);a.on("unpipe",g);function g(a,b){s("onunpipe"),a===d&&(b&&b.hasUnpiped===!1&&(b.hasUnpiped=!0,k()))}function h(){s("onend"),a.end()}var i=Q(d);a.on("drain",i);var j=!1;function k(){s("cleanup"),a.removeListener("close",o),a.removeListener("finish",p),a.removeListener("drain",i),a.removeListener("error",n),a.removeListener("unpipe",g),d.removeListener("end",h),d.removeListener("end",q),d.removeListener("data",m),j=!0,f.awaitDrain&&(!a._writableState||a._writableState.needDrain)&&i()}var l=!1;d.on("data",m);function m(b){s("ondata");l=!1;b=a.write(b);!1===b&&!l&&((f.pipesCount===1&&f.pipes===a||f.pipesCount>1&&aa(f.pipes,a)!==-1)&&!j&&(s("false write response, pause",d._readableState.awaitDrain),d._readableState.awaitDrain++,l=!0),d.pause())}function n(b){s("onerror",b),q(),a.removeListener("error",n),e(a,"error")===0&&a.emit("error",b)}y(a,"error",n);function o(){a.removeListener("finish",p),q()}a.once("close",o);function p(){s("onfinish"),a.removeListener("close",o),q()}a.once("finish",p);function q(){s("unpipe"),d.unpipe(a)}a.emit("pipe",d);f.flowing||(s("pipe resume"),d.resume());return a};function Q(a){return function(){var b=a._readableState;s("pipeOnDrain",b.awaitDrain);b.awaitDrain&&b.awaitDrain--;b.awaitDrain===0&&e(a,"data")&&(b.flowing=!0,U(a))}}A.prototype.unpipe=function(a){var b=this._readableState,c={hasUnpiped:!1};if(b.pipesCount===0)return this;if(b.pipesCount===1){if(a&&a!==b.pipes)return this;a||(a=b.pipes);b.pipes=null;b.pipesCount=0;b.flowing=!1;a&&a.emit("unpipe",this,c);return this}if(!a){var d=b.pipes,e=b.pipesCount;b.pipes=null;b.pipesCount=0;b.flowing=!1;for(var f=0;f<e;f++)d[f].emit("unpipe",this,c);return this}d=aa(b.pipes,a);if(d===-1)return this;b.pipes.splice(d,1);b.pipesCount-=1;b.pipesCount===1&&(b.pipes=b.pipes[0]);a.emit("unpipe",this,c);return this};A.prototype.on=function(a,c){c=f.prototype.on.call(this,a,c);if(a==="data")this._readableState.flowing!==!1&&this.resume();else if(a==="readable"){a=this._readableState;!a.endEmitted&&!a.readableListening&&(a.readableListening=a.needReadable=!0,a.emittedReadable=!1,!a.reading?b.nextTick(R,this):a.length&&M(this))}return c};A.prototype.addListener=A.prototype.on;function R(a){s("readable nexttick read 0"),a.read(0)}A.prototype.resume=function(){var a=this._readableState;a.flowing||(s("resume"),a.flowing=!0,S(this,a));return this};function S(a,c){c.resumeScheduled||(c.resumeScheduled=!0,b.nextTick(T,a,c))}function T(a,b){b.reading||(s("resume read 0"),a.read(0)),b.resumeScheduled=!1,b.awaitDrain=0,a.emit("resume"),U(a),b.flowing&&!b.reading&&a.read(0)}A.prototype.pause=function(){s("call pause flowing=%j",this._readableState.flowing);!1!==this._readableState.flowing&&(s("pause"),this._readableState.flowing=!1,this.emit("pause"));return this};function U(a){var b=a._readableState;s("flow",b.flowing);while(b.flowing&&a.read()!==null);}A.prototype.wrap=function(a){var b=this,c=this._readableState,d=!1;a.on("end",function(){s("wrapped end");if(c.decoder&&!c.ended){var a=c.decoder.end();a&&a.length&&b.push(a)}b.push(null)});a.on("data",function(e){s("wrapped data");c.decoder&&(e=c.decoder.write(e));if(c.objectMode&&(e===null||e===void 0))return;else if(!c.objectMode&&(!e||!e.length))return;e=b.push(e);e||(d=!0,a.pause())});for(var e in a)this[e]===void 0&&typeof a[e]==="function"&&(this[e]=function(b){return function(){return a[b].apply(a,arguments)}}(e));for(e=0;e<w.length;e++)a.on(w[e],this.emit.bind(this,w[e]));this._read=function(b){s("wrapped _read",b),d&&(d=!1,a.resume())};return this};Object.defineProperty(A.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});A._fromList=V;function V(a,b){if(b.length===0)return null;var c;b.objectMode?c=b.buffer.shift():!a||a>=b.length?(b.decoder?c=b.buffer.join(""):b.buffer.length===1?c=b.buffer.head.data:c=b.buffer.concat(b.length),b.buffer.clear()):c=W(a,b.buffer,b.decoder);return c}function W(a,b,c){var d;a<b.head.data.length?(d=b.head.data.slice(0,a),b.head.data=b.head.data.slice(a)):a===b.head.data.length?d=b.shift():d=c?X(a,b):Y(a,b);return d}function X(a,b){var c=b.head,d=1,e=c.data;a-=e.length;while(c=c.next){var f=c.data,g=a>f.length?f.length:a;g===f.length?e+=f:e+=f.slice(0,a);a-=g;if(a===0){g===f.length?(++d,c.next?b.head=c.next:b.head=b.tail=null):(b.head=c,c.data=f.slice(g));break}++d}b.length-=d;return e}function Y(a,b){var c=k.allocUnsafe(a),d=b.head,e=1;d.data.copy(c);a-=d.data.length;while(d=d.next){var f=d.data,g=a>f.length?f.length:a;f.copy(c,c.length-a,0,g);a-=g;if(a===0){g===f.length?(++e,d.next?b.head=d.next:b.head=b.tail=null):(b.head=d,d.data=f.slice(g));break}++e}b.length-=e;return c}function Z(a){var c=a._readableState;if(c.length>0)throw new Error('"endReadable()" called on non-empty stream');c.endEmitted||(c.ended=!0,b.nextTick($,c,a))}function $(a,b){!a.endEmitted&&a.length===0&&(a.endEmitted=!0,b.readable=!1,b.emit("end"))}function aa(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1}}var N=!1;function O(){N||(N=!0,M());return L.exports}c={};var P={exports:c};function Q(){P.exports=d;var a=F(),b=i();b.inherits=j();b.inherits(d,a);function c(a,b){var c=this._transformState;c.transforming=!1;var d=c.writecb;if(!d)return this.emit("error",new Error("write callback called multiple times"));c.writechunk=null;c.writecb=null;b!=null&&this.push(b);d(a);c=this._readableState;c.reading=!1;(c.needReadable||c.length<c.highWaterMark)&&this._read(c.highWaterMark)}function d(b){if(!(this instanceof d))return new d(b);a.call(this,b);this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null};this._readableState.needReadable=!0;this._readableState.sync=!1;b&&(typeof b.transform==="function"&&(this._transform=b.transform),typeof b.flush==="function"&&(this._flush=b.flush));this.on("prefinish",e)}function e(){var a=this;typeof this._flush==="function"?this._flush(function(b,c){f(a,b,c)}):f(this,null,null)}d.prototype.push=function(b,c){this._transformState.needTransform=!1;return a.prototype.push.call(this,b,c)};d.prototype._transform=function(a,b,c){throw new Error("_transform() is not implemented")};d.prototype._write=function(a,b,c){var d=this._transformState;d.writecb=c;d.writechunk=a;d.writeencoding=b;if(!d.transforming){c=this._readableState;(d.needTransform||c.needReadable||c.length<c.highWaterMark)&&this._read(c.highWaterMark)}};d.prototype._read=function(a){a=this._transformState;a.writechunk!==null&&a.writecb&&!a.transforming?(a.transforming=!0,this._transform(a.writechunk,a.writeencoding,a.afterTransform)):a.needTransform=!0};d.prototype._destroy=function(b,c){var d=this;a.prototype._destroy.call(this,b,function(a){c(a),d.emit("close")})};function f(a,b,c){if(b)return a.emit("error",b);c!=null&&a.push(c);if(a._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(a._transformState.transforming)throw new Error("Calling transform done when still transforming");return a.push(null)}}var R=!1;function S(){R||(R=!0,Q());return P.exports}b={};var T={exports:b};function U(){T.exports=c;var a=S(),b=i();b.inherits=j();b.inherits(c,a);function c(b){if(!(this instanceof c))return new c(b);a.call(this,b)}c.prototype._transform=function(a,b,c){c(null,a)}}var V=!1;function W(){V||(V=!0,U());return T.exports}d={};var X={exports:d};function Y(){var a={};process.env.READABLE_STREAM==="disable"&&a?(X.exports=a,d=X.exports=a.Readable,d.Readable=a.Readable,d.Writable=a.Writable,d.Duplex=a.Duplex,d.Transform=a.Transform,d.PassThrough=a.PassThrough,d.Stream=a):(d=X.exports=O(),d.Stream=a||d,d.Readable=d,d.Writable=B(),d.Duplex=F(),d.Transform=S(),d.PassThrough=W())}var Z=!1;function $(){Z||(Z=!0,Y());return X.exports}function f(a){switch(a){case void 0:return $()}}e.exports=f}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("set-immediate-shim-1.0.1",[],(function(a,b,c,d,e,f){"use strict";b={};var g={exports:b};function h(){g.exports=typeof setImmediate==="function"?setImmediate:function(){var a=[].slice.apply(arguments);a.splice(1,0,0);setTimeout.apply(null,a)}}var i=!1;function j(){i||(i=!0,h());return g.exports}function a(a){switch(a){case void 0:return j()}}e.exports=a}),null);
/**
 * License: https://www.facebook.com/legal/license/cr2jmG-CdKo/
 */
__d("jszip-3.2.0",["readable-stream-2.3.6","set-immediate-shim-1.0.1","lie-3.3.0","pako-1.0.8"],(function(a,b,c,d,e,f){"use strict";var g=b("readable-stream-2.3.6"),h=b("set-immediate-shim-1.0.1"),i=b("lie-3.3.0"),j=b("pako-1.0.8"),k={},l={exports:k};function m(){k.base64=!0;k.array=!0;k.string=!0;k.arraybuffer=typeof ArrayBuffer!=="undefined"&&typeof Uint8Array!=="undefined";k.nodebuffer=typeof Buffer!=="undefined";k.uint8array=typeof Uint8Array!=="undefined";if(typeof ArrayBuffer==="undefined")k.blob=!1;else{var a=new ArrayBuffer(0);try{k.blob=new Blob([a],{type:"application/zip"}).size===0}catch(c){try{var b=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder;b=new b();b.append(a);k.blob=b.getBlob("application/zip").size===0}catch(a){k.blob=!1}}}try{k.nodestream=!!g().Readable}catch(a){k.nodestream=!1}}var n=!1;function o(){n||(n=!0,m());return l.exports}var p={},q={exports:p};function r(){var a=E(),b=o(),c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";p.encode=function(b){var d=[],e,f,g,h,i=0,j=b.length,k=j,l=a.getTypeOf(b)!=="string";while(i<b.length)k=j-i,!l?(e=b.charCodeAt(i++),f=i<j?b.charCodeAt(i++):0,g=i<j?b.charCodeAt(i++):0):(e=b[i++],f=i<j?b[i++]:0,g=i<j?b[i++]:0),h=e>>2,e=(e&3)<<4|f>>4,f=k>1?(f&15)<<2|g>>6:64,g=k>2?g&63:64,d.push(c.charAt(h)+c.charAt(e)+c.charAt(f)+c.charAt(g));return d.join("")};p.decode=function(a){var d,e,f,g,h=0,i=0,j="data:";if(a.substr(0,j.length)===j)throw new Error("Invalid base64 input, it looks like a data url.");a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");j=a.length*3/4;a.charAt(a.length-1)===c.charAt(64)&&j--;a.charAt(a.length-2)===c.charAt(64)&&j--;if(j%1!==0)throw new Error("Invalid base64 input, bad content length.");var k;b.uint8array?k=new Uint8Array(j|0):k=new Array(j|0);while(h<a.length)j=c.indexOf(a.charAt(h++)),e=c.indexOf(a.charAt(h++)),f=c.indexOf(a.charAt(h++)),g=c.indexOf(a.charAt(h++)),j=j<<2|e>>4,e=(e&15)<<4|f>>2,d=(f&3)<<6|g,k[i++]=j,f!==64&&(k[i++]=e),g!==64&&(k[i++]=d);return k}}var s=!1;function t(){s||(s=!0,r());return q.exports}c={};var u={exports:c};function v(){u.exports={isNode:typeof Buffer!=="undefined",newBufferFrom:function(a,b){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(a,b);else{if(typeof a==="number")throw new Error('The "data" argument must not be a number');return new Buffer(a,b)}},allocBuffer:function(a){if(Buffer.alloc)return Buffer.alloc(a);else{a=new Buffer(a);a.fill(0);return a}},isBuffer:function(a){return Buffer.isBuffer(a)},isStream:function(a){return a&&typeof a.on==="function"&&typeof a.pause==="function"&&typeof a.resume==="function"}}}var w=!1;function x(){w||(w=!0,v());return u.exports}d={};var y={exports:d};function z(){var a;typeof Promise!=="undefined"?a=Promise:a=i();y.exports={Promise:a}}var A=!1;function B(){A||(A=!0,z());return y.exports}var C={},aa={exports:C};function ba(){var a=o(),b=t(),c=x(),d=h(),e=B();function f(b){var c;a.uint8array?c=new Uint8Array(b.length):c=new Array(b.length);return i(b,c)}C.newBlob=function(a,b){C.checkSupport("blob");try{return new Blob([a],{type:b})}catch(d){try{var c=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder;c=new c();c.append(a);return c.getBlob(b)}catch(a){throw new Error("Bug : can't construct the Blob.")}}};function g(a){return a}function i(a,b){for(var c=0;c<a.length;++c)b[c]=a.charCodeAt(c)&255;return b}var j={stringifyByChunk:function(a,b,c){var d=[],e=0,f=a.length;if(f<=c)return String.fromCharCode.apply(null,a);while(e<f)b==="array"||b==="nodebuffer"?d.push(String.fromCharCode.apply(null,a.slice(e,Math.min(e+c,f)))):d.push(String.fromCharCode.apply(null,a.subarray(e,Math.min(e+c,f)))),e+=c;return d.join("")},stringifyByChar:function(a){var b="";for(var c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);return b},applyCanBeUsed:{uint8array:function(){try{return a.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch(a){return!1}}(),nodebuffer:function(){try{return a.nodebuffer&&String.fromCharCode.apply(null,c.allocBuffer(1)).length===1}catch(a){return!1}}()}};function k(a){var b=65536,c=C.getTypeOf(a),d=!0;c==="uint8array"?d=j.applyCanBeUsed.uint8array:c==="nodebuffer"&&(d=j.applyCanBeUsed.nodebuffer);if(d)while(b>1)try{return j.stringifyByChunk(a,c,b)}catch(a){b=Math.floor(b/2)}return j.stringifyByChar(a)}C.applyFromCharCode=k;function l(a,b){for(var c=0;c<a.length;c++)b[c]=a[c];return b}var m={};m.string={string:g,array:function(a){return i(a,new Array(a.length))},arraybuffer:function(a){return m.string.uint8array(a).buffer},uint8array:function(a){return i(a,new Uint8Array(a.length))},nodebuffer:function(a){return i(a,c.allocBuffer(a.length))}};m.array={string:k,array:g,arraybuffer:function(a){return new Uint8Array(a).buffer},uint8array:function(a){return new Uint8Array(a)},nodebuffer:function(a){return c.newBufferFrom(a)}};m.arraybuffer={string:function(a){return k(new Uint8Array(a))},array:function(a){return l(new Uint8Array(a),new Array(a.byteLength))},arraybuffer:g,uint8array:function(a){return new Uint8Array(a)},nodebuffer:function(a){return c.newBufferFrom(new Uint8Array(a))}};m.uint8array={string:k,array:function(a){return l(a,new Array(a.length))},arraybuffer:function(a){return a.buffer},uint8array:g,nodebuffer:function(a){return c.newBufferFrom(a)}};m.nodebuffer={string:k,array:function(a){return l(a,new Array(a.length))},arraybuffer:function(a){return m.nodebuffer.uint8array(a).buffer},uint8array:function(a){return l(a,new Uint8Array(a.length))},nodebuffer:g};C.transformTo=function(a,b){b||(b="");if(!a)return b;C.checkSupport(a);var c=C.getTypeOf(b);c=m[c][a](b);return c};C.getTypeOf=function(b){if(typeof b==="string")return"string";if(Object.prototype.toString.call(b)==="[object Array]")return"array";if(a.nodebuffer&&c.isBuffer(b))return"nodebuffer";if(a.uint8array&&b instanceof Uint8Array)return"uint8array";if(a.arraybuffer&&b instanceof ArrayBuffer)return"arraybuffer"};C.checkSupport=function(b){var c=a[b.toLowerCase()];if(!c)throw new Error(b+" is not supported by this platform")};C.MAX_VALUE_16BITS=65535;C.MAX_VALUE_32BITS=-1;C.pretty=function(a){var b="",c,d;for(d=0;d<(a||"").length;d++)c=a.charCodeAt(d),b+="\\x"+(c<16?"0":"")+c.toString(16).toUpperCase();return b};C.delay=function(a,b,c){d(function(){a.apply(c||null,b||[])})};C.inherits=function(a,b){var c=function(){};c.prototype=b.prototype;a.prototype=new c()};C.extend=function(){var a={},b,c;for(b=0;b<arguments.length;b++)for(c in arguments[b])arguments[b].hasOwnProperty(c)&&typeof a[c]==="undefined"&&(a[c]=arguments[b][c]);return a};C.prepareContent=function(c,d,g,h,i){d=e.Promise.resolve(d).then(function(b){var c=a.blob&&(b instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(b))!==-1);if(c&&typeof FileReader!=="undefined")return new e.Promise(function(a,c){var d=new FileReader();d.onload=function(b){a(b.target.result)};d.onerror=function(a){c(a.target.error)};d.readAsArrayBuffer(b)});else return b});return d.then(function(a){var d=C.getTypeOf(a);if(!d)return e.Promise.reject(new Error("Can't read the data of '"+c+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"));d==="arraybuffer"?a=C.transformTo("uint8array",a):d==="string"&&(i?a=b.decode(a):g&&(h!==!0&&(a=f(a))));return a})}}var D=!1;function E(){D||(D=!0,ba());return aa.exports}f={};var F={exports:f};function ca(){function a(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}a.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){if(this.isFinished)return!1;this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp());return!0},on:function(a,b){this._listeners[a].push(b);return this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,b){if(this._listeners[a])for(var c=0;c<this._listeners[a].length;c++)this._listeners[a][c].call(this,b)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo;this.mergeStreamInfo();this.previous=a;var b=this;a.on("data",function(a){b.processChunk(a)});a.on("end",function(){b.end()});a.on("error",function(a){b.error(a)});return this},pause:function(){if(this.isPaused||this.isFinished)return!1;this.isPaused=!0;this.previous&&this.previous.pause();return!0},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var a=!1;this.generatedError&&(this.error(this.generatedError),a=!0);this.previous&&this.previous.resume();return!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,b){this.extraStreamInfo[a]=b;this.mergeStreamInfo();return this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo){if(!this.extraStreamInfo.hasOwnProperty(a))continue;this.streamInfo[a]=this.extraStreamInfo[a]}},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0;this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;if(this.previous)return this.previous+" -> "+a;else return a}};F.exports=a}var G=!1;function H(){G||(G=!0,ca());return F.exports}var I={},da={exports:I};function ea(){var a=E(),b=o(),c=x(),d=H(),e=new Array(256);for(var f=0;f<256;f++)e[f]=f>=252?6:f>=248?5:f>=240?4:f>=224?3:f>=192?2:1;e[254]=e[254]=1;var g=function(c){var d,e,f,g,a,h=c.length,i=0;for(g=0;g<h;g++)e=c.charCodeAt(g),(e&64512)===55296&&g+1<h&&(f=c.charCodeAt(g+1),(f&64512)===56320&&(e=65536+(e-55296<<10)+(f-56320),g++)),i+=e<128?1:e<2048?2:e<65536?3:4;b.uint8array?d=new Uint8Array(i):d=new Array(i);for(a=0,g=0;a<i;g++)e=c.charCodeAt(g),(e&64512)===55296&&g+1<h&&(f=c.charCodeAt(g+1),(f&64512)===56320&&(e=65536+(e-55296<<10)+(f-56320),g++)),e<128?d[a++]=e:e<2048?(d[a++]=192|e>>>6,d[a++]=128|e&63):e<65536?(d[a++]=224|e>>>12,d[a++]=128|e>>>6&63,d[a++]=128|e&63):(d[a++]=240|e>>>18,d[a++]=128|e>>>12&63,d[a++]=128|e>>>6&63,d[a++]=128|e&63);return d},h=function(a,b){var c;b=b||a.length;b>a.length&&(b=a.length);c=b-1;while(c>=0&&(a[c]&192)===128)c--;if(c<0)return b;return c===0?b:c+e[a[c]]>b?c:b},i=function(c){var b,d,f,g,h=c.length,i=new Array(h*2);for(d=0,b=0;b<h;){f=c[b++];if(f<128){i[d++]=f;continue}g=e[f];if(g>4){i[d++]=65533;b+=g-1;continue}f&=g===2?31:g===3?15:7;while(g>1&&b<h)f=f<<6|c[b++]&63,g--;if(g>1){i[d++]=65533;continue}f<65536?i[d++]=f:(f-=65536,i[d++]=55296|f>>10&1023,i[d++]=56320|f&1023)}i.length!==d&&(i.subarray?i=i.subarray(0,d):i.length=d);return a.applyFromCharCode(i)};I.utf8encode=function(a){return b.nodebuffer?c.newBufferFrom(a,"utf-8"):g(a)};I.utf8decode=function(c){if(b.nodebuffer)return a.transformTo("nodebuffer",c).toString("utf-8");c=a.transformTo(b.uint8array?"uint8array":"array",c);return i(c)};function j(){d.call(this,"utf-8 decode"),this.leftOver=null}a.inherits(j,d);j.prototype.processChunk=function(c){var d=a.transformTo(b.uint8array?"uint8array":"array",c.data);if(this.leftOver&&this.leftOver.length){if(b.uint8array){var e=d;d=new Uint8Array(e.length+this.leftOver.length);d.set(this.leftOver,0);d.set(e,this.leftOver.length)}else d=this.leftOver.concat(d);this.leftOver=null}e=h(d);var f=d;e!==d.length&&(b.uint8array?(f=d.subarray(0,e),this.leftOver=d.subarray(e,d.length)):(f=d.slice(0,e),this.leftOver=d.slice(e,d.length)));this.push({data:I.utf8decode(f),meta:c.meta})};j.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:I.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)};I.Utf8DecodeWorker=j;function k(){d.call(this,"utf-8 encode")}a.inherits(k,d);k.prototype.processChunk=function(a){this.push({data:I.utf8encode(a.data),meta:a.meta})};I.Utf8EncodeWorker=k}var J=!1;function K(){J||(J=!0,ea());return da.exports}b={};var L={exports:b};function fa(){var a=H(),b=E();function c(b){a.call(this,"ConvertWorker to "+b),this.destType=b}b.inherits(c,a);c.prototype.processChunk=function(a){this.push({data:b.transformTo(this.destType,a.data),meta:a.meta})};L.exports=c}var M=!1;function ga(){M||(M=!0,fa());return L.exports}c={};var N={exports:c};function ha(){var a=g().Readable,b=E();b.inherits(c,a);function c(b,c,d){a.call(this,c);this._helper=b;var e=this;b.on("data",function(a,b){e.push(a)||e._helper.pause(),d&&d(b)}).on("error",function(a){e.emit("error",a)}).on("end",function(){e.push(null)})}c.prototype._read=function(){this._helper.resume()};N.exports=c}var O=!1;function ia(){O||(O=!0,ha());return N.exports}d={};var P={exports:d};function ja(){var a=E(),b=ga(),c=H(),d=t(),e=o(),f=B(),g=null;if(e.nodestream)try{g=ia()}catch(a){}function h(b,c,e){switch(b){case"blob":return a.newBlob(a.transformTo("arraybuffer",c),e);case"base64":return d.encode(c);default:return a.transformTo(b,c)}}function i(a,b){var c,d=0,e=null,f=0;for(c=0;c<b.length;c++)f+=b[c].length;switch(a){case"string":return b.join("");case"array":return Array.prototype.concat.apply([],b);case"uint8array":e=new Uint8Array(f);for(c=0;c<b.length;c++)e.set(b[c],d),d+=b[c].length;return e;case"nodebuffer":return Buffer.concat(b);default:throw new Error("concat : unsupported type '"+a+"'")}}function j(a,b){return new f.Promise(function(c,d){var e=[],f=a._internalType,g=a._outputType,j=a._mimeType;a.on("data",function(a,c){e.push(a),b&&b(c)}).on("error",function(a){e=[],d(a)}).on("end",function(){try{var a=h(g,i(f,e),j);c(a)}catch(a){d(a)}e=[]}).resume()})}function k(d,e,f){var g=e;switch(e){case"blob":case"arraybuffer":g="uint8array";break;case"base64":g="string";break}try{this._internalType=g,this._outputType=e,this._mimeType=f,a.checkSupport(g),this._worker=d.pipe(new b(g)),d.lock()}catch(a){this._worker=new c("error"),this._worker.error(a)}}k.prototype={accumulate:function(a){return j(this,a)},on:function(b,c){var d=this;b==="data"?this._worker.on(b,function(a){c.call(d,a.data,a.meta)}):this._worker.on(b,function(){a.delay(c,arguments,d)});return this},resume:function(){a.delay(this._worker.resume,[],this._worker);return this},pause:function(){this._worker.pause();return this},toNodejsStream:function(b){a.checkSupport("nodestream");if(this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new g(this,{objectMode:this._outputType!=="nodebuffer"},b)}};P.exports=k}var Q=!1;function R(){Q||(Q=!0,ja());return P.exports}var S={},ka={exports:S};function la(){S.base64=!1,S.binary=!1,S.dir=!1,S.createFolders=!0,S.date=null,S.compression=null,S.compressionOptions=null,S.comment=null,S.unixPermissions=null,S.dosPermissions=null}var T=!1;function U(){T||(T=!0,la());return ka.exports}f={};var V={exports:f};function ma(){var a=E(),b=H(),c=16*1024;function d(c){b.call(this,"DataWorker");var d=this;this.dataIsReady=!1;this.index=0;this.max=0;this.data=null;this.type="";this._tickScheduled=!1;c.then(function(b){d.dataIsReady=!0,d.data=b,d.max=b&&b.length||0,d.type=a.getTypeOf(b),d.isPaused||d._tickAndRepeat()},function(a){d.error(a)})}a.inherits(d,b);d.prototype.cleanUp=function(){b.prototype.cleanUp.call(this),this.data=null};d.prototype.resume=function(){if(!b.prototype.resume.call(this))return!1;!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,a.delay(this._tickAndRepeat,[],this));return!0};d.prototype._tickAndRepeat=function(){this._tickScheduled=!1;if(this.isPaused||this.isFinished)return;this._tick();this.isFinished||(a.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0)};d.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var a=c,b=null;a=Math.min(this.max,this.index+a);if(this.index>=this.max)return this.end();else{switch(this.type){case"string":b=this.data.substring(this.index,a);break;case"uint8array":b=this.data.subarray(this.index,a);break;case"array":case"nodebuffer":b=this.data.slice(this.index,a);break}this.index=a;return this.push({data:b,meta:{percent:this.max?this.index/this.max*100:0}})}};V.exports=d}var na=!1;function oa(){na||(na=!0,ma());return V.exports}b={};var pa={exports:b};function qa(){var a=E(),b=H();function c(a){b.call(this,"DataLengthProbe for "+a),this.propName=a,this.withStreamInfo(a,0)}a.inherits(c,b);c.prototype.processChunk=function(a){if(a){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+a.data.length}b.prototype.processChunk.call(this,a)};pa.exports=c}var ra=!1;function sa(){ra||(ra=!0,qa());return pa.exports}c={};var ta={exports:c};function ua(){var a=E();function b(){var a,b=[];for(var c=0;c<256;c++){a=c;for(var d=0;d<8;d++)a=a&1?3988292384^a>>>1:a>>>1;b[c]=a}return b}var c=b();function d(a,b,d,e){var f=c;d=e+d;a=a^-1;for(e=e;e<d;e++)a=a>>>8^f[(a^b[e])&255];return a^-1}function e(a,b,d,e){var f=c;d=e+d;a=a^-1;for(e=e;e<d;e++)a=a>>>8^f[(a^b.charCodeAt(e))&255];return a^-1}ta.exports=function(b,c){if(typeof b==="undefined"||!b.length)return 0;var f=a.getTypeOf(b)!=="string";if(f)return d(c|0,b,b.length,0);else return e(c|0,b,b.length,0)}}var va=!1;function W(){va||(va=!0,ua());return ta.exports}d={};var wa={exports:d};function xa(){var a=H(),b=W(),c=E();function d(){a.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}c.inherits(d,a);d.prototype.processChunk=function(a){this.streamInfo.crc32=b(a.data,this.streamInfo.crc32||0),this.push(a)};wa.exports=d}var ya=!1;function za(){ya||(ya=!0,xa());return wa.exports}f={};var Aa={exports:f};function Ba(){var a=B(),b=oa(),c=sa(),d=za(),c=sa();function e(a,b,c,d,e){this.compressedSize=a,this.uncompressedSize=b,this.crc32=c,this.compression=d,this.compressedContent=e}e.prototype={getContentWorker:function(){var d=new b(a.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),e=this;d.on("end",function(){if(this.streamInfo.data_length!==e.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")});return d},getCompressedWorker:function(){return new b(a.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}};e.createWorkerFrom=function(a,b,e){return a.pipe(new d()).pipe(new c("uncompressedSize")).pipe(b.compressWorker(e)).pipe(new c("compressedSize")).withStreamInfo("compression",b)};Aa.exports=e}var Ca=!1;function X(){Ca||(Ca=!0,Ba());return Aa.exports}b={};var Da={exports:b};function Ea(){var a=R(),b=oa(),c=K(),d=X(),e=H(),f=function(a,b,c){this.name=a,this.dir=c.dir,this.date=c.date,this.comment=c.comment,this.unixPermissions=c.unixPermissions,this.dosPermissions=c.dosPermissions,this._data=b,this._dataBinary=c.binary,this.options={compression:c.compression,compressionOptions:c.compressionOptions}};f.prototype={internalStream:function(b){var d=null,f="string";try{if(!b)throw new Error("No output type specified.");f=b.toLowerCase();b=f==="string"||f==="text";(f==="binarystring"||f==="text")&&(f="string");d=this._decompressWorker();var g=!this._dataBinary;g&&!b&&(d=d.pipe(new c.Utf8EncodeWorker()));!g&&b&&(d=d.pipe(new c.Utf8DecodeWorker()))}catch(a){d=new e("error"),d.error(a)}return new a(d,f,"")},async:function(a,b){return this.internalStream(a).accumulate(b)},nodeStream:function(a,b){return this.internalStream(a||"nodebuffer").toNodejsStream(b)},_compressWorker:function(a,b){if(this._data instanceof d&&this._data.compression.magic===a.magic)return this._data.getCompressedWorker();else{var e=this._decompressWorker();this._dataBinary||(e=e.pipe(new c.Utf8EncodeWorker()));return d.createWorkerFrom(e,a,b)}},_decompressWorker:function(){if(this._data instanceof d)return this._data.getContentWorker();else if(this._data instanceof e)return this._data;else return new b(this._data)}};var g=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")};for(var i=0;i<g.length;i++)f.prototype[g[i]]=h;Da.exports=f}var Fa=!1;function Ga(){Fa||(Fa=!0,Ea());return Da.exports}var Y={},Ha={exports:Y};function Ia(){var a=typeof Uint8Array!=="undefined"&&typeof Uint16Array!=="undefined"&&typeof Uint32Array!=="undefined",b=j(),c=E(),d=H(),e=a?"uint8array":"array";Y.magic="\b\0";function f(a,b){d.call(this,"FlateWorker/"+a),this._pako=null,this._pakoAction=a,this._pakoOptions=b,this.meta={}}c.inherits(f,d);f.prototype.processChunk=function(a){this.meta=a.meta,this._pako===null&&this._createPako(),this._pako.push(c.transformTo(e,a.data),!1)};f.prototype.flush=function(){d.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)};f.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this._pako=null};f.prototype._createPako=function(){this._pako=new b[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var a=this;this._pako.onData=function(b){a.push({data:b,meta:a.meta})}};Y.compressWorker=function(a){return new f("Deflate",a)};Y.uncompressWorker=function(){return new f("Inflate",{})}}var Ja=!1;function Ka(){Ja||(Ja=!0,Ia());return Ha.exports}var Z={},La={exports:Z};function Ma(){var a=H();Z.STORE={magic:"\0\0",compressWorker:function(b){return new a("STORE compression")},uncompressWorker:function(){return new a("STORE decompression")}};Z.DEFLATE=Ka()}var Na=!1;function Oa(){Na||(Na=!0,Ma());return La.exports}var $={},Pa={exports:$};function Qa(){$.LOCAL_FILE_HEADER="PK\x03\x04",$.CENTRAL_FILE_HEADER="PK\x01\x02",$.CENTRAL_DIRECTORY_END="PK\x05\x06",$.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",$.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",$.DATA_DESCRIPTOR="PK\x07\b"}var Ra=!1;function Sa(){Ra||(Ra=!0,Qa());return Pa.exports}c={};var Ta={exports:c};function Ua(){var a=E(),b=H(),c=K(),d=W(),e=Sa(),f=function(a,b){var c="",d;for(d=0;d<b;d++)c+=String.fromCharCode(a&255),a=a>>>8;return c},g=function(a,b){var c=a;a||(c=b?16893:33204);return(c&65535)<<16},h=function(a,b){return(a||0)&63},i=function(b,i,j,k,l,m){var n=b.file,o=b.compression,p=m!==c.utf8encode,q=a.transformTo("string",m(n.name)),r=a.transformTo("string",c.utf8encode(n.name)),s=n.comment;m=a.transformTo("string",m(s));var t=a.transformTo("string",c.utf8encode(s)),u=r.length!==n.name.length;s=t.length!==s.length;var v="",w="",x="",y=n.dir,z=n.date,A={crc32:0,compressedSize:0,uncompressedSize:0};(!i||j)&&(A.crc32=b.crc32,A.compressedSize=b.compressedSize,A.uncompressedSize=b.uncompressedSize);j=0;i&&(j|=8);!p&&(u||s)&&(j|=2048);b=0;i=0;y&&(b|=16);l==="UNIX"?(i=798,b|=g(n.unixPermissions,y)):(i=20,b|=h(n.dosPermissions));p=z.getUTCHours();p=p<<6;p=p|z.getUTCMinutes();p=p<<5;p=p|z.getUTCSeconds()/2;l=z.getUTCFullYear()-1980;l=l<<4;l=l|z.getUTCMonth()+1;l=l<<5;l=l|z.getUTCDate();u&&(w=f(1,1)+f(d(q),4)+r,v+="up"+f(w.length,2)+w);s&&(x=f(1,1)+f(d(m),4)+t,v+="uc"+f(x.length,2)+x);y="";y+="\n\0";y+=f(j,2);y+=o.magic;y+=f(p,2);y+=f(l,2);y+=f(A.crc32,4);y+=f(A.compressedSize,4);y+=f(A.uncompressedSize,4);y+=f(q.length,2);y+=f(v.length,2);n=e.LOCAL_FILE_HEADER+y+q+v;z=e.CENTRAL_FILE_HEADER+f(i,2)+y+f(m.length,2)+"\0\0\0\0"+f(b,4)+f(k,4)+q+v+m;return{fileRecord:n,dirRecord:z}},j=function(b,c,d,g,h){h=a.transformTo("string",h(g));g=e.CENTRAL_DIRECTORY_END+"\0\0\0\0"+f(b,2)+f(b,2)+f(c,4)+f(d,4)+f(h.length,2)+h;return g},k=function(a){a=e.DATA_DESCRIPTOR+f(a.crc32,4)+f(a.compressedSize,4)+f(a.uncompressedSize,4);return a};function l(a,c,d,e){b.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=c,this.zipPlatform=d,this.encodeFileName=e,this.streamFiles=a,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(l,b);l.prototype.push=function(a){var c=a.meta.percent||0,d=this.entriesCount,e=this._sources.length;this.accumulate?this.contentBuffer.push(a):(this.bytesWritten+=a.data.length,b.prototype.push.call(this,{data:a.data,meta:{currentFile:this.currentFile,percent:d?(c+100*(d-e-1))/d:100}}))};l.prototype.openedSource=function(a){this.currentSourceOffset=this.bytesWritten;this.currentFile=a.file.name;var b=this.streamFiles&&!a.file.dir;if(b){a=i(a,b,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:a.fileRecord,meta:{percent:0}})}else this.accumulate=!0};l.prototype.closedSource=function(a){this.accumulate=!1;var b=this.streamFiles&&!a.file.dir,c=i(a,b,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.dirRecords.push(c.dirRecord);if(b)this.push({data:k(a),meta:{percent:100}});else{this.push({data:c.fileRecord,meta:{percent:0}});while(this.contentBuffer.length)this.push(this.contentBuffer.shift())}this.currentFile=null};l.prototype.flush=function(){var a=this.bytesWritten;for(var b=0;b<this.dirRecords.length;b++)this.push({data:this.dirRecords[b],meta:{percent:100}});b=this.bytesWritten-a;b=j(this.dirRecords.length,b,a,this.zipComment,this.encodeFileName);this.push({data:b,meta:{percent:100}})};l.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()};l.prototype.registerPrevious=function(a){this._sources.push(a);var b=this;a.on("data",function(a){b.processChunk(a)});a.on("end",function(){b.closedSource(b.previous.streamInfo),b._sources.length?b.prepareNextSource():b.end()});a.on("error",function(a){b.error(a)});return this};l.prototype.resume=function(){if(!b.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length){this.prepareNextSource();return!0}if(!this.previous&&!this._sources.length&&!this.generatedError){this.end();return!0}};l.prototype.error=function(a){var c=this._sources;if(!b.prototype.error.call(this,a))return!1;for(var d=0;d<c.length;d++)try{c[d].error(a)}catch(a){}return!0};l.prototype.lock=function(){b.prototype.lock.call(this);var a=this._sources;for(var c=0;c<a.length;c++)a[c].lock()};Ta.exports=l}var Va=!1;function Wa(){Va||(Va=!0,Ua());return Ta.exports}var Xa={},Ya={exports:Xa};function Za(){var a=Oa(),b=Wa(),c=function(b,c){b=b||c;c=a[b];if(!c)throw new Error(b+" is not a valid compression method !");return c};Xa.generateWorker=function(a,d,e){var f=new b(d.streamFiles,e,d.platform,d.encodeFileName),g=0;try{a.forEach(function(a,b){g++;var e=c(b.options.compression,d.compression),h=b.options.compressionOptions||d.compressionOptions||{},i=b.dir,j=b.date;b._compressWorker(e,h).withStreamInfo("file",{name:a,dir:i,date:j,comment:b.comment||"",unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions}).pipe(f)}),f.entriesCount=g}catch(a){f.error(a)}return f}}var $a=!1;function ab(){$a||($a=!0,Za());return Ya.exports}d={};var bb={exports:d};function cb(){var a=E(),b=H();function c(a,c){b.call(this,"Nodejs stream input adapter for "+a),this._upstreamEnded=!1,this._bindStream(c)}a.inherits(c,b);c.prototype._bindStream=function(a){var b=this;this._stream=a;a.pause();a.on("data",function(a){b.push({data:a,meta:{percent:0}})}).on("error",function(a){b.isPaused?this.generatedError=a:b.error(a)}).on("end",function(){b.isPaused?b._upstreamEnded=!0:b.end()})};c.prototype.pause=function(){if(!b.prototype.pause.call(this))return!1;this._stream.pause();return!0};c.prototype.resume=function(){if(!b.prototype.resume.call(this))return!1;this._upstreamEnded?this.end():this._stream.resume();return!0};bb.exports=c}var db=!1;function eb(){db||(db=!0,cb());return bb.exports}f={};var fb={exports:f};function gb(){var a=K(),b=E(),c=H(),d=R(),e=U(),f=X(),g=Ga(),h=ab(),i=x(),j=eb(),k=function(a,d,h){var k=b.getTypeOf(d),o,p=b.extend(h||{},e);p.date=p.date||new Date();p.compression!==null&&(p.compression=p.compression.toUpperCase());typeof p.unixPermissions==="string"&&(p.unixPermissions=parseInt(p.unixPermissions,8));p.unixPermissions&&p.unixPermissions&16384&&(p.dir=!0);p.dosPermissions&&p.dosPermissions&16&&(p.dir=!0);p.dir&&(a=m(a));p.createFolders&&(o=l(a))&&n.call(this,o,!0);var q=k==="string"&&p.binary===!1&&p.base64===!1;(!h||typeof h.binary==="undefined")&&(p.binary=!q);h=d instanceof f&&d.uncompressedSize===0;(h||p.dir||!d||d.length===0)&&(p.base64=!1,p.binary=!0,d="",p.compression="STORE",k="string");d instanceof f||d instanceof c?q=d:i.isNode&&i.isStream(d)?q=new j(a,d):q=b.prepareContent(a,d,p.binary,p.optimizedBinaryString,p.base64);h=new g(a,q,p);this.files[a]=h},l=function(a){a.slice(-1)==="/"&&(a=a.substring(0,a.length-1));var b=a.lastIndexOf("/");return b>0?a.substring(0,b):""},m=function(a){a.slice(-1)!=="/"&&(a+="/");return a},n=function(a,b){b=typeof b!=="undefined"?b:e.createFolders;a=m(a);this.files[a]||k.call(this,a,null,{dir:!0,createFolders:b});return this.files[a]};function o(a){return Object.prototype.toString.call(a)==="[object RegExp]"}var p={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(a){var b,c,d;for(b in this.files){if(!this.files.hasOwnProperty(b))continue;d=this.files[b];c=b.slice(this.root.length,b.length);c&&b.slice(0,this.root.length)===this.root&&a(c,d)}},filter:function(a){var b=[];this.forEach(function(c,d){a(c,d)&&b.push(d)});return b},file:function(a,b,c){if(arguments.length===1)if(o(a)){var d=a;return this.filter(function(a,b){return!b.dir&&d.test(a)})}else{var e=this.files[this.root+a];if(e&&!e.dir)return e;else return null}else a=this.root+a,k.call(this,a,b,c);return this},folder:function(a){if(!a)return this;if(o(a))return this.filter(function(b,c){return c.dir&&a.test(b)});var b=this.root+a;b=n.call(this,b);var c=this.clone();c.root=b.name;return c},remove:function(a){a=this.root+a;var b=this.files[a];b||(a.slice(-1)!=="/"&&(a+="/"),b=this.files[a]);if(b&&!b.dir)delete this.files[a];else{b=this.filter(function(c,b){return b.name.slice(0,a.length)===a});for(var c=0;c<b.length;c++)delete this.files[b[c].name]}return this},generate:function(a){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var f,g={};try{g=b.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode});g.type=g.type.toLowerCase();g.compression=g.compression.toUpperCase();g.type==="binarystring"&&(g.type="string");if(!g.type)throw new Error("No output type specified.");b.checkSupport(g.type);(g.platform==="darwin"||g.platform==="freebsd"||g.platform==="linux"||g.platform==="sunos")&&(g.platform="UNIX");g.platform==="win32"&&(g.platform="DOS");e=g.comment||this.comment||"";f=h.generateWorker(this,g,e)}catch(a){f=new c("error"),f.error(a)}return new d(f,g.type||"string",g.mimeType)},generateAsync:function(a,b){return this.generateInternalStream(a).accumulate(b)},generateNodeStream:function(a,b){a=a||{};a.type||(a.type="nodebuffer");return this.generateInternalStream(a).toNodejsStream(b)}};fb.exports=p}var hb=!1;function ib(){hb||(hb=!0,gb());return fb.exports}b={};var jb={exports:b};function kb(){var a=E();function b(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}b.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(a){},readInt:function(a){var b=0,c;this.checkOffset(a);for(c=this.index+a-1;c>=this.index;c--)b=(b<<8)+this.byteAt(c);this.index+=a;return b},readString:function(b){return a.transformTo("string",this.readData(b))},readData:function(a){},lastIndexOfSignature:function(a){},readAndCheckSignature:function(a){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC((a>>25&127)+1980,(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(a&31)<<1))}};jb.exports=b}var lb=!1;function mb(){lb||(lb=!0,kb());return jb.exports}c={};var nb={exports:c};function ob(){var a=mb(),b=E();function c(b){a.call(this,b);for(var c=0;c<this.data.length;c++)b[c]=b[c]&255}b.inherits(c,a);c.prototype.byteAt=function(a){return this.data[this.zero+a]};c.prototype.lastIndexOfSignature=function(a){var b=a.charCodeAt(0),c=a.charCodeAt(1),d=a.charCodeAt(2);a=a.charCodeAt(3);for(var e=this.length-4;e>=0;--e)if(this.data[e]===b&&this.data[e+1]===c&&this.data[e+2]===d&&this.data[e+3]===a)return e-this.zero;return-1};c.prototype.readAndCheckSignature=function(a){var b=a.charCodeAt(0),c=a.charCodeAt(1),d=a.charCodeAt(2);a=a.charCodeAt(3);var e=this.readData(4);return b===e[0]&&c===e[1]&&d===e[2]&&a===e[3]};c.prototype.readData=function(a){this.checkOffset(a);if(a===0)return[];var b=this.data.slice(this.zero+this.index,this.zero+this.index+a);this.index+=a;return b};nb.exports=c}var pb=!1;function qb(){pb||(pb=!0,ob());return nb.exports}d={};var rb={exports:d};function sb(){var a=mb(),b=E();function c(b){a.call(this,b)}b.inherits(c,a);c.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)};c.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero};c.prototype.readAndCheckSignature=function(a){var b=this.readData(4);return a===b};c.prototype.readData=function(a){this.checkOffset(a);var b=this.data.slice(this.zero+this.index,this.zero+this.index+a);this.index+=a;return b};rb.exports=c}var tb=!1;function ub(){tb||(tb=!0,sb());return rb.exports}f={};var vb={exports:f};function wb(){var a=qb(),b=E();function c(b){a.call(this,b)}b.inherits(c,a);c.prototype.readData=function(a){this.checkOffset(a);if(a===0)return new Uint8Array(0);var b=this.data.subarray(this.zero+this.index,this.zero+this.index+a);this.index+=a;return b};vb.exports=c}var xb=!1;function yb(){xb||(xb=!0,wb());return vb.exports}b={};var zb={exports:b};function Ab(){var a=yb(),b=E();function c(b){a.call(this,b)}b.inherits(c,a);c.prototype.readData=function(a){this.checkOffset(a);var b=this.data.slice(this.zero+this.index,this.zero+this.index+a);this.index+=a;return b};zb.exports=c}var Bb=!1;function Cb(){Bb||(Bb=!0,Ab());return zb.exports}c={};var Db={exports:c};function Eb(){var a=E(),b=o(),c=qb(),d=ub(),e=Cb(),f=yb();Db.exports=function(g){var h=a.getTypeOf(g);a.checkSupport(h);if(h==="string"&&!b.uint8array)return new d(g);if(h==="nodebuffer")return new e(g);return b.uint8array?new f(a.transformTo("uint8array",g)):new c(a.transformTo("array",g))}}var Fb=!1;function Gb(){Fb||(Fb=!0,Eb());return Db.exports}d={};var Hb={exports:d};function Ib(){var a=Gb(),b=E(),c=X(),d=W(),e=K(),f=Oa(),g=o(),h=0,i=3,j=function(a){for(var b in f){if(!f.hasOwnProperty(b))continue;if(f[b].magic===a)return f[b]}return null};function k(a,b){this.options=a,this.loadOptions=b}k.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(a){var d;a.skip(22);this.fileNameLength=a.readInt(2);d=a.readInt(2);this.fileName=a.readData(this.fileNameLength);a.skip(d);if(this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize === -1 || uncompressedSize === -1)");d=j(this.compressionMethod);if(d===null)throw new Error("Corrupted zip : compression "+b.pretty(this.compressionMethod)+" unknown (inner file : "+b.transformTo("string",this.fileName)+")");this.decompressed=new c(this.compressedSize,this.uncompressedSize,this.crc32,d,a.readData(this.compressedSize))},readCentralPart:function(a){this.versionMadeBy=a.readInt(2);a.skip(2);this.bitFlag=a.readInt(2);this.compressionMethod=a.readString(2);this.date=a.readDate();this.crc32=a.readInt(4);this.compressedSize=a.readInt(4);this.uncompressedSize=a.readInt(4);var b=a.readInt(2);this.extraFieldsLength=a.readInt(2);this.fileCommentLength=a.readInt(2);this.diskNumberStart=a.readInt(2);this.internalFileAttributes=a.readInt(2);this.externalFileAttributes=a.readInt(4);this.localHeaderOffset=a.readInt(4);if(this.isEncrypted())throw new Error("Encrypted zip are not supported");a.skip(b);this.readExtraFields(a);this.parseZIP64ExtraField(a);this.fileComment=a.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null;this.dosPermissions=null;var a=this.versionMadeBy>>8;this.dir=this.externalFileAttributes&16?!0:!1;a===h&&(this.dosPermissions=this.externalFileAttributes&63);a===i&&(this.unixPermissions=this.externalFileAttributes>>16&65535);!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(c){if(!this.extraFields[1])return;c=a(this.extraFields[1].value);this.uncompressedSize===b.MAX_VALUE_32BITS&&(this.uncompressedSize=c.readInt(8));this.compressedSize===b.MAX_VALUE_32BITS&&(this.compressedSize=c.readInt(8));this.localHeaderOffset===b.MAX_VALUE_32BITS&&(this.localHeaderOffset=c.readInt(8));this.diskNumberStart===b.MAX_VALUE_32BITS&&(this.diskNumberStart=c.readInt(4))},readExtraFields:function(a){var b=a.index+this.extraFieldsLength,c,d,e;this.extraFields||(this.extraFields={});while(a.index<b)c=a.readInt(2),d=a.readInt(2),e=a.readData(d),this.extraFields[c]={id:c,length:d,value:e}},handleUTF8:function(){var a=g.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=e.utf8decode(this.fileName),this.fileCommentStr=e.utf8decode(this.fileComment);else{var c=this.findExtraFieldUnicodePath();if(c!==null)this.fileNameStr=c;else{c=b.transformTo(a,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(c)}c=this.findExtraFieldUnicodeComment();if(c!==null)this.fileCommentStr=c;else{c=b.transformTo(a,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(c)}}},findExtraFieldUnicodePath:function(){var b=this.extraFields[28789];if(b){var c=a(b.value);if(c.readInt(1)!==1)return null;return d(this.fileName)!==c.readInt(4)?null:e.utf8decode(c.readData(b.length-5))}return null},findExtraFieldUnicodeComment:function(){var b=this.extraFields[25461];if(b){var c=a(b.value);if(c.readInt(1)!==1)return null;return d(this.fileComment)!==c.readInt(4)?null:e.utf8decode(c.readData(b.length-5))}return null}};Hb.exports=k}var Jb=!1;function Kb(){Jb||(Jb=!0,Ib());return Hb.exports}f={};var Lb={exports:f};function Mb(){var a=Gb(),b=E(),c=Sa(),d=Kb();K();var e=o();function f(a){this.files=[],this.loadOptions=a}f.prototype={checkSignature:function(a){if(!this.reader.readAndCheckSignature(a)){this.reader.index-=4;var c=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+b.pretty(c)+", expected "+b.pretty(a)+")")}},isSignature:function(a,b){var c=this.reader.index;this.reader.setIndex(a);a=this.reader.readString(4);a=a===b;this.reader.setIndex(c);return a},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2);this.diskWithCentralDirStart=this.reader.readInt(2);this.centralDirRecordsOnThisDisk=this.reader.readInt(2);this.centralDirRecords=this.reader.readInt(2);this.centralDirSize=this.reader.readInt(4);this.centralDirOffset=this.reader.readInt(4);this.zipCommentLength=this.reader.readInt(2);var a=this.reader.readData(this.zipCommentLength),c=e.uint8array?"uint8array":"array";c=b.transformTo(c,a);this.zipComment=this.loadOptions.decodeFileName(c)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8);this.reader.skip(4);this.diskNumber=this.reader.readInt(4);this.diskWithCentralDirStart=this.reader.readInt(4);this.centralDirRecordsOnThisDisk=this.reader.readInt(8);this.centralDirRecords=this.reader.readInt(8);this.centralDirSize=this.reader.readInt(8);this.centralDirOffset=this.reader.readInt(8);this.zip64ExtensibleData={};var a=this.zip64EndOfCentralSize-44,b=0,c,d,e;while(b<a)c=this.reader.readInt(2),d=this.reader.readInt(4),e=this.reader.readData(d),this.zip64ExtensibleData[c]={id:c,length:d,value:e}},readBlockZip64EndOfCentralLocator:function(){this.diskWithZip64CentralDirStart=this.reader.readInt(4);this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8);this.disksCount=this.reader.readInt(4);if(this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var a,b;for(a=0;a<this.files.length;a++)b=this.files[a],this.reader.setIndex(b.localHeaderOffset),this.checkSignature(c.LOCAL_FILE_HEADER),b.readLocalPart(this.reader),b.handleUTF8(),b.processAttributes()},readCentralDir:function(){var a;this.reader.setIndex(this.centralDirOffset);while(this.reader.readAndCheckSignature(c.CENTRAL_FILE_HEADER))a=new d({zip64:this.zip64},this.loadOptions),a.readCentralPart(this.reader),this.files.push(a);if(this.centralDirRecords!==this.files.length&&(this.centralDirRecords!==0&&this.files.length===0))throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var a=this.reader.lastIndexOfSignature(c.CENTRAL_DIRECTORY_END);if(a<0){var d=!this.isSignature(0,c.LOCAL_FILE_HEADER);if(d)throw new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");else throw new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(a);d=a;this.checkSignature(c.CENTRAL_DIRECTORY_END);this.readBlockEndOfCentral();if(this.diskNumber===b.MAX_VALUE_16BITS||this.diskWithCentralDirStart===b.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===b.MAX_VALUE_16BITS||this.centralDirRecords===b.MAX_VALUE_16BITS||this.centralDirSize===b.MAX_VALUE_32BITS||this.centralDirOffset===b.MAX_VALUE_32BITS){this.zip64=!0;a=this.reader.lastIndexOfSignature(c.ZIP64_CENTRAL_DIRECTORY_LOCATOR);if(a<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");this.reader.setIndex(a);this.checkSignature(c.ZIP64_CENTRAL_DIRECTORY_LOCATOR);this.readBlockZip64EndOfCentralLocator();if(!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,c.ZIP64_CENTRAL_DIRECTORY_END)){this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(c.ZIP64_CENTRAL_DIRECTORY_END);if(this.relativeOffsetEndOfZip64CentralDir<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory")}this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir);this.checkSignature(c.ZIP64_CENTRAL_DIRECTORY_END);this.readBlockZip64EndOfCentral()}a=this.centralDirOffset+this.centralDirSize;this.zip64&&(a+=20,a+=12+this.zip64EndOfCentralSize);a=d-a;if(a>0)this.isSignature(d,c.CENTRAL_FILE_HEADER)||(this.reader.zero=a);else if(a<0)throw new Error("Corrupted zip: missing "+Math.abs(a)+" bytes.")},prepareReader:function(b){this.reader=a(b)},load:function(a){this.prepareReader(a),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}};Lb.exports=f}var Nb=!1;function Ob(){Nb||(Nb=!0,Mb());return Lb.exports}b={};var Pb={exports:b};function Qb(){var a=E(),b=B(),c=K(),a=E(),d=Ob(),e=za(),f=x();function g(a){return new b.Promise(function(b,c){var d=a.decompressed.getContentWorker().pipe(new e());d.on("error",function(a){c(a)}).on("end",function(){d.streamInfo.crc32!==a.decompressed.crc32?c(new Error("Corrupted zip : CRC32 mismatch")):b()}).resume()})}Pb.exports=function(e,h){var i=this;h=a.extend(h||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:c.utf8decode});return f.isNode&&f.isStream(e)?b.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):a.prepareContent("the loaded zip file",e,!0,h.optimizedBinaryString,h.base64).then(function(a){var b=new d(h);b.load(a);return b}).then(function(a){var c=[b.Promise.resolve(a)];a=a.files;if(h.checkCRC32)for(var d=0;d<a.length;d++)c.push(g(a[d]));return b.Promise.all(c)}).then(function(a){a=a.shift();var b=a.files;for(var c=0;c<b.length;c++){var d=b[c];i.file(d.fileNameStr,d.decompressed,{binary:!0,optimizedBinaryString:!0,date:d.date,dir:d.dir,comment:d.fileCommentStr.length?d.fileCommentStr:null,unixPermissions:d.unixPermissions,dosPermissions:d.dosPermissions,createFolders:h.createFolders})}a.zipComment.length&&(i.comment=a.zipComment);return i})}}var Rb=!1;function Sb(){Rb||(Rb=!0,Qb());return Pb.exports}c={};var Tb={exports:c};function Ub(){function a(){if(!(this instanceof a))return new a();if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={};this.comment=null;this.root="";this.clone=function(){var b=new a();for(var c in this)typeof this[c]!=="function"&&(b[c]=this[c]);return b}}a.prototype=ib();a.prototype.loadAsync=Sb();a.support=o();a.defaults=U();a.version="3.2.0";a.loadAsync=function(b,c){return new a().loadAsync(b,c)};a.external=B();Tb.exports=a}var Vb=!1;function Wb(){Vb||(Vb=!0,Ub());return Tb.exports}function a(a){switch(a){case void 0:return Wb()}}e.exports=a}),null);
__d("jszip",["jszip-3.2.0"],(function(a,b,c,d,e,f){e.exports=b("jszip-3.2.0")()}),null);/*FB_PKG_DELIM*/
__d("ACSCipherSuiteModule",[],(function(a,b,c,d,e,f){"use strict";b={hash:"SHA-512",name:"HMAC"};c={curveName:"RISTRETTO",macAlgorithm:b,value:1};var g=new Map([[c.value,c]]);function a(a){return g.has(a)?g.get(a):null}f.VOPRF_RISTRETTO_HMACSHA512=c;f.getACSCipherSuiteByValue=a}),66);
__d("ACSTokenHmacUtil",["XPlatReactCrypto"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c){return h(a,b).then(function(a){return j(a,c)})}function h(a,b){return d("XPlatReactCrypto").subtleImportKey("raw",b,a,!1,["sign"]).then(function(b){return{algo:a,key:b}})}function i(a){return typeof a.hash==="string"?a.hash:a.hash.name}function j(a,b){var c=a.algo;a=a.key;c={hash:i(c),name:"HMAC"};return d("XPlatReactCrypto").subtleSign(c,a,b).then(function(a){return new Uint8Array(a)})}g.hmac=a}),98);
__d("GetBlobFromInt64BE",["I64","LSResult","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a){var e=new Uint8Array(8);e.reduceRight(function(a,b,c){b=(i||(i=d("I64"))).to_int32(i.mod_(a,i.of_string("256")));e[c]=b;return i.div(a,i.of_string("256"))},a);return(h||(h=b("Promise"))).resolve(c("LSResult")(e.buffer))}g.GetBlobFromInt64BE=a}),98);
__d("LSACSExperimentCapability",[],(function(a,b,c,d,e,f){a=Object.freeze({RETRY_AFTER_TASK_SERIALIZATION_FAILURE_EXPONENTIAL_BACKOFF:0,BUMP_TOKEN_SYNC_TASK_AT_TASK_SERIALIZATION:1,INSERT_PENDING_TASK_PARENT_ROW_WHEN_NO_ACS_TOKENS_AT_TASK_INSERTION:2});f["default"]=a}),66);
__d("LSBeginHandlingFireForgetTasksForQueue",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(e){return b.sequence([function(d){return c[0]=b.createArray(),b.forEach(b.filter(b.db.table(5).fetch(),function(b){return b.queueName===a[0]}),function(a){a=a.item;return c[3]=new b.Map(),c[3].set("label",a.context),c[3].set("payload",a.taskValue),c[3].set("queue_name",a.queueName),c[3].set("task_id",a.taskId),c[3].set("failure_count",b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))?void 0:b.i64.cast([0,0])),c[4]=(c[0].push(c[3]),c[0])})},function(e){return c[1]=new b.Map(),c[1].set("tasks",c[0]),c[1].set("epoch_id",void 0),c[2]=new b.Map(),c[2].set("queue_name",a[0]),c[2].set("next_sync_ms",void 0),c[2].set("work_item_type",b.i64.cast([0,5])),c[2].set("network_payload",c[1]),c[2].set("http_url_override",void 0),c[2].set("skip_realtime_gateway",!1),d[0]=c[2]}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSCoreBeginHandlingFireForgetTasksForQueueStoredProcedure";a.__tables__=["pending_fire_and_forget_tasks"];e.exports=a}),null);
__d("LSBeginHandlingFireForgetTasksForQueueStoredProcedure",["LSBeginHandlingFireForgetTasksForQueue","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSBeginHandlingFireForgetTasksForQueue"),e.queueName);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSForceTaskExecutionImmediately",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(d){return b.db.table(2).fetch([[[a[0]]]]).next().then(function(d,e){var f=d.done;d=d.value;return f?0:(e=d.item,c[1]=b.i64.of_float(Date.now()),b.i64.lt(c[1],e.minTimeToSyncTimestampMs)?b.forEach(b.db.table(2).fetch([[[a[0]]]]),function(a){var c=a.update;a=a.item;return c({minTimeToSyncTimestampMs:b.i64.cast([0,0]),failureCount:b.i64.add(a.failureCount,b.i64.cast([0,1]))})}):b.resolve())})},function(a){return b.resolve(d)}])}a.__sproc_name__="LSCoreForceTaskExecutionImmediatelyStoredProcedure";a.__tables__=["pending_tasks"];e.exports=a}),null);
__d("LSRemoveUsedTokens",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(a){return b.forEach(b.filter(b.db.table(309).fetch(),function(a){return b.i64.le(a.redeemLimit,b.i64.cast([0,0]))}),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSAnonymousCredentialsRemoveUsedTokensStoredProcedure";a.__tables__=["secure_acs_tokens"];e.exports=a}),null);
__d("LSGetCurrentTokenPoolState",["LSArrayGetObjectAt","LSRemoveBlindedTokens","LSRemoveUsedTokens"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(b){return d[0]=c.i64.of_float(Date.now()),d[1]=c.createArray(),c.count(c.filter(c.db.table(307).fetch(),function(b){return b.projectName===a[0]})).then(function(a){return d[2]=a})},function(b){return c.forEach(c.filter(c.db.table(307).fetch(),function(b){return b.projectName===a[0]}),function(a){a=a.item;return d[7]=a.configId,c.i64.gt(d[0],a.expirationTimestampMs)?c.forEach(c.db.table(307).fetch([[[d[7]]]]),function(a){return a["delete"]()}):c.resolve(d[8]=(d[1].push(d[7]),d[1]))})},function(a){return c.storedProcedure(b("LSRemoveUsedTokens"))},function(a){return d[3]=c.i64.cast([0,0]),d[4]=c.i64.of_int32(d[1].length),c.i64.gt(d[4],c.i64.cast([0,0]))?c.loopAsync(d[4],function(a){return d[7]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[1],d[7]).then(function(a){return a=a,d[8]=a[0],d[9]=a[1],a})},function(a){return c.count(c.filter(c.db.table(309).fetch(),function(a){return a.configId===d[8]})).then(function(a){return d[10]=a})},function(a){return d[3]=c.i64.add(d[10],d[3]),c.storedProcedure(b("LSRemoveBlindedTokens"),d[8])}])}):c.resolve()},function(a){return c.i64.gt(d[2],c.i64.cast([0,0]))?(d[7]=c.i64.of_int32(d[1].length),d[5]=c.i64.ge(d[7],c.i64.cast([0,1]))):d[5]=void 0,d[5]!==void 0?(d[5]?(c.i64.gt(d[3],c.i64.cast([0,0]))?d[8]=c.i64.cast([0,3]):d[8]=c.i64.cast([0,2]),d[7]=d[8]):d[7]=c.i64.cast([0,1]),d[6]=d[7]):d[6]=c.i64.cast([0,0]),a=[d[6],d[3]],e[0]=a[0],e[1]=a[1]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSAnonymousCredentialsGetCurrentTokenPoolStateStoredProcedure";a.__tables__=["secure_acs_configurations","secure_acs_tokens"];e.exports=a}),null);
__d("LSVoprfBlind.nop",["XPlatReactVoprf"],(function(a,b,c,d,e,f,g){"use strict";a=async function(a,b,c){a=await d("XPlatReactVoprf").loadXPlatReactVoprf();b=a.voprfInstance;a=b.voprfInfo;var e=b.voprfWasm;try{e=e.blind(a,new Uint8Array(c));return[e.blindedElement.buffer,e.blindingFactor.buffer]}catch(a){throw a}finally{d("XPlatReactVoprf").freeVoprfInstance(b)}};a.__nop_name__="LSVoprfBlind";g.default=a}),98);
__d("LSVoprfCreateNonce.nop",["LSSynchronousPromise","XPlatReactCrypto"],(function(a,b,c,d,e,f,g){"use strict";var h=32;a=function(a,b){a=h;b=new Uint8Array(a);d("XPlatReactCrypto").getRandomValues(b);return d("LSSynchronousPromise").makeSynchronousPromise([b.buffer])};a.__nop_name__="LSVoprfCreateNonce";g["default"]=a}),98);
__d("LSTaskSerializerAcsIssueNextSync",["LSBase64Encode.nop","LSGetCurrentTokenPoolState","LSIssueNextSync","LSVoprfBlind.nop","LSVoprfCreateNonce.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return c.db.table(310).fetch([[[a[0]]]]).next().then(function(a,e){var f=a.done;a=a.value;return f?(function(a){c.logger(a).mustfix(a)}("Request context for the passed task_id was not found"),f=[void 0,void 0,void 0],d[0]=f[0],d[1]=f[1],d[2]=f[2]):(e=a.item,c.sequence([function(a){return d[9]=e.projectName,d[10]=e.maxClientTokenPoolSize,c.storedProcedure(b("LSGetCurrentTokenPoolState"),d[9]).then(function(a){return a=a,d[4]=a[0],d[5]=a[1],a})},function(a){return c.i64.eq(d[4],c.i64.cast([0,0]))||c.i64.eq(d[4],c.i64.cast([0,1]))?c.resolve((d[11]=new c.Map(),d[11].set("project_name",d[9]),d[12]=c.toJSON(d[11]),a=[d[12],c.i64.cast([0,351]),void 0],d[6]=a[0],d[7]=a[1],d[8]=a[2])):c.sequence([function(a){return d[11]=c.i64.of_float(Date.now()),c.islc(c.sortBy(c.filter(c.db.table(307).fetch(),function(a){return a.projectName===d[9]&&c.i64.gt(a.expirationTimestampMs,d[11])}),[["expirationTimestampMs","DESC"]]),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(e,f){var a=e.done;e=e.value;return a?(function(a){c.logger(a).mustfix(a)}("A config for the passed project name was not found"),d[16]=new c.Map(),d[16].set("project_name",d[9]),d[16].set("max_client_token_pool_size",d[10]),d[17]=c.toJSON(d[16]),a=[d[17],c.i64.cast([0,362]),void 0],d[12]=a[0],d[13]=a[1],d[14]=a[2]):(f=e.item,c.sequence([function(a){return d[24]=f.configId,d[16]=f.maxEvals,d[26]=f.tokenPollFrequencyMs,d[25]=f.maxClientTokenPoolSize,d[17]=c.i64.sub(d[10],d[5]),d[23]=c.i64.lt(d[16],d[17])?d[16]:d[17],d[18]=c.createArray(),c.i64.gt(d[23],c.i64.cast([0,0]))?c.loopAsync(d[23],function(a){return d[27]=a,c.sequence([function(a){return c.nativeOperation(b("LSVoprfCreateNonce.nop")).then(function(a){return a=a,d[28]=a[0],a})},function(a){return c.blobs.neq(d[28],void 0)?c.sequence([function(a){return c.nativeOperation(b("LSVoprfBlind.nop"),d[28]).then(function(a){return a=a,d[29]=a[0],d[30]=a[1],a})},function(a){return c.blobs.neq(d[29],void 0)?c.blobs.neq(d[30],void 0)?c.sequence([function(a){return d[31]=c.i64.cast([-1,4294967295]),c.db.table(308).peekNextAutoIncrementId().then(function(a){return d[31]=a})},function(a){return c.db.table(308).add({tokenId:void 0,blindedNonce:d[29],blindingFactor:d[30],nonce:d[28],configId:d[24]})},function(a){return c.db.table(308).fetch([[[d[31]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[32]=c.i64.cast([-1,4294967295]):(e=b.item,d[32]=e.tokenId)})},function(a){return c.i64.eq(d[32],c.i64.cast([-1,4294967295]))?c.sequence([function(a){return c.islc(c.db.table(308).fetchDesc([[[{gt:c.i64.cast([0,0])}]]]),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(b,e){var a=b.done;b=b.value;return a?d[37]=c.i64.cast([-1,4294967295]):(e=b.item,d[37]=e.tokenId)})},function(a){return d[34]=d[37]}]):c.resolve(d[34]=d[32])},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[29]).then(function(a){return a=a,d[35]=a[0],a})},function(a){return d[36]=new c.Map(),d[36].set("id",d[34]),d[36].set("data",d[35]==null?"":d[35]),d[37]=(d[18].push(d[36]),d[18])}]):c.resolve():c.resolve()}]):c.resolve()}])}):c.resolve()},function(a){return d[19]=c.i64.of_int32(d[18].length),c.i64.gt(d[19],c.i64.cast([0,0]))?c.resolve((d[27]=new c.Map(),d[27].set("project_name",d[9]),d[27].set("config_id",d[24]),d[27].set("blinded_nonces",d[18]),d[28]=c.toJSON(d[27]),a=[d[28],c.i64.cast([0,354]),void 0],d[20]=a[0],d[21]=a[1],d[22]=a[2])):c.sequence([function(a){return c.i64.neq(d[26],void 0)?c.sequence([function(a){return c.i64.neq(d[25],void 0)?c.sequence([function(a){return function(a){c.logger(a).info(a)}(["Already have the max number of tokens. Scheduling next ACS token sync locally for project: ",d[9]].join("")),c.storedProcedure(b("LSIssueNextSync"),d[25],d[9],d[26],!1)},function(a){return a=[void 0,void 0,void 0],d[30]=a[0],d[31]=a[1],d[32]=a[2],a}]):c.resolve((function(a){c.logger(a).info(a)}(["token_poll_frequency is nonnull but max_client_token_pool_size is null. Already have the max number of tokens. Scheduling the next ACS token sync for project: ",d[9]].join("")),d[33]=new c.Map(),d[33].set("project_name",d[9]),d[33].set("max_client_token_pool_size",d[10]),d[34]=c.toJSON(d[33]),a=[d[34],c.i64.cast([0,362]),void 0],d[30]=a[0],d[31]=a[1],d[32]=a[2]))},function(a){return a=[d[30],d[31],d[32]],d[27]=a[0],d[28]=a[1],d[29]=a[2],a}]):c.resolve((function(a){c.logger(a).info(a)}(["Already have the max number of tokens. Scheduling the next ACS token sync for project: ",d[9]].join("")),d[30]=new c.Map(),d[30].set("project_name",d[9]),d[30].set("max_client_token_pool_size",d[10]),d[31]=c.toJSON(d[30]),a=[d[31],c.i64.cast([0,362]),void 0],d[27]=a[0],d[28]=a[1],d[29]=a[2]))},function(a){return a=[d[27],d[28],d[29]],d[20]=a[0],d[21]=a[1],d[22]=a[2],a}])},function(a){return a=[d[20],d[21],d[22]],d[12]=a[0],d[13]=a[1],d[14]=a[2],a}]))})},function(a){return a=[d[12],d[13],d[14]],d[6]=a[0],d[7]=a[1],d[8]=a[2],a}])},function(a){return a=[d[6],d[7],d[8]],d[0]=a[0],d[1]=a[1],d[2]=a[2],a}]))})},function(a){return a=[d[0],d[1],d[2]],e[0]=a[0],e[1]=a[1],e[2]=a[2],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSAnonymousCredentialsTaskSerializerAcsIssueNextSyncStoredProcedure";a.__tables__=["acs_request_context","secure_acs_configurations","secure_acs_blinded_tokens"];e.exports=a}),null);
__d("LSTaskSerializerDeleteChatHistory",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(e){return b.sequence([function(d){return b.db.table(32).fetch([[[a[0]]]]).next().then(function(d,e){var f=d.done;d=d.value;return f?(c[4]=b.createArray(),c[5]=(c[4].push("taskSerializerDeleteChatHistory: Task ID not found"),c[4]),c[6]=(c[4].push(a[0]),c[4]),c[7]=b.toJSON(c[4]),function(a){b.logger(a).mustfix(a)}(c[7]),f=[void 0,void 0,void 0],c[0]=f[0],c[1]=f[1],c[2]=f[2]):(e=d.item,b.sequence([function(a){return c[8]=e.threadKey,b.db.table(9).fetch([[[c[8]]]]).next().then(function(a,d){d=a.done;a=a.value;return d?(c[9]=b.createArray(),c[10]=(c[9].push("taskSerializerDeleteChatHistory: Thread not found"),c[9]),c[11]=(c[9].push(c[8]),c[9]),c[12]=b.toJSON(c[9]),function(a){b.logger(a).mustfix(a)}(c[12]),d=[void 0,void 0,void 0],c[4]=d[0],c[5]=d[1],c[6]=d[2]):(a.item,b.sequence([function(a){return b.db.table(9).fetch([[[c[8]]]]).next().then(function(d,e){var a=d.done;d=d.value;return a?c[9]=b.i64.cast([0,1]):(e=d.item,c[14]=e.syncGroup,b.i64.neq(c[14],void 0)?c[13]=c[14]:c[13]=b.i64.cast([0,1]),c[9]=c[13])})},function(a){return c[11]=new b.Map(),c[11].set("thread_key",c[8]),c[11].set("sync_group",c[9]),c[12]=b.toJSON(c[11]),a=[c[12],b.i64.cast([0,903]),void 0],c[4]=a[0],c[5]=a[1],c[6]=a[2]}]))})},function(a){return a=[c[4],c[5],c[6]],c[0]=a[0],c[1]=a[1],c[2]=a[2],a}]))})},function(a){return a=[c[0],c[1],c[2]],d[0]=a[0],d[1]=a[1],d[2]=a[2],a}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxTaskSerializerDeleteChatHistoryStoredProcedure";a.__tables__=["threads_optimistic_context","threads"];e.exports=a}),null);
__d("LSTaskSerializerE2eeMessageIntegrityCheckV2",[],(function(a,b,c,d,e,f){function a(){var a,b=arguments,c=b[b.length-1],d=[];return a=[void 0,c.i64.cast([0,705]),void 0],d[0]=a[0],d[1]=a[1],d[2]=a[2],c.resolve(d)}a.__sproc_name__="LSEncryptedBackupsTaskSerializerE2eeMessageIntegrityCheckV2StoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSTaskSerializerE2eeMetadataThreadIntegrityCheck",[],(function(a,b,c,d,e,f){function a(){var a,b=arguments,c=b[b.length-1],d=[];return a=[void 0,c.i64.cast([0,700]),void 0],d[0]=a[0],d[1]=a[1],d[2]=a[2],c.resolve(d)}a.__sproc_name__="LSE2EEMessagingMetadataMailboxTaskSerializerE2eeMetadataThreadIntegrityCheckStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSTaskSerializerEncryptedBackupAction",[],(function(a,b,c,d,e,f){function a(){var a,b=arguments,c=b[b.length-1],d=[];return a=[void 0,c.i64.cast([0,319]),void 0],d[0]=a[0],d[1]=a[1],d[2]=a[2],c.resolve(d)}a.__sproc_name__="LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSTaskSerializerEncryptedBackupsLoopingUpload",["LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(a){return c.sequence([function(a){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][taskSerializerEncryptedBackupsLoopingUpload] Beginning execution."),d[1]=c.i64.of_float(Date.now()),function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsLoopingUploadStoredProcedure] LSEncryptedBackupsLoopingUploadPayloadsTable table not found"),d[3]="LSEncryptedBackupsLoopingUploadPayloadsTable table not found",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsLoopingUploadStoredProcedure] ","",d[3]].join("")),d[2]=c.createArray(),void 0!==void 0?d[10]=(d[2].push(void 0),d[2]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsTaskSerializerEncryptedBackupsLoopingUploadStoredProcedure",d[3],d[2],c.i64.cast([0,3]))},function(a){return d[4]=c.i64.of_float(Date.now()),d[5]=c.i64.random(),d[7]="Finishing execution. Execution time: ",d[8]=c.i64.to_string(c.i64.sub(d[4],d[0])),d[9]=" ms",d[6]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][taskSerializerEncryptedBackupsLoopingUpload] ",d[6],d[7],d[6],d[8],d[6],d[9]].join("")),c.i64.eq(c.i64.mod_(d[5],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[10]=",",d[11]=c.createArray(),void 0!==void 0?d[12]=(d[11].push(void 0),d[11]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"taskSerializerEncryptedBackupsLoopingUpload",[d[7],d[10],d[8],d[10],d[9]].join(""),d[11],c.i64.cast([0,4]))):c.resolve()},function(a){return a=['{"request_id":"unknown","upload_type":"FBN","payload":{"error_code":2,"operation":"","error_message":"","__typename":"MPSUploadFailurePayload"}}',c.i64.cast([0,50043]),void 0],e[0]=a[0],e[1]=a[1],e[2]=a[2],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsTaskSerializerEncryptedBackupsLoopingUploadStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSQueryLocalPersistenceStoreForBackup.nop",["ReQL"],(function(a,b,c,d,e,f,g){"use strict";a=async function(a,b,c,e){b=await d("ReQL").toArrayAsync(d("ReQL").fromTableDescending(a.local_message_persistence_store).filter(function(a){var b=a.offlineThreadingId;a=a.threadId;return a===c&&e===b}));if(b.length===0)return Promise.resolve([void 0,void 0,!1]);a=b[0];return Promise.resolve([a.messagePayload,a.messageTimestampMs,!1])};a.__nop_name__="LSQueryLocalPersistenceStoreForBackup";g.default=a}),98);
__d("LSQueryLocalPersistenceStoreSupplementalForBackup.nop",["ReQL"],(function(a,b,c,d,e,f,g){"use strict";a=async function(a,b,c,e,f){b=await d("ReQL").firstAsync(d("ReQL").fromTableDescending(a.local_message_persistence_store_supplemental).filter(function(a){var b=a.supplementalKey,d=a.threadId;a=a.toplevelOfflineThreadingId;return d===c&&a===e&&b===f}));return b==null?Promise.resolve([void 0,void 0]):Promise.resolve([b.messagePayload,b.messageTimestampMs])};a.__nop_name__="LSQueryLocalPersistenceStoreSupplementalForBackup";g.default=a}),98);
__d("LSQueryLocalPersistenceStoreTagsForBackup.nop",["LSVec","ReQL"],(function(a,b,c,d,e,f,g){"use strict";var h=":";a=async function(a,b,e,f){b=await d("ReQL").firstAsync(d("ReQL").fromTableDescending(a.local_message_persistence_store_tag_index.index("offlineThreadingId")).getKeyRange(f,e));if(b==null)return Promise.resolve([c("LSVec").ofArray([])]);a=b.tag;return Promise.resolve([c("LSVec").ofArray(a.split(h))])};a.__nop_name__="LSQueryLocalPersistenceStoreTagsForBackup";g.default=a}),98);
__d("LSLoadUnencryptedProtobufWithInputs",["LSBase64Encode.nop","LSGetBlobFromString.nop","LSLogMebClientEvent.nop","LSQueryLocalPersistenceStoreForBackup.nop","LSQueryLocalPersistenceStoreSupplementalForBackup.nop","LSQueryLocalPersistenceStoreTagsForBackup.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][loadUnencryptedProtobufWithInputs] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.i64.eq(a[0],c.i64.cast([0,1]))?c.sequence([function(e){return c.nativeOperation(b("LSQueryLocalPersistenceStoreForBackup.nop"),a[1],a[2]).then(function(a){return a=a,d[10]=a[0],d[11]=a[1],d[12]=a[2],a})},function(e){return c.nativeOperation(b("LSQueryLocalPersistenceStoreTagsForBackup.nop"),a[1],a[2]).then(function(a){return a=a,d[13]=a[0],a})},function(e){return c.blobs.neq(d[10],void 0)?c.sequence([function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[10]).then(function(a){return a=a,d[16]=a[0],a})},function(b){return d[16]!==void 0?(d[13]!==void 0?(d[21]=new c.Map(),d[21].set("message_tags",d[13]),d[22]=new c.Map(),d[26]="message_tags",d[23]=d[21].get(d[26]),d[23]?d[24]=!1:d[24]=!0,d[24]?0:d[22].set(d[26],d[23]),d[25]=c.toJSON(d[22]),d[19]=d[25]):d[19]=void 0,d[20]=new c.Map(),d[20].set("backup_action",a[0]),d[20].set("protobuf_encrypted",d[16]),d[20].set("supplemental_data_encrypted",void 0),d[20].set("timestamp_ms",a[4]),d[20].set("message_tags",d[19]),b=[d[20],void 0],d[17]=b[0],d[18]=b[1]):(function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error PROTOBUF_FORMATTING_FAILED"),d[19]=new c.Map(),d[19].set("error_code",c.i64.cast([0,68])),d[19].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),d[19].set("error_message",""),b=[void 0,d[19]],d[17]=b[0],d[18]=b[1]),b=[d[17],d[18]],d[14]=b[0],d[15]=b[1]}]):c.resolve((d[12]?(function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error PROTOBUF_ALREADY_DELETED"),d[18]=new c.Map(),d[18].set("error_code",c.i64.cast([0,70])),d[18].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),d[18].set("error_message",""),e=[void 0,d[18]],d[16]=e[0],d[17]=e[1]):(function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error PROTOBUF_NOT_FOUND_IN_TOPLEVEL_TABLE"),d[18]=new c.Map(),d[18].set("error_code",c.i64.cast([0,63])),d[18].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),d[18].set("error_message",""),e=[void 0,d[18]],d[16]=e[0],d[17]=e[1]),e=[d[16],d[17]],d[14]=e[0],d[15]=e[1]))},function(a){return a=[d[14],d[15]],d[2]=a[0],d[3]=a[1],a}]):c.sequence([function(e){return c.i64.eq(a[0],c.i64.cast([0,2]))?c.sequence([function(e){return a[3]!==void 0?c.sequence([function(e){return c.nativeOperation(b("LSQueryLocalPersistenceStoreSupplementalForBackup.nop"),a[1],a[2],a[3]).then(function(a){return a=a,d[14]=a[0],d[15]=a[1],a})},function(e){return c.nativeOperation(b("LSQueryLocalPersistenceStoreTagsForBackup.nop"),a[1],a[2]).then(function(a){return a=a,d[16]=a[0],a})},function(e){return c.blobs.neq(d[14],void 0)?c.sequence([function(e){return c.nativeOperation(b("LSGetBlobFromString.nop"),a[3]).then(function(a){return a=a,d[19]=a[0],a})},function(e){return c.blobs.neq(d[19],void 0)?c.sequence([function(a){return d[22]=new c.Map(),d[22].set("sk_ciphertext",d[19]),d[22].set("sk_hash",d[19]),c.nativeOperation(b("LSBase64Encode.nop"),d[14]).then(function(a){return a=a,d[23]=a[0],a})},function(b){return d[23]!==void 0?(d[16]!==void 0?(d[28]=new c.Map(),d[28].set("message_tags",d[16]),d[29]=new c.Map(),d[33]="message_tags",d[30]=d[28].get(d[33]),d[30]?d[31]=!1:d[31]=!0,d[31]?0:d[29].set(d[33],d[30]),d[32]=c.toJSON(d[29]),d[26]=d[32]):d[26]=void 0,d[27]=new c.Map(),d[27].set("backup_action",a[0]),d[27].set("protobuf_encrypted",d[23]),d[27].set("supplemental_data_encrypted",d[22]),d[27].set("timestamp_ms",a[4]),d[27].set("message_tags",d[26]),b=[d[27],void 0],d[24]=b[0],d[25]=b[1]):(function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error PROTOBUF_FORMATTING_FAILED"),d[26]=new c.Map(),d[26].set("error_code",c.i64.cast([0,68])),d[26].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),d[26].set("error_message",""),b=[void 0,d[26]],d[24]=b[0],d[25]=b[1]),b=[d[24],d[25]],d[20]=b[0],d[21]=b[1]}]):c.resolve((function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error SUPPLEMENTAL_FORMATTING_FAILED"),d[22]=new c.Map(),d[22].set("error_code",c.i64.cast([0,69])),d[22].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),d[22].set("error_message",""),e=[void 0,d[22]],d[20]=e[0],d[21]=e[1]))},function(a){return a=[d[20],d[21]],d[17]=a[0],d[18]=a[1],a}]):c.resolve((function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error PROTOBUF_NOT_FOUND_IN_SUPPLEMENTAL_TABLE"),d[19]=new c.Map(),d[19].set("error_code",c.i64.cast([0,64])),d[19].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),d[19].set("error_message",""),e=[void 0,d[19]],d[17]=e[0],d[18]=e[1]))},function(a){return a=[d[17],d[18]],d[12]=a[0],d[13]=a[1],a}]):c.resolve((function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error SUPPLEMENTAL_KEY_NOT_SET_IN_CONTEXT_TABLE"),d[14]=new c.Map(),d[14].set("error_code",c.i64.cast([0,65])),d[14].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),d[14].set("error_message",""),e=[void 0,d[14]],d[12]=e[0],d[13]=e[1]))},function(a){return a=[d[12],d[13]],d[10]=a[0],d[11]=a[1],a}]):c.resolve((c.i64.eq(a[0],c.i64.cast([0,3]))?(d[14]=new c.Map(),d[14].set("backup_action",a[0]),d[14].set("protobuf_encrypted",void 0),d[14].set("supplemental_data_encrypted",void 0),d[14].set("timestamp_ms",a[4]),d[14].set("message_tags",void 0),e=[d[14],void 0],d[12]=e[0],d[13]=e[1]):(function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure] Returning error INVALID_BACKUP_OPERATION"),d[14]=new c.Map(),d[14].set("error_code",c.i64.cast([-1,4294967289])),d[14].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure"),d[14].set("error_message",""),e=[void 0,d[14]],d[12]=e[0],d[13]=e[1]),e=[d[12],d[13]],d[10]=e[0],d[11]=e[1]))},function(a){return a=[d[10],d[11]],d[2]=a[0],d[3]=a[1],a}])},function(a){return d[4]=c.i64.of_float(Date.now()),d[5]=c.i64.random(),d[7]="Finishing execution. Execution time: ",d[8]=c.i64.to_string(c.i64.sub(d[4],d[0])),d[9]=" ms",d[6]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][loadUnencryptedProtobufWithInputs] ",d[6],d[7],d[6],d[8],d[6],d[9]].join("")),c.i64.eq(c.i64.mod_(d[5],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[10]=",",d[11]=c.createArray(),void 0!==void 0?d[12]=(d[11].push(void 0),d[11]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"loadUnencryptedProtobufWithInputs",[d[7],d[10],d[8],d[10],d[9]].join(""),d[11],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[2],d[3]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsLoadUnencryptedProtobufWithInputsStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSLoadUnencryptedProtobufBackupSerializedPayloadData",["LSLoadUnencryptedProtobufWithInputs","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(b){var e;return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][loadUnencryptedProtobufBackupSerializedPayloadData] Beginning execution."),d[1]=c.i64.of_float(Date.now()),d[18]=c.i64.mul(d[1],c.i64.cast([0,1e6])),c.sequence([function(b){return c.db.table(2).fetch([[[a[0]]]]).next().then(function(b,e){var f=b.done;b=b.value;return f?(d[30]=c.i64.of_float(Date.now()),f=[a[0],void 0,void 0,void 0,void 0,c.i64.sub(c.i64.mul(d[30],c.i64.cast([0,1e6])),d[18]),void 0],d[22]=f[0],d[23]=f[1],d[24]=f[2],d[25]=f[3],d[26]=f[4],d[27]=f[5],d[28]=f[6]):(e=b.item,d[30]=c.i64.of_float(Date.now()),f=[a[0],e.queueName,e.enqueueTimestampMs,e.priority,e.firstExecutedTimestampMs,c.i64.sub(c.i64.mul(d[30],c.i64.cast([0,1e6])),d[18]),void 0],d[22]=f[0],d[23]=f[1],d[24]=f[2],d[25]=f[3],d[26]=f[4],d[27]=f[5],d[28]=f[6])})},function(a){return a=[d[22],d[23],d[24],d[25],d[26],d[27],d[28]],d[2]=a[0],d[3]=a[1],d[4]=a[2],d[5]=a[3],d[6]=a[4],d[7]=a[5],d[8]=a[6],a}])},function(e){return d[9]=new c.Map(),d[9].set("task_id",d[2]),d[9].set("queue_name",d[3]),d[9].set("enqueue_timestamp_ms",d[4]),d[9].set("priority",d[5]),d[9].set("first_executed_timestamp_ms",d[6]),d[9].set("execution_time_ns",d[7]),d[9].set("echo_encoding_execution_time_ns",d[8]),d[10]=new c.Map(),d[10].set("task_metadata",d[9]),d[10].set("action_type",void 0),d[10].set("content_type",void 0),d[10].set("identifiers",void 0),d[10].set("identifiers_v2",void 0),d[10].set("task_creation_source",void 0),d[10].set("message_payload_source",c.i64.cast([0,2])),c.filter(c.db.table(305).fetch(),function(b){return c.i64.eq(b.pendingBackupTaskId,a[0])}).next().then(function(e,f){var g=e.done;e=e.value;return g?(d[22]=new c.Map(),d[22].set("error_code",c.i64.cast([0,5])),d[22].set("stored_procedure","LSEncryptedBackupsLoadUnencryptedProtobufBackupSerializedPayloadDataStoredProcedure"),d[22].set("error_message",""),g=[void 0,d[22],d[10]],d[11]=g[0],d[12]=g[1],d[13]=g[2]):(f=e.item,c.sequence([function(b){var e;return d[39]=f.actThreadId,d[40]=f.toplevelOfflineThreadingId,d[23]=f.messageTimestampMs,d[22]=new c.Map(),d[22].set("backup_id","openEbUploadGenericBackupId"),d[22].set("act_thread_id",d[39]),d[22].set("server_thread_id",d[39]),d[22].set("timestamp",c.i64.to_string(d[23])),d[22].set("otid",d[40]),d[24]=new c.Map(),d[24].set("backup_id","openEbUploadGenericBackupId"),d[24].set("act_thread_id",d[39]),d[24].set("timestamp",c.i64.to_string(d[23])),d[24].set("otid",d[40]),c.sequence([function(b){return c.db.table(2).fetch([[[a[0]]]]).next().then(function(e,f){var b=e.done;e=e.value;return b?(d[49]=c.i64.of_float(Date.now()),b=[a[0],void 0,void 0,void 0,void 0,c.i64.sub(c.i64.mul(d[49],c.i64.cast([0,1e6])),d[18]),void 0],d[41]=b[0],d[42]=b[1],d[43]=b[2],d[44]=b[3],d[45]=b[4],d[46]=b[5],d[47]=b[6]):(f=e.item,d[49]=c.i64.of_float(Date.now()),b=[a[0],f.queueName,f.enqueueTimestampMs,f.priority,f.firstExecutedTimestampMs,c.i64.sub(c.i64.mul(d[49],c.i64.cast([0,1e6])),d[18]),void 0],d[41]=b[0],d[42]=b[1],d[43]=b[2],d[44]=b[3],d[45]=b[4],d[46]=b[5],d[47]=b[6])})},function(a){return a=[d[41],d[42],d[43],d[44],d[45],d[46],d[47]],d[25]=a[0],d[26]=a[1],d[27]=a[2],d[28]=a[3],d[29]=a[4],d[30]=a[5],d[31]=a[6],a}])},function(a){return d[32]=new c.Map(),d[32].set("task_id",d[25]),d[32].set("queue_name",d[26]),d[32].set("enqueue_timestamp_ms",d[27]),d[32].set("priority",d[28]),d[32].set("first_executed_timestamp_ms",d[29]),d[32].set("execution_time_ns",d[30]),d[32].set("echo_encoding_execution_time_ns",d[31]),d[33]=new c.Map(),d[33].set("task_metadata",d[32]),d[33].set("action_type",void 0),d[33].set("content_type",void 0),d[33].set("identifiers",void 0),d[33].set("identifiers_v2",d[24]),d[33].set("task_creation_source",void 0),d[33].set("message_payload_source",c.i64.cast([0,2])),c.storedProcedure(b("LSLoadUnencryptedProtobufWithInputs"),f.backupAction,d[39],d[40],f.supplementalKey,d[23],d[22]).then(function(a){return a=a,d[34]=a[0],d[35]=a[1],a})},function(a){return d[34]!==void 0?(d[41]=new c.Map(),d[41].set("unencrypted_protobuf_backup_payload",d[34]),d[41].set("message_identifiers",d[22]),d[41].set("attachment_backup_payload",f.attachmentPayload),d[41].set("sender_id",f.senderId),d[41].set("extra_data_for_eb_upload",void 0),a=[d[41],void 0,d[33]],d[36]=a[0],d[37]=a[1],d[38]=a[2]):(a=[void 0,d[35],d[33]],d[36]=a[0],d[37]=a[1],d[38]=a[2],a),a=[d[36],d[37],d[38]],d[11]=a[0],d[12]=a[1],d[13]=a[2]}]))})},function(a){return d[15]=c.i64.of_float(Date.now()),d[16]=c.i64.random(),d[19]="Finishing execution. Execution time: ",d[20]=c.i64.to_string(c.i64.sub(d[15],d[0])),d[21]=" ms",d[17]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][loadUnencryptedProtobufBackupSerializedPayloadData] ",d[17],d[19],d[17],d[20],d[17],d[21]].join("")),c.i64.eq(c.i64.mod_(d[16],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[22]=",",d[23]=c.createArray(),void 0!==void 0?d[24]=(d[23].push(void 0),d[23]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"loadUnencryptedProtobufBackupSerializedPayloadData",[d[19],d[22],d[20],d[22],d[21]].join(""),d[23],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[11],d[12],d[13]],e[0]=a[0],e[1]=a[1],e[2]=a[2],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsLoadUnencryptedProtobufBackupSerializedPayloadDataStoredProcedure";a.__tables__=["pending_tasks","pending_protobuf_backups_context"];e.exports=a}),null);
__d("LSTaskSerializerEncryptedBackupsOpenUpload",["LSArrayGetObjectAt","LSBase64Encode.nop","LSDeserializeFromJsonIntoDictionaryV2.nop","LSLoadUnencryptedProtobufBackupSerializedPayloadData","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][taskSerializerEncryptedBackupsOpenUpload] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.storedProcedure(b("LSLoadUnencryptedProtobufBackupSerializedPayloadData"),a[0]).then(function(a){return a=a,d[2]=a[0],d[3]=a[1],d[4]=a[2],a})},function(a){return d[2]!==void 0?c.sequence([function(a){return d[15]=d[2].get("message_identifiers"),d[16]=d[2].get("unencrypted_protobuf_backup_payload"),d[17]=d[15].get("server_thread_id"),d[18]=d[15].get("timestamp"),d[19]=d[15].get("otid"),d[20]=d[15].get("act_thread_id"),d[21]=new c.Map(),d[21].set("server_thread_key",d[17]),d[21].set("timestamp",d[18]),d[21].set("otid",d[19]),d[21].set("wa_thread_id",c.i64.from_string(d[20])),d[22]=new c.Map(),d[22].set("message_identifiers",d[21]),d[23]=d[2].get("extra_data_for_eb_upload"),d[23]!==void 0?c.sequence([function(a){return c.nativeOperation(b("LSDeserializeFromJsonIntoDictionaryV2.nop"),d[23]).then(function(a){return a=a,d[32]=a[0],a})},function(a){return d[33]=new c.Map(),d[39]="ttd",d[34]=d[32].get(d[39]),d[34]?d[35]=!1:d[35]=!0,d[35]?c.resolve():c.sequence([function(a){return d[34]?d[42]=!1:d[42]=!0,d[42]?c.resolve(d[43]=void 0):c.sequence([function(a){return d[44]=new c.Map(),d[47]="message_tags",d[45]=d[34].get(d[47]),d[45]?d[46]=!1:d[46]=!0,d[46]?c.resolve():c.sequence([function(a){return d[48]=c.createArray(),d[49]=c.i64.of_int32(d[45].length),c.i64.gt(d[49],c.i64.cast([0,0]))?c.loopAsync(d[49],function(a){return d[50]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[45],d[50]).then(function(a){return a=a,d[51]=a[0],d[52]=a[1],a})},function(a){return d[53]=(d[48].push(d[51]),d[48])}])}):c.resolve()},function(a){return d[44].set(d[47],d[48])}])},function(a){return d[43]=d[44]}])},function(a){return d[33].set(d[39],d[43])}])},function(a){return d[40]="mt",d[36]=d[32].get(d[40]),d[36]?d[37]=!1:d[37]=!0,d[37]?c.resolve():c.sequence([function(a){return d[36]?d[42]=!1:d[42]=!0,d[42]?c.resolve(d[43]=void 0):c.sequence([function(a){return d[44]=new c.Map(),d[47]="message_tags",d[45]=d[36].get(d[47]),d[45]?d[46]=!1:d[46]=!0,d[46]?c.resolve():c.sequence([function(a){return d[48]=c.createArray(),d[49]=c.i64.of_int32(d[45].length),c.i64.gt(d[49],c.i64.cast([0,0]))?c.loopAsync(d[49],function(a){return d[50]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[45],d[50]).then(function(a){return a=a,d[51]=a[0],d[52]=a[1],a})},function(a){return d[53]=(d[48].push(d[51]),d[48])}])}):c.resolve()},function(a){return d[44].set(d[47],d[48])}])},function(a){return d[43]=d[44]}])},function(a){return d[33].set(d[40],d[43])}])},function(a){return d[41]="mooos",d[38]=d[32].get(d[41]),d[38]!==void 0?d[33].set(d[41],d[38]):0,d[24]=d[33]}]):c.resolve(d[24]=void 0)},function(a){return d[24]!==void 0?(d[32]=d[24].get("mt"),d[32]!==void 0?(d[34]=new c.Map(),d[38]="message_tags",d[35]=d[32].get(d[38]),d[35]?d[36]=!1:d[36]=!0,d[36]?0:d[34].set(d[38],d[35]),d[37]=c.toJSON(d[34]),d[33]=d[37]):d[33]=void 0,d[25]=d[33]):d[25]=void 0,d[26]=d[16].get("supplemental_data_encrypted"),d[26]!==void 0?c.sequence([function(a){return d[32]=d[16].get("protobuf_encrypted"),d[33]=d[16].get("backup_action"),d[34]=d[16].get("timestamp_ms"),d[35]=d[26].get("sk_ciphertext"),c.nativeOperation(b("LSBase64Encode.nop"),d[35]).then(function(a){return a=a,d[36]=a[0],a})},function(a){return d[37]=d[26].get("sk_hash"),c.nativeOperation(b("LSBase64Encode.nop"),d[37]).then(function(a){return a=a,d[38]=a[0],a})},function(a){return d[39]=new c.Map(),d[39].set("supplementary_data_key",void 0),d[39].set("encrypted_protobuf",d[32]),d[39].set("key_value_backup_action",d[33]),d[39].set("protobuf_ts_ms",d[34]),d[39].set("supplemental_key_ciphertext",d[36]),d[39].set("supplemental_key_hash",d[38]),d[39].set("message_tags",d[25]),d[27]=d[39]}]):c.resolve((d[32]=d[16].get("protobuf_encrypted"),d[33]=d[16].get("backup_action"),d[34]=d[16].get("timestamp_ms"),d[35]=new c.Map(),d[35].set("supplementary_data_key",void 0),d[35].set("encrypted_protobuf",d[32]),d[35].set("key_value_backup_action",d[33]),d[35].set("protobuf_ts_ms",d[34]),d[35].set("message_tags",d[25]),d[27]=d[35]))},function(a){return d[22].set("key_value_backup_unencrypted_payload",d[27]),d[28]=d[2].get("sender_id"),d[22].set("sender_id",d[28]),d[29]=d[2].get("attachment_backup_payload"),d[29]!==void 0?d[22].set("attachment_backup_payload",d[29]):0,d[24]!==void 0?(d[32]=d[24].get("ttd"),d[32]!==void 0?(d[34]=new c.Map(),d[38]="message_tags",d[35]=d[32].get(d[38]),d[35]?d[36]=!1:d[36]=!0,d[36]?0:d[34].set(d[38],d[35]),d[37]=c.toJSON(d[34]),d[33]=d[37]):d[33]=void 0,d[30]=d[33]):d[30]=void 0,d[30]!==void 0?d[22].set("tags_to_delete",d[30]):0,d[31]=c.toJSON(d[22]),a=[d[31],void 0,d[4]],d[5]=a[0],d[6]=a[1],d[7]=a[2]}]):c.resolve((d[3]?d[15]=!1:d[15]=!0,d[15]?(a=[void 0,void 0,d[4]],d[16]=a[0],d[17]=a[1],d[18]=a[2],a):(a=[void 0,d[3],d[4]],d[16]=a[0],d[17]=a[1],d[18]=a[2],a),a=[d[16],d[17],d[18]],d[5]=a[0],d[6]=a[1],d[7]=a[2]))},function(a){return d[15]=new c.Map(),d[16]=d[15].set("success",d[5]),d[17]=d[15].set("failure",d[6]),d[18]=d[15].set("context",d[7]),d[19]=c.toJSON(d[15]),d[8]=d[19],d[9]=c.i64.of_float(Date.now()),d[10]=c.i64.random(),d[12]="Finishing execution. Execution time: ",d[13]=c.i64.to_string(c.i64.sub(d[9],d[0])),d[14]=" ms",d[11]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][taskSerializerEncryptedBackupsOpenUpload] ",d[11],d[12],d[11],d[13],d[11],d[14]].join("")),c.i64.eq(c.i64.mod_(d[10],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[15]=",",d[16]=c.createArray(),void 0!==void 0?d[17]=(d[16].push(void 0),d[16]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"taskSerializerEncryptedBackupsOpenUpload",[d[12],d[15],d[13],d[15],d[14]].join(""),d[16],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[8],c.i64.cast([0,50048])],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsTaskSerializerEncryptedBackupsOpenUploadStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSTaskSerializerEncryptedBackupsRestoreWithSerializer",[],(function(a,b,c,d,e,f){function a(){var a,b=arguments,c=b[b.length-1],d=[];return a=[void 0,void 0,void 0],d[0]=a[0],d[1]=a[1],d[2]=a[2],c.resolve(d)}a.__sproc_name__="LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSDeriveValueSecretRefV2",["LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDerivedKeys.nop","LSGetBlobFromString.nop","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][deriveValueSecretRefV2] Beginning execution."),d[1]=c.i64.of_float(Date.now()),d[2]=a[2].get("message_payload_encryption_keys"),d[3]=d[2].get("encryption_version"),d[4]=d[2].get("epoch_anon_id"),d[5]=d[2].get("epoch_root_key"),d[6]=d[2].get("payload_key"),d[7]=c.createArray(),d[41]=(d[7].push(c.i64.cast([0,6])),d[7]),c.nativeOperation(b("LSGetBlobFromString.nop"),"epoch_anon_id_debug").then(function(a){return a=a,d[8]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[8],void 0,d[4],d[7]).then(function(a){return a=a,d[9]=a[0],a})},function(a){return d[9]?d[10]=!1:d[10]=!0,d[10]?c.resolve(d[11]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[9],c.i64.cast([0,0])).then(function(a){return a=a,d[41]=a[0],d[42]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[41]).then(function(a){return a=a,d[43]=a[0],a})},function(a){return d[11]=d[43]==null?"":d[43]}])},function(a){return d[12]=c.createArray(),d[41]=(d[12].push(c.i64.cast([0,6])),d[12]),c.nativeOperation(b("LSGetBlobFromString.nop"),"epoch_root_key_debug").then(function(a){return a=a,d[13]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[13],void 0,d[5],d[12]).then(function(a){return a=a,d[14]=a[0],a})},function(a){return d[14]?d[15]=!1:d[15]=!0,d[15]?c.resolve(d[16]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[14],c.i64.cast([0,0])).then(function(a){return a=a,d[41]=a[0],d[42]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[41]).then(function(a){return a=a,d[43]=a[0],a})},function(a){return d[16]=d[43]==null?"":d[43]}])},function(a){return d[17]=c.createArray(),d[41]=(d[17].push(c.i64.cast([0,6])),d[17]),c.nativeOperation(b("LSGetBlobFromString.nop"),"message_key_debug").then(function(a){return a=a,d[18]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[18],void 0,d[6],d[17]).then(function(a){return a=a,d[19]=a[0],a})},function(a){return d[19]?d[20]=!1:d[20]=!0,d[20]?c.resolve(d[21]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[19],c.i64.cast([0,0])).then(function(a){return a=a,d[41]=a[0],d[42]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[41]).then(function(a){return a=a,d[43]=a[0],a})},function(a){return d[21]=d[43]==null?"":d[43]}])},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[5]).then(function(a){return a=a,d[22]=a[0],a})},function(e){return c.nativeOperation(b("LSGetBlobFromString.nop"),[d[22]==null?"":d[22],a[0]].join("")).then(function(a){return a=a,d[23]=a[0],a})},function(a){return d[24]=c.createArray(),d[41]=(d[24].push(c.i64.cast([0,6])),d[24]),c.nativeOperation(b("LSGetBlobFromString.nop"),"epoch_root_key_thread_id_debug").then(function(a){return a=a,d[25]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[25],void 0,d[23],d[24]).then(function(a){return a=a,d[26]=a[0],a})},function(a){return d[26]?d[27]=!1:d[27]=!0,d[27]?c.resolve(d[28]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[26],c.i64.cast([0,0])).then(function(a){return a=a,d[41]=a[0],d[42]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[41]).then(function(a){return a=a,d[43]=a[0],a})},function(a){return d[28]=d[43]==null?"":d[43]}])},function(a){return d[29]=":",c.blobs.neq(d[5],void 0)?c.sequence([function(a){return d[41]=c.createArray(),d[47]=(d[41].push(c.i64.cast([0,18])),d[41]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkVwb2NoUm9vdEtleQ=="),void 0,d[5],d[41]).then(function(a){return a=a,d[42]=a[0],a})},function(a){return d[42]!==void 0?c.sequence([function(a){return d[47]=c.i64.of_int32(d[42].length),c.i64.ge(d[47],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[42],c.i64.cast([0,0])).then(function(a){return a=a,d[49]=a[0],d[50]=a[1],a})},function(a){return d[48]=d[49]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[50]="CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][MEBFingerprint] ","",d[50]].join("")),d[49]=c.createArray(),void 0!==void 0?d[51]=(d[49].push(void 0),d[49]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint",d[50],d[49],c.i64.cast([0,3]))},function(a){return d[48]=void 0}])},function(a){return d[43]=d[48]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[48]="CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][MEBFingerprint] ","",d[48]].join("")),d[47]=c.createArray(),void 0!==void 0?d[49]=(d[47].push(void 0),d[47]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint",d[48],d[47],c.i64.cast([0,3]))},function(a){return d[43]=void 0}])},function(a){return c.blobs.neq(d[43],void 0)?d[44]=!0:d[44]=!1,d[44]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),c.nativeOperation(b("LSBase64Encode.nop"),d[43]).then(function(a){return a=a,d[45]=a[0],a})},function(a){return d[45]!==void 0?d[46]=d[45]:d[46]="encodingfailed",d[30]=d[46]}]):c.resolve(d[30]="null")},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[4]).then(function(a){return a=a,d[31]=a[0],a})},function(e){return d[32]=new c.Map(),d[32].set("encryption_version",d[3]),d[32].set("epoch_anon_id",d[31]==null?"":d[31]),d[32].set("message_encryption_values",[d[11],d[29],d[16],d[29],d[21],d[29],d[28]].join("")),d[32].set("root_key_fingerprint",d[30]),d[32].set("backup_id",a[1]),d[33]=c.toJSON(d[32]),d[34]=new c.Map(),d[34].set("value_secret_ref",d[33]),d[35]=c.i64.of_float(Date.now()),d[36]=c.i64.random(),d[38]="Finishing execution. Execution time: ",d[39]=c.i64.to_string(c.i64.sub(d[35],d[0])),d[40]=" ms",d[37]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][deriveValueSecretRefV2] ",d[37],d[38],d[37],d[39],d[37],d[40]].join("")),c.i64.eq(c.i64.mod_(d[36],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[41]=",",d[42]=c.createArray(),void 0!==void 0?d[43]=(d[42].push(void 0),d[42]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"deriveValueSecretRefV2",[d[38],d[41],d[39],d[41],d[40]].join(""),d[42],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[34],void 0],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsDeriveValueSecretRefV2StoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSGetBlobFromInt64BE.nop",["GetBlobFromInt64BE"],(function(a,b,c,d,e,f,g){"use strict";a=function(a,b,c){return d("GetBlobFromInt64BE").GetBlobFromInt64BE(c)};a.__nop_name__="LSGetBlobFromInt64BE";g["default"]=a}),98);
__d("OrderPreservingEncryption",["FBLogger","LSCryptoUtils","LSSynchronousPromise","Promise","UInt8Array","WACryptoHkdfSync","XPlatReactCrypto","gkx","isPromise"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(){return d("XPlatReactCrypto").getRandomValues(new Uint8Array(32)).buffer}function j(a){var b=a.length;return b%2!==0?"0"+a:a}function k(a){a=BigInt(a);var b=j(a.toString(16));a=b.length;a=a/2;var c=[];for(var d=0;d<a;++d)c.push(d*2);return new Uint8Array(c.map(function(a){var c=a+2;return b.slice(a,c)}).map(function(a){return parseInt(a,16)}))}function l(a){a=a.map(function(a){return a._0});return{_0:d("UInt8Array").concatBytes(a)}}function m(a){return"OPE key has length "+String(a)+", expected  "+String(32)}function n(a,b,e){var f=new ArrayBuffer(0);if(c("gkx")("13860"))try{var g=d("WACryptoHkdfSync").hkdf(a,d("LSCryptoUtils").bufToUint8(f),d("LSCryptoUtils").bufToUint8(b.buffer),e);return d("LSSynchronousPromise").makeSynchronousPromise({_0:g})}catch(a){c("FBLogger")("labyrinth_web").mustfix("hkdf failed at OrderPreservingEncryption");throw a}return d("XPlatReactCrypto").subtleImportKey("raw",a.buffer,"HKDF",!1,["deriveKey","deriveBits"]).then(function(a){return d("XPlatReactCrypto").subtleDeriveBits({hash:"SHA-256",info:b.buffer,name:"HKDF",salt:f},a,e*8)}).then(function(a){return{_0:d("LSCryptoUtils").bufToUint8(a)}})}function o(a,b){return{_0:d("LSCryptoUtils").modAddBytes(a._0,b)}}function p(a,e,f,g){var j=f.byteLength;if(j!==32)throw c("FBLogger")("labyrinth_web").mustfixThrow(m(j));var k=g.byteLength,p=function(a,b){var c=new Uint8Array(1+k),d=new Uint8Array(k-b).fill(0);c.set([b]);c.set(a.subarray(0,b),1);c.set(d,b+1);return c};if(k>=255)throw c("FBLogger")("labyrinth_web").mustfixThrow("Input is too large");j=Array.from(g).map(function(b,c){c=p(g,c);var e=new Uint8Array(a);e[a-1]=b;b=d("LSCryptoUtils").bufToUint8(f);return n(b,c,a).then(function(a){return o(a,e)})}).map(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise);j=(i||(i=c("isPromise")))(j[0])?(h||(h=b("Promise"))).all(j):d("LSSynchronousPromise").makeSynchronousPromise(j);return j.then(function(a){return d("UInt8Array").concatBytes([new Uint8Array([e]),l(a)._0])})}function e(a,b,c,d){d=k(d);return p(a,b,c,d)}g.keyGen=a;g.intStringToBEBytes=k;g.buildKeyLengthErrorMsg=m;g.encryptBigEndianBytes=p;g.encryptIntString=e}),98);
__d("OpeEncrypt",["CryptoLogger","I64","LSResult","OrderPreservingEncryption"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,e){var f=d("CryptoLogger").CryptoLogger("ope_encrypt");return d("OrderPreservingEncryption").encryptBigEndianBytes((h||(h=d("I64"))).to_int32(e),1,a,new Uint8Array(b)).then(function(a){return c("LSResult")(a.buffer)},function(a){d("CryptoLogger").captureError(f,a).mustfix("OpeEncrypt_impl failed");throw a})}g.OpeEncrypt=a}),98);
__d("LSOpeEncrypt.nop",["OpeEncrypt"],(function(a,b,c,d,e,f,g){"use strict";a=function(a,b,c,e,f){return d("OpeEncrypt").OpeEncrypt(c,e,f)};a.__nop_name__="LSOpeEncrypt";g["default"]=a}),98);
__d("TruncateSortKey",["CryptoLogger","LSResult","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("CryptoLogger").CryptoLogger("truncate_sort_key");function a(a){if(a.byteLength!==8)throw i.mustfixThrow("Bad length on sort key for truncation");var d=new Uint8Array(a);d=d.subarray(0,2);if(d.some(function(a){return a!==0}))throw i.mustfixThrow("Bad prefix on sort key for truncation");return(h||(h=b("Promise"))).resolve(c("LSResult")(a.slice(2)))}g.TruncateSortKey=a}),98);
__d("LSTruncateSortKey.nop",["TruncateSortKey"],(function(a,b,c,d,e,f,g){"use strict";a=function(a,b,c){return d("TruncateSortKey").TruncateSortKey(c)};a.__nop_name__="LSTruncateSortKey";g["default"]=a}),98);
__d("LSEncryptIdentifiersV2",["LSBase64Encode.nop","LSBinaryToHex.nop","LSGetBlobFromInt64BE.nop","LSGetBlobFromString.nop","LSHmac_v2.nop","LSLogMebClientEvent.nop","LSOcmfClientMap.nop","LSOpeEncrypt.nop","LSTruncateSortKey.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][encryptIdentifiersV2] Beginning execution."),d[1]=c.i64.of_float(Date.now()),d[2]=a[6].get("ocmf_shared_key"),c.nativeOperation(b("LSGetBlobFromString.nop"),a[2]).then(function(a){return a=a,d[3]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("bWFpbGJveF9pZF9zY29wZQ=="),d[3]).then(function(a){return a=a,d[4]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[2],d[4]).then(function(a){return a=a,d[5]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[5]).then(function(a){return a=a,d[6]=a[0],a})},function(e){return c.i64.eq(a[0],c.i64.cast([0,2]))&&c.i64.eq(a[1],c.i64.cast([0,2]))?d[7]=a[5]:d[7]=a[3],d[8]=a[6].get("ocmf_shared_key"),c.nativeOperation(b("LSGetBlobFromString.nop"),d[7]).then(function(a){return a=a,d[9]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("dGhyZWFkX2lkX3Njb3Bl"),d[9]).then(function(a){return a=a,d[10]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[8],d[10]).then(function(a){return a=a,d[11]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[11]).then(function(a){return a=a,d[12]=a[0],a})},function(e){return d[13]=a[6].get("ope_key"),c.nativeOperation(b("LSGetBlobFromInt64BE.nop"),a[4]).then(function(a){return a=a,d[14]=a[0],a})},function(a){return c.nativeOperation(b("LSTruncateSortKey.nop"),d[14]).then(function(a){return a=a,d[15]=a[0],a})},function(a){return c.nativeOperation(b("LSOpeEncrypt.nop"),d[13],d[15],c.i64.cast([0,16])).then(function(a){return a=a,d[16]=a[0],a})},function(a){return c.nativeOperation(b("LSBinaryToHex.nop"),d[16]).then(function(a){return a=a,d[17]=a[0],a})},function(e){return d[18]=a[6].get("ocmf_shared_key"),c.nativeOperation(b("LSGetBlobFromString.nop"),a[5]).then(function(a){return a=a,d[19]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("bWVzc2FnZV9pZF9zY29wZQ=="),d[19]).then(function(a){return a=a,d[20]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[18],d[20]).then(function(a){return a=a,d[21]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[21]).then(function(a){return a=a,d[22]=a[0],a})},function(a){return d[23]=new c.Map(),d[23].set("backup_id_ocmf_partial",d[6]==null?"":d[6]),d[23].set("act_thread_id_ocmf_partial",d[12]==null?"":d[12]),d[23].set("timestamp_encrypted",d[17]==null?"":d[17]),d[23].set("otid_ocmf_partial",d[22]==null?"":d[22]),d[24]=c.i64.of_float(Date.now()),d[25]=c.i64.random(),d[27]="Finishing execution. Execution time: ",d[28]=c.i64.to_string(c.i64.sub(d[24],d[0])),d[29]=" ms",d[26]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][encryptIdentifiersV2] ",d[26],d[27],d[26],d[28],d[26],d[29]].join("")),c.i64.eq(c.i64.mod_(d[25],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[30]=",",d[31]=c.createArray(),void 0!==void 0?d[32]=(d[31].push(void 0),d[31]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"encryptIdentifiersV2",[d[27],d[30],d[28],d[30],d[29]].join(""),d[31],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[23],void 0],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsEncryptIdentifiersV2StoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSEncryptMessagePayloadV2",["LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDerivedKeys.nop","LSGetBlobFromString.nop","LSLogMebClientEvent.nop","LSSymmetricEncryptionCreateEncryptedString.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][encryptMessagePayloadV2] Beginning execution."),d[1]=c.i64.of_float(Date.now()),d[2]=a[2].get("message_payload_encryption_keys"),d[3]=d[2].get("payload_key"),c.nativeOperation(b("LSSymmetricEncryptionCreateEncryptedString.nop"),d[3],c.blobs.of_string(["message_thread","_",a[1]].join("")),a[3]).then(function(a){return a=a,d[4]=a[0],a})},function(e){return d[4]!==void 0?c.sequence([function(a){return d[13]=d[2].get("encryption_version"),d[14]=d[2].get("epoch_anon_id"),d[15]=d[2].get("epoch_root_key"),d[16]=d[2].get("payload_key"),d[17]=c.createArray(),d[45]=(d[17].push(c.i64.cast([0,6])),d[17]),c.nativeOperation(b("LSGetBlobFromString.nop"),"epoch_anon_id_debug").then(function(a){return a=a,d[18]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[18],void 0,d[14],d[17]).then(function(a){return a=a,d[19]=a[0],a})},function(a){return d[19]?d[20]=!1:d[20]=!0,d[20]?c.resolve(d[21]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[19],c.i64.cast([0,0])).then(function(a){return a=a,d[45]=a[0],d[46]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[45]).then(function(a){return a=a,d[47]=a[0],a})},function(a){return d[21]=d[47]==null?"":d[47]}])},function(a){return d[22]=c.createArray(),d[45]=(d[22].push(c.i64.cast([0,6])),d[22]),c.nativeOperation(b("LSGetBlobFromString.nop"),"epoch_root_key_debug").then(function(a){return a=a,d[23]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[23],void 0,d[15],d[22]).then(function(a){return a=a,d[24]=a[0],a})},function(a){return d[24]?d[25]=!1:d[25]=!0,d[25]?c.resolve(d[26]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[24],c.i64.cast([0,0])).then(function(a){return a=a,d[45]=a[0],d[46]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[45]).then(function(a){return a=a,d[47]=a[0],a})},function(a){return d[26]=d[47]==null?"":d[47]}])},function(a){return d[27]=c.createArray(),d[45]=(d[27].push(c.i64.cast([0,6])),d[27]),c.nativeOperation(b("LSGetBlobFromString.nop"),"message_key_debug").then(function(a){return a=a,d[28]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[28],void 0,d[16],d[27]).then(function(a){return a=a,d[29]=a[0],a})},function(a){return d[29]?d[30]=!1:d[30]=!0,d[30]?c.resolve(d[31]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[29],c.i64.cast([0,0])).then(function(a){return a=a,d[45]=a[0],d[46]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[45]).then(function(a){return a=a,d[47]=a[0],a})},function(a){return d[31]=d[47]==null?"":d[47]}])},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[15]).then(function(a){return a=a,d[32]=a[0],a})},function(e){return c.nativeOperation(b("LSGetBlobFromString.nop"),[d[32]==null?"":d[32],a[1]].join("")).then(function(a){return a=a,d[33]=a[0],a})},function(a){return d[34]=c.createArray(),d[45]=(d[34].push(c.i64.cast([0,6])),d[34]),c.nativeOperation(b("LSGetBlobFromString.nop"),"epoch_root_key_thread_id_debug").then(function(a){return a=a,d[35]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[35],void 0,d[33],d[34]).then(function(a){return a=a,d[36]=a[0],a})},function(a){return d[36]?d[37]=!1:d[37]=!0,d[37]?c.resolve(d[38]=""):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[36],c.i64.cast([0,0])).then(function(a){return a=a,d[45]=a[0],d[46]=a[1],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[45]).then(function(a){return a=a,d[47]=a[0],a})},function(a){return d[38]=d[47]==null?"":d[47]}])},function(a){return d[39]=":",c.blobs.neq(d[15],void 0)?c.sequence([function(a){return d[45]=c.createArray(),d[51]=(d[45].push(c.i64.cast([0,18])),d[45]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkVwb2NoUm9vdEtleQ=="),void 0,d[15],d[45]).then(function(a){return a=a,d[46]=a[0],a})},function(a){return d[46]!==void 0?c.sequence([function(a){return d[51]=c.i64.of_int32(d[46].length),c.i64.ge(d[51],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[46],c.i64.cast([0,0])).then(function(a){return a=a,d[53]=a[0],d[54]=a[1],a})},function(a){return d[52]=d[53]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[54]="CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][MEBFingerprint] ","",d[54]].join("")),d[53]=c.createArray(),void 0!==void 0?d[55]=(d[53].push(void 0),d[53]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint",d[54],d[53],c.i64.cast([0,3]))},function(a){return d[52]=void 0}])},function(a){return d[47]=d[52]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[52]="CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][MEBFingerprint] ","",d[52]].join("")),d[51]=c.createArray(),void 0!==void 0?d[53]=(d[51].push(void 0),d[51]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint",d[52],d[51],c.i64.cast([0,3]))},function(a){return d[47]=void 0}])},function(a){return c.blobs.neq(d[47],void 0)?d[48]=!0:d[48]=!1,d[48]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),c.nativeOperation(b("LSBase64Encode.nop"),d[47]).then(function(a){return a=a,d[49]=a[0],a})},function(a){return d[49]!==void 0?d[50]=d[49]:d[50]="encodingfailed",d[40]=d[50]}]):c.resolve(d[40]="null")},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[14]).then(function(a){return a=a,d[41]=a[0],a})},function(b){return d[42]=new c.Map(),d[42].set("encryption_version",d[13]),d[42].set("epoch_anon_id",d[41]==null?"":d[41]),d[42].set("message_encryption_values",[d[21],d[39],d[26],d[39],d[31],d[39],d[38]].join("")),d[42].set("root_key_fingerprint",d[40]),d[42].set("backup_id",a[0]),d[43]=c.toJSON(d[42]),d[44]=new c.Map(),d[44].set("encrypted_message_payload",d[4]),d[44].set("value_secret_ref",d[43]),b=[d[44],void 0],d[5]=b[0],d[6]=b[1]}]):c.resolve((d[13]=new c.Map(),d[13].set("error_code",c.i64.cast([0,40])),d[13].set("stored_procedure","LSEncryptedBackupsEncryptMessagePayloadV2StoredProcedure"),d[13].set("error_message",""),e=[void 0,d[13]],d[5]=e[0],d[6]=e[1]))},function(a){return d[7]=c.i64.of_float(Date.now()),d[8]=c.i64.random(),d[10]="Finishing execution. Execution time: ",d[11]=c.i64.to_string(c.i64.sub(d[7],d[0])),d[12]=" ms",d[9]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][encryptMessagePayloadV2] ",d[9],d[10],d[9],d[11],d[9],d[12]].join("")),c.i64.eq(c.i64.mod_(d[8],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[13]=",",d[14]=c.createArray(),void 0!==void 0?d[15]=(d[14].push(void 0),d[14]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"encryptMessagePayloadV2",[d[10],d[13],d[11],d[13],d[12]].join(""),d[14],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[5],d[6]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsEncryptMessagePayloadV2StoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSLoadAndEncryptProtobufWithInputsV2",["LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDerivedKeys.nop","LSGetBlobFromString.nop","LSHmac_v2.nop","LSLogMebClientEvent.nop","LSQueryLocalPersistenceStoreForBackup.nop","LSQueryLocalPersistenceStoreSupplementalForBackup.nop","LSQueryLocalPersistenceStoreTagsForBackup.nop","LSSymmetricEncryptionCreateEncryptedData.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][loadAndEncryptProtobufWithInputsV2] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.i64.eq(a[0],c.i64.cast([0,1]))?c.sequence([function(e){return c.nativeOperation(b("LSQueryLocalPersistenceStoreForBackup.nop"),a[1],a[2]).then(function(a){return a=a,d[10]=a[0],d[11]=a[1],d[12]=a[2],a})},function(e){return c.nativeOperation(b("LSQueryLocalPersistenceStoreTagsForBackup.nop"),a[1],a[2]).then(function(a){return a=a,d[13]=a[0],a})},function(e){return d[14]=new c.Map(),d[14].set("message_tags",d[13]),d[15]=new c.Map(),d[15].set("mt",d[14]),c.blobs.neq(d[10],void 0)?c.sequence([function(e){return d[18]=a[5].get("message_payload_encryption_keys"),d[19]=d[18].get("payload_key"),c.nativeOperation(b("LSSymmetricEncryptionCreateEncryptedData.nop"),d[19],c.blobs.of_string(["message_thread","_",a[1]].join("")),d[10]).then(function(a){return a=a,d[20]=a[0],a})},function(a){return c.blobs.neq(d[20],void 0)?c.sequence([function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[20]).then(function(a){return a=a,d[24]=a[0],a})},function(a){return d[21]=d[24]}]):c.resolve(d[21]=void 0)},function(b){return d[21]!==void 0?(d[15]!==void 0?(d[27]=d[15].get("mt"),d[27]!==void 0?(d[29]=new c.Map(),d[33]="message_tags",d[30]=d[27].get(d[33]),d[30]?d[31]=!1:d[31]=!0,d[31]?0:d[29].set(d[33],d[30]),d[32]=c.toJSON(d[29]),d[28]=d[32]):d[28]=void 0,d[24]=d[28]):d[24]=void 0,d[15]!==void 0?(d[27]=d[15].get("mooos"),d[25]=d[27]):d[25]=void 0,d[26]=new c.Map(),d[26].set("backup_action",a[0]),d[26].set("protobuf_encrypted",d[21]),d[26].set("supplemental_data_encrypted",void 0),d[26].set("timestamp_ms",a[4]),d[26].set("message_tags",d[24]),d[26].set("serialized_attachment_backup_payload",void 0),d[26].set("maybe_ooo_supplemental_upload",d[25]),b=[d[26],void 0],d[22]=b[0],d[23]=b[1]):(function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_ENCRYPTION_FAILED"),d[24]=new c.Map(),d[24].set("error_code",c.i64.cast([0,62])),d[24].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),d[24].set("error_message",""),b=[void 0,d[24]],d[22]=b[0],d[23]=b[1]),b=[d[22],d[23]],d[16]=b[0],d[17]=b[1]}]):c.resolve((d[12]?(function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_ALREADY_DELETED"),d[20]=new c.Map(),d[20].set("error_code",c.i64.cast([0,70])),d[20].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),d[20].set("error_message",""),e=[void 0,d[20]],d[18]=e[0],d[19]=e[1]):(function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_NOT_FOUND_IN_TOPLEVEL_TABLE"),d[20]=new c.Map(),d[20].set("error_code",c.i64.cast([0,63])),d[20].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),d[20].set("error_message",""),e=[void 0,d[20]],d[18]=e[0],d[19]=e[1]),e=[d[18],d[19]],d[16]=e[0],d[17]=e[1]))},function(a){return a=[d[16],d[17]],d[2]=a[0],d[3]=a[1],a}]):c.sequence([function(e){return c.i64.eq(a[0],c.i64.cast([0,2]))?c.sequence([function(e){return a[3]!==void 0?c.sequence([function(e){return c.nativeOperation(b("LSQueryLocalPersistenceStoreSupplementalForBackup.nop"),a[1],a[2],a[3]).then(function(a){return a=a,d[14]=a[0],d[15]=a[1],a})},function(e){return c.nativeOperation(b("LSQueryLocalPersistenceStoreTagsForBackup.nop"),a[1],a[2]).then(function(a){return a=a,d[16]=a[0],a})},function(e){return d[17]=new c.Map(),d[17].set("message_tags",d[16]),d[18]=new c.Map(),d[18].set("mt",d[17]),c.blobs.neq(d[14],void 0)?c.sequence([function(e){return a[3]!==void 0?c.sequence([function(e){return d[23]=a[5].get("mailbox_root_key_v2"),c.blobs.neq(d[23],void 0)?c.sequence([function(e){return d[26]=a[5].get("message_payload_encryption_keys"),d[27]=d[26].get("epoch_root_key"),d[28]=c.createArray(),d[41]=(d[28].push(c.i64.cast([0,32])),d[28]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleV92Mj5zdXBwbGVtZW50YWxfcHJmX2tleQ=="),void 0,d[23],d[28]).then(function(a){return a=a,d[29]=a[0],a})},function(a){return d[29]!==void 0?c.sequence([function(a){return d[41]=c.i64.of_int32(d[29].length),c.i64.ge(d[41],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[29],c.i64.cast([0,0])).then(function(a){return a=a,d[43]=a[0],d[44]=a[1],a})},function(a){return d[42]=d[43]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[44]="CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][MEBCryptoUtils] ","",d[44]].join("")),d[43]=c.createArray(),void 0!==void 0?d[45]=(d[43].push(void 0),d[43]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils",d[44],d[43],c.i64.cast([0,3]))},function(a){return d[42]=void 0}])},function(a){return d[30]=d[42]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[42]="CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][MEBCryptoUtils] ","",d[42]].join("")),d[41]=c.createArray(),void 0!==void 0?d[43]=(d[41].push(void 0),d[41]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils",d[42],d[41],c.i64.cast([0,3]))},function(a){return d[30]=void 0}])},function(a){return c.blobs.neq(d[30],void 0)?d[31]=!0:d[31]=!1,d[31]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),d[32]=c.createArray(),d[41]=(d[32].push(c.i64.cast([0,32])),d[32]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleV92Mj5zdXBwbGVtZW50YWxfZW5jX2tleQ=="),void 0,d[27],d[32]).then(function(a){return a=a,d[33]=a[0],a})},function(a){return d[33]!==void 0?c.sequence([function(a){return d[41]=c.i64.of_int32(d[33].length),c.i64.ge(d[41],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[33],c.i64.cast([0,0])).then(function(a){return a=a,d[43]=a[0],d[44]=a[1],a})},function(a){return d[42]=d[43]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[44]="CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][MEBCryptoUtils] ","",d[44]].join("")),d[43]=c.createArray(),void 0!==void 0?d[45]=(d[43].push(void 0),d[43]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils",d[44],d[43],c.i64.cast([0,3]))},function(a){return d[42]=void 0}])},function(a){return d[34]=d[42]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[42]="CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][MEBCryptoUtils] ","",d[42]].join("")),d[41]=c.createArray(),void 0!==void 0?d[43]=(d[41].push(void 0),d[41]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils",d[42],d[41],c.i64.cast([0,3]))},function(a){return d[34]=void 0}])},function(e){return c.blobs.neq(d[34],void 0)?d[35]=!0:d[35]=!1,d[35]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),c.nativeOperation(b("LSGetBlobFromString.nop"),a[3]).then(function(a){return a=a,d[36]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),d[30],d[36]).then(function(a){return a=a,d[37]=a[0],a})},function(a){return c.nativeOperation(b("LSSymmetricEncryptionCreateEncryptedData.nop"),d[34],c.blob("c3VwcGxlbWVudGFsX2VuY19hYWQ="),d[36]).then(function(a){return a=a,d[38]=a[0],a})},function(e){return c.blobs.neq(d[38],void 0)?c.sequence([function(e){return d[41]=new c.Map(),d[41].set("sk_ciphertext",d[38]),d[41].set("sk_hash",d[37]),d[42]=a[5].get("message_payload_encryption_keys"),d[43]=d[42].get("payload_key"),c.nativeOperation(b("LSSymmetricEncryptionCreateEncryptedData.nop"),d[43],c.blobs.of_string(["message_thread","_",a[1]].join("")),d[14]).then(function(a){return a=a,d[44]=a[0],a})},function(a){return c.blobs.neq(d[44],void 0)?c.sequence([function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[44]).then(function(a){return a=a,d[48]=a[0],a})},function(a){return d[45]=d[48]}]):c.resolve(d[45]=void 0)},function(b){return d[45]!==void 0?(d[18]!==void 0?(d[51]=d[18].get("mt"),d[51]!==void 0?(d[53]=new c.Map(),d[57]="message_tags",d[54]=d[51].get(d[57]),d[54]?d[55]=!1:d[55]=!0,d[55]?0:d[53].set(d[57],d[54]),d[56]=c.toJSON(d[53]),d[52]=d[56]):d[52]=void 0,d[48]=d[52]):d[48]=void 0,d[18]!==void 0?(d[51]=d[18].get("mooos"),d[49]=d[51]):d[49]=void 0,d[50]=new c.Map(),d[50].set("backup_action",a[0]),d[50].set("protobuf_encrypted",d[45]),d[50].set("supplemental_data_encrypted",d[41]),d[50].set("timestamp_ms",a[4]),d[50].set("message_tags",d[48]),d[50].set("serialized_attachment_backup_payload",void 0),d[50].set("maybe_ooo_supplemental_upload",d[49]),b=[d[50],void 0],d[46]=b[0],d[47]=b[1]):(function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_ENCRYPTION_FAILED"),d[48]=new c.Map(),d[48].set("error_code",c.i64.cast([0,62])),d[48].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),d[48].set("error_message",""),b=[void 0,d[48]],d[46]=b[0],d[47]=b[1]),b=[d[46],d[47]],d[39]=b[0],d[40]=b[1]}]):c.resolve((function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error SUPPLEMENTAL_ENCRYPTION_FAILED"),d[41]=new c.Map(),d[41].set("error_code",c.i64.cast([0,66])),d[41].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),d[41].set("error_message",""),e=[void 0,d[41]],d[39]=e[0],d[40]=e[1]))},function(a){return a=[d[39],d[40]],d[24]=a[0],d[25]=a[1],a}]):c.resolve((function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error NULL_MAILBOX_ROOT_KEY_V2"),d[26]=new c.Map(),d[26].set("error_code",c.i64.cast([0,27])),d[26].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),d[26].set("error_message",""),e=[void 0,d[26]],d[24]=e[0],d[25]=e[1]))},function(a){return a=[d[24],d[25]],d[21]=a[0],d[22]=a[1],a}]):c.resolve((function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error SUPPLEMENTAL_KEY_NOT_SET_IN_CONTEXT_TABLE"),d[23]=new c.Map(),d[23].set("error_code",c.i64.cast([0,65])),d[23].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),d[23].set("error_message",""),e=[void 0,d[23]],d[21]=e[0],d[22]=e[1]))},function(a){return a=[d[21],d[22]],d[19]=a[0],d[20]=a[1],a}]):c.resolve((function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_NOT_FOUND_IN_SUPPLEMENTAL_TABLE"),d[21]=new c.Map(),d[21].set("error_code",c.i64.cast([0,64])),d[21].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),d[21].set("error_message",""),e=[void 0,d[21]],d[19]=e[0],d[20]=e[1]))},function(a){return a=[d[19],d[20]],d[12]=a[0],d[13]=a[1],a}]):c.resolve((function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error SUPPLEMENTAL_KEY_NOT_SET_IN_CONTEXT_TABLE"),d[14]=new c.Map(),d[14].set("error_code",c.i64.cast([0,65])),d[14].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),d[14].set("error_message",""),e=[void 0,d[14]],d[12]=e[0],d[13]=e[1]))},function(a){return a=[d[12],d[13]],d[10]=a[0],d[11]=a[1],a}]):c.sequence([function(e){return c.i64.eq(a[0],c.i64.cast([0,4]))?c.sequence([function(e){return c.nativeOperation(b("LSQueryLocalPersistenceStoreForBackup.nop"),a[1],a[2]).then(function(a){return a=a,d[14]=a[0],d[15]=a[1],d[16]=a[2],a})},function(e){return c.nativeOperation(b("LSQueryLocalPersistenceStoreTagsForBackup.nop"),a[1],a[2]).then(function(a){return a=a,d[17]=a[0],a})},function(e){return d[18]=new c.Map(),d[18].set("message_tags",d[17]),d[19]=new c.Map(),d[19].set("mt",d[18]),c.blobs.neq(d[14],void 0)?c.sequence([function(e){return d[22]=a[5].get("message_payload_encryption_keys"),d[23]=d[22].get("payload_key"),c.nativeOperation(b("LSSymmetricEncryptionCreateEncryptedData.nop"),d[23],c.blobs.of_string(["message_thread","_",a[1]].join("")),d[14]).then(function(a){return a=a,d[24]=a[0],a})},function(a){return c.blobs.neq(d[24],void 0)?c.sequence([function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[24]).then(function(a){return a=a,d[28]=a[0],a})},function(a){return d[25]=d[28]}]):c.resolve(d[25]=void 0)},function(b){return d[25]!==void 0?(d[19]!==void 0?(d[31]=d[19].get("mt"),d[31]!==void 0?(d[33]=new c.Map(),d[37]="message_tags",d[34]=d[31].get(d[37]),d[34]?d[35]=!1:d[35]=!0,d[35]?0:d[33].set(d[37],d[34]),d[36]=c.toJSON(d[33]),d[32]=d[36]):d[32]=void 0,d[28]=d[32]):d[28]=void 0,d[19]!==void 0?(d[31]=d[19].get("mooos"),d[29]=d[31]):d[29]=void 0,d[30]=new c.Map(),d[30].set("backup_action",a[0]),d[30].set("protobuf_encrypted",d[25]),d[30].set("supplemental_data_encrypted",void 0),d[30].set("timestamp_ms",a[4]),d[30].set("message_tags",d[28]),d[30].set("serialized_attachment_backup_payload",void 0),d[30].set("maybe_ooo_supplemental_upload",d[29]),b=[d[30],void 0],d[26]=b[0],d[27]=b[1]):(function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_ENCRYPTION_FAILED"),d[28]=new c.Map(),d[28].set("error_code",c.i64.cast([0,62])),d[28].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),d[28].set("error_message",""),b=[void 0,d[28]],d[26]=b[0],d[27]=b[1]),b=[d[26],d[27]],d[20]=b[0],d[21]=b[1]}]):c.resolve((d[16]?(function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_ALREADY_DELETED"),d[24]=new c.Map(),d[24].set("error_code",c.i64.cast([0,70])),d[24].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),d[24].set("error_message",""),e=[void 0,d[24]],d[22]=e[0],d[23]=e[1]):(function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error PROTOBUF_NOT_FOUND_IN_TOPLEVEL_TABLE"),d[24]=new c.Map(),d[24].set("error_code",c.i64.cast([0,63])),d[24].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),d[24].set("error_message",""),e=[void 0,d[24]],d[22]=e[0],d[23]=e[1]),e=[d[22],d[23]],d[20]=e[0],d[21]=e[1]))},function(a){return a=[d[20],d[21]],d[12]=a[0],d[13]=a[1],a}]):c.resolve((c.i64.eq(a[0],c.i64.cast([0,3]))?(void 0!==void 0?(d[19]=(void 0).get("mt"),d[19]!==void 0?(d[21]=new c.Map(),d[25]="message_tags",d[22]=d[19].get(d[25]),d[22]?d[23]=!1:d[23]=!0,d[23]?0:d[21].set(d[25],d[22]),d[24]=c.toJSON(d[21]),d[20]=d[24]):d[20]=void 0,d[16]=d[20]):d[16]=void 0,void 0!==void 0?(d[19]=(void 0).get("mooos"),d[17]=d[19]):d[17]=void 0,d[18]=new c.Map(),d[18].set("backup_action",a[0]),d[18].set("protobuf_encrypted",void 0),d[18].set("supplemental_data_encrypted",void 0),d[18].set("timestamp_ms",a[4]),d[18].set("message_tags",d[16]),d[18].set("serialized_attachment_backup_payload",void 0),d[18].set("maybe_ooo_supplemental_upload",d[17]),e=[d[18],void 0],d[14]=e[0],d[15]=e[1]):(function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure] Returning error UNKNOWN_PROTOBUF_TYPE"),d[16]=new c.Map(),d[16].set("error_code",c.i64.cast([0,60])),d[16].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure"),d[16].set("error_message",""),e=[void 0,d[16]],d[14]=e[0],d[15]=e[1]),e=[d[14],d[15]],d[12]=e[0],d[13]=e[1]))},function(a){return a=[d[12],d[13]],d[10]=a[0],d[11]=a[1],a}])},function(a){return a=[d[10],d[11]],d[2]=a[0],d[3]=a[1],a}])},function(a){return d[4]=c.i64.of_float(Date.now()),d[5]=c.i64.random(),d[7]="Finishing execution. Execution time: ",d[8]=c.i64.to_string(c.i64.sub(d[4],d[0])),d[9]=" ms",d[6]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][loadAndEncryptProtobufWithInputsV2] ",d[6],d[7],d[6],d[8],d[6],d[9]].join("")),c.i64.eq(c.i64.mod_(d[5],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[10]=",",d[11]=c.createArray(),void 0!==void 0?d[12]=(d[11].push(void 0),d[11]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"loadAndEncryptProtobufWithInputsV2",[d[7],d[10],d[8],d[10],d[9]].join(""),d[11],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[2],d[3]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsLoadAndEncryptProtobufWithInputsV2StoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSLoadAndEncryptProtobufV2",["LSLoadAndEncryptProtobufWithInputsV2","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][loadAndEncryptProtobufV2] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.filter(c.db.table(305).fetch(),function(b){return c.i64.eq(b.pendingBackupTaskId,a[0])}).next().then(function(e,f){var g=e.done;e=e.value;return g?(function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsLoadAndEncryptProtobufV2StoredProcedure] Returning error PROTOBUF_CONTEXT_ROW_NOT_FOUND"),d[11]=new c.Map(),d[11].set("error_code",c.i64.cast([0,67])),d[11].set("stored_procedure","LSEncryptedBackupsLoadAndEncryptProtobufV2StoredProcedure"),d[11].set("error_message",""),g=[void 0,d[11]],d[2]=g[0],d[3]=g[1]):(f=e.item,c.sequence([function(e){return c.storedProcedure(b("LSLoadAndEncryptProtobufWithInputsV2"),f.backupAction,a[2],f.toplevelOfflineThreadingId,f.supplementalKey,f.messageTimestampMs,a[1]).then(function(a){return a=a,d[11]=a[0],d[12]=a[1],a})},function(a){return a=[d[11],d[12]],d[2]=a[0],d[3]=a[1],a}]))})},function(a){return d[5]=c.i64.of_float(Date.now()),d[6]=c.i64.random(),d[8]="Finishing execution. Execution time: ",d[9]=c.i64.to_string(c.i64.sub(d[5],d[0])),d[10]=" ms",d[7]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][loadAndEncryptProtobufV2] ",d[7],d[8],d[7],d[9],d[7],d[10]].join("")),c.i64.eq(c.i64.mod_(d[6],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[11]=",",d[12]=c.createArray(),void 0!==void 0?d[13]=(d[12].push(void 0),d[12]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"loadAndEncryptProtobufV2",[d[8],d[11],d[9],d[11],d[10]].join(""),d[12],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[2],d[3]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsLoadAndEncryptProtobufV2StoredProcedure";a.__tables__=["pending_protobuf_backups_context"];e.exports=a}),null);
__d("LSSerializeBackupPayloadV2",["LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDerivedKeys.nop","LSDeriveValueSecretRefV2","LSEncryptIdentifiersV2","LSEncryptMessagePayloadV2","LSGetBlobFromString.nop","LSGetLatestEpochKeys","LSIsEncryptionVersionSecure","LSLoadAndEncryptProtobufV2","LSLogMebClientEvent.nop","LSLogWebQpl.nop","LSQplAnnotateBool.nop","LSQplAnnotateString.nop","LSQplMarkEnd.nop","LSQplMarkPoint.nop","LSQplStartTrace.nop","gkx"],(function(a,b,c,d,e,f,g){function a(){var a=arguments,d=a[a.length-1],e=[],f=[];return d.sequence([function(g){return d.sequence([function(b){return e[0]=d.i64.of_float(Date.now()),function(a){d.logger(a).info(a)}("[EncryptedBackups][serializeBackupPayloadV2] Beginning execution."),e[1]=d.i64.of_float(Date.now()),e[19]=d.i64.mul(e[1],d.i64.cast([0,1e6])),e[2]=d.i64.random(),e[6]=d.i64.to_string(e[2]),d.db.table(2).fetch([[[a[0]]]]).next().then(function(a,b){var c=a.done;a=a.value;return c?e[3]=void 0:(b=a.item,e[3]=b.dataTraceId)})},function(a){return e[3]!==void 0?e[5]=e[3]:e[5]=void 0,e[6]!==void 0?d.nativeOperation(b("LSQplStartTrace.nop"),d.i64.cast([0,637746317]),e[6],!0,e[5]):d.resolve()},function(a){return e[6]!==void 0?d.nativeOperation(b("LSQplMarkPoint.nop"),d.i64.cast([0,637746317]),e[6],"LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure_start"):d.resolve()},function(a){return d.islc(d.filter(d.db.table(168).fetch(),function(a){return d.i64.eq(a.authorityLevel,d.i64.cast([0,80]))||!1}),0,d.i64.to_float(d.i64.cast([0,1]))).next().then(function(a,b){var c=a.done;a=a.value;return c?(e[23]=new d.Map(),e[23].set("error_msg","Expected a nonempty query result"),e[23].set("code",d.i64.cast([0,3])),e[23].set("src_line","MEBClientStateUtils.php:256 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),e[24]=d.createArray(),e[25]=(e[24].push(e[23]),e[24]),c=[void 0,e[24]],e[7]=c[0],e[8]=c[1]):(b=a.item,e[23]=new d.Map(),e[23].set("backup_id",b.backupId),e[23].set("device_public_key_blob",b.devicePublicKeyBlob),e[23].set("device_private_key_blob",b.devicePrivateKeyBlob),e[23].set("epoch_storage_public_key_blob",b.epochStoragePublicKeyBlob),e[23].set("epoch_storage_private_key_blob",b.epochStoragePrivateKeyBlob),e[23].set("epoch_auth_public_key_blob",b.epochAuthPublicKeyBlob),e[23].set("epoch_auth_private_key_blob",b.epochAuthPrivateKeyBlob),e[23].set("mailbox_root_key_blob",b.mailboxRootKeyBlob),e[23].set("ocmf_client_state_blob",b.ocmfClientStateBlob),e[23].set("orf_client_state_v2_blob",void 0),e[23].set("orf_v2_authority_level",void 0),e[23].set("oblivious_validation_token_blob",b.obliviousValidationTokenBlob),e[23].set("device_id",b.deviceId),e[23].set("backup_tenancy",b.backupTenancy),e[23].set("encryption_version",b.encryptionVersion),e[23].set("revision_version",b.revisionVersion),e[23].set("initialize_restore_result",void 0),e[23].set("device_creation_timestamp_sec",void 0),e[23].set("authority_level",b.authorityLevel),c=[e[23],void 0],e[7]=c[0],e[8]=c[1])})},function(f){return e[10]=new d.Map(),e[10].set("value",e[7]),e[10].set("errors",e[8]),e[11]=e[10].get("value"),e[11]!==void 0?d.sequence([function(f){return e[23]=e[11].get("backup_id"),e[24]=e[11].get("device_public_key_blob"),e[25]=e[11].get("device_private_key_blob"),e[26]=e[11].get("epoch_storage_public_key_blob"),e[27]=e[11].get("epoch_storage_private_key_blob"),e[28]=e[11].get("epoch_auth_public_key_blob"),e[29]=e[11].get("epoch_auth_private_key_blob"),e[30]=e[11].get("mailbox_root_key_blob"),e[31]=e[11].get("ocmf_client_state_blob"),e[32]=e[11].get("orf_client_state_v2_blob"),e[33]=e[11].get("orf_v2_authority_level"),e[34]=e[11].get("oblivious_validation_token_blob"),e[35]=e[11].get("device_id"),e[36]=e[11].get("backup_tenancy"),e[37]=e[11].get("encryption_version"),e[38]=e[11].get("revision_version"),e[39]=e[11].get("initialize_restore_result"),e[40]=e[11].get("device_creation_timestamp_sec"),e[41]=e[11].get("authority_level"),d.i64.neq(e[35],void 0)?d.sequence([function(a){return e[46]=void 0,d.i64.neq(e[46],void 0)?d.resolve(e[47]=e[46]):d.sequence([function(a){return e[55]=d.createArray(),d.storedProcedure(b("LSIsEncryptionVersionSecure"),d.i64.cast([0,0])).then(function(a){return a=a,e[56]=a[0],a})},function(a){return e[56]?e[65]=(e[55].push(d.i64.cast([0,0])),e[55]):0,d.storedProcedure(b("LSIsEncryptionVersionSecure"),d.i64.cast([0,2])).then(function(a){return a=a,e[57]=a[0],a})},function(a){return e[57]?e[65]=(e[55].push(d.i64.cast([0,2])),e[55]):0,d.storedProcedure(b("LSIsEncryptionVersionSecure"),d.i64.cast([0,3])).then(function(a){return a=a,e[58]=a[0],a})},function(a){return e[58]?e[65]=(e[55].push(d.i64.cast([0,3])),e[55]):0,d.storedProcedure(b("LSIsEncryptionVersionSecure"),d.i64.cast([0,4])).then(function(a){return a=a,e[59]=a[0],a})},function(a){return e[59]?e[65]=(e[55].push(d.i64.cast([0,4])),e[55]):0,e[60]=d.createArray(),e[61]=d.i64.of_int32(e[55].length),d.i64.gt(e[61],d.i64.cast([0,0]))?d.loopAsync(e[61],function(a){return e[65]=a,d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[55],e[65]).then(function(a){return a=a,e[66]=a[0],e[67]=a[1],a})},function(a){return e[68]=(e[60].push(e[66]),e[60])}])}):d.resolve()},function(a){return d.sequence([function(a){return e[65]=d.createArray(),e[66]=d.i64.of_int32(e[60].length),d.i64.gt(e[66],d.i64.cast([0,0]))?d.loopAsync(e[66],function(a){return e[68]=a,d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[60],e[68]).then(function(a){return a=a,e[69]=a[0],e[70]=a[1],a})},function(a){return e[71]=(e[65].push(d.i64.to_string(e[69])),e[65])}])}):d.resolve()},function(a){return e[67]=e[65].join(","),e[62]=e[67]}])},function(a){return e[60].some(function(a){return d.i64.eq(e[37],a)})?e[63]=e[37]:e[63]=void 0,d.i64.neq(e[63],void 0)?e[64]=e[63]:e[64]=void 0,e[47]=e[64]}])},function(f){return d.i64.neq(e[47],void 0)?e[48]=e[47]:e[48]=d.i64.cast([0,0]),d.i64.neq(e[36],void 0)?e[49]=e[36]:e[49]=d.i64.cast([0,1]),d.db.table(177).fetch([[[a[0]]],"fk_pending_tasks"]).next().then(function(f,g){var h=f.done;f=f.value;return h?d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[67]=d.i64.of_float(Date.now()),b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[67],d.i64.cast([0,1e6])),e[19]),void 0],e[55]=b[0],e[56]=b[1],e[57]=b[2],e[58]=b[3],e[59]=b[4],e[60]=b[5],e[61]=b[6]):(f=c.item,e[67]=d.i64.of_float(Date.now()),b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[67],d.i64.cast([0,1e6])),e[19]),void 0],e[55]=b[0],e[56]=b[1],e[57]=b[2],e[58]=b[3],e[59]=b[4],e[60]=b[5],e[61]=b[6])})},function(a){return e[63]=new d.Map(),e[63].set("task_id",e[55]),e[63].set("queue_name",e[56]),e[63].set("enqueue_timestamp_ms",e[57]),e[63].set("priority",e[58]),e[63].set("first_executed_timestamp_ms",e[59]),e[63].set("execution_time_ns",e[60]),e[63].set("echo_encoding_execution_time_ns",e[61]),e[64]=new d.Map(),e[64].set("task_metadata",e[63]),e[64].set("action_type",void 0),e[64].set("content_type",void 0),e[64].set("identifiers",void 0),e[64].set("identifiers_v2",void 0),e[64].set("task_creation_source",void 0),e[64].set("message_payload_source",d.i64.cast([0,2])),e[65]=new d.Map(),e[65].set("error_code",d.i64.cast([0,5])),e[65].set("stored_procedure","LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure"),e[65].set("error_message","Pending backup context row not found"),e[65]!==void 0?(e[67]=e[65].get("stored_procedure"),e[68]=e[65].get("error_code"),e[69]=e[65].get("error_message"),e[70]=".",e[71]=[e[67],e[70],d.i64.to_string(e[68]),e[70],e[69]].join(""),e[6]!==void 0?e[71]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"exception_error",e[71]):d.resolve():d.resolve()):d.resolve()},function(a){return void 0!==void 0?(e[67]=(void 0).get("stored_procedure"),e[68]=(void 0).get("error_code"),e[69]=(void 0).get("error_message"),e[70]=".",e[71]=[e[67],e[70],d.i64.to_string(e[68]),e[70],e[69]].join(""),e[6]!==void 0?e[71]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"exception_error",e[71]):d.resolve():d.resolve()):d.resolve()},function(a){return e[6]!==void 0?d.nativeOperation(b("LSQplMarkEnd.nop"),d.i64.cast([0,637746317]),e[6],!1):d.resolve()},function(a){return e[66]=d.createArray(),a=[void 0,e[65],e[64],e[66]],e[50]=a[0],e[51]=a[1],e[52]=a[2],e[53]=a[3]}]):(g=f.item,d.sequence([function(b){return e[62]=g.actionType,e[63]=g.contentType,e[68]=g.echoContent,e[69]=g.lsTraceId,e[67]=g.echoEncodingLatencyNs,e[66]=g.attachmentPayload,e[70]=g.tamThreadSubtype,e[71]=g.isInstamadillo,e[55]=new d.Map(),e[55].set("backup_id",d.i64.to_string(e[23])),e[55].set("act_thread_id",g.listKey),e[55].set("timestamp",g.sortKey),e[55].set("otid",g.uniqueKey),d.filter(d.db.table(305).fetch(),function(b){return d.i64.eq(b.pendingBackupTaskId,a[0])}).next().then(function(a,b){b=a.done;a=a.value;return b?e[56]=!1:(a.item,e[56]=!0)})},function(a){return e[65]=d.i64.eq(void 0,void 0),e[6]!==void 0?d.nativeOperation(b("LSQplAnnotateBool.nop"),d.i64.cast([0,637746317]),e[6],"should_run_device_timestamp_sync",e[65]):d.resolve()},function(f){return e[64]=g.error==null?d.i64.cast([0,0]):g.error,[d.i64.cast([0,0]),d.i64.cast([0,32])].some(function(a){return d.i64.eq(e[64],a)})?d.sequence([function(a){return e[72]=e[55].get("act_thread_id"),e[73]=e[55].get("otid"),d.storedProcedure(b("LSGetLatestEpochKeys"),!1).then(function(a){return a=a,e[74]=a[0],e[75]=a[1],a})},function(a){return e[74]!==void 0?d.sequence([function(a){return d.i64.eq(e[63],d.i64.cast([0,1]))?d.sequence([function(a){return e[85]=d.createArray(),e[90]=(e[85].push(d.i64.cast([0,32])),e[85]),d.nativeOperation(b("LSGetBlobFromString.nop"),["thread_ope_key","_",e[72]].join("")).then(function(a){return a=a,e[86]=a[0],a})},function(a){return d.nativeOperation(b("LSCreateDerivedKeys.nop"),e[86],void 0,e[30],e[85]).then(function(a){return a=a,e[87]=a[0],a})},function(a){return e[87]?e[88]=!1:e[88]=!0,e[88]?d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] Got null keys while deriving message list OPE key. Returning null blobish"),e[91]="Got null keys while deriving message list OPE key. Returning null blobish",function(a){d.logger(a).mustfix(a)}(["[EncryptedBackups][MEBCryptoUtils] ","",e[91]].join("")),e[90]=d.createArray(),void 0!==void 0?e[92]=(e[90].push(void 0),e[90]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils",e[91],e[90],d.i64.cast([0,3]))},function(a){return e[89]=void 0}]):d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[87],d.i64.cast([0,0])).then(function(a){return a=a,e[90]=a[0],e[91]=a[1],a})},function(a){return e[89]=e[90]}])},function(a){return e[82]=e[89]}]):d.sequence([function(a){return d.i64.eq(e[62],d.i64.cast([0,2]))?d.sequence([function(a){return e[86]=d.createArray(),e[91]=(e[86].push(d.i64.cast([0,32])),e[86]),d.nativeOperation(b("LSGetBlobFromString.nop"),["thread_ope_key","_",e[73]].join("")).then(function(a){return a=a,e[87]=a[0],a})},function(a){return d.nativeOperation(b("LSCreateDerivedKeys.nop"),e[87],void 0,e[30],e[86]).then(function(a){return a=a,e[88]=a[0],a})},function(a){return e[88]?e[89]=!1:e[89]=!0,e[89]?d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] Got null keys while deriving message list OPE key. Returning null blobish"),e[92]="Got null keys while deriving message list OPE key. Returning null blobish",function(a){d.logger(a).mustfix(a)}(["[EncryptedBackups][MEBCryptoUtils] ","",e[92]].join("")),e[91]=d.createArray(),void 0!==void 0?e[93]=(e[91].push(void 0),e[91]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils",e[92],e[91],d.i64.cast([0,3]))},function(a){return e[90]=void 0}]):d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[88],d.i64.cast([0,0])).then(function(a){return a=a,e[91]=a[0],e[92]=a[1],a})},function(a){return e[90]=e[91]}])},function(a){return e[85]=e[90]}]):d.resolve(e[85]=void 0)},function(a){return e[82]=e[85]}])},function(a){return d.blobs.neq(e[82],void 0)?d.sequence([function(a){return e[85]=e[74].get("epoch_keys"),e[86]=e[85].get("epoch_anon_id"),e[87]=e[85].get("epoch_root_key"),e[88]=d.createArray(),e[103]=(e[88].push(d.i64.cast([0,32])),e[88]),d.i64.ge(e[48],d.i64.cast([0,3]))?d.resolve(e[89]=void 0):d.sequence([function(a){return d.nativeOperation(b("LSGetBlobFromString.nop"),e[72]).then(function(a){return a=a,e[103]=a[0],a})},function(a){return e[89]=e[103]}])},function(a){return d.i64.ge(e[48],d.i64.cast([0,4]))?(e[103]="_",e[90]=["message_key_in_epoch",e[103],d.blobs.to_string(e[86]),e[103],"cipher_version",e[103],d.i64.to_string(e[48]),e[103],"thread",e[103],e[72]==null?"":e[72]].join("")):(d.i64.ge(e[48],d.i64.cast([0,3]))?(e[104]="_",e[103]=["message_key_in_epoch",e[104],d.blobs.to_string(e[86]),e[104],"cipher_version",e[104],d.i64.to_string(e[48]),e[104],"thread",e[104],e[72]==null?"":e[72]].join("")):(d.i64.ge(e[48],d.i64.cast([0,2]))?(e[105]="_",e[104]=["message_key_in_epoch",e[105],d.blobs.to_string(e[86]),e[105],"cipher_version",e[105],d.i64.to_string(e[48])].join("")):e[104]=["message_key_in_epoch","_",d.blobs.to_string(e[86])].join(""),e[103]=e[104]),e[90]=e[103]),d.nativeOperation(b("LSGetBlobFromString.nop"),e[90]).then(function(a){return a=a,e[91]=a[0],a})},function(a){return d.nativeOperation(b("LSCreateDerivedKeys.nop"),e[91],e[89],e[87],e[88]).then(function(a){return a=a,e[92]=a[0],a})},function(a){return e[92]?e[93]=!1:e[93]=!0,e[93]?d.resolve(e[94]=void 0):d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[92],d.i64.cast([0,0])).then(function(a){return a=a,e[103]=a[0],e[104]=a[1],a})},function(a){return e[94]=e[103]}])},function(a){return d.filter(d.db.table(169).fetch(),function(a){return d.blobs.eq(a.epochAnonIdBlob,d.blob("MA=="))}).next().then(function(b,c){var a=b.done;b=b.value;return a?(e[103]=new d.Map(),e[103].set("error_msg","Expected a nonempty query result"),e[103].set("code",d.i64.cast([0,3])),e[103].set("src_line","MEBEpochClientUtils.php:556 MEBEpochClientUtils::maybeEpochWithAnonIDFromPersistentEpochsTableDirectly()"),e[104]=d.createArray(),e[105]=(e[104].push(e[103]),e[104]),a=[void 0,e[104]],e[95]=a[0],e[96]=a[1]):(c=b.item,e[103]=new d.Map(),e[103].set("epoch_id",c.epochId),e[103].set("backup_id",c.backupId),e[103].set("epoch_anon_id_blob",c.epochAnonIdBlob),e[103].set("epoch_root_key_blob",c.epochRootKeyBlob),e[103].set("epoch_status",c.epochStatus),e[103].set("epoch_head",c.epochHead),e[103].set("authority_level",c.authorityLevel),a=[e[103],void 0],e[95]=a[0],e[96]=a[1])})},function(a){return e[98]=new d.Map(),e[98].set("value",e[95]),e[98].set("errors",e[96]),e[99]=e[98].get("value"),e[99]!==void 0?d.sequence([function(a){return e[103]=e[99].get("epoch_id"),e[104]=e[99].get("backup_id"),e[105]=e[99].get("epoch_anon_id_blob"),e[106]=e[99].get("epoch_root_key_blob"),e[107]=e[99].get("epoch_status"),e[108]=e[99].get("epoch_head"),e[109]=e[99].get("authority_level"),e[110]=d.createArray(),e[118]=(e[110].push(d.i64.cast([0,32])),e[110]),d.nativeOperation(b("LSCreateDerivedKeys.nop"),d.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleT5zYWx0X21haWxib3hfcm9vdF9rZXlfdjI="),void 0,e[30],e[110]).then(function(a){return a=a,e[111]=a[0],a})},function(a){return e[111]!==void 0?d.sequence([function(a){return e[118]=d.i64.of_int32(e[111].length),d.i64.ge(e[118],d.i64.cast([0,1]))?d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[111],d.i64.cast([0,0])).then(function(a){return a=a,e[120]=a[0],e[121]=a[1],a})},function(a){return e[119]=e[120]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),e[121]="CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",function(a){d.logger(a).mustfix(a)}(["[EncryptedBackups][MEBCryptoUtils] ","",e[121]].join("")),e[120]=d.createArray(),void 0!==void 0?e[122]=(e[120].push(void 0),e[120]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils",e[121],e[120],d.i64.cast([0,3]))},function(a){return e[119]=void 0}])},function(a){return e[112]=e[119]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),e[119]="CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",function(a){d.logger(a).mustfix(a)}(["[EncryptedBackups][MEBCryptoUtils] ","",e[119]].join("")),e[118]=d.createArray(),void 0!==void 0?e[120]=(e[118].push(void 0),e[118]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils",e[119],e[118],d.i64.cast([0,3]))},function(a){return e[112]=void 0}])},function(a){return d.blobs.neq(e[112],void 0)?e[113]=!0:e[113]=!1,e[113]?0:(function(a){d.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),d["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),e[114]=d.createArray(),e[118]=(e[114].push(d.i64.cast([0,32])),e[114]),d.nativeOperation(b("LSCreateDerivedKeys.nop"),d.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleT5tYWlsYm94X3Jvb3Rfa2V5X3Yy"),e[112],e[106],e[114]).then(function(a){return a=a,e[115]=a[0],a})},function(a){return e[115]!==void 0?d.sequence([function(a){return e[118]=d.i64.of_int32(e[115].length),d.i64.ge(e[118],d.i64.cast([0,1]))?d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[115],d.i64.cast([0,0])).then(function(a){return a=a,e[120]=a[0],e[121]=a[1],a})},function(a){return e[119]=e[120]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),e[121]="CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",function(a){d.logger(a).mustfix(a)}(["[EncryptedBackups][MEBCryptoUtils] ","",e[121]].join("")),e[120]=d.createArray(),void 0!==void 0?e[122]=(e[120].push(void 0),e[120]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils",e[121],e[120],d.i64.cast([0,3]))},function(a){return e[119]=void 0}])},function(a){return e[116]=e[119]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),e[119]="CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",function(a){d.logger(a).mustfix(a)}(["[EncryptedBackups][MEBCryptoUtils] ","",e[119]].join("")),e[118]=d.createArray(),void 0!==void 0?e[120]=(e[118].push(void 0),e[118]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils",e[119],e[118],d.i64.cast([0,3]))},function(a){return e[116]=void 0}])},function(a){return d.blobs.neq(e[116],void 0)?e[117]=!0:e[117]=!1,e[117]?0:(function(a){d.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),d["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),e[100]=e[116]}]):d.sequence([function(a){return e[103]=e[98].get("errors"),e[104]=e[98].get("errors"),function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBEpochClientUtils] Failed to get mailbox_root_key_v2: epoch 0 is not available."),e[106]="Failed to get mailbox_root_key_v2: epoch 0 is not available.",function(a){d.logger(a).mustfix(a)}(["[EncryptedBackups][MEBEpochClientUtils] ","",e[106]].join("")),e[105]=d.createArray(),void 0!==void 0?e[107]=(e[105].push(void 0),e[105]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBEpochClientUtils",e[106],e[105],d.i64.cast([0,3]))},function(a){return e[100]=void 0}])},function(a){return d.blobs.neq(e[94],void 0)?d.sequence([function(a){return d.blobs.neq(e[100],void 0)?d.sequence([function(a){return e[109]=d.createArray(),e[113]=(e[109].push(d.i64.cast([0,32])),e[109]),d.nativeOperation(b("LSCreateDerivedKeys.nop"),d.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleV92Mj5mYWxsYmFja19rZXk="),void 0,e[100],e[109]).then(function(a){return a=a,e[110]=a[0],a})},function(a){return e[110]!==void 0?d.sequence([function(a){return e[113]=d.i64.of_int32(e[110].length),d.i64.ge(e[113],d.i64.cast([0,1]))?d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[110],d.i64.cast([0,0])).then(function(a){return a=a,e[115]=a[0],e[116]=a[1],a})},function(a){return e[114]=e[115]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),e[116]="CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",function(a){d.logger(a).mustfix(a)}(["[EncryptedBackups][MEBCryptoUtils] ","",e[116]].join("")),e[115]=d.createArray(),void 0!==void 0?e[117]=(e[115].push(void 0),e[115]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils",e[116],e[115],d.i64.cast([0,3]))},function(a){return e[114]=void 0}])},function(a){return e[111]=e[114]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),e[114]="CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",function(a){d.logger(a).mustfix(a)}(["[EncryptedBackups][MEBCryptoUtils] ","",e[114]].join("")),e[113]=d.createArray(),void 0!==void 0?e[115]=(e[113].push(void 0),e[113]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils",e[114],e[113],d.i64.cast([0,3]))},function(a){return e[111]=void 0}])},function(a){return d.blobs.neq(e[111],void 0)?e[112]=!0:e[112]=!1,e[112]?0:(function(a){d.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),d["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),e[103]=e[111]}]):d.resolve(e[103]=void 0)},function(a){return e[104]=e[85].get("epoch_root_key"),e[105]=e[85].get("epoch_anon_id"),e[106]=e[85].get("epoch_id"),e[107]=new d.Map(),e[107].set("payload_key",e[94]),e[107].set("payload_fallback_key",e[103]),e[107].set("encryption_version",e[48]),e[107].set("epoch_root_key",e[104]),e[107].set("epoch_anon_id",e[105]),e[107].set("epoch_id",e[106]),e[108]=new d.Map(),e[108].set("ope_key",e[82]),e[108].set("message_payload_encryption_keys",e[107]),e[108].set("ocmf_shared_key",e[31]),e[108].set("mailbox_base_salt",e[30]),e[108].set("mailbox_root_key_v2",e[100]),a=[e[108],void 0],e[101]=a[0],e[102]=a[1]}]):d.resolve((e[103]=new d.Map(),e[103].set("error_code",d.i64.cast([0,26])),e[103].set("stored_procedure","MEBKeyDeriver"),e[103].set("error_message",""),a=[void 0,e[103]],e[101]=a[0],e[102]=a[1]))},function(a){return a=[e[101],e[102]],e[83]=a[0],e[84]=a[1],a}]):d.resolve((e[85]=new d.Map(),e[85].set("error_code",d.i64.cast([0,25])),e[85].set("stored_procedure","MEBKeyDeriver"),e[85].set("error_message",""),a=[void 0,e[85]],e[83]=a[0],e[84]=a[1]))},function(a){return a=[e[83],e[84]],e[76]=a[0],e[77]=a[1],a}]):d.resolve((a=[void 0,e[75]],e[76]=a[0],e[77]=a[1],a))},function(f){return e[76]!==void 0?d.sequence([function(a){return e[82]=e[55].get("backup_id"),e[83]=e[55].get("act_thread_id"),e[84]=e[55].get("timestamp"),e[85]=e[55].get("otid"),d.storedProcedure(b("LSEncryptIdentifiersV2"),e[62],e[63],e[82],e[83],d.i64.from_string(e[84]),e[85],e[76]).then(function(a){return a=a,e[86]=a[0],e[87]=a[1],a})},function(f){return e[86]!==void 0?d.sequence([function(c){return e[92]=e[55].get("act_thread_id"),d.storedProcedure(b("LSLoadAndEncryptProtobufV2"),a[0],e[76],e[92]).then(function(a){return a=a,e[93]=a[0],e[94]=a[1],a})},function(f){return e[99]=d.i64.eq(e[64],d.i64.cast([0,32]))||!1||c("gkx")("12541")||!1,e[100]=e[93]!==void 0,e[99]&&e[100]?d.sequence([function(a){return e[101]=e[55].get("act_thread_id"),e[102]=e[55].get("backup_id"),d.storedProcedure(b("LSDeriveValueSecretRefV2"),e[101],e[102],e[76]).then(function(a){return a=a,e[103]=a[0],e[104]=a[1],a})},function(c){return e[93]!==void 0?d.sequence([function(c){return e[103]!==void 0?d.sequence([function(a){return e[113]=e[103].get("value_secret_ref"),e[114]=e[86].get("act_thread_id_ocmf_partial"),e[115]=e[86].get("otid_ocmf_partial"),e[116]=e[86].get("timestamp_encrypted"),e[117]=new d.Map(),e[117].set("list_key",e[114]),e[117].set("unique_key",e[115]),e[117].set("sort_key",e[116]),void 0!==void 0?(e[151]=(void 0).get("encrypted_message_payload"),e[152]=(void 0).get("value_secret_ref"),e[153]=new d.Map(),e[153].set("value",e[151]),e[153].set("value_secret_ref",e[152]),e[118]=e[153]):e[118]=void 0,e[119]=new d.Map(),e[119].set("list_item_id",e[117]),e[119].set("list_item",e[118]),e[119].set("action_type",e[62]),e[120]=e[55].get("timestamp"),e[121]=e[55].get("otid"),e[122]=e[55].get("act_thread_id"),e[123]=e[55].get("supplemental_otid"),e[124]=e[55].get("deletion_otid"),e[125]=new d.Map(),e[125].set("timestamp",e[120]),e[125].set("otid",e[121]),e[125].set("wa_thread_id",d.i64.from_string(e[122])),e[125].set("supplemental_otid",e[123]),e[125].set("deletion_otid",e[124]),e[126]=e[76].get("mailbox_base_salt"),d.nativeOperation(b("LSBase64Encode.nop"),e[126]).then(function(a){return a=a,e[127]=a[0],a})},function(a){return e[128]=e[76].get("ocmf_shared_key"),d.nativeOperation(b("LSBase64Encode.nop"),e[128]).then(function(a){return a=a,e[129]=a[0],a})},function(a){return e[130]=new d.Map(),e[130].set("mailbox_root_key",e[127]==null?"":e[127]),e[130].set("ocmf_client_state_blob",e[129]==null?"":e[129]),e[131]=e[86].get("backup_id_ocmf_partial"),e[132]=e[76].get("message_payload_encryption_keys"),e[133]=e[132].get("epoch_id"),e[134]=e[76].get("message_payload_encryption_keys"),e[135]=e[134].get("encryption_version"),e[150]=e[69]==null?"":e[69],e[136]=new d.Map(),e[136].set("mailbox_partial_id",e[131]),e[136].set("action",e[119]),e[136].set("device_id",e[35]),e[136].set("echo_version",d.i64.cast([0,0])),e[136].set("epoch_id",e[133]),e[136].set("trace_id",void 0),e[136].set("encryption_version",e[135]),e[136].set("is_thread",d.i64.eq(e[63],d.i64.cast([0,2]))),e[136].set("raw_identifiers",e[125]),e[136].set("raw_tokens",e[130]),e[136].set("request_id",e[150]),e[136].set("tam_thread_subtype",e[70]==null?d.i64.cast([0,0]):e[70]),e[136].set("is_instamadillo",e[71]==null?!1:e[71]),e[136].set("should_run_device_creation_timestamp_sync",e[65]),e[136].set("empty_echo_payload_reason",d.i64.cast([0,1])),e[136].set("value_secret_ref",e[113]),e[93]!==void 0?d.sequence([function(a){return e[151]=e[93].get("supplemental_data_encrypted"),e[151]!==void 0?d.sequence([function(a){return e[153]=e[93].get("protobuf_encrypted"),e[154]=e[93].get("backup_action"),e[155]=e[93].get("timestamp_ms"),e[156]=e[151].get("sk_ciphertext"),d.nativeOperation(b("LSBase64Encode.nop"),e[156]).then(function(a){return a=a,e[157]=a[0],a})},function(a){return e[158]=e[151].get("sk_hash"),d.nativeOperation(b("LSBase64Encode.nop"),e[158]).then(function(a){return a=a,e[159]=a[0],a})},function(a){return e[160]=e[93].get("message_tags"),e[161]=e[93].get("maybe_ooo_supplemental_upload"),e[162]=new d.Map(),e[162].set("supplementary_data_key",void 0),e[162].set("encrypted_protobuf",e[153]),e[162].set("key_value_backup_action",e[154]),e[162].set("protobuf_ts_ms",e[155]),e[162].set("supplemental_key_ciphertext",e[157]),e[162].set("supplemental_key_hash",e[159]),e[162].set("message_tags",e[160]),e[162].set("maybe_ooo_supplemental_upload",e[161]),e[152]=e[162]}]):d.resolve((e[153]=e[93].get("protobuf_encrypted"),e[154]=e[93].get("backup_action"),e[155]=e[93].get("timestamp_ms"),e[156]=e[93].get("message_tags"),e[157]=new d.Map(),e[157].set("supplementary_data_key",void 0),e[157].set("encrypted_protobuf",e[153]),e[157].set("key_value_backup_action",e[154]),e[157].set("protobuf_ts_ms",e[155]),e[157].set("message_tags",e[156]),e[152]=e[157]))},function(a){return e[136].set("key_value_backup_payload",e[152])}]):d.resolve()},function(a){return e[66]!==void 0?d.resolve(e[136].set("attachment_backup_payload",e[66])):(function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure] attachment_payload is null."),e[151]="payload_null",e[6]!==void 0?e[151]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"attachment_info",e[151]):d.resolve():d.resolve())},function(a){return e[6]!==void 0?d.nativeOperation(b("LSQplAnnotateBool.nop"),d.i64.cast([0,637746317]),e[6],"process_attachments_via_message_upload",!0):d.resolve()},function(a){return e[150]!==void 0?d.nativeOperation(b("LSLogWebQpl.nop"),e[150],d.i64.cast([0,521481602]),"upload_start",d.i64.cast([0,0]),void 0,void 0):d.resolve()},function(b){return e[137]=d.toJSON(e[136]),d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[151]=d.i64.of_float(Date.now()),d.i64.eq(e[67],d.i64.cast([0,0]))||d.i64.eq(e[67],void 0)?e[152]=void 0:e[152]=e[67],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[151],d.i64.cast([0,1e6])),e[19]),e[152]],e[138]=b[0],e[139]=b[1],e[140]=b[2],e[141]=b[3],e[142]=b[4],e[143]=b[5],e[144]=b[6]):(f=c.item,e[151]=d.i64.of_float(Date.now()),d.i64.eq(e[67],d.i64.cast([0,0]))||d.i64.eq(e[67],void 0)?e[152]=void 0:e[152]=e[67],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[151],d.i64.cast([0,1e6])),e[19]),e[152]],e[138]=b[0],e[139]=b[1],e[140]=b[2],e[141]=b[3],e[142]=b[4],e[143]=b[5],e[144]=b[6])})},function(a){return e[146]=new d.Map(),e[146].set("task_id",e[138]),e[146].set("queue_name",e[139]),e[146].set("enqueue_timestamp_ms",e[140]),e[146].set("priority",e[141]),e[146].set("first_executed_timestamp_ms",e[142]),e[146].set("execution_time_ns",e[143]),e[146].set("echo_encoding_execution_time_ns",e[144]),e[147]=new d.Map(),e[147].set("task_metadata",e[146]),e[147].set("action_type",e[62]),e[147].set("content_type",e[63]),e[147].set("identifiers",void 0),e[147].set("identifiers_v2",e[55]),e[147].set("task_creation_source",void 0),e[147].set("message_payload_source",d.i64.cast([0,2])),void 0!==void 0?(e[151]=(void 0).get("stored_procedure"),e[152]=(void 0).get("error_code"),e[153]=(void 0).get("error_message"),e[154]=".",e[155]=[e[151],e[154],d.i64.to_string(e[152]),e[154],e[153]].join(""),e[6]!==void 0?e[155]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"exception_error",e[155]):d.resolve():d.resolve()):d.resolve()},function(a){return void 0!==void 0?(e[151]=(void 0).get("stored_procedure"),e[152]=(void 0).get("error_code"),e[153]=(void 0).get("error_message"),e[154]=".",e[155]=[e[151],e[154],d.i64.to_string(e[152]),e[154],e[153]].join(""),e[6]!==void 0?e[155]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"exception_error",e[155]):d.resolve():d.resolve()):d.resolve()},function(a){return e[6]!==void 0?d.nativeOperation(b("LSQplMarkEnd.nop"),d.i64.cast([0,637746317]),e[6],!0):d.resolve()},function(a){return e[148]=new d.Map(),e[148].set("payload",e[137]),e[149]=d.createArray(),e[151]=(e[149].push(void 0),e[149]),a=[e[148],void 0,e[147],e[149]],e[109]=a[0],e[110]=a[1],e[111]=a[2],e[112]=a[3]}]):d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[124]=d.i64.of_float(Date.now()),d.i64.eq(e[67],d.i64.cast([0,0]))||d.i64.eq(e[67],void 0)?e[125]=void 0:e[125]=e[67],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[124],d.i64.cast([0,1e6])),e[19]),e[125]],e[113]=b[0],e[114]=b[1],e[115]=b[2],e[116]=b[3],e[117]=b[4],e[118]=b[5],e[119]=b[6]):(f=c.item,e[124]=d.i64.of_float(Date.now()),d.i64.eq(e[67],d.i64.cast([0,0]))||d.i64.eq(e[67],void 0)?e[125]=void 0:e[125]=e[67],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[124],d.i64.cast([0,1e6])),e[19]),e[125]],e[113]=b[0],e[114]=b[1],e[115]=b[2],e[116]=b[3],e[117]=b[4],e[118]=b[5],e[119]=b[6])})},function(a){return e[121]=new d.Map(),e[121].set("task_id",e[113]),e[121].set("queue_name",e[114]),e[121].set("enqueue_timestamp_ms",e[115]),e[121].set("priority",e[116]),e[121].set("first_executed_timestamp_ms",e[117]),e[121].set("execution_time_ns",e[118]),e[121].set("echo_encoding_execution_time_ns",e[119]),e[122]=new d.Map(),e[122].set("task_metadata",e[121]),e[122].set("action_type",e[62]),e[122].set("content_type",e[63]),e[122].set("identifiers",void 0),e[122].set("identifiers_v2",e[55]),e[122].set("task_creation_source",void 0),e[122].set("message_payload_source",d.i64.cast([0,2])),e[104]!==void 0?(e[124]=e[104].get("stored_procedure"),e[125]=e[104].get("error_code"),e[126]=e[104].get("error_message"),e[127]=".",e[128]=[e[124],e[127],d.i64.to_string(e[125]),e[127],e[126]].join(""),e[6]!==void 0?e[128]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"exception_error",e[128]):d.resolve():d.resolve()):d.resolve()},function(a){return void 0!==void 0?(e[124]=(void 0).get("stored_procedure"),e[125]=(void 0).get("error_code"),e[126]=(void 0).get("error_message"),e[127]=".",e[128]=[e[124],e[127],d.i64.to_string(e[125]),e[127],e[126]].join(""),e[6]!==void 0?e[128]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"exception_error",e[128]):d.resolve():d.resolve()):d.resolve()},function(a){return e[6]!==void 0?d.nativeOperation(b("LSQplMarkEnd.nop"),d.i64.cast([0,637746317]),e[6],!1):d.resolve()},function(a){return e[123]=d.createArray(),e[124]=(e[123].push(void 0),e[123]),a=[void 0,e[104],e[122],e[123]],e[109]=a[0],e[110]=a[1],e[111]=a[2],e[112]=a[3]}])},function(a){return a=[e[109],e[110],e[111],e[112]],e[105]=a[0],e[106]=a[1],e[107]=a[2],e[108]=a[3],a}]):d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[120]=d.i64.of_float(Date.now()),d.i64.eq(e[67],d.i64.cast([0,0]))||d.i64.eq(e[67],void 0)?e[121]=void 0:e[121]=e[67],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[120],d.i64.cast([0,1e6])),e[19]),e[121]],e[109]=b[0],e[110]=b[1],e[111]=b[2],e[112]=b[3],e[113]=b[4],e[114]=b[5],e[115]=b[6]):(f=c.item,e[120]=d.i64.of_float(Date.now()),d.i64.eq(e[67],d.i64.cast([0,0]))||d.i64.eq(e[67],void 0)?e[121]=void 0:e[121]=e[67],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[120],d.i64.cast([0,1e6])),e[19]),e[121]],e[109]=b[0],e[110]=b[1],e[111]=b[2],e[112]=b[3],e[113]=b[4],e[114]=b[5],e[115]=b[6])})},function(a){return e[117]=new d.Map(),e[117].set("task_id",e[109]),e[117].set("queue_name",e[110]),e[117].set("enqueue_timestamp_ms",e[111]),e[117].set("priority",e[112]),e[117].set("first_executed_timestamp_ms",e[113]),e[117].set("execution_time_ns",e[114]),e[117].set("echo_encoding_execution_time_ns",e[115]),e[118]=new d.Map(),e[118].set("task_metadata",e[117]),e[118].set("action_type",e[62]),e[118].set("content_type",e[63]),e[118].set("identifiers",void 0),e[118].set("identifiers_v2",e[55]),e[118].set("task_creation_source",void 0),e[118].set("message_payload_source",d.i64.cast([0,2])),void 0!==void 0?(e[120]=(void 0).get("stored_procedure"),e[121]=(void 0).get("error_code"),e[122]=(void 0).get("error_message"),e[123]=".",e[124]=[e[120],e[123],d.i64.to_string(e[121]),e[123],e[122]].join(""),e[6]!==void 0?e[124]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"exception_error",e[124]):d.resolve():d.resolve()):d.resolve()},function(a){return e[94]!==void 0?(e[120]=e[94].get("stored_procedure"),e[121]=e[94].get("error_code"),e[122]=e[94].get("error_message"),e[123]=".",e[124]=[e[120],e[123],d.i64.to_string(e[121]),e[123],e[122]].join(""),e[6]!==void 0?e[124]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"exception_error",e[124]):d.resolve():d.resolve()):d.resolve()},function(a){return e[6]!==void 0?d.nativeOperation(b("LSQplMarkEnd.nop"),d.i64.cast([0,637746317]),e[6],!1):d.resolve()},function(a){return e[119]=d.createArray(),e[120]=(e[119].push(e[94]),e[119]),a=[void 0,void 0,e[118],e[119]],e[105]=a[0],e[106]=a[1],e[107]=a[2],e[108]=a[3]}])},function(a){return a=[e[105],e[106],e[107],e[108]],e[95]=a[0],e[96]=a[1],e[97]=a[2],e[98]=a[3],a}]):d.sequence([function(c){return e[99]===!0&&e[100]===!1?d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[116]=d.i64.of_float(Date.now()),d.i64.eq(e[67],d.i64.cast([0,0]))||d.i64.eq(e[67],void 0)?e[117]=void 0:e[117]=e[67],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[116],d.i64.cast([0,1e6])),e[19]),e[117]],e[105]=b[0],e[106]=b[1],e[107]=b[2],e[108]=b[3],e[109]=b[4],e[110]=b[5],e[111]=b[6]):(f=c.item,e[116]=d.i64.of_float(Date.now()),d.i64.eq(e[67],d.i64.cast([0,0]))||d.i64.eq(e[67],void 0)?e[117]=void 0:e[117]=e[67],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[116],d.i64.cast([0,1e6])),e[19]),e[117]],e[105]=b[0],e[106]=b[1],e[107]=b[2],e[108]=b[3],e[109]=b[4],e[110]=b[5],e[111]=b[6])})},function(a){return e[113]=new d.Map(),e[113].set("task_id",e[105]),e[113].set("queue_name",e[106]),e[113].set("enqueue_timestamp_ms",e[107]),e[113].set("priority",e[108]),e[113].set("first_executed_timestamp_ms",e[109]),e[113].set("execution_time_ns",e[110]),e[113].set("echo_encoding_execution_time_ns",e[111]),e[114]=new d.Map(),e[114].set("task_metadata",e[113]),e[114].set("action_type",e[62]),e[114].set("content_type",e[63]),e[114].set("identifiers",void 0),e[114].set("identifiers_v2",e[55]),e[114].set("task_creation_source",void 0),e[114].set("message_payload_source",d.i64.cast([0,2])),void 0!==void 0?(e[116]=(void 0).get("stored_procedure"),e[117]=(void 0).get("error_code"),e[118]=(void 0).get("error_message"),e[119]=".",e[120]=[e[116],e[119],d.i64.to_string(e[117]),e[119],e[118]].join(""),e[6]!==void 0?e[120]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"exception_error",e[120]):d.resolve():d.resolve()):d.resolve()},function(a){return e[94]!==void 0?(e[116]=e[94].get("stored_procedure"),e[117]=e[94].get("error_code"),e[118]=e[94].get("error_message"),e[119]=".",e[120]=[e[116],e[119],d.i64.to_string(e[117]),e[119],e[118]].join(""),e[6]!==void 0?e[120]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"exception_error",e[120]):d.resolve():d.resolve()):d.resolve()},function(a){return e[6]!==void 0?d.nativeOperation(b("LSQplMarkEnd.nop"),d.i64.cast([0,637746317]),e[6],!1):d.resolve()},function(a){return e[115]=d.createArray(),e[116]=(e[115].push(e[94]),e[115]),a=[void 0,void 0,e[114],e[115]],e[101]=a[0],e[102]=a[1],e[103]=a[2],e[104]=a[3]}]):d.sequence([function(c){return d.i64.eq(e[62],d.i64.cast([0,1]))?(e[113]=e[68]===""?void 0:e[68],e[113]!==void 0?(c=[e[113],void 0],e[111]=c[0],e[112]=c[1],c):(e[114]=new d.Map(),e[114].set("error_code",d.i64.cast([0,30])),e[114].set("stored_procedure","LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure"),e[114].set("error_message",""),c=[void 0,e[114]],e[111]=c[0],e[112]=c[1]),c=[e[111],e[112]],e[105]=c[0],e[106]=c[1]):(c=["",void 0],e[105]=c[0],e[106]=c[1],c),e[105]!==void 0?d.sequence([function(a){return d.i64.eq(e[62],d.i64.cast([0,1]))?d.sequence([function(a){return e[117]=e[55].get("backup_id"),e[118]=e[55].get("act_thread_id"),d.storedProcedure(b("LSEncryptMessagePayloadV2"),e[117],e[118],e[76],e[105]).then(function(a){return a=a,e[119]=a[0],e[120]=a[1],a})},function(a){return a=[e[119],e[120]],e[111]=a[0],e[112]=a[1],a}]):d.resolve((e[117]=new d.Map(),e[117].set("encrypted_message_payload",""),e[117].set("value_secret_ref",""),a=[e[117],void 0],e[111]=a[0],e[112]=a[1]))},function(c){return e[111]!==void 0?d.sequence([function(a){return e[117]=e[86].get("act_thread_id_ocmf_partial"),e[118]=e[86].get("otid_ocmf_partial"),e[119]=e[86].get("timestamp_encrypted"),e[120]=new d.Map(),e[120].set("list_key",e[117]),e[120].set("unique_key",e[118]),e[120].set("sort_key",e[119]),e[111]!==void 0?(e[154]=e[111].get("encrypted_message_payload"),e[155]=e[111].get("value_secret_ref"),e[156]=new d.Map(),e[156].set("value",e[154]),e[156].set("value_secret_ref",e[155]),e[121]=e[156]):e[121]=void 0,e[122]=new d.Map(),e[122].set("list_item_id",e[120]),e[122].set("list_item",e[121]),e[122].set("action_type",e[62]),e[123]=e[55].get("timestamp"),e[124]=e[55].get("otid"),e[125]=e[55].get("act_thread_id"),e[126]=e[55].get("supplemental_otid"),e[127]=e[55].get("deletion_otid"),e[128]=new d.Map(),e[128].set("timestamp",e[123]),e[128].set("otid",e[124]),e[128].set("wa_thread_id",d.i64.from_string(e[125])),e[128].set("supplemental_otid",e[126]),e[128].set("deletion_otid",e[127]),e[129]=e[76].get("mailbox_base_salt"),d.nativeOperation(b("LSBase64Encode.nop"),e[129]).then(function(a){return a=a,e[130]=a[0],a})},function(a){return e[131]=e[76].get("ocmf_shared_key"),d.nativeOperation(b("LSBase64Encode.nop"),e[131]).then(function(a){return a=a,e[132]=a[0],a})},function(a){return e[133]=new d.Map(),e[133].set("mailbox_root_key",e[130]==null?"":e[130]),e[133].set("ocmf_client_state_blob",e[132]==null?"":e[132]),e[134]=e[86].get("backup_id_ocmf_partial"),e[135]=e[76].get("message_payload_encryption_keys"),e[136]=e[135].get("epoch_id"),e[137]=e[76].get("message_payload_encryption_keys"),e[138]=e[137].get("encryption_version"),e[153]=e[69]==null?"":e[69],e[139]=new d.Map(),e[139].set("mailbox_partial_id",e[134]),e[139].set("action",e[122]),e[139].set("device_id",e[35]),e[139].set("echo_version",d.i64.cast([0,0])),e[139].set("epoch_id",e[136]),e[139].set("trace_id",void 0),e[139].set("encryption_version",e[138]),e[139].set("is_thread",d.i64.eq(e[63],d.i64.cast([0,2]))),e[139].set("raw_identifiers",e[128]),e[139].set("raw_tokens",e[133]),e[139].set("request_id",e[153]),e[139].set("tam_thread_subtype",e[70]==null?d.i64.cast([0,0]):e[70]),e[139].set("is_instamadillo",e[71]==null?!1:e[71]),e[139].set("should_run_device_creation_timestamp_sync",e[65]),e[93]!==void 0?d.sequence([function(a){return e[154]=e[93].get("supplemental_data_encrypted"),e[154]!==void 0?d.sequence([function(a){return e[156]=e[93].get("protobuf_encrypted"),e[157]=e[93].get("backup_action"),e[158]=e[93].get("timestamp_ms"),e[159]=e[154].get("sk_ciphertext"),d.nativeOperation(b("LSBase64Encode.nop"),e[159]).then(function(a){return a=a,e[160]=a[0],a})},function(a){return e[161]=e[154].get("sk_hash"),d.nativeOperation(b("LSBase64Encode.nop"),e[161]).then(function(a){return a=a,e[162]=a[0],a})},function(a){return e[163]=e[93].get("message_tags"),e[164]=e[93].get("maybe_ooo_supplemental_upload"),e[165]=new d.Map(),e[165].set("supplementary_data_key",void 0),e[165].set("encrypted_protobuf",e[156]),e[165].set("key_value_backup_action",e[157]),e[165].set("protobuf_ts_ms",e[158]),e[165].set("supplemental_key_ciphertext",e[160]),e[165].set("supplemental_key_hash",e[162]),e[165].set("message_tags",e[163]),e[165].set("maybe_ooo_supplemental_upload",e[164]),e[155]=e[165]}]):d.resolve((e[156]=e[93].get("protobuf_encrypted"),e[157]=e[93].get("backup_action"),e[158]=e[93].get("timestamp_ms"),e[159]=e[93].get("message_tags"),e[160]=new d.Map(),e[160].set("supplementary_data_key",void 0),e[160].set("encrypted_protobuf",e[156]),e[160].set("key_value_backup_action",e[157]),e[160].set("protobuf_ts_ms",e[158]),e[160].set("message_tags",e[159]),e[155]=e[160]))},function(a){return e[139].set("key_value_backup_payload",e[155])}]):d.resolve()},function(a){return e[66]!==void 0?d.resolve(e[139].set("attachment_backup_payload",e[66])):(function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure] attachment_payload is null."),e[154]="payload_null",e[6]!==void 0?e[154]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"attachment_info",e[154]):d.resolve():d.resolve())},function(a){return e[6]!==void 0?d.nativeOperation(b("LSQplAnnotateBool.nop"),d.i64.cast([0,637746317]),e[6],"process_attachments_via_message_upload",!0):d.resolve()},function(a){return e[153]!==void 0?d.nativeOperation(b("LSLogWebQpl.nop"),e[153],d.i64.cast([0,521481602]),"upload_start",d.i64.cast([0,0]),void 0,void 0):d.resolve()},function(b){return e[140]=d.toJSON(e[139]),d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[154]=d.i64.of_float(Date.now()),d.i64.eq(e[67],d.i64.cast([0,0]))||d.i64.eq(e[67],void 0)?e[155]=void 0:e[155]=e[67],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[154],d.i64.cast([0,1e6])),e[19]),e[155]],e[141]=b[0],e[142]=b[1],e[143]=b[2],e[144]=b[3],e[145]=b[4],e[146]=b[5],e[147]=b[6]):(f=c.item,e[154]=d.i64.of_float(Date.now()),d.i64.eq(e[67],d.i64.cast([0,0]))||d.i64.eq(e[67],void 0)?e[155]=void 0:e[155]=e[67],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[154],d.i64.cast([0,1e6])),e[19]),e[155]],e[141]=b[0],e[142]=b[1],e[143]=b[2],e[144]=b[3],e[145]=b[4],e[146]=b[5],e[147]=b[6])})},function(a){return e[149]=new d.Map(),e[149].set("task_id",e[141]),e[149].set("queue_name",e[142]),e[149].set("enqueue_timestamp_ms",e[143]),e[149].set("priority",e[144]),e[149].set("first_executed_timestamp_ms",e[145]),e[149].set("execution_time_ns",e[146]),e[149].set("echo_encoding_execution_time_ns",e[147]),e[150]=new d.Map(),e[150].set("task_metadata",e[149]),e[150].set("action_type",e[62]),e[150].set("content_type",e[63]),e[150].set("identifiers",void 0),e[150].set("identifiers_v2",e[55]),e[150].set("task_creation_source",void 0),e[150].set("message_payload_source",d.i64.cast([0,2])),void 0!==void 0?(e[154]=(void 0).get("stored_procedure"),e[155]=(void 0).get("error_code"),e[156]=(void 0).get("error_message"),e[157]=".",e[158]=[e[154],e[157],d.i64.to_string(e[155]),e[157],e[156]].join(""),e[6]!==void 0?e[158]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"exception_error",e[158]):d.resolve():d.resolve()):d.resolve()},function(a){return e[94]!==void 0?(e[154]=e[94].get("stored_procedure"),e[155]=e[94].get("error_code"),e[156]=e[94].get("error_message"),e[157]=".",e[158]=[e[154],e[157],d.i64.to_string(e[155]),e[157],e[156]].join(""),e[6]!==void 0?e[158]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"exception_error",e[158]):d.resolve():d.resolve()):d.resolve()},function(a){return e[6]!==void 0?d.nativeOperation(b("LSQplMarkEnd.nop"),d.i64.cast([0,637746317]),e[6],!0):d.resolve()},function(a){return e[151]=new d.Map(),e[151].set("payload",e[140]),e[152]=d.createArray(),e[154]=(e[152].push(e[94]),e[152]),a=[e[151],void 0,e[150],e[152]],e[113]=a[0],e[114]=a[1],e[115]=a[2],e[116]=a[3]}]):d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[128]=d.i64.of_float(Date.now()),d.i64.eq(e[67],d.i64.cast([0,0]))||d.i64.eq(e[67],void 0)?e[129]=void 0:e[129]=e[67],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[128],d.i64.cast([0,1e6])),e[19]),e[129]],e[117]=b[0],e[118]=b[1],e[119]=b[2],e[120]=b[3],e[121]=b[4],e[122]=b[5],e[123]=b[6]):(f=c.item,e[128]=d.i64.of_float(Date.now()),d.i64.eq(e[67],d.i64.cast([0,0]))||d.i64.eq(e[67],void 0)?e[129]=void 0:e[129]=e[67],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[128],d.i64.cast([0,1e6])),e[19]),e[129]],e[117]=b[0],e[118]=b[1],e[119]=b[2],e[120]=b[3],e[121]=b[4],e[122]=b[5],e[123]=b[6])})},function(a){return e[125]=new d.Map(),e[125].set("task_id",e[117]),e[125].set("queue_name",e[118]),e[125].set("enqueue_timestamp_ms",e[119]),e[125].set("priority",e[120]),e[125].set("first_executed_timestamp_ms",e[121]),e[125].set("execution_time_ns",e[122]),e[125].set("echo_encoding_execution_time_ns",e[123]),e[126]=new d.Map(),e[126].set("task_metadata",e[125]),e[126].set("action_type",e[62]),e[126].set("content_type",e[63]),e[126].set("identifiers",void 0),e[126].set("identifiers_v2",e[55]),e[126].set("task_creation_source",void 0),e[126].set("message_payload_source",d.i64.cast([0,2])),e[112]!==void 0?(e[128]=e[112].get("stored_procedure"),e[129]=e[112].get("error_code"),e[130]=e[112].get("error_message"),e[131]=".",e[132]=[e[128],e[131],d.i64.to_string(e[129]),e[131],e[130]].join(""),e[6]!==void 0?e[132]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"exception_error",e[132]):d.resolve():d.resolve()):d.resolve()},function(a){return e[94]!==void 0?(e[128]=e[94].get("stored_procedure"),e[129]=e[94].get("error_code"),e[130]=e[94].get("error_message"),e[131]=".",e[132]=[e[128],e[131],d.i64.to_string(e[129]),e[131],e[130]].join(""),e[6]!==void 0?e[132]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"exception_error",e[132]):d.resolve():d.resolve()):d.resolve()},function(a){return e[6]!==void 0?d.nativeOperation(b("LSQplMarkEnd.nop"),d.i64.cast([0,637746317]),e[6],!1):d.resolve()},function(a){return e[127]=d.createArray(),e[128]=(e[127].push(e[94]),e[127]),a=[void 0,e[112],e[126],e[127]],e[113]=a[0],e[114]=a[1],e[115]=a[2],e[116]=a[3]}])},function(a){return a=[e[113],e[114],e[115],e[116]],e[107]=a[0],e[108]=a[1],e[109]=a[2],e[110]=a[3],a}]):d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[122]=d.i64.of_float(Date.now()),d.i64.eq(e[67],d.i64.cast([0,0]))||d.i64.eq(e[67],void 0)?e[123]=void 0:e[123]=e[67],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[122],d.i64.cast([0,1e6])),e[19]),e[123]],e[111]=b[0],e[112]=b[1],e[113]=b[2],e[114]=b[3],e[115]=b[4],e[116]=b[5],e[117]=b[6]):(f=c.item,e[122]=d.i64.of_float(Date.now()),d.i64.eq(e[67],d.i64.cast([0,0]))||d.i64.eq(e[67],void 0)?e[123]=void 0:e[123]=e[67],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[122],d.i64.cast([0,1e6])),e[19]),e[123]],e[111]=b[0],e[112]=b[1],e[113]=b[2],e[114]=b[3],e[115]=b[4],e[116]=b[5],e[117]=b[6])})},function(a){return e[119]=new d.Map(),e[119].set("task_id",e[111]),e[119].set("queue_name",e[112]),e[119].set("enqueue_timestamp_ms",e[113]),e[119].set("priority",e[114]),e[119].set("first_executed_timestamp_ms",e[115]),e[119].set("execution_time_ns",e[116]),e[119].set("echo_encoding_execution_time_ns",e[117]),e[120]=new d.Map(),e[120].set("task_metadata",e[119]),e[120].set("action_type",e[62]),e[120].set("content_type",e[63]),e[120].set("identifiers",void 0),e[120].set("identifiers_v2",e[55]),e[120].set("task_creation_source",void 0),e[120].set("message_payload_source",d.i64.cast([0,2])),e[106]!==void 0?(e[122]=e[106].get("stored_procedure"),e[123]=e[106].get("error_code"),e[124]=e[106].get("error_message"),e[125]=".",e[126]=[e[122],e[125],d.i64.to_string(e[123]),e[125],e[124]].join(""),e[6]!==void 0?e[126]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"exception_error",e[126]):d.resolve():d.resolve()):d.resolve()},function(a){return e[94]!==void 0?(e[122]=e[94].get("stored_procedure"),e[123]=e[94].get("error_code"),e[124]=e[94].get("error_message"),e[125]=".",e[126]=[e[122],e[125],d.i64.to_string(e[123]),e[125],e[124]].join(""),e[6]!==void 0?e[126]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"exception_error",e[126]):d.resolve():d.resolve()):d.resolve()},function(a){return e[6]!==void 0?d.nativeOperation(b("LSQplMarkEnd.nop"),d.i64.cast([0,637746317]),e[6],!1):d.resolve()},function(a){return e[121]=d.createArray(),e[122]=(e[121].push(e[94]),e[121]),a=[void 0,e[106],e[120],e[121]],e[107]=a[0],e[108]=a[1],e[109]=a[2],e[110]=a[3]}])},function(a){return a=[e[107],e[108],e[109],e[110]],e[101]=a[0],e[102]=a[1],e[103]=a[2],e[104]=a[3],a}])},function(a){return a=[e[101],e[102],e[103],e[104]],e[95]=a[0],e[96]=a[1],e[97]=a[2],e[98]=a[3],a}])},function(a){return a=[e[95],e[96],e[97],e[98]],e[88]=a[0],e[89]=a[1],e[90]=a[2],e[91]=a[3],a}]):d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[103]=d.i64.of_float(Date.now()),d.i64.eq(e[67],d.i64.cast([0,0]))||d.i64.eq(e[67],void 0)?e[104]=void 0:e[104]=e[67],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[103],d.i64.cast([0,1e6])),e[19]),e[104]],e[92]=b[0],e[93]=b[1],e[94]=b[2],e[95]=b[3],e[96]=b[4],e[97]=b[5],e[98]=b[6]):(f=c.item,e[103]=d.i64.of_float(Date.now()),d.i64.eq(e[67],d.i64.cast([0,0]))||d.i64.eq(e[67],void 0)?e[104]=void 0:e[104]=e[67],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[103],d.i64.cast([0,1e6])),e[19]),e[104]],e[92]=b[0],e[93]=b[1],e[94]=b[2],e[95]=b[3],e[96]=b[4],e[97]=b[5],e[98]=b[6])})},function(a){return e[100]=new d.Map(),e[100].set("task_id",e[92]),e[100].set("queue_name",e[93]),e[100].set("enqueue_timestamp_ms",e[94]),e[100].set("priority",e[95]),e[100].set("first_executed_timestamp_ms",e[96]),e[100].set("execution_time_ns",e[97]),e[100].set("echo_encoding_execution_time_ns",e[98]),e[101]=new d.Map(),e[101].set("task_metadata",e[100]),e[101].set("action_type",e[62]),e[101].set("content_type",e[63]),e[101].set("identifiers",void 0),e[101].set("identifiers_v2",e[55]),e[101].set("task_creation_source",void 0),e[101].set("message_payload_source",d.i64.cast([0,2])),e[87]!==void 0?(e[103]=e[87].get("stored_procedure"),e[104]=e[87].get("error_code"),e[105]=e[87].get("error_message"),e[106]=".",e[107]=[e[103],e[106],d.i64.to_string(e[104]),e[106],e[105]].join(""),e[6]!==void 0?e[107]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"exception_error",e[107]):d.resolve():d.resolve()):d.resolve()},function(a){return void 0!==void 0?(e[103]=(void 0).get("stored_procedure"),e[104]=(void 0).get("error_code"),e[105]=(void 0).get("error_message"),e[106]=".",e[107]=[e[103],e[106],d.i64.to_string(e[104]),e[106],e[105]].join(""),e[6]!==void 0?e[107]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"exception_error",e[107]):d.resolve():d.resolve()):d.resolve()},function(a){return e[6]!==void 0?d.nativeOperation(b("LSQplMarkEnd.nop"),d.i64.cast([0,637746317]),e[6],!1):d.resolve()},function(a){return e[102]=d.createArray(),e[103]=(e[102].push(void 0),e[102]),a=[void 0,e[87],e[101],e[102]],e[88]=a[0],e[89]=a[1],e[90]=a[2],e[91]=a[3]}])},function(a){return a=[e[88],e[89],e[90],e[91]],e[78]=a[0],e[79]=a[1],e[80]=a[2],e[81]=a[3],a}]):d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[93]=d.i64.of_float(Date.now()),d.i64.eq(e[67],d.i64.cast([0,0]))||d.i64.eq(e[67],void 0)?e[94]=void 0:e[94]=e[67],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[93],d.i64.cast([0,1e6])),e[19]),e[94]],e[82]=b[0],e[83]=b[1],e[84]=b[2],e[85]=b[3],e[86]=b[4],e[87]=b[5],e[88]=b[6]):(f=c.item,e[93]=d.i64.of_float(Date.now()),d.i64.eq(e[67],d.i64.cast([0,0]))||d.i64.eq(e[67],void 0)?e[94]=void 0:e[94]=e[67],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[93],d.i64.cast([0,1e6])),e[19]),e[94]],e[82]=b[0],e[83]=b[1],e[84]=b[2],e[85]=b[3],e[86]=b[4],e[87]=b[5],e[88]=b[6])})},function(a){return e[90]=new d.Map(),e[90].set("task_id",e[82]),e[90].set("queue_name",e[83]),e[90].set("enqueue_timestamp_ms",e[84]),e[90].set("priority",e[85]),e[90].set("first_executed_timestamp_ms",e[86]),e[90].set("execution_time_ns",e[87]),e[90].set("echo_encoding_execution_time_ns",e[88]),e[91]=new d.Map(),e[91].set("task_metadata",e[90]),e[91].set("action_type",e[62]),e[91].set("content_type",e[63]),e[91].set("identifiers",void 0),e[91].set("identifiers_v2",e[55]),e[91].set("task_creation_source",void 0),e[91].set("message_payload_source",d.i64.cast([0,2])),e[77]!==void 0?(e[93]=e[77].get("stored_procedure"),e[94]=e[77].get("error_code"),e[95]=e[77].get("error_message"),e[96]=".",e[97]=[e[93],e[96],d.i64.to_string(e[94]),e[96],e[95]].join(""),e[6]!==void 0?e[97]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"exception_error",e[97]):d.resolve():d.resolve()):d.resolve()},function(a){return void 0!==void 0?(e[93]=(void 0).get("stored_procedure"),e[94]=(void 0).get("error_code"),e[95]=(void 0).get("error_message"),e[96]=".",e[97]=[e[93],e[96],d.i64.to_string(e[94]),e[96],e[95]].join(""),e[6]!==void 0?e[97]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"exception_error",e[97]):d.resolve():d.resolve()):d.resolve()},function(a){return e[6]!==void 0?d.nativeOperation(b("LSQplMarkEnd.nop"),d.i64.cast([0,637746317]),e[6],!1):d.resolve()},function(a){return e[92]=d.createArray(),e[93]=(e[92].push(void 0),e[92]),a=[void 0,e[77],e[91],e[92]],e[78]=a[0],e[79]=a[1],e[80]=a[2],e[81]=a[3]}])},function(a){return a=[e[78],e[79],e[80],e[81]],e[58]=a[0],e[59]=a[1],e[60]=a[2],e[61]=a[3],a}]):d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(c,f){var b=c.done;c=c.value;return b?(e[84]=d.i64.of_float(Date.now()),d.i64.eq(e[67],d.i64.cast([0,0]))||d.i64.eq(e[67],void 0)?e[85]=void 0:e[85]=e[67],b=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[84],d.i64.cast([0,1e6])),e[19]),e[85]],e[72]=b[0],e[73]=b[1],e[74]=b[2],e[75]=b[3],e[76]=b[4],e[77]=b[5],e[78]=b[6]):(f=c.item,e[84]=d.i64.of_float(Date.now()),d.i64.eq(e[67],d.i64.cast([0,0]))||d.i64.eq(e[67],void 0)?e[85]=void 0:e[85]=e[67],b=[a[0],f.queueName,f.enqueueTimestampMs,void 0,f.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[84],d.i64.cast([0,1e6])),e[19]),e[85]],e[72]=b[0],e[73]=b[1],e[74]=b[2],e[75]=b[3],e[76]=b[4],e[77]=b[5],e[78]=b[6])})},function(a){return e[80]=new d.Map(),e[80].set("task_id",e[72]),e[80].set("queue_name",e[73]),e[80].set("enqueue_timestamp_ms",e[74]),e[80].set("priority",e[75]),e[80].set("first_executed_timestamp_ms",e[76]),e[80].set("execution_time_ns",e[77]),e[80].set("echo_encoding_execution_time_ns",e[78]),e[81]=new d.Map(),e[81].set("task_metadata",e[80]),e[81].set("action_type",e[62]),e[81].set("content_type",e[63]),e[81].set("identifiers",void 0),e[81].set("identifiers_v2",e[55]),e[81].set("task_creation_source",void 0),e[81].set("message_payload_source",d.i64.cast([0,2])),e[82]=new d.Map(),e[82].set("error_code",e[64]),e[82].set("stored_procedure","LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure"),e[82].set("error_message",""),e[82]!==void 0?(e[84]=e[82].get("stored_procedure"),e[85]=e[82].get("error_code"),e[86]=e[82].get("error_message"),e[87]=".",e[88]=[e[84],e[87],d.i64.to_string(e[85]),e[87],e[86]].join(""),e[6]!==void 0?e[88]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"exception_error",e[88]):d.resolve():d.resolve()):d.resolve()},function(a){return void 0!==void 0?(e[84]=(void 0).get("stored_procedure"),e[85]=(void 0).get("error_code"),e[86]=(void 0).get("error_message"),e[87]=".",e[88]=[e[84],e[87],d.i64.to_string(e[85]),e[87],e[86]].join(""),e[6]!==void 0?e[88]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"exception_error",e[88]):d.resolve():d.resolve()):d.resolve()},function(a){return e[6]!==void 0?d.nativeOperation(b("LSQplMarkEnd.nop"),d.i64.cast([0,637746317]),e[6],!1):d.resolve()},function(a){return e[83]=d.createArray(),a=[void 0,e[82],e[81],e[83]],e[58]=a[0],e[59]=a[1],e[60]=a[2],e[61]=a[3]}])},function(a){return a=[e[58],e[59],e[60],e[61]],e[50]=a[0],e[51]=a[1],e[52]=a[2],e[53]=a[3],a}]))})},function(a){return a=[e[50],e[51],e[52],e[53]],e[42]=a[0],e[43]=a[1],e[44]=a[2],e[45]=a[3],a}]):d.sequence([function(b){return d.db.table(2).fetch([[[a[0]]]]).next().then(function(b,c){var f=b.done;b=b.value;return f?(e[58]=d.i64.of_float(Date.now()),f=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[58],d.i64.cast([0,1e6])),e[19]),void 0],e[46]=f[0],e[47]=f[1],e[48]=f[2],e[49]=f[3],e[50]=f[4],e[51]=f[5],e[52]=f[6]):(c=b.item,e[58]=d.i64.of_float(Date.now()),f=[a[0],c.queueName,c.enqueueTimestampMs,void 0,c.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[58],d.i64.cast([0,1e6])),e[19]),void 0],e[46]=f[0],e[47]=f[1],e[48]=f[2],e[49]=f[3],e[50]=f[4],e[51]=f[5],e[52]=f[6])})},function(a){return e[54]=new d.Map(),e[54].set("task_id",e[46]),e[54].set("queue_name",e[47]),e[54].set("enqueue_timestamp_ms",e[48]),e[54].set("priority",e[49]),e[54].set("first_executed_timestamp_ms",e[50]),e[54].set("execution_time_ns",e[51]),e[54].set("echo_encoding_execution_time_ns",e[52]),e[55]=new d.Map(),e[55].set("task_metadata",e[54]),e[55].set("action_type",void 0),e[55].set("content_type",void 0),e[55].set("identifiers",void 0),e[55].set("identifiers_v2",void 0),e[55].set("task_creation_source",void 0),e[55].set("message_payload_source",d.i64.cast([0,2])),e[56]=new d.Map(),e[56].set("error_code",d.i64.cast([0,24])),e[56].set("stored_procedure","LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure"),e[56].set("error_message",""),e[56]!==void 0?(e[58]=e[56].get("stored_procedure"),e[59]=e[56].get("error_code"),e[60]=e[56].get("error_message"),e[61]=".",e[62]=[e[58],e[61],d.i64.to_string(e[59]),e[61],e[60]].join(""),e[6]!==void 0?e[62]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"exception_error",e[62]):d.resolve():d.resolve()):d.resolve()},function(a){return void 0!==void 0?(e[58]=(void 0).get("stored_procedure"),e[59]=(void 0).get("error_code"),e[60]=(void 0).get("error_message"),e[61]=".",e[62]=[e[58],e[61],d.i64.to_string(e[59]),e[61],e[60]].join(""),e[6]!==void 0?e[62]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"exception_error",e[62]):d.resolve():d.resolve()):d.resolve()},function(a){return e[6]!==void 0?d.nativeOperation(b("LSQplMarkEnd.nop"),d.i64.cast([0,637746317]),e[6],!1):d.resolve()},function(a){return e[57]=d.createArray(),a=[void 0,e[56],e[55],e[57]],e[42]=a[0],e[43]=a[1],e[44]=a[2],e[45]=a[3]}])},function(a){return a=[e[42],e[43],e[44],e[45]],e[12]=a[0],e[13]=a[1],e[14]=a[2],e[15]=a[3],a}]):d.sequence([function(b){return e[23]=e[10].get("errors"),e[24]=e[10].get("errors"),d.db.table(2).fetch([[[a[0]]]]).next().then(function(b,c){var f=b.done;b=b.value;return f?(e[37]=d.i64.of_float(Date.now()),f=[a[0],void 0,void 0,void 0,void 0,d.i64.sub(d.i64.mul(e[37],d.i64.cast([0,1e6])),e[19]),void 0],e[25]=f[0],e[26]=f[1],e[27]=f[2],e[28]=f[3],e[29]=f[4],e[30]=f[5],e[31]=f[6]):(c=b.item,e[37]=d.i64.of_float(Date.now()),f=[a[0],c.queueName,c.enqueueTimestampMs,void 0,c.firstExecutedTimestampMs,d.i64.sub(d.i64.mul(e[37],d.i64.cast([0,1e6])),e[19]),void 0],e[25]=f[0],e[26]=f[1],e[27]=f[2],e[28]=f[3],e[29]=f[4],e[30]=f[5],e[31]=f[6])})},function(a){return e[33]=new d.Map(),e[33].set("task_id",e[25]),e[33].set("queue_name",e[26]),e[33].set("enqueue_timestamp_ms",e[27]),e[33].set("priority",e[28]),e[33].set("first_executed_timestamp_ms",e[29]),e[33].set("execution_time_ns",e[30]),e[33].set("echo_encoding_execution_time_ns",e[31]),e[34]=new d.Map(),e[34].set("task_metadata",e[33]),e[34].set("action_type",void 0),e[34].set("content_type",void 0),e[34].set("identifiers",void 0),e[34].set("identifiers_v2",void 0),e[34].set("task_creation_source",void 0),e[34].set("message_payload_source",d.i64.cast([0,2])),e[35]=new d.Map(),e[35].set("error_code",d.i64.cast([0,1])),e[35].set("stored_procedure","LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure"),e[35].set("error_message",""),e[35]!==void 0?(e[37]=e[35].get("stored_procedure"),e[38]=e[35].get("error_code"),e[39]=e[35].get("error_message"),e[40]=".",e[41]=[e[37],e[40],d.i64.to_string(e[38]),e[40],e[39]].join(""),e[6]!==void 0?e[41]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"exception_error",e[41]):d.resolve():d.resolve()):d.resolve()},function(a){return void 0!==void 0?(e[37]=(void 0).get("stored_procedure"),e[38]=(void 0).get("error_code"),e[39]=(void 0).get("error_message"),e[40]=".",e[41]=[e[37],e[40],d.i64.to_string(e[38]),e[40],e[39]].join(""),e[6]!==void 0?e[41]!==void 0?d.nativeOperation(b("LSQplAnnotateString.nop"),d.i64.cast([0,637746317]),e[6],"exception_error",e[41]):d.resolve():d.resolve()):d.resolve()},function(a){return e[6]!==void 0?d.nativeOperation(b("LSQplMarkEnd.nop"),d.i64.cast([0,637746317]),e[6],!1):d.resolve()},function(a){return e[36]=d.createArray(),a=[void 0,e[35],e[34],e[36]],e[12]=a[0],e[13]=a[1],e[14]=a[2],e[15]=a[3]}])},function(a){return e[16]=d.i64.of_float(Date.now()),e[17]=d.i64.random(),e[20]="Finishing execution. Execution time: ",e[21]=d.i64.to_string(d.i64.sub(e[16],e[0])),e[22]=" ms",e[18]="",function(a){d.logger(a).info(a)}(["[EncryptedBackups][serializeBackupPayloadV2] ",e[18],e[20],e[18],e[21],e[18],e[22]].join("")),d.i64.eq(d.i64.mod_(e[17],d.i64.cast([0,1e3])),d.i64.cast([0,0]))?(e[23]=",",e[24]=d.createArray(),void 0!==void 0?e[25]=(e[24].push(void 0),e[24]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"serializeBackupPayloadV2",[e[20],e[23],e[21],e[23],e[22]].join(""),e[24],d.i64.cast([0,4]))):d.resolve()},function(a){return a=[e[12],e[13],e[14],e[15]],f[0]=a[0],f[1]=a[1],f[2]=a[2],f[3]=a[3],a}])},function(a){return d.resolve(f)}])}a.__sproc_name__="LSEncryptedBackupsSerializeBackupPayloadV2StoredProcedure";a.__tables__=["pending_tasks","secure_encrypted_backups_client_state","pending_backups_context_v2","pending_protobuf_backups_context","secure_encrypted_backups_epochs"];d=a;g["default"]=d}),98);
__d("LSTaskSerializerEncryptedBackupsUpload",["LSArrayGetObjectAt","LSLogMebClientEvent.nop","LSSerializeBackupPayloadV2"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(b){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][taskSerializerEncryptedBackupsUpload] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.forEach(c.db.table(177).fetch([[[a[0]]],"fk_pending_tasks"]),function(a){var b=a.update;a.item;return b({backupStatus:c.i64.cast([0,2])})})},function(e){return c.storedProcedure(b("LSSerializeBackupPayloadV2"),a[0]).then(function(a){return a=a,d[2]=a[0],d[3]=a[1],d[4]=a[2],d[5]=a[3],a})},function(a){return d[6]=c.createArray(),d[7]=c.i64.of_int32(d[5].length),c.i64.gt(d[7],c.i64.cast([0,0]))?c.loopAsync(d[7],function(a){return d[23]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[5],d[23]).then(function(a){return a=a,d[24]=a[0],d[25]=a[1],a})},function(a){return d[24]!==void 0?d[26]=(d[6].push(d[24]),d[6]):0}])}):c.resolve()},function(a){return d[8]=c.i64.of_int32(d[6].length),c.i64.gt(d[8],c.i64.cast([0,0]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[6],c.i64.cast([0,0])).then(function(a){return a=a,d[23]=a[0],d[24]=a[1],a})},function(a){return d[9]=d[23]}]):c.resolve(d[9]=void 0)},function(a){return d[2]?d[10]=!1:d[10]=!0,d[10]?(d[3]?d[23]=!1:d[23]=!0,d[23]?(a=[void 0,void 0,d[9],d[6],d[4]],d[24]=a[0],d[25]=a[1],d[26]=a[2],d[27]=a[3],d[28]=a[4],a):(a=[void 0,d[3],d[9],d[6],d[4]],d[24]=a[0],d[25]=a[1],d[26]=a[2],d[27]=a[3],d[28]=a[4],a),a=[d[24],d[25],d[26],d[27],d[28]],d[11]=a[0],d[12]=a[1],d[13]=a[2],d[14]=a[3],d[15]=a[4]):(d[23]=d[2].get("payload"),a=[d[23],d[3],d[9],d[6],d[4]],d[11]=a[0],d[12]=a[1],d[13]=a[2],d[14]=a[3],d[15]=a[4]),d[23]=new c.Map(),d[24]=d[23].set("success",d[11]),d[25]=d[23].set("failure",d[12]),d[26]=d[23].set("protobuf_failure",d[13]),d[27]=d[23].set("protobuf_failures",d[14]),d[28]=d[23].set("context",d[15]),d[29]=c.toJSON(d[23]),d[16]=d[29],d[17]=c.i64.of_float(Date.now()),d[18]=c.i64.random(),d[20]="Finishing execution. Execution time: ",d[21]=c.i64.to_string(c.i64.sub(d[17],d[0])),d[22]=" ms",d[19]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][taskSerializerEncryptedBackupsUpload] ",d[19],d[20],d[19],d[21],d[19],d[22]].join("")),c.i64.eq(c.i64.mod_(d[18],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[23]=",",d[24]=c.createArray(),void 0!==void 0?d[25]=(d[24].push(void 0),d[24]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"taskSerializerEncryptedBackupsUpload",[d[20],d[23],d[21],d[23],d[22]].join(""),d[24],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[16],c.i64.cast([0,50026])],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsTaskSerializerEncryptedBackupsUploadStoredProcedure";a.__tables__=["pending_backups_context_v2"];e.exports=a}),null);
__d("LSTaskSerializerEncryptedBackupsUploadProtobufOnly",[],(function(a,b,c,d,e,f){function a(){var a,b=arguments,c=b[b.length-1],d=[],e=[];return d[0]=new c.Map(),d[0].set("error_code",c.i64.cast([0,802])),d[0].set("stored_procedure","LSEncryptedBackupsTaskSerializerEncryptedBackupsUploadProtobufOnlyStoredProcedure"),d[0].set("error_message",""),d[2]=new c.Map(),d[3]=d[2].set("success",void 0),d[4]=d[2].set("failure",d[0]),d[5]=d[2].set("context",void 0),d[6]=c.toJSON(d[2]),d[1]=d[6],a=[d[1],c.i64.cast([0,50042]),void 0],e[0]=a[0],e[1]=a[1],e[2]=a[2],c.resolve(e)}a.__sproc_name__="LSEncryptedBackupsTaskSerializerEncryptedBackupsUploadProtobufOnlyStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSTaskSerializerEncryptedBackupsUploadSenderBackup",["LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(a){return c.sequence([function(a){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][taskSerializerEncryptedBackupsUploadSenderBackup] Beginning execution."),d[1]=c.i64.of_float(Date.now()),function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsUploadSenderBackupStoredProcedure] LSEncryptedBackupsMinosEncrypt native op not supported"),d[3]="LSEncryptedBackupsMinosEncrypt native op not supported",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsUploadSenderBackupStoredProcedure] ","",d[3]].join("")),d[2]=c.createArray(),void 0!==void 0?d[12]=(d[2].push(void 0),d[2]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsTaskSerializerEncryptedBackupsUploadSenderBackupStoredProcedure",d[3],d[2],c.i64.cast([0,3]))},function(a){return d[4]=new c.Map(),d[4].set("error_code",c.i64.cast([0,3])),d[4].set("stored_procedure","taskSerializerEncryptedBackupsUploadSenderBackup"),d[4].set("error_message",""),d[12]=new c.Map(),d[13]=d[12].set("success",void 0),d[14]=d[12].set("failure",d[4]),d[15]=d[12].set("context",void 0),d[16]=c.toJSON(d[12]),d[5]=d[16],d[6]=c.i64.of_float(Date.now()),d[7]=c.i64.random(),d[9]="Finishing execution. Execution time: ",d[10]=c.i64.to_string(c.i64.sub(d[6],d[0])),d[11]=" ms",d[8]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][taskSerializerEncryptedBackupsUploadSenderBackup] ",d[8],d[9],d[8],d[10],d[8],d[11]].join("")),c.i64.eq(c.i64.mod_(d[7],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[12]=",",d[13]=c.createArray(),void 0!==void 0?d[14]=(d[13].push(void 0),d[13]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"taskSerializerEncryptedBackupsUploadSenderBackup",[d[9],d[12],d[10],d[12],d[11]].join(""),d[13],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[5],c.i64.cast([0,50057]),void 0],e[0]=a[0],e[1]=a[1],e[2]=a[2],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsTaskSerializerEncryptedBackupsUploadSenderBackupStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSTaskSerializerMuteThreadV2",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(e){return b.sequence([function(d){return b.db.table(32).fetch([[[a[0]]]]).next().then(function(d,e){var f=d.done;d=d.value;return f?(c[4]=b.createArray(),c[5]=(c[4].push("TaskSerializerMuteThreadV2: Task ID not found"),c[4]),c[6]=(c[4].push(a[0]),c[4]),c[7]=b.toJSON(c[4]),function(a){b.logger(a).mustfix(a)}(c[7]),f=[void 0,void 0,void 0],c[0]=f[0],c[1]=f[1],c[2]=f[2]):(e=d.item,b.sequence([function(a){return c[8]=e.threadKey,b.db.table(9).fetch([[[c[8]]]]).next().then(function(d,e){var a=d.done;d=d.value;return a?(c[9]=b.createArray(),c[10]=(c[9].push("TaskSerializerMuteThreadV2: Thread not found"),c[9]),c[11]=(c[9].push(c[8]),c[9]),c[12]=b.toJSON(c[9]),function(a){b.logger(a).mustfix(a)}(c[12]),a=[void 0,void 0,void 0],c[4]=a[0],c[5]=a[1],c[6]=a[2]):(e=d.item,b.sequence([function(a){return b.db.table(9).fetch([[[c[8]]]]).next().then(function(d,e){var a=d.done;d=d.value;return a?c[9]=b.i64.cast([0,1]):(e=d.item,c[14]=e.syncGroup,b.i64.neq(c[14],void 0)?c[13]=c[14]:c[13]=b.i64.cast([0,1]),c[9]=c[13])})},function(a){return c[11]=new b.Map(),c[11].set("thread_key",c[8]),c[11].set("mailbox_type",b.i64.cast([0,0])),c[11].set("mute_expire_time_ms",e.muteExpireTimeMs),c[11].set("sync_group",c[9]),c[12]=b.toJSON(c[11]),a=[c[12],b.i64.cast([0,144]),void 0],c[4]=a[0],c[5]=a[1],c[6]=a[2]}]))})},function(a){return a=[c[4],c[5],c[6]],c[0]=a[0],c[1]=a[1],c[2]=a[2],a}]))})},function(a){return a=[c[0],c[1]],d[0]=a[0],d[1]=a[1],a}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxTaskSerializerMuteThreadV2StoredProcedure";a.__tables__=["threads_optimistic_context","threads"];e.exports=a}),null);
__d("LSTaskSerializerRemoveThread",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(e){return b.sequence([function(d){return b.db.table(32).fetch([[[a[0]]]]).next().then(function(d,e){var f=d.done;d=d.value;return f?(c[4]=b.createArray(),c[5]=(c[4].push("TaskSerializerRemoveThreadV2: Task ID not found"),c[4]),c[6]=(c[4].push(a[0]),c[4]),c[7]=b.toJSON(c[4]),function(a){b.logger(a).mustfix(a)}(c[7]),f=[void 0,void 0,void 0],c[0]=f[0],c[1]=f[1],c[2]=f[2]):(e=d.item,c[7]=e.removeType,b.i64.neq(c[7],void 0)?(c[8]=new b.Map(),c[8].set("thread_key",e.threadKey),c[8].set("remove_type",c[7]),c[8].set("sync_group",e.syncGroup==null?b.i64.cast([0,1]):e.syncGroup),c[9]=b.toJSON(c[8]),f=[c[9],b.i64.cast([0,146]),void 0],c[4]=f[0],c[5]=f[1],c[6]=f[2]):(d=[void 0,void 0,void 0],c[4]=d[0],c[5]=d[1],c[6]=d[2],d),e=[c[4],c[5],c[6]],c[0]=e[0],c[1]=e[1],c[2]=e[2])})},function(a){return a=[c[0],c[1]],d[0]=a[0],d[1]=a[1],a}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxTaskSerializerRemoveThreadStoredProcedure";a.__tables__=["threads_optimistic_context"];e.exports=a}),null);
__d("LSTaskSerializerSendMessageV2",["LSSymmetricEncryptionCreateEncryptedString.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(e){return b.sequence([function(d){return b.db.table(31).fetch([[[a[0]]]]).next().then(function(d,e){var f=d.done;d=d.value;return f?(c[4]=b.createArray(),c[5]=(c[4].push("task ID not found"),c[4]),c[6]=(c[4].push(a[0]),c[4]),c[7]=b.toJSON(c[4]),function(a){b.logger(a).mustfix(a)}(c[7]),f=[void 0,void 0,void 0],c[0]=f[0],c[1]=f[1],c[2]=f[2]):(e=d.item,b.sequence([function(d){return c[11]=e.offlineThreadingId,c[12]=e.messageId,c[22]=e.threadAttributionSource,c[9]=e.platformRef,c[10]=e.platformToken,c[8]=e.replySourceId,c[13]=e.replySourceType,c[21]=e.sendType,c[23]=e.markThreadRead,c[14]=e.initiatingSource,c[15]=e.skipUrlPreviewGen,c[17]=e.textHasLinks,c[18]=e.dataclassParams,c[19]=e.multitabEnv,c[20]=e.metadataDataclass,c[16]=e.richTextFormatType,b.db.table(12).fetch([[[c[11]]],"optimistic"]).next().then(function(e,f){var d=e.done;e=e.value;return d?(c[24]=b.createArray(),c[25]=(c[24].push("OTID not found"),c[24]),c[26]=(c[24].push(c[11]),c[24]),c[27]=b.toJSON(c[24]),function(a){b.logger(a).mustfix(a)}(c[27]),d=[void 0,void 0,void 0],c[4]=d[0],c[5]=d[1],c[6]=d[2]):(f=e.item,b.sequence([function(d){return c[32]=f.text,c[28]=f.threadKey,c[33]=f.messageId,c[41]=f.senderId,c[30]=f.stickerId,c[35]=f.mentionOffsets,c[36]=f.mentionLengths,c[29]=f.mentionIds,c[37]=f.mentionTypes,c[40]=f.replyType,c[38]=f.isForwarded,c[34]=f.forwardScore,c[39]=f.hotEmojiSize,c[31]=f.metadataDataclass,b.db.table(9).fetch([[[c[28]]]]).next().then(function(e,g){var d=e.done;e=e.value;return d?(c[42]=b.createArray(),c[43]=(c[42].push("thread not found"),c[42]),c[44]=(c[42].push(c[28]),c[42]),c[45]=b.toJSON(c[42]),function(a){b.logger(a).mustfix(a)}(c[45]),d=[void 0,void 0,void 0],c[24]=d[0],c[25]=d[1],c[26]=d[2]):(g=e.item,b.sequence([function(d){return c[49]=g.threadName,c[48]=g.threadKey,c[50]=g.mailboxType,c[42]=g.threadType,c[51]=g.capabilities,c[52]=g.capabilities2,c[53]=g.capabilities3,c[54]=g.capabilities4,c[55]=g.capabilities5,b.db.table(2).fetch([[[a[0]]]]).next().then(function(e,f){var d=e.done;e=e.value;return d?c[43]=!1:(f=e.item,b.sequence([function(d){return b.islc(b.db.table(2).fetch([[[f.queueName]],"queueNameTaskId"]),0,b.i64.to_float(b.i64.cast([0,1]))).next().then(function(e,f){var d=e.done;e=e.value;return d?c[56]=!1:(f=e.item,c[56]=b.i64.eq(f.taskId,a[0]))})},function(a){return c[43]=c[56]}]))})},function(a){return b.i64.eq(g.authorityLevel,b.i64.cast([0,20]))&&(b.i64.eq(c[42],b.i64.cast([0,2]))||b.i64.eq(c[42],b.i64.cast([0,5]))||b.i64.eq(c[42],b.i64.cast([0,26])))&&c[43]?b.sequence([function(a){return c[59]=c[21]==null?b.i64.cast([0,1]):c[21],b.db.table(9).fetch([[[c[28]]]]).next().then(function(d,e){var a=d.done;d=d.value;return a?c[56]=b.i64.cast([0,1]):(e=d.item,c[74]=e.syncGroup,b.i64.neq(c[74],void 0)?c[73]=c[74]:c[73]=b.i64.cast([0,1]),c[56]=c[73])})},function(a){return c[58]=new b.Map(),c[58].set("thread_id",c[28]),c[58].set("otid",c[11]),c[58].set("source",c[22]==null?b.i64.cast([0,0]):c[22]),c[58].set("send_type",b.i64.cast([0,1])),c[58].set("sync_group",c[56]),c[58].set("mark_thread_read",c[23]),b.i64.eq(c[59],b.i64.cast([0,1]))?b.resolve(c[58].set("text",c[32])):b.i64.eq(c[59],b.i64.cast([0,2]))?b.resolve(b.i64.neq(c[30],void 0)?(c[58].set("sticker_id",c[30]),c[58].set("send_type",c[59])):0):b.i64.eq(c[59],b.i64.cast([0,7]))?b.sequence([function(a){return b.db.table(16).fetch([[[c[28],c[33]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?(a=[void 0,void 0],c[73]=a[0],c[74]=a[1],a):(d=b.item,a=[d.filename,d.attributionAppId],c[73]=a[0],c[74]=a[1])})},function(a){return c[73]!==void 0?b.i64.neq(c[74],void 0)?(c[58].set("url",c[73]),c[58].set("attribution_app_id",c[74]),c[58].set("send_type",c[59]),c[31]!==void 0?c[58].set("metadata_dataclass",c[31]):0):0:0}]):b.i64.eq(c[59],b.i64.cast([0,3]))?b.sequence([function(a){return c[58].set("text",c[32]),c[73]=b.createArray(),c[74]=b.createArray(),b.forEach(b.sortBy(b.db.table(16).fetch([[[c[28],c[33]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[75]=a.offlineAttachmentId,c[76]=(c[73].push(b.i64.from_string(a.attachmentFbid)),c[73]),c[75]!==void 0?c[76]=(c[74].push(c[75]),c[74]):0})},function(a){return c[58].set("attachment_fbids",c[73]),b.i64.eq(c[59],b.i64.cast([0,9]))?c[58].set("offline_attachment_ids",c[74]):0,c[58].set("send_type",c[59])}]):b.i64.eq(c[59],b.i64.cast([0,9]))?b.sequence([function(a){return c[58].set("text",c[32]),c[73]=b.createArray(),c[74]=b.createArray(),b.forEach(b.sortBy(b.db.table(16).fetch([[[c[28],c[33]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[75]=a.offlineAttachmentId,c[76]=(c[73].push(b.i64.from_string(a.attachmentFbid)),c[73]),c[75]!==void 0?c[76]=(c[74].push(c[75]),c[74]):0})},function(a){return c[58].set("attachment_fbids",c[73]),b.i64.eq(c[59],b.i64.cast([0,9]))?c[58].set("offline_attachment_ids",c[74]):0,c[58].set("send_type",c[59])}]):b.i64.eq(c[59],b.i64.cast([0,4]))?b.sequence([function(a){return b.db.table(16).fetch([[[c[28],c[33]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?c[73]=void 0:(d=b.item,c[73]=d.attachmentFbid)})},function(a){return b.db.table(16).fetch([[[c[28],c[33]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?c[75]=void 0:(d=b.item,c[75]=d.actionUrl)})},function(a){return c[73]!==void 0?(c[58].set("text",c[32]),c[75]!==void 0?c[58].set("url",c[75]):0,c[58].set("forwarded_share_id",c[73]),c[58].set("send_type",c[59])):0}]):b.i64.eq(c[59],b.i64.cast([0,5]))?b.resolve(c[12]!==void 0?(c[58].set("forwarded_msg_id",c[12]),c[58].set("send_type",c[59]),b.i64.neq(c[34],void 0)?c[58].set("forward_score",c[34]):0,c[58].set("strip_forwarded_msg_caption",!1)):0):b.i64.eq(c[59],b.i64.cast([0,6]))?b.sequence([function(a){return b.db.table(16).fetch([[[c[28],c[33]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?(a=[void 0,void 0],c[73]=a[0],c[74]=a[1],a):(d=b.item,a=[d.filename,d.attributionAppId],c[73]=a[0],c[74]=a[1])})},function(a){return c[73]!==void 0?(c[58].set("url",c[73]),c[58].set("text",c[32]),c[58].set("send_type",c[59])):0}]):b.i64.eq(c[59],b.i64.cast([0,11]))?b.sequence([function(a){return b.db.table(16).fetch([[[c[28],c[33]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?(a=[void 0,void 0],c[73]=a[0],c[74]=a[1],a):(d=b.item,a=[d.actionUrl,d.attributionAppId],c[73]=a[0],c[74]=a[1])})},function(a){return c[73]!==void 0?(c[58].set("url",c[73]),c[58].set("text",c[32]),c[58].set("send_type",c[59])):0}]):b.resolve(0)},function(a){return c[69]=c[8]===""?void 0:c[8],c[69]!==void 0?b.i64.neq(c[13],void 0)?(c[73]=new b.Map(),c[73].set("reply_source_id",c[69]),c[73].set("reply_source_type",c[13]),c[73].set("reply_type",c[40]==null?b.i64.cast([0,0]):c[40]),c[73].set("reply_source_attachment_id",void 0),c[58].set("reply_metadata",c[73])):0:0,c[70]=c[29]===""?void 0:c[29],c[70]!==void 0?(c[73]=c[35]===""?void 0:c[35],c[73]!==void 0?(c[74]=c[36]===""?void 0:c[36],c[74]!==void 0?(c[75]=new b.Map(),c[75].set("mention_ids",c[70]),c[75].set("mention_offsets",c[73]),c[75].set("mention_lengths",c[74]),c[75].set("mention_types",c[37]===""?void 0:c[37]),c[58].set("mention_data",c[75])):0):0):0,c[38]!==void 0?c[58].set("is_forwarded",c[38]):0,c[71]=c[9]===""?void 0:c[9],c[71]!==void 0?c[58].set("platform_ref",c[71]):0,c[72]=c[10]===""?void 0:c[10],c[72]!==void 0?c[58].set("platform_token",c[72]):0,[b.i64.cast([0,1]),b.i64.cast([0,2])].some(function(a){return b.i64.eq(c[59],a)})?b.i64.neq(c[39],void 0)?c[58].set("hot_emoji_size",c[39]):0:0,b.i64.neq(c[14],void 0)?c[58].set("initiating_source",c[14]):0,c[15]!==void 0?c[58].set("skip_url_preview_gen",c[15]):0,b.i64.neq(c[16],void 0)?c[58].set("rich_text_format_type",c[16]):0,b.resolve()},function(a){return c[17]!==void 0?c[58].set("text_has_links",c[17]):0,c[18]!==void 0?c[58].set("dataclass_params",c[18]):0,c[19]!==void 0?c[58].set("multitab_env",c[19]):0,c[20]!==void 0?c[58].set("metadata_dataclass",c[20]):0,b.filter(b.db.table(14).fetch([[[c[48],c[41]]]]),function(a){return b.i64.eq(a.threadKey,c[48])&&b.i64.eq(b.i64.cast([0,0]),c[50])&&b.i64.eq(a.contactId,c[41])}).next().then(function(d,e){var a=d.done;d=d.value;return a?c[60]=!1:(e=d.item,b.i64.eq(c[42],b.i64.cast([0,152]))?(c[74]=e.threadRoles,b.i64.lt(b.i64.cast([0,7]),b.i64.cast([0,0]))||b.i64.gt(b.i64.cast([0,7]),b.i64.cast([0,7]))?c[75]=!1:c[75]=!b.i64.eq(b.i64.and_(b.i64.lsl_(b.i64.cast([0,1]),b.i64.to_int32(b.i64.cast([0,7]))),c[74]),b.i64.cast([0,0])),c[76]=c[51],c[77]=c[52],c[78]=c[53],c[79]=c[54],c[80]=c[55],c[82]=b.i64.div(b.i64.cast([0,223]),b.i64.cast([0,64])),c[83]=b.i64.lsl_(b.i64.cast([0,1]),b.i64.to_int32(b.i64.sub(b.i64.cast([0,223]),b.i64.mul(c[82],b.i64.cast([0,64]))))),b.i64.lt(b.i64.cast([0,223]),b.i64.cast([0,0]))||b.i64.gt(b.i64.cast([0,223]),b.i64.cast([0,285]))?c[81]=!1:(b.i64.eq(c[82],b.i64.cast([0,0]))?c[84]=!b.i64.eq(b.i64.and_(c[83],c[76]),b.i64.cast([0,0])):(b.i64.eq(c[82],b.i64.cast([0,1]))?c[85]=!b.i64.eq(b.i64.and_(c[83],c[77]),b.i64.cast([0,0])):(b.i64.eq(c[82],b.i64.cast([0,2]))?c[86]=!b.i64.eq(b.i64.and_(c[83],c[78]),b.i64.cast([0,0])):(b.i64.eq(c[82],b.i64.cast([0,3]))?c[87]=!b.i64.eq(b.i64.and_(c[83],c[79]),b.i64.cast([0,0])):(b.i64.eq(c[82],b.i64.cast([0,4]))?c[88]=!b.i64.eq(b.i64.and_(c[83],c[80]),b.i64.cast([0,0])):c[88]=!1,c[87]=c[88]),c[86]=c[87]),c[85]=c[86]),c[84]=c[85]),c[81]=c[84]),c[75]===c[81]?0:(function(a){b.logger(a).mustfix(a)}("LS::assert is failed. Thread role and thread capability don't agree for Broadcast Channels message-as-page functionality; aborting"),b["throw"]("LS::assert is failed. Thread role and thread capability don't agree for Broadcast Channels message-as-page functionality; aborting")),c[73]=c[75]):c[73]=!1,c[60]=c[73])})},function(a){return c[60]?c[58].set("perform_action_as_page",!0):0,c[62]=b.createArray(),b.forEach(b.db.table(14).fetch([[[c[28]]]]),function(a){a=a.item;return c[73]=(c[62].push(a.contactId),c[62])})},function(a){return c[63]=new b.Map(),c[63].set("participants",c[62]),c[63].set("send_payload",c[58]),c[49]!==void 0?c[63].set("thread_name",c[49]):0,b.db.table(312).fetch([[[c[28]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?c[64]=void 0:(d=b.item,c[64]=d.metadata)})},function(a){return c[63].set("thread_metadata",c[64]),b.forEach(b.db.table(9).fetch([[[c[48]]]]),function(a){var b=a.update;a.item;return b({otidOfFirstMessage:f.offlineThreadingId})})},function(a){return c[64]===void 0||!1?(b.i64.eq(c[42],b.i64.cast([0,5]))||b.i64.eq(c[42],b.i64.cast([0,26]))?(function(a){b.logger(a).mustfix(a)}("For Marketplace & community chat subthreads, thread metadata cannot be null"),a=[void 0,void 0,void 0],c[73]=a[0],c[74]=a[1],c[75]=a[2]):(c[76]=b.toJSON(c[63]),a=[c[76],b.i64.cast([0,130]),void 0],c[73]=a[0],c[74]=a[1],c[75]=a[2]),a=[c[73],c[74],c[75]],c[66]=a[0],c[67]=a[1],c[68]=a[2]):(b.i64.eq(c[42],b.i64.cast([0,5]))?(c[76]=b.toJSON(c[63]),a=[c[76],b.i64.cast([0,645]),void 0],c[73]=a[0],c[74]=a[1],c[75]=a[2]):(b.i64.eq(c[42],b.i64.cast([0,2]))?(c[79]=b.toJSON(c[63]),a=[c[79],b.i64.cast([0,787]),void 0],c[76]=a[0],c[77]=a[1],c[78]=a[2]):(c[79]=b.toJSON(c[63]),a=[c[79],b.i64.cast([0,645]),void 0],c[76]=a[0],c[77]=a[1],c[78]=a[2]),a=[c[76],c[77],c[78]],c[73]=a[0],c[74]=a[1],c[75]=a[2]),a=[c[73],c[74],c[75]],c[66]=a[0],c[67]=a[1],c[68]=a[2]),a=[c[66],c[67],c[68]],c[45]=a[0],c[46]=a[1],c[47]=a[2]}]):b.sequence([function(a){return c[59]=c[21]==null?b.i64.cast([0,1]):c[21],b.db.table(9).fetch([[[c[28]]]]).next().then(function(d,e){var a=d.done;d=d.value;return a?c[56]=b.i64.cast([0,1]):(e=d.item,c[68]=e.syncGroup,b.i64.neq(c[68],void 0)?c[67]=c[68]:c[67]=b.i64.cast([0,1]),c[56]=c[67])})},function(a){return c[58]=new b.Map(),c[58].set("thread_id",c[28]),c[58].set("otid",c[11]),c[58].set("source",c[22]==null?b.i64.cast([0,0]):c[22]),c[58].set("send_type",b.i64.cast([0,1])),c[58].set("sync_group",c[56]),c[58].set("mark_thread_read",c[23]),b.i64.eq(c[59],b.i64.cast([0,1]))?b.resolve(c[58].set("text",c[32])):b.i64.eq(c[59],b.i64.cast([0,2]))?b.resolve(b.i64.neq(c[30],void 0)?(c[58].set("sticker_id",c[30]),c[58].set("send_type",c[59])):0):b.i64.eq(c[59],b.i64.cast([0,7]))?b.sequence([function(a){return b.db.table(16).fetch([[[c[28],c[33]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?(a=[void 0,void 0],c[67]=a[0],c[68]=a[1],a):(d=b.item,a=[d.filename,d.attributionAppId],c[67]=a[0],c[68]=a[1])})},function(a){return c[67]!==void 0?b.i64.neq(c[68],void 0)?(c[58].set("url",c[67]),c[58].set("attribution_app_id",c[68]),c[58].set("send_type",c[59]),c[31]!==void 0?c[58].set("metadata_dataclass",c[31]):0):0:0}]):b.i64.eq(c[59],b.i64.cast([0,3]))?b.sequence([function(a){return c[58].set("text",c[32]),c[67]=b.createArray(),c[68]=b.createArray(),b.forEach(b.sortBy(b.db.table(16).fetch([[[c[28],c[33]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[69]=a.offlineAttachmentId,c[70]=(c[67].push(b.i64.from_string(a.attachmentFbid)),c[67]),c[69]!==void 0?c[70]=(c[68].push(c[69]),c[68]):0})},function(a){return c[58].set("attachment_fbids",c[67]),b.i64.eq(c[59],b.i64.cast([0,9]))?c[58].set("offline_attachment_ids",c[68]):0,c[58].set("send_type",c[59])}]):b.i64.eq(c[59],b.i64.cast([0,9]))?b.sequence([function(a){return c[58].set("text",c[32]),c[67]=b.createArray(),c[68]=b.createArray(),b.forEach(b.sortBy(b.db.table(16).fetch([[[c[28],c[33]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[69]=a.offlineAttachmentId,c[70]=(c[67].push(b.i64.from_string(a.attachmentFbid)),c[67]),c[69]!==void 0?c[70]=(c[68].push(c[69]),c[68]):0})},function(a){return c[58].set("attachment_fbids",c[67]),b.i64.eq(c[59],b.i64.cast([0,9]))?c[58].set("offline_attachment_ids",c[68]):0,c[58].set("send_type",c[59])}]):b.i64.eq(c[59],b.i64.cast([0,4]))?b.sequence([function(a){return b.db.table(16).fetch([[[c[28],c[33]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?c[67]=void 0:(d=b.item,c[67]=d.attachmentFbid)})},function(a){return b.db.table(16).fetch([[[c[28],c[33]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?c[69]=void 0:(d=b.item,c[69]=d.actionUrl)})},function(a){return c[67]!==void 0?(c[58].set("text",c[32]),c[69]!==void 0?c[58].set("url",c[69]):0,c[58].set("forwarded_share_id",c[67]),c[58].set("send_type",c[59])):0}]):b.i64.eq(c[59],b.i64.cast([0,5]))?b.resolve(c[12]!==void 0?(c[58].set("forwarded_msg_id",c[12]),c[58].set("send_type",c[59]),b.i64.neq(c[34],void 0)?c[58].set("forward_score",c[34]):0,c[58].set("strip_forwarded_msg_caption",!1)):0):b.i64.eq(c[59],b.i64.cast([0,6]))?b.sequence([function(a){return b.db.table(16).fetch([[[c[28],c[33]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?(a=[void 0,void 0],c[67]=a[0],c[68]=a[1],a):(d=b.item,a=[d.filename,d.attributionAppId],c[67]=a[0],c[68]=a[1])})},function(a){return c[67]!==void 0?(c[58].set("url",c[67]),c[58].set("text",c[32]),c[58].set("send_type",c[59])):0}]):b.i64.eq(c[59],b.i64.cast([0,11]))?b.sequence([function(a){return b.db.table(16).fetch([[[c[28],c[33]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?(a=[void 0,void 0],c[67]=a[0],c[68]=a[1],a):(d=b.item,a=[d.actionUrl,d.attributionAppId],c[67]=a[0],c[68]=a[1])})},function(a){return c[67]!==void 0?(c[58].set("url",c[67]),c[58].set("text",c[32]),c[58].set("send_type",c[59])):0}]):b.resolve(0)},function(a){return c[63]=c[8]===""?void 0:c[8],c[63]!==void 0?b.i64.neq(c[13],void 0)?(c[67]=new b.Map(),c[67].set("reply_source_id",c[63]),c[67].set("reply_source_type",c[13]),c[67].set("reply_type",c[40]==null?b.i64.cast([0,0]):c[40]),c[67].set("reply_source_attachment_id",void 0),c[58].set("reply_metadata",c[67])):0:0,c[64]=c[29]===""?void 0:c[29],c[64]!==void 0?(c[67]=c[35]===""?void 0:c[35],c[67]!==void 0?(c[68]=c[36]===""?void 0:c[36],c[68]!==void 0?(c[69]=new b.Map(),c[69].set("mention_ids",c[64]),c[69].set("mention_offsets",c[67]),c[69].set("mention_lengths",c[68]),c[69].set("mention_types",c[37]===""?void 0:c[37]),c[58].set("mention_data",c[69])):0):0):0,c[38]!==void 0?c[58].set("is_forwarded",c[38]):0,c[65]=c[9]===""?void 0:c[9],c[65]!==void 0?c[58].set("platform_ref",c[65]):0,c[66]=c[10]===""?void 0:c[10],c[66]!==void 0?c[58].set("platform_token",c[66]):0,[b.i64.cast([0,1]),b.i64.cast([0,2])].some(function(a){return b.i64.eq(c[59],a)})?b.i64.neq(c[39],void 0)?c[58].set("hot_emoji_size",c[39]):0:0,b.i64.neq(c[14],void 0)?c[58].set("initiating_source",c[14]):0,c[15]!==void 0?c[58].set("skip_url_preview_gen",c[15]):0,b.i64.neq(c[16],void 0)?c[58].set("rich_text_format_type",c[16]):0,b.resolve()},function(a){return c[17]!==void 0?c[58].set("text_has_links",c[17]):0,c[18]!==void 0?c[58].set("dataclass_params",c[18]):0,c[19]!==void 0?c[58].set("multitab_env",c[19]):0,c[20]!==void 0?c[58].set("metadata_dataclass",c[20]):0,b.filter(b.db.table(14).fetch([[[c[48],c[41]]]]),function(a){return b.i64.eq(a.threadKey,c[48])&&b.i64.eq(b.i64.cast([0,0]),c[50])&&b.i64.eq(a.contactId,c[41])}).next().then(function(d,e){var a=d.done;d=d.value;return a?c[60]=!1:(e=d.item,b.i64.eq(c[42],b.i64.cast([0,152]))?(c[68]=e.threadRoles,b.i64.lt(b.i64.cast([0,7]),b.i64.cast([0,0]))||b.i64.gt(b.i64.cast([0,7]),b.i64.cast([0,7]))?c[69]=!1:c[69]=!b.i64.eq(b.i64.and_(b.i64.lsl_(b.i64.cast([0,1]),b.i64.to_int32(b.i64.cast([0,7]))),c[68]),b.i64.cast([0,0])),c[70]=c[51],c[71]=c[52],c[72]=c[53],c[73]=c[54],c[74]=c[55],c[76]=b.i64.div(b.i64.cast([0,223]),b.i64.cast([0,64])),c[77]=b.i64.lsl_(b.i64.cast([0,1]),b.i64.to_int32(b.i64.sub(b.i64.cast([0,223]),b.i64.mul(c[76],b.i64.cast([0,64]))))),b.i64.lt(b.i64.cast([0,223]),b.i64.cast([0,0]))||b.i64.gt(b.i64.cast([0,223]),b.i64.cast([0,285]))?c[75]=!1:(b.i64.eq(c[76],b.i64.cast([0,0]))?c[78]=!b.i64.eq(b.i64.and_(c[77],c[70]),b.i64.cast([0,0])):(b.i64.eq(c[76],b.i64.cast([0,1]))?c[79]=!b.i64.eq(b.i64.and_(c[77],c[71]),b.i64.cast([0,0])):(b.i64.eq(c[76],b.i64.cast([0,2]))?c[80]=!b.i64.eq(b.i64.and_(c[77],c[72]),b.i64.cast([0,0])):(b.i64.eq(c[76],b.i64.cast([0,3]))?c[81]=!b.i64.eq(b.i64.and_(c[77],c[73]),b.i64.cast([0,0])):(b.i64.eq(c[76],b.i64.cast([0,4]))?c[82]=!b.i64.eq(b.i64.and_(c[77],c[74]),b.i64.cast([0,0])):c[82]=!1,c[81]=c[82]),c[80]=c[81]),c[79]=c[80]),c[78]=c[79]),c[75]=c[78]),c[69]===c[75]?0:(function(a){b.logger(a).mustfix(a)}("LS::assert is failed. Thread role and thread capability don't agree for Broadcast Channels message-as-page functionality; aborting"),b["throw"]("LS::assert is failed. Thread role and thread capability don't agree for Broadcast Channels message-as-page functionality; aborting")),c[67]=c[69]):c[67]=!1,c[60]=c[67])})},function(a){return c[60]?c[58].set("perform_action_as_page",!0):0,c[62]=b.toJSON(c[58]),a=[c[62],b.i64.cast([0,46]),void 0],c[45]=a[0],c[46]=a[1],c[47]=a[2]}])},function(a){return a=[c[45],c[46],c[47]],c[24]=a[0],c[25]=a[1],c[26]=a[2],a}]))})},function(a){return a=[c[24],c[25],c[26]],c[4]=a[0],c[5]=a[1],c[6]=a[2],a}]))})},function(a){return a=[c[4],c[5],c[6]],c[0]=a[0],c[1]=a[1],c[2]=a[2],a}]))})},function(a){return a=[c[0],c[1]],d[0]=a[0],d[1]=a[1],a}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxTaskSerializerSendMessageV2StoredProcedure";a.__tables__=["messages_optimistic_context","messages","threads","pending_tasks","attachments","participants","threads_optimistic_metadata"];e.exports=a}),null);
__d("LSTaskSerializerSyncThreadCapabilities",[],(function(a,b,c,d,e,f){function a(){var a,b=arguments,c=b[b.length-1],d=[];return a=[void 0,void 0,void 0],d[0]=a[0],d[1]=a[1],d[2]=a[2],c.resolve(d)}a.__sproc_name__="LSMailboxTaskSerializerSyncThreadCapabilitiesStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSIsExperimentCapabilityEnabled.nop",["LSACSExperimentCapability","LSIntEnum","MetaConfig","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("MetaConfig")._("87"),k=c("MetaConfig")._("156");a=function(a,e,f,g){switch((i||(i=d("LSIntEnum"))).toNumber(f)){case c("LSACSExperimentCapability").BUMP_TOKEN_SYNC_TASK_AT_TASK_SERIALIZATION:return(h||(h=b("Promise"))).resolve([k]);case c("LSACSExperimentCapability").INSERT_PENDING_TASK_PARENT_ROW_WHEN_NO_ACS_TOKENS_AT_TASK_INSERTION:return(h||(h=b("Promise"))).resolve([!1]);case c("LSACSExperimentCapability").RETRY_AFTER_TASK_SERIALIZATION_FAILURE_EXPONENTIAL_BACKOFF:return(h||(h=b("Promise"))).resolve([j])}return(h||(h=b("Promise"))).resolve([!1])};a.__nop_name__="LSIsExperimentCapabilityEnabled";g["default"]=a}),98);
__d("LSVoprfHmac.nop",["ACSCipherSuiteModule","ACSTokenHmacUtil","XPlatReactTextEncoder"],(function(a,b,c,d,e,f,g){"use strict";a=async function(a,b,c,e){a=d("ACSCipherSuiteModule").getACSCipherSuiteByValue(d("ACSCipherSuiteModule").VOPRF_RISTRETTO_HMACSHA512.value);if(!a)return Promise.resolve([void 0]);b=await d("ACSTokenHmacUtil").hmac(a.macAlgorithm,new Uint8Array(e).slice(),new(d("XPlatReactTextEncoder").TextEncoder)().encode(c));return Promise.resolve([b.buffer])};a.__nop_name__="LSVoprfHmac";g.default=a}),98);
__d("LSTaskSerializerUnauthenticatedTask",["LSArrayGetObjectAt","LSBase64Encode.nop","LSIsExperimentCapabilityEnabled.nop","LSMailboxTaskCompletionApiOnTaskCompletion","LSRemoveUsedTokens","LSVoprfHmac.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(b){return c.db.table(311).fetch([[[a[0]]]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[0]=void 0:(b=a.item,d[0]=b.projectName)})},function(e){return d[0]!==void 0?c.sequence([function(e){return a[1]!==void 0?c.sequence([function(a){return d[9]=c.createArray(),d[10]=c.i64.of_float(Date.now()),c.forEach(c.filter(c.db.table(307).fetch(),function(a){return d[0]===a.projectName&&c.i64.gt(a.expirationTimestampMs,d[10])}),function(a){a=a.item;return d[16]=(d[9].push(a.configId),d[9])})},function(a){return c.sequence([function(a){return d[16]=c.createArray(),d[17]=c.i64.of_int32(d[9].length),c.i64.gt(d[17],c.i64.cast([0,0]))?c.loopAsync(d[17],function(a){return d[19]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[9],d[19]).then(function(a){return a=a,d[20]=a[0],d[21]=a[1],a})},function(a){return d[22]=(d[16].push(d[20]),d[16])}])}):c.resolve()},function(a){return d[18]=d[16].join(","),d[11]=d[18]}])},function(e){return c.filter(c.db.table(309).fetch(),function(a){return d[9].includes(a.configId)&&c.i64.gt(a.redeemLimit,c.i64.cast([0,0]))}).next().then(function(e,f){var g=e.done;e=e.value;return g?c.sequence([function(a){return c.nativeOperation(b("LSIsExperimentCapabilityEnabled.nop"),c.i64.cast([0,0]),d[0]).then(function(a){return a=a,d[16]=a[0],a})},function(e){return d[16]?c.sequence([function(b){return c.db.table(311).fetch([[[a[0]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[20]=c.i64.cast([0,0]):(e=b.item,d[20]=e.failureCount)})},function(b){return c.forEach(c.db.table(311).fetch([[[a[0]]]]),function(a){a=a.item;return c.forEach(c.db.table(311).fetch([[[a.taskId]]]),function(a){var b=a.update;a.item;return b({failureCount:c.i64.add(d[20],c.i64.cast([0,1]))})})})},function(a){return a=[void 0,void 0,c.i64.mul(c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.mod_(d[20],c.i64.cast([0,7])))),c.i64.cast([0,500]))],d[17]=a[0],d[18]=a[1],d[19]=a[2],a}]):c.sequence([function(d){return c.storedProcedure(b("LSMailboxTaskCompletionApiOnTaskCompletion"),a[0],!1)},function(b){return d[20]=c.createArray(),d[21]=(d[20].push("Unauthenticated Task Serializer: no valid tokens"),d[20]),d[22]=(d[20].push(a[0]),d[20]),d[23]=(d[20].push(d[0]),d[20]),d[24]=c.toJSON(d[20]),function(a){c.logger(a).mustfix(a)}(d[24]),b=[void 0,void 0,void 0],d[17]=b[0],d[18]=b[1],d[19]=b[2]}])},function(a){return a=[d[17],d[18],d[19]],d[12]=a[0],d[13]=a[1],d[14]=a[2],a}]):(f=e.item,c.sequence([function(e){return d[20]=f.tokenId,c.nativeOperation(b("LSVoprfHmac.nop"),a[2]==null?"":a[2],f.sharedSecret).then(function(a){return a=a,d[16]=a[0],a})},function(e){return c.blobs.neq(d[16],void 0)?c.sequence([function(a){return c.forEach(c.db.table(309).fetch([[[d[20]]]]),function(a){var b=a.update;a=a.item;return b({redeemLimit:c.i64.sub(a.redeemLimit,c.i64.cast([0,1]))})})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[16]).then(function(a){return a=a,d[21]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),f.nonce).then(function(a){return a=a,d[22]=a[0],a})},function(b){return d[23]=new c.Map(),d[23].set("config_id",f.configId),d[23].set("tag",d[21]==null?"":d[21]),d[23].set("aux",d[22]==null?"":d[22]),d[23].set("project_name",d[0]),d[24]=c.toJSON(d[23]),d[25]=new c.Map(),d[25].set("payload",a[2]==null?"":a[2]),d[25].set("token",d[24]),d[26]=c.toJSON(d[25]),b=[d[26],c.i64.from_string(a[1]),void 0],d[17]=b[0],d[18]=b[1],d[19]=b[2]}]):c.sequence([function(a){return c.forEach(c.db.table(309).fetch([[[d[20]]]]),function(a){return a["delete"]()})},function(d){return c.storedProcedure(b("LSMailboxTaskCompletionApiOnTaskCompletion"),a[0],!1)},function(b){return d[21]=c.createArray(),d[22]=(d[21].push("Unauthenticated Task Serializer: hmac failed"),d[21]),d[23]=(d[21].push(a[0]),d[21]),d[24]=c.toJSON(d[21]),function(a){c.logger(a).mustfix(a)}(d[24]),b=[void 0,void 0,void 0],d[17]=b[0],d[18]=b[1],d[19]=b[2]}])},function(a){return a=[d[17],d[18],d[19]],d[12]=a[0],d[13]=a[1],d[14]=a[2],a}]))})},function(a){return a=[d[12],d[13],d[14]],d[6]=a[0],d[7]=a[1],d[8]=a[2],a}]):c.sequence([function(d){return c.storedProcedure(b("LSMailboxTaskCompletionApiOnTaskCompletion"),a[0],!1)},function(b){return d[9]=c.createArray(),d[10]=(d[9].push("Unauthenticated Task Serializer: task has no write label"),d[9]),d[11]=(d[9].push(a[0]),d[9]),d[12]=c.toJSON(d[9]),function(a){c.logger(a).mustfix(a)}(d[12]),b=[void 0,void 0,void 0],d[6]=b[0],d[7]=b[1],d[8]=b[2]}])},function(a){return a=[d[6],d[7],d[8]],d[2]=a[0],d[3]=a[1],d[4]=a[2],a}]):c.sequence([function(d){return c.storedProcedure(b("LSMailboxTaskCompletionApiOnTaskCompletion"),a[0],!1)},function(b){return d[6]=c.createArray(),d[7]=(d[6].push("Unauthenticated Task Serializer: anonymous_task_context row not found"),d[6]),d[8]=(d[6].push(a[0]),d[6]),d[9]=c.toJSON(d[6]),function(a){c.logger(a).mustfix(a)}(d[9]),b=[void 0,void 0,void 0],d[2]=b[0],d[3]=b[1],d[4]=b[2]}])},function(a){return c.storedProcedure(b("LSRemoveUsedTokens"))},function(a){return d[0]!==void 0?c.sequence([function(a){return c.nativeOperation(b("LSIsExperimentCapabilityEnabled.nop"),c.i64.cast([0,1]),d[0]).then(function(a){return a=a,d[6]=a[0],a})},function(a){return d[6]?c.sequence([function(a){return c.i64.neq(d[4],void 0)?c.resolve(d[8]=!0):c.sequence([function(a){return d[10]=c.createArray(),d[11]=c.i64.of_float(Date.now()),c.forEach(c.filter(c.db.table(307).fetch(),function(a){return d[0]===a.projectName&&c.i64.gt(a.expirationTimestampMs,d[11])}),function(a){a=a.item;return d[15]=(d[10].push(a.configId),d[10])})},function(a){return c.sequence([function(a){return d[15]=c.createArray(),d[16]=c.i64.of_int32(d[10].length),c.i64.gt(d[16],c.i64.cast([0,0]))?c.loopAsync(d[16],function(a){return d[18]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[10],d[18]).then(function(a){return a=a,d[19]=a[0],d[20]=a[1],a})},function(a){return d[21]=(d[15].push(d[19]),d[15])}])}):c.resolve()},function(a){return d[17]=d[15].join(","),d[12]=d[17]}])},function(a){return c.filter(c.db.table(309).fetch(),function(a){return d[10].includes(a.configId)&&c.i64.gt(a.redeemLimit,c.i64.cast([0,0]))}).next().then(function(a,b){b=a.done;a=a.value;return b?d[13]=!0:(a.item,d[13]=!1)})},function(a){return d[8]=d[13]}])},function(a){return d[8]?c.sequence([function(a){return c.filter(c.db.table(310).fetch(),function(a){return a.projectName===d[0]}).next().then(function(a,b){var c=a.done;a=a.value;return c?d[10]=void 0:(b=a.item,d[10]=b.taskId)})},function(a){return d[9]=d[10]}]):c.resolve(d[9]=void 0)},function(a){return d[7]=d[9]}]):c.resolve(d[7]=void 0)},function(a){return d[5]=d[7]}]):c.resolve(d[5]=void 0)},function(a){return a=[d[2],d[3],d[4],d[5]],e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=a[3],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSAnonymousCredentialsTaskSerializerUnauthenticatedTaskStoredProcedure";a.__tables__=["anonymous_task_context","secure_acs_configurations","secure_acs_tokens","acs_request_context"];e.exports=a}),null);
__d("LSTaskSerializerUpdateThreadName",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(e){return b.sequence([function(d){return b.db.table(32).fetch([[[a[0]]]]).next().then(function(d,e){var f=d.done;d=d.value;return f?(c[4]=b.createArray(),c[5]=(c[4].push("taskSerializerUpdateThreadName: Task ID not found"),c[4]),c[6]=(c[4].push(a[0]),c[4]),c[7]=b.toJSON(c[4]),function(a){b.logger(a).mustfix(a)}(c[7]),f=[void 0,void 0,void 0],c[0]=f[0],c[1]=f[1],c[2]=f[2]):(e=d.item,b.sequence([function(a){return c[8]=e.threadKey,b.db.table(9).fetch([[[c[8]]]]).next().then(function(d,e){var a=d.done;d=d.value;return a?(c[9]=b.createArray(),c[10]=(c[9].push("taskSerializerUpdateThreadName: Thread not found"),c[9]),c[11]=(c[9].push(c[8]),c[9]),c[12]=b.toJSON(c[9]),function(a){b.logger(a).mustfix(a)}(c[12]),a=[void 0,void 0,void 0],c[4]=a[0],c[5]=a[1],c[6]=a[2]):(e=d.item,b.sequence([function(a){return b.db.table(9).fetch([[[c[8]]]]).next().then(function(d,e){var a=d.done;d=d.value;return a?c[9]=b.i64.cast([0,1]):(e=d.item,c[14]=e.syncGroup,b.i64.neq(c[14],void 0)?c[13]=c[14]:c[13]=b.i64.cast([0,1]),c[9]=c[13])})},function(a){return c[11]=new b.Map(),c[11].set("thread_key",c[8]),c[11].set("thread_name",e.threadName==null?"":e.threadName),c[11].set("sync_group",c[9]),c[12]=b.toJSON(c[11]),a=[c[12],b.i64.cast([0,32]),void 0],c[4]=a[0],c[5]=a[1],c[6]=a[2]}]))})},function(a){return a=[c[4],c[5],c[6]],c[0]=a[0],c[1]=a[1],c[2]=a[2],a}]))})},function(a){return a=[c[0],c[1],c[2]],d[0]=a[0],d[1]=a[1],d[2]=a[2],a}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxTaskSerializerUpdateThreadNameStoredProcedure";a.__tables__=["threads_optimistic_context","threads"];e.exports=a}),null);
__d("LSSerializeTask",["LSForceTaskExecutionImmediately","LSLogMebClientEvent.nop","LSTaskSerializerAcsIssueNextSync","LSTaskSerializerDeleteChatHistory","LSTaskSerializerE2eeMessageIntegrityCheckV2","LSTaskSerializerE2eeMetadataThreadIntegrityCheck","LSTaskSerializerEncryptedBackupAction","LSTaskSerializerEncryptedBackupsLoopingUpload","LSTaskSerializerEncryptedBackupsOpenUpload","LSTaskSerializerEncryptedBackupsRestoreWithSerializer","LSTaskSerializerEncryptedBackupsUpload","LSTaskSerializerEncryptedBackupsUploadProtobufOnly","LSTaskSerializerEncryptedBackupsUploadSenderBackup","LSTaskSerializerMuteThreadV2","LSTaskSerializerRemoveThread","LSTaskSerializerSendMessageV2","LSTaskSerializerSyncThreadCapabilities","LSTaskSerializerUnauthenticatedTask","LSTaskSerializerUpdateThreadName"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return a[1]==="46"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerSendMessageV2"),a[0]).then(function(a){return a=a,d[8]=a[0],d[9]=a[1],a})},function(a){return a=[d[8],c.i64.to_string(d[9]),void 0,void 0],d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3],a}]):c.sequence([function(e){return a[1]==="144"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerMuteThreadV2"),a[0]).then(function(a){return a=a,d[12]=a[0],d[13]=a[1],a})},function(a){return a=[d[12],c.i64.to_string(d[13]),void 0,void 0],d[8]=a[0],d[9]=a[1],d[10]=a[2],d[11]=a[3],a}]):c.sequence([function(e){return a[1]==="146"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerRemoveThread"),a[0]).then(function(a){return a=a,d[16]=a[0],d[17]=a[1],a})},function(a){return a=[d[16],c.i64.to_string(d[17]),void 0,void 0],d[12]=a[0],d[13]=a[1],d[14]=a[2],d[15]=a[3],a}]):c.sequence([function(e){return a[1]==="32"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerUpdateThreadName"),a[0]).then(function(a){return a=a,d[20]=a[0],d[21]=a[1],d[22]=a[2],a})},function(a){return a=[d[20],c.i64.to_string(d[21]),void 0,d[22]],d[16]=a[0],d[17]=a[1],d[18]=a[2],d[19]=a[3],a}]):c.sequence([function(e){return a[1]==="362"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerAcsIssueNextSync"),a[0]).then(function(a){return a=a,d[24]=a[0],d[25]=a[1],d[26]=a[2],a})},function(a){return a=[d[24],c.i64.to_string(d[25]),void 0,d[26]],d[20]=a[0],d[21]=a[1],d[22]=a[2],d[23]=a[3],a}]):c.sequence([function(e){return a[1]==="50015"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerEncryptedBackupsRestoreWithSerializer"),a[0]).then(function(a){return a=a,d[28]=a[0],d[29]=a[1],d[30]=a[2],a})},function(a){return a=[d[28],c.i64.to_string(d[29]),void 0,d[30]],d[24]=a[0],d[25]=a[1],d[26]=a[2],d[27]=a[3],a}]):c.sequence([function(e){return a[1]==="319"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerEncryptedBackupAction"),a[0]).then(function(a){return a=a,d[32]=a[0],d[33]=a[1],d[34]=a[2],a})},function(a){return a=[d[32],c.i64.to_string(d[33]),void 0,d[34]],d[28]=a[0],d[29]=a[1],d[30]=a[2],d[31]=a[3],a}]):c.sequence([function(e){return a[1]==="50026"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerEncryptedBackupsUpload"),a[0]).then(function(a){return a=a,d[36]=a[0],d[37]=a[1],a})},function(a){return a=[d[36],c.i64.to_string(d[37]),void 0,void 0],d[32]=a[0],d[33]=a[1],d[34]=a[2],d[35]=a[3],a}]):c.sequence([function(e){return a[1]==="50042"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerEncryptedBackupsUploadProtobufOnly"),a[0]).then(function(a){return a=a,d[40]=a[0],d[41]=a[1],d[42]=a[2],a})},function(a){return a=[d[40],c.i64.to_string(d[41]),void 0,d[42]],d[36]=a[0],d[37]=a[1],d[38]=a[2],d[39]=a[3],a}]):c.sequence([function(e){return a[1]==="700"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerE2eeMetadataThreadIntegrityCheck"),a[0]).then(function(a){return a=a,d[44]=a[0],d[45]=a[1],d[46]=a[2],a})},function(a){return a=[d[44],c.i64.to_string(d[45]),void 0,d[46]],d[40]=a[0],d[41]=a[1],d[42]=a[2],d[43]=a[3],a}]):c.sequence([function(e){return a[1]==="705"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerE2eeMessageIntegrityCheckV2"),a[0]).then(function(a){return a=a,d[48]=a[0],d[49]=a[1],d[50]=a[2],a})},function(a){return a=[d[48],c.i64.to_string(d[49]),void 0,d[50]],d[44]=a[0],d[45]=a[1],d[46]=a[2],d[47]=a[3],a}]):c.sequence([function(e){return a[1]==="50043"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerEncryptedBackupsLoopingUpload"),a[0]).then(function(a){return a=a,d[52]=a[0],d[53]=a[1],d[54]=a[2],a})},function(a){return a=[d[52],c.i64.to_string(d[53]),void 0,d[54]],d[48]=a[0],d[49]=a[1],d[50]=a[2],d[51]=a[3],a}]):c.sequence([function(e){return a[1]==="50048"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerEncryptedBackupsOpenUpload"),a[0]).then(function(a){return a=a,d[56]=a[0],d[57]=a[1],a})},function(a){return a=[d[56],c.i64.to_string(d[57]),void 0,void 0],d[52]=a[0],d[53]=a[1],d[54]=a[2],d[55]=a[3],a}]):c.sequence([function(e){return a[1]==="160013"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerSyncThreadCapabilities"),a[0]).then(function(a){return a=a,d[60]=a[0],d[61]=a[1],d[62]=a[2],a})},function(a){return a=[d[60],c.i64.to_string(d[61]),void 0,d[62]],d[56]=a[0],d[57]=a[1],d[58]=a[2],d[59]=a[3],a}]):c.sequence([function(e){return a[1]==="903"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerDeleteChatHistory"),a[0]).then(function(a){return a=a,d[64]=a[0],d[65]=a[1],d[66]=a[2],a})},function(a){return a=[d[64],c.i64.to_string(d[65]),void 0,d[66]],d[60]=a[0],d[61]=a[1],d[62]=a[2],d[63]=a[3],a}]):c.sequence([function(e){return a[1]==="50057"?c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerEncryptedBackupsUploadSenderBackup"),a[0]).then(function(a){return a=a,d[68]=a[0],d[69]=a[1],d[70]=a[2],a})},function(a){return a=[d[68],c.i64.to_string(d[69]),void 0,d[70]],d[64]=a[0],d[65]=a[1],d[66]=a[2],d[67]=a[3],a}]):c.resolve((e=[a[2],a[1],void 0,void 0],d[64]=e[0],d[65]=e[1],d[66]=e[2],d[67]=e[3],e))},function(a){return a=[d[64],d[65],d[66],d[67]],d[60]=a[0],d[61]=a[1],d[62]=a[2],d[63]=a[3],a}])},function(a){return a=[d[60],d[61],d[62],d[63]],d[56]=a[0],d[57]=a[1],d[58]=a[2],d[59]=a[3],a}])},function(a){return a=[d[56],d[57],d[58],d[59]],d[52]=a[0],d[53]=a[1],d[54]=a[2],d[55]=a[3],a}])},function(a){return a=[d[52],d[53],d[54],d[55]],d[48]=a[0],d[49]=a[1],d[50]=a[2],d[51]=a[3],a}])},function(a){return a=[d[48],d[49],d[50],d[51]],d[44]=a[0],d[45]=a[1],d[46]=a[2],d[47]=a[3],a}])},function(a){return a=[d[44],d[45],d[46],d[47]],d[40]=a[0],d[41]=a[1],d[42]=a[2],d[43]=a[3],a}])},function(a){return a=[d[40],d[41],d[42],d[43]],d[36]=a[0],d[37]=a[1],d[38]=a[2],d[39]=a[3],a}])},function(a){return a=[d[36],d[37],d[38],d[39]],d[32]=a[0],d[33]=a[1],d[34]=a[2],d[35]=a[3],a}])},function(a){return a=[d[32],d[33],d[34],d[35]],d[28]=a[0],d[29]=a[1],d[30]=a[2],d[31]=a[3],a}])},function(a){return a=[d[28],d[29],d[30],d[31]],d[24]=a[0],d[25]=a[1],d[26]=a[2],d[27]=a[3],a}])},function(a){return a=[d[24],d[25],d[26],d[27]],d[20]=a[0],d[21]=a[1],d[22]=a[2],d[23]=a[3],a}])},function(a){return a=[d[20],d[21],d[22],d[23]],d[16]=a[0],d[17]=a[1],d[18]=a[2],d[19]=a[3],a}])},function(a){return a=[d[16],d[17],d[18],d[19]],d[12]=a[0],d[13]=a[1],d[14]=a[2],d[15]=a[3],a}])},function(a){return a=[d[12],d[13],d[14],d[15]],d[8]=a[0],d[9]=a[1],d[10]=a[2],d[11]=a[3],a}])},function(a){return a=[d[8],d[9],d[10],d[11]],d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3],a}])},function(e){return a[3]?c.sequence([function(a){return d[9]="60009"===d[1]||"60006"===d[1]||"60008"===d[1]||"60011"===d[1]||"765"===d[1]||"1006"===d[1]||"160009"===d[1]||"761"===d[1]||"1018"===d[1]||"632"===d[1]||"384"===d[1]||"384"===d[1],d[9]?d[1]!==void 0?(d[15]=["Deidentified task is being executed through the 'identified' path. Canceling task with label: ",d[1]].join(""),function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][LSCoreSerializeTaskStoredProcedure] ","",d[15]].join("")),d[14]=c.createArray(),void 0!==void 0?d[16]=(d[14].push(void 0),d[14]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSCoreSerializeTaskStoredProcedure",d[15],d[14],c.i64.cast([0,3]))):c.resolve():c.resolve()},function(a){return c.resolve(d[8]=!1)},function(a){return d[9]||d[8]?(a=[void 0,void 0,void 0,void 0],d[10]=a[0],d[11]=a[1],d[12]=a[2],d[13]=a[3],a):(a=[d[0],d[1],d[2],d[3]],d[10]=a[0],d[11]=a[1],d[12]=a[2],d[13]=a[3],a),a=[d[10],d[11],d[12],d[13]],d[4]=a[0],d[5]=a[1],d[6]=a[2],d[7]=a[3]}]):c.sequence([function(e){return c.storedProcedure(b("LSTaskSerializerUnauthenticatedTask"),a[0],d[1],d[0]).then(function(a){return a=a,d[8]=a[0],d[9]=a[1],d[10]=a[2],d[11]=a[3],a})},function(a){return c.i64.neq(d[11],void 0)?c.storedProcedure(b("LSForceTaskExecutionImmediately"),d[11]):c.resolve()},function(a){return a=[d[8],c.i64.to_string(d[9]),void 0,d[10]],d[4]=a[0],d[5]=a[1],d[6]=a[2],d[7]=a[3],a}])},function(a){return a=[d[4],d[5],d[6],d[7]],e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=a[3],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSCoreSerializeTaskStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSSerializeTaskStoredProcedure",["LSSerializeTask","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSSerializeTask"),e.taskId,e.taskLabel,e.taskValue,e.requiresAuthentication);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSBeginHandlingPendingTasksForQueue2",["I64","LSFactory","LSIntEnum","LSPendingTasksPluginType","LSSerializeTaskStoredProcedure","LSShape","LSVec","ReQL","XPlatReactCrypto","gkx","isNativeTask","qex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=500,k=3e4,l=5,m=(b=c("qex")._("4835"))!=null?b:50,n=7;async function o(a,b){a=await a.lightspeed_task_context.get(b);return a==null||a.requiresAuthentication}async function p(a,b){a=await d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.pending_tasks.index("queueNameTaskId")).getKeyRange(b));return a==null?{context:void 0,failureCount:(h||(h=d("I64"))).neg_one,httpUrlOverride:void 0,minTimeToSyncTimestampMs:h.neg_one,pluginType:(i||(i=d("LSIntEnum"))).ofNumber(c("LSPendingTasksPluginType").LS_BROKER),queueName:""}:a}async function q(a,b){a=await d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.network_requests).getKeyRange(b));return a==null?0:(h||(h=d("I64"))).to_float(a.lastSyncRequestTimestampMs)}function r(a,b,c){b=(h||(h=d("I64"))).equal(a.failureCount,(h||(h=d("I64"))).zero)||b;if(b)return 0;b=(h||(h=d("I64"))).to_float(a.failureCount)>n?(h||(h=d("I64"))).to_float(a.failureCount)-n:(h||(h=d("I64"))).to_float(a.failureCount);a=Math.min((1<<Math.min(b-1,n))*j,k);b=c+a;return Math.max(b-Date.now(),0)}function s(){var a=Array.from(d("XPlatReactCrypto").getRandomValues(new Uint32Array(2)));a[0]>>>=1;return(h||(h=d("I64"))).add(h.lsl_(h.of_float(a[0]),32),h.of_float(a[1]))}function t(){var a=(h||(h=d("I64"))).of_float(Date.now());return h.and_(h.or_(h.lsl_(a,22),h.and_(s(),h.castExn([0,4194303]))),h.castExn([2147483647,4294967295]))}async function u(a,b){var c=t(),e=await a.network_requests.get(b,(h||(h=d("I64"))).neg_one);e==null?await a.network_requests.add({epochId:c,failureCount:(h||(h=d("I64"))).zero,lastSentTimestampMs:h.zero,lastSyncRequestTimestampMs:h.of_float(Date.now()),syncDatabaseId:h.neg_one,taskQueueName:b}):await a.network_requests.put(babelHelpers.extends({},e,{epochId:c,lastSyncRequestTimestampMs:(h||(h=d("I64"))).of_float(Date.now())}));return c}async function v(a,b){return await d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.network_requests).getKeyRange(b).filter(function(a){return a.epochId!=null}))!=null}function w(a,b,c){var e=(h||(h=d("I64"))).to_float(a.minTimeToSyncTimestampMs),f=Date.now();e=e-f;f=e<=0;return f?r(a,b,c):e}function x(a){return a.httpUrlOverride!=null||(h||(h=d("I64"))).to_float(a.failureCount)>n}function y(a){return a.timeoutTimestampMs!=null?(h||(h=d("I64"))).to_float(a.timeoutTimestampMs)<=Date.now():!1}function z(a){return a===90..toString()||a===130..toString()||a===153..toString()}function A(a,b,c,d,e){e=e===0?void 0:e;return{failureCount:e,label:a,payload:b,queueName:c,taskId:d}}async function B(a,b,e){a=await c("LSSerializeTaskStoredProcedure")(c("LSFactory")(a),{requiresAuthentication:e,taskId:b.taskId,taskLabel:b.context,taskValue:b.taskValue});e=a[0];var f=a[1];a[2];a=a[3];if(e==null){if(a!=null)return{minRetryDelayMs:a};return}return A(f,e,b.queueName,b.taskId,(h||(h=d("I64"))).to_float(b.failureCount))}async function C(a,b,c){if(b.context==null){await a.pending_tasks.delete(b.taskId);return}var d=y(b);if(d){await a.pending_tasks.delete(b.taskId);return}return B(a,b,c)}function D(a,b){b=b>=(c("gkx")("26373")&&a===String(207)?m:l)||z(a);return!b}async function E(a,b){var c=await a.pending_tasks.get(b.taskId);c!=null&&(h||(h=d("I64"))).equal(b.firstExecutedTimestampMs,(h||(h=d("I64"))).zero)&&await a.pending_tasks.put(babelHelpers.extends({},c,{firstExecutedTimestampMs:(h||(h=d("I64"))).of_float(Date.now())}))}async function F(a,b){if(b.length===0)return{epochId:void 0,tasks:[]};var c=[],e=b[0].httpUrlOverride,f=(await Promise.all(b.map(function(b){return o(a,b.taskId)}))).some(Boolean);for(b of b){var g=b.httpUrlOverride===e,i=await o(a,b.taskId)===f;await E(a,b);if(!g||!i)break;g=await C(a,b,f);if(g!=null&&g.payload!=null)c.push(g);else if((g==null?void 0:g.minRetryDelayMs)!=null){i=await a.pending_tasks.get(b.taskId);if(i!=null){await a.pending_tasks.put(babelHelpers.extends({},i,{failureCount:(h||(h=d("I64"))).add((i=i.failureCount)!=null?i:(h||(h=d("I64"))).zero,h.one),minTimeToSyncTimestampMs:h.add(g.minRetryDelayMs,h.of_float(Date.now()))}))}}else await a.pending_tasks.delete(b.taskId);if(!D(b.context,c.length))break}return{epochId:void 0,tasks:c}}async function G(a,b,c,d,e){e===void 0&&(e=!0);b=await F(a,b);var f=b.tasks;if(f.length===0)return{httpUrlOverride:void 0,networkPayload:void 0,nextSyncMs:void 0,queueName:c,skipRealtimeGateway:!1,workItemType:4};if(e===!0){f=await u(a,c);b.epochId=f}e=await p(a,c);return{httpUrlOverride:e.httpUrlOverride,networkPayload:b,nextSyncMs:void 0,queueName:c,skipRealtimeGateway:x(e),workItemType:d}}async function H(a,b,e){var f=await p(a,b),g=await q(a,b);f=w(f,e,g);e=f!==0;if(e)return[{httpUrlOverride:void 0,networkPayload:void 0,nextSyncMs:f,queueName:b,skipRealtimeGateway:!1,workItemType:3}];g=[];e=await d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.pending_tasks.index("queueNameTaskId")).getKeyRange(b));f=e.filter(c("isNativeTask"));if(f.length>0){f=await G(a,f,b,2,c("gkx")("4778")===!0);g.push(f)}f=e.filter(function(a){return!c("isNativeTask")(a)});if(f.length>0){e=await G(a,f,b,1);g.push(e)}return g}async function I(a,b,c){var d=!await v(a,b);return d?H(a,b,c):[{httpUrlOverride:void 0,networkPayload:void 0,nextSyncMs:void 0,queueName:b,skipRealtimeGateway:!1,workItemType:4}]}async function a(a,b){var e=b.ignoreSoftDelay;b=b.queueName;a=await I(a,b,e);return a.map(function(a){var b;return d("LSShape").ofRecord({network_payload:d("LSShape").ofRecord({epoch_id:(b=a.networkPayload)==null?void 0:b.epochId,tasks:c("LSVec").ofArray(((b=(b=a.networkPayload)==null?void 0:b.tasks)!=null?b:[]).map(function(a){var b;return d("LSShape").ofRecord({failure_count:a.failureCount!=null?(h||(h=d("I64"))).of_float(a.failureCount):void 0,label:(b=a.label)!=null?b:void 0,payload:a.payload,queue_name:a.queueName,task_id:a.taskId})}))}),next_sync_ms:a.nextSyncMs!=null?(h||(h=d("I64"))).of_float(a.nextSyncMs):void 0,queue_name:a.queueName,skip_realtime_gateway:a.skipRealtimeGateway,work_item_type:(i||(i=d("LSIntEnum"))).ofNumber(a.workItemType)})})}a._updateTaskIfNeeded=E;a._getHeadOfNormalQueue=p;a._lastSyncRequestTimestampForQueue=q;a._exponentialBackoffForNormalQueue=r;a._generateNewEpoch=t;a._openNewEpochForQueue=u;a._isEpochOpenForQueue=v;a._calculateDelayForNormalQueue=w;a._queueShouldSkipRealtimeGateway=x;a._isNativeTask=c("isNativeTask");a._taskIsTimedOut=y;a._taskShouldStopBatching=z;a._buildTaskPayloadExpressionForNormalTaskWithParameters=A;a._buildTaskPayloadExpressionForValidatedNormalTask=B;a._buildTaskPayloadExpressionForUnvalidatedNormalTask=C;a._workForNormalQueueWithoutDelay=G;a._workForNormalQueueWithClosedEpoch=H;a._buildWorkForNormalQueue=I;a._buildNetworkPayloadShapeForTasks=F;a._canContinueBatchingForQueue=D;g.default=a}),98);
__d("LSDataTraceFlushDeferred",["MetaConfig","Promise","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("requireDeferred")("LSDataTraceFlush").__setRef("LSDataTraceFlushDeferred");function a(a){if(!c("MetaConfig")._("62"))return(h||(h=b("Promise"))).resolve(function(){});else return i.load().then(function(b){return b.flushExpiredDataTraces(a)})}g.watchForExpiredTraces=a}),98);
__d("LSTruncateTableAndSetShowError",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(d){return b.sequence([function(a){return b.forEach(b.db.table(115).fetch(),function(a){return a["delete"]()})},function(d){return c[0]=b.i64.of_float(Date.now()),b.db.table(115).add({statusId:b.i64.cast([0,0]),timestampMs:c[0],errorShouldBeShown:a[0]})}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSConnectivityTruncateTableAndSetShowErrorStoredProcedure";a.__tables__=["user_visible_network_connectivity_error"];e.exports=a}),null);
__d("LSDeleteAllAndInsertConnectivityStatus",["LSTruncateTableAndSetShowError"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(a){return c.forEach(c.db.table(114).fetch(),function(a){return a["delete"]()})},function(b){return d[0]=c.i64.of_float(Date.now()),c.db.table(114).add({statusId:void 0,timestampMs:d[0],internetConnectionState:a[0]})},function(d){return c.storedProcedure(b("LSTruncateTableAndSetShowError"),c.i64.neq(a[0],c.i64.cast([0,1])))}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSConnectivityDeleteAllAndInsertConnectivityStatusStoredProcedure";a.__tables__=["connectivity_status"];e.exports=a}),null);
__d("LSDeleteAllAndInsertConnectivityStatusStoredProcedure",["LSDeleteAllAndInsertConnectivityStatus","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSDeleteAllAndInsertConnectivityStatus"),e.internetConnectionState);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSSyncStoredProcedureUtils",["I64","ReQL"],(function(a,b,c,d,e,f,g){"use strict";var h;async function i(a,b,c){c=c!=null?(h||(h=d("I64"))).of_float(Date.now()+c):b.minTimeToSyncTimestampMs;await a.pending_tasks.put(babelHelpers.extends({},b,{failureCount:(h||(h=d("I64"))).add(b.failureCount,h.one),minTimeToSyncTimestampMs:c}))}async function a(a,b,c){b=await d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.pending_tasks.index("queueNameTaskId")).getKeyRange(b));if(b==null)return;return i(a,b,c)}async function b(a,b,c){b=await a.network_requests.get(b,c);if(b==null)return;await a.network_requests.put(babelHelpers.extends({},b,{failureCount:(h||(h=d("I64"))).add(b==null?void 0:b.failureCount,h.one)}))}async function c(a,b,c){b=await a.network_requests.get(b,c);if(b==null)return;await a.network_requests.put(babelHelpers.extends({},b,{epochId:void 0,networkTaskIdentifier:void 0}))}g.incrementPendingTaskFailureCount=i;g.incrementPendingTasksTaskFailureCount=a;g.incrementNetworkRequestsTaskFailureCount=b;g.closeEpoch=c}),98);
__d("LSHandleTaskSendFailureForQueue2",["I64","LSSyncStoredProcedureUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;async function a(a,b,c){await d("LSSyncStoredProcedureUtils").incrementPendingTasksTaskFailureCount(a,b,c),await d("LSSyncStoredProcedureUtils").incrementNetworkRequestsTaskFailureCount(a,b,(h||(h=d("I64"))).neg_one),await d("LSSyncStoredProcedureUtils").closeEpoch(a,b,h.neg_one)}g.default=a}),98);
__d("LSHandleTaskSendSuccessForQueue2",["I64"],(function(a,b,c,d,e,f,g){"use strict";var h;async function a(a,b){var c=await a.network_requests.get(b,(h||(h=d("I64"))).neg_one);if(c==null||c.epochId==null)return;await a.network_requests.delete(b,h.neg_one)}g.default=a}),98);
__d("LSIssueMessageRangeQueryTaskStoredProcedure",["LSIssueMessageRangeQueryTask","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSIssueMessageRangeQueryTask"),e.threadId,e.numMessages,e.startSortKey,e.isPointQuery,e.traceId,e.newerNumMessages,e.source,e.includeOffset);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSPlatformTaskSyncGroupId",[],(function(a,b,c,d,e,f){"use strict";a=-1;b=a;f["default"]=b}),66);
__d("MWPBeginHandlingPendingTasksForQueue",["LSBeginHandlingFireForgetTasksForQueueStoredProcedure","LSBeginHandlingPendingTasksForQueue2","LSFactory"],(function(a,b,c,d,e,f,g){"use strict";async function a(a,b){var d=b.fireAndForgetTask,e=b.ignoreSoftDelay,g=b.queueName;b=await a.runInTransaction(async function(a){if(d===!0){var b=await c("LSBeginHandlingFireForgetTasksForQueueStoredProcedure")(c("LSFactory")(a),{queueName:g});b=b[0];return[b]}return c("LSBeginHandlingPendingTasksForQueue2")(a,{ignoreSoftDelay:e,queueName:g})},"readwrite",void 0,void 0,f.id+":37");return b}g.default=a}),98);
__d("MWPlatformTaskUtils",["FBLogger","I64","JSScheduler","MetaConfig","ReQL","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a,b){async function e(){try{await a(b)}catch(a){c("FBLogger")("messenger_web").catching(a).warn("Failed to calculate work for task queue %s",b.queueName)}}if((i||(i=d("I64"))).gt(b.priority,(i||(i=d("I64"))).zero)&&c("MetaConfig")._("78")){var f=function(){e()};(h||(h=c("JSScheduler"))).scheduleLoggingPriCallback(f)}else c("promiseDone")(e())}async function k(a,b){try{await a(b)}catch(a){c("FBLogger")("messenger_web").catching(a).warn("Failed to calculate work for fire forget queue %s",b.queueName)}}function a(a,b){var c=new Set(),e=[],f=[];f.push(a.tables.pending_tasks.index("queueNameTaskId").subscribe(function(a,b){var f;if(b.operation==="delete"){c.add(a[0]);return}a=b.operation==="put"&&b.prevValue==null||b.operation==="add";f=b.operation==="put"&&(i||(i=d("I64"))).compare(b.value.failureCount,(f=(f=b.prevValue)==null?void 0:f.failureCount)!=null?f:(i||(i=d("I64"))).zero)>0;(a||f)&&c.add(b.value.queueName);(b.operation==="add"&&b.value.dataTraceId==null||b.value.dataTraceId==="")&&e.push(b.value)}));f.push(a.tables.network_requests.subscribe(function(a,b){a=a[0];if(a==="")return;b.operation==="delete"?c.add(a):b.value.epochId==null&&c.add(a)}));f.push(a.subscribeToCommit(function(){var f=Array.from(c);c.clear();e=[];f.forEach(async function(c){c=await d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.tables.pending_tasks.index("queueNameTaskId")).bounds({gte:[c]}));c!=null&&j(b,c)})}));return f}function b(a,b){c("promiseDone")(async function(){var c=await d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.tables.pending_tasks)),e=new Set();for(c of c){if(e.has(c.queueName))continue;e.add(c.queueName);j(b,c)}}())}function l(a,b){c("promiseDone")(async function(){var e=await d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.tables.pending_fire_and_forget_tasks));await Promise.all(e.map(function(a){return k(b,a)}));c("promiseDone")(a.runInTransaction(function(a){return Promise.all(e.map(function(b){return a.pending_fire_and_forget_tasks.delete(b.taskId)}))},"readwrite","background",void 0,f.id+":196"))}())}function e(a,b){var c=!1,d=[];d.push(a.tables.pending_fire_and_forget_tasks.subscribe(function(a,b){if(b.operation==="delete")return;a=b.operation==="put"&&b.prevValue==null||b.operation==="add";a&&(c=!0)}));d.push(a.subscribeToCommit(function(){c&&l(a,b),c=!1}));return d}g.checkQueuesWhenPendingTaskTableUpdates=a;g.checkAllPendingTasksForWork=b;g.checkAllFireForgetTasksForWork=l;g.checkQueuesWhenPendingFireForgetTaskTableUpdates=e}),98);
__d("LSPlatformTaskSystemTransport",["CurrentMessengerUser","FBLogger","I64","JSResourceForInteraction","JSScheduler","LSDatabaseProviderType","LSHandleTaskSendFailureForQueue2","LSHandleTaskSendSuccessForQueue2","LSIntEnum","LSJson","LSMailboxInitialSyncCursor","LSPlatformRealtimeTransport","LSPlatformRequestId","LSPlatformRequestScheduler","LSPlatformServerResponseHandler","LSPlatformTaskSyncGroupId","LSShape","LSVec","MWPBeginHandlingPendingTasksForQueue","MWPBumpEntityKey","MWPlatformTaskUtils","ReQL","cr:4031","cr:6668","gkx","promiseDone","qex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=500,l=c("JSResourceForInteraction")("publishLSPlatformDeidentifiedPayload").__setRef("LSPlatformTaskSystemTransport"),m=new Set([632,765,60011,1006,1018].map(function(a){return a.toString()}));a=function(){function a(a,b,e,f){var g=this;this.key="ls";this.$8=!1;this.$18=async function(a,b){b=await c("MWPBeginHandlingPendingTasksForQueue")(g.$1,{ignoreSoftDelay:b,queueName:a});for(a of b)await g.$17(d("LSShape").toRecord(a))};this.$1=a;this.$2=b;this.$3=e;this.$4=f;this.$8=d("LSDatabaseProviderType").isProviderPersisted(a);this.$5=new(c("LSPlatformRequestScheduler"))();this.$6=new(c("LSPlatformServerResponseHandler"))(e);this.$7=this.$9();this.$10()}var e=a.prototype;e.$11=async function(a,b){var d=a.filter(function(a){return a.label!=null&&m.has(a.label)});if(d.length<a.length){d.length>0&&c("FBLogger")("maw_ohai").mustfix("Deidentifed tasks label %s sent together with normal tasks",d[0].label);a=await this.$2.publish(b);return a}a=d[0];d=await l.load();d=await d(babelHelpers.extends({},b,{taskLabel:a.label}));return d};e.$12=async function(a){await this.$1.runInTransaction(function(b){return c("LSHandleTaskSendFailureForQueue2")(b,a)},"readwrite",void 0,void 0,f.id+":150")};e.$13=async function(a){await this.$1.runInTransaction(function(b){return c("LSHandleTaskSendSuccessForQueue2")(b,a)},"readwrite","background",void 0,f.id+":159")};e.$14=async function(a){a=c("LSVec").toArray(a.tasks).slice(0).map(function(a){return d("LSShape").toRecord(a)});a=a[0];if(a==null)return;a=await d("ReQL").firstAsync(d("ReQL").fromTableAscending(this.$1.tables.pending_tasks).getKeyRange(a.task_id));return a==null?void 0:a.dataTraceId};e.$15=async function(a,e){var f=this;if(a.network_payload==null)return;var g=d("LSShape").toRecord(a.network_payload);(j||(j=c("JSScheduler"))).scheduleLoggingPriCallback(function(){return g&&(b("cr:6668")==null?void 0:b("cr:6668").recordTaskSending(g.tasks))});var i=this.$4;try{await Promise.all(c("LSVec").toArray(g.tasks).map(function(a){return d("LSShape").toRecord(a)}).map(function(b){var g=c("LSPlatformRequestId").generate();return f.$11([b],{databaseType:c("LSPlatformTaskSyncGroupId"),payload:d("LSJson").stringify(d("LSShape").ofRecord({label:b.label,payload:b.payload,version:i})),queueName:a.queue_name,requestId:g,syncChannel:d("LSMailboxInitialSyncCursor").taskChannel,type_:(h||(h=d("I64"))).of_int32(e)})}))}catch(a){}};e.$16=async function(a,e){if(a.network_payload==null)return;var f=d("LSShape").toRecord(a.network_payload),g=c("LSVec").toArray(f.tasks).map(function(a){return d("LSShape").toRecord(a)}),k=await this.$14(f);(j||(j=c("JSScheduler"))).scheduleLoggingPriCallback(function(){return f&&(b("cr:6668")==null?void 0:b("cr:6668").recordTaskSending(f.tasks))});var l=c("LSPlatformRequestId").generate(),m,n=c("qex")._("789");if(n!=null&&n!=="default"){var o=n+"."+(i||(i=d("LSIntEnum"))).toNumber(d("LSMailboxInitialSyncCursor").taskChannel)+"."+e.toString();d("MWPBumpEntityKey").bumpEntityKeyWithAppId("messenger.lightspeed",o)}try{m=await this.$11(g,{databaseType:c("LSPlatformTaskSyncGroupId"),payload:d("LSJson").stringify(d("LSShape").ofRecord(babelHelpers.extends({},f,{version_id:this.$4},k==null?{}:{data_trace_id:k}))),queueName:a.queue_name,requestId:l,syncChannel:d("LSMailboxInitialSyncCursor").taskChannel,type_:(h||(h=d("I64"))).of_int32(e)})}catch(b){if(n!=null&&n!=="default"){o=n+"."+(i||(i=d("LSIntEnum"))).toNumber(d("LSMailboxInitialSyncCursor").taskChannel)+"."+e.toString();d("MWPBumpEntityKey").bumpEntityKeyWithAppId("messenger.lightspeed",o+".exception");b.RE_EXN_ID===d("LSPlatformRealtimeTransport").Timeout?d("MWPBumpEntityKey").bumpEntityKeyWithAppId("messenger.lightspeed",o+".exception.timeout"):b.RE_EXN_ID===d("LSPlatformRealtimeTransport").NotConnected&&d("MWPBumpEntityKey").bumpEntityKeyWithAppId("messenger.lightspeed",o+".exception.notconnected")}b.RE_EXN_ID===d("LSPlatformRealtimeTransport").Timeout?d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_tasks","send_fail_timeout"):b.RE_EXN_ID===d("LSPlatformRealtimeTransport").NotConnected?(d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_tasks","send_fail_notconnected"),c("FBLogger")("messenger_web").warn("Publishing a task to the server not connected")):(d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_tasks","send_fail_generic"),c("FBLogger")("messenger_web").warn("Error while publishing a task for request: %s, error %s",e,JSON.stringify(b)));await this.$12(a.queue_name)}if(m!=null&&m.type==="taskresponse")try{k=m.downloadTask;var p=m.payload;l={experiments:p.ex,sp:p.sp,syncScript:p.payload,target:p.target,taskNames:g.map(function(a){return a.label}).filter(Boolean)};this.$8||c("gkx")("10470")?await this.$6.evalWhenReady(k,l):await this.$3(l);await this.$13(a.queue_name);(j||(j=c("JSScheduler"))).scheduleLoggingPriCallback(function(){return f&&(b("cr:6668")==null?void 0:b("cr:6668").recordTaskSent(f.tasks,p.payload))})}catch(b){d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_tasks","handle_task_failure"),c("FBLogger")("messenger_web").catching(b).mustfix("Encountered an error while processing a task response via realtime transport"),await this.$12(a.queue_name)}};e.decideWhatToDoWithTask=async function(a,b,e,f){var g=this,h=await c("MWPBeginHandlingPendingTasksForQueue")(a,{fireAndForgetTask:f,ignoreSoftDelay:!1,queueName:b,transportKey:e});c("promiseDone")(async function(){for(var a of h)await g.$17(d("LSShape").toRecord(a))}())};e.$17=async function(a){var e=this.$5,f=this.$18;function g(a,b){e.schedule(function(){c("promiseDone")(f(a,!1))},a,b!=null?(h||(h=d("I64"))).to_float(b):k)}var i=(h||(h=d("I64"))).to_int32(a.work_item_type);switch(i){case 1:await this.$16(a,3);break;case 5:await this.$15(a,4);break;case 3:g(a.queue_name,a.next_sync_ms);break;case 2:await b("cr:4031").handleLSWork(this.$1,a,d("CurrentMessengerUser").getAccountID());break;case 4:break;default:c("FBLogger")("messenger_web").warn("Unknown Task type of %s",i)}};e.$9=function(){var a=this,b=this.$1;return this.$2.onReconnect(function(e){if(d("LSMailboxInitialSyncCursor").isWebApp&&3===e&&c("qex")._("3198")===!0)return;c("promiseDone")(b.runInTransaction(async function(a){var b=await d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.network_requests).bounds({gte:d("ReQL").key("")}));await Promise.all(b.map(function(b){b=b.taskQueueName;return c("LSHandleTaskSendFailureForQueue2")(a,b)}))},"readwrite",void 0,void 0,f.id+":474"));a.$10()})};e.$10=function(){var a=this;d("MWPlatformTaskUtils").checkAllPendingTasksForWork(this.$1,function(b){b=b.queueName;return a.decideWhatToDoWithTask(a.$1,b)})};e.cleanup=function(){this.$7()};return a}();g.default=a}),98);
__d("LSProcessBackupIds",["LSAppendDataTraceAddon","LSIsMobileClient","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsProcessBackupIdsStoredProcedure] Beginning execution."),c.sequence([function(d){return a[0]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[0],c.i64.cast([0,1487]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[9]=a[0],a})},function(a){return d[9]?d[10]=!0:d[10]=!1,d[10]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[12]="LSDataTraceMciTraceLog native op not supported",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][MEBTraceUtils] ","",d[12]].join("")),d[11]=c.createArray(),void 0!==void 0?d[13]=(d[11].push(void 0),d[11]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils",d[12],d[11],c.i64.cast([0,3]))):c.resolve()}])},function(e){return c.db.table(172).fetch([[[c.i64.cast([0,1])]]]).next().then(function(e,f){var g=e.done;e=e.value;return g?c.sequence([function(e){return c.sequence([function(d){return a[0]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[0],c.i64.cast([0,1488]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[9]=a[0],a})},function(a){return d[9]?d[10]=!0:d[10]=!1,d[10]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[12]="LSDataTraceMciTraceLog native op not supported",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][MEBTraceUtils] ","",d[12]].join("")),d[11]=c.createArray(),void 0!==void 0?d[13]=(d[11].push(void 0),d[11]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils",d[12],d[11],c.i64.cast([0,3]))):c.resolve()}])},function(a){return d[1]=c.i64.cast([0,0])}]):(f=e.item,c.sequence([function(e){return d[11]=f.backupId,d[10]=f.authorityLevel,c.i64.eq(d[10],c.i64.cast([0,20]))?c.resolve(d[9]=c.i64.cast([0,1])):c.sequence([function(e){return c.i64.eq(d[10],c.i64.cast([0,80]))?c.sequence([function(e){return c.i64.eq(d[11],void 0)?c.sequence([function(e){return c.sequence([function(d){return a[0]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[0],c.i64.cast([0,1492]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[14]=a[0],a})},function(a){return d[14]?d[15]=!0:d[15]=!1,d[15]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[17]="LSDataTraceMciTraceLog native op not supported",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][MEBTraceUtils] ","",d[17]].join("")),d[16]=c.createArray(),void 0!==void 0?d[18]=(d[16].push(void 0),d[16]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils",d[17],d[16],c.i64.cast([0,3]))):c.resolve()}])},function(a){return d[13]=c.i64.cast([0,2])}]):c.sequence([function(e){return c.i64.eq(d[11],c.i64.cast([-1,4294967295]))?c.sequence([function(e){return c.sequence([function(d){return a[0]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[0],c.i64.cast([0,1489]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[15]=a[0],a})},function(a){return d[15]?d[16]=!0:d[16]=!1,d[16]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[18]="LSDataTraceMciTraceLog native op not supported",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][MEBTraceUtils] ","",d[18]].join("")),d[17]=c.createArray(),void 0!==void 0?d[19]=(d[17].push(void 0),d[17]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils",d[18],d[17],c.i64.cast([0,3]))):c.resolve()}])},function(a){return d[14]=c.i64.cast([-1,4294967295])}]):c.sequence([function(e){return c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.backupId,d[11])&&c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}).next().then(function(e,f){f=e.done;e=e.value;return f?c.sequence([function(e){return c.sequence([function(d){return a[0]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[0],c.i64.cast([0,1490]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[17]=a[0],a})},function(a){return d[17]?d[18]=!0:d[18]=!1,d[18]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[20]="LSDataTraceMciTraceLog native op not supported",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][MEBTraceUtils] ","",d[20]].join("")),d[19]=c.createArray(),void 0!==void 0?d[21]=(d[19].push(void 0),d[19]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils",d[20],d[19],c.i64.cast([0,3]))):c.resolve()}])},function(a){return d[15]=c.i64.cast([0,4])}]):(e.item,c.sequence([function(e){return c.sequence([function(d){return a[0]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[0],c.i64.cast([0,1491]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[17]=a[0],a})},function(a){return d[17]?d[18]=!0:d[18]=!1,d[18]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[20]="LSDataTraceMciTraceLog native op not supported",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][MEBTraceUtils] ","",d[20]].join("")),d[19]=c.createArray(),void 0!==void 0?d[21]=(d[19].push(void 0),d[19]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils",d[20],d[19],c.i64.cast([0,3]))):c.resolve()}])},function(a){return d[15]=c.i64.cast([0,3])}]))})},function(a){return d[14]=d[15]}])},function(a){return d[13]=d[14]}])},function(a){return d[12]=d[13]}]):c.sequence([function(e){return c.sequence([function(d){return a[0]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[0],c.i64.cast([0,1489]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[13]=a[0],a})},function(a){return d[13]?d[14]=!0:d[14]=!1,d[14]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[16]="LSDataTraceMciTraceLog native op not supported",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][MEBTraceUtils] ","",d[16]].join("")),d[15]=c.createArray(),void 0!==void 0?d[17]=(d[15].push(void 0),d[15]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils",d[16],d[15],c.i64.cast([0,3]))):c.resolve()}])},function(a){return d[12]=c.i64.cast([-1,4294967295])}])},function(a){return d[9]=d[12]}])},function(a){return d[1]=d[9]}]))})},function(a){return d[3]=c.i64.of_float(Date.now()),d[4]=c.i64.random(),d[6]="Finishing execution. Execution time: ",d[7]=c.i64.to_string(c.i64.sub(d[3],d[0])),d[8]=" ms",d[5]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsProcessBackupIdsStoredProcedure] ",d[5],d[6],d[5],d[7],d[5],d[8]].join("")),c.i64.eq(c.i64.mod_(d[4],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[9]=",",d[10]=c.createArray(),void 0!==void 0?d[11]=(d[10].push(void 0),d[10]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsProcessBackupIdsStoredProcedure",[d[6],d[9],d[7],d[9],d[8]].join(""),d[10],c.i64.cast([0,4]))):c.resolve()},function(a){return e[0]=d[1]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsProcessBackupIdsStoredProcedure";a.__tables__=["encrypted_backups","secure_encrypted_backups_client_state"];e.exports=a}),null);
__d("LSProcessBackupIdsStoredProcedure",["LSProcessBackupIds","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){e===void 0&&(e={});a=a.storedProcedure(c("LSProcessBackupIds"),e.traceId);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("MWEncryptedBackupsProcessBackupIdsDEPRECATED",["FBLogger","LSFactory","LSIntEnum","LSProcessBackupIdsStoredProcedure","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWEncryptedBackupsFirstRestoreUpsellTime","Promise","QPLEvent","QPLUserFlow","ReQL","WebSession","gkx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=c("gkx")("23914");function l(a){if(k){var e=d("MWEncryptedBackupsFirstRestoreUpsellTime").getFirstRestoreUpsellTime();c("QPLUserFlow").getActiveFlowIDs().includes((i||(i=d("QPLEvent"))).getMarkerId(d("MWChatEncryptedBackupsQPLEvents").processBackupIdsQPLEvent))||c("QPLUserFlow").start(d("MWChatEncryptedBackupsQPLEvents").processBackupIdsQPLEvent,{annotations:{string:{ebSessionIdentifier:e,processBackupIdsVersion:"msys",sessionTabId:d("WebSession").getId()}}});return a.runInTransaction(function(a){return c("LSProcessBackupIdsStoredProcedure")(c("LSFactory")(a))},"readwrite",void 0,void 0,f.id+":53").then(function(a){a=(j||(j=d("LSIntEnum"))).unwrapIntEnum(a[0]);c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").processBackupIdsQPLEvent,"EB_STATE_"+a+".");d("MWChatEncryptedBackupsLogging").endSuccess({event:d("MWChatEncryptedBackupsQPLEvents").processBackupIdsQPLEvent});return a})}else return(h||(h=b("Promise"))).resolve(0)}function a(a,b){return a.tables.encrypted_backups.subscribe(function(){c("promiseDone")(d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.tables.encrypted_backups)),function(d){if(d!=null){c("promiseDone")(l(a),b,function(a){c("FBLogger")("labyrinth_web").catching(a).info("Error in db transaction")});return}})})}g.processBackupIdsStoredProcedure=l;g.subscribeToEncryptedBackupsRow=a}),98);
__d("MWEncryptedBackupsListenForChangesToBackupStateInitPath",["EBAPIWorkerCheck","I64","LSAuthorityLevel","LSDataTraceType","LSEncryptedBackupsBackupTenancy","LSFactory","LSFetchBackupIdsStoredProcedure","LSIntEnum","LSIssueMessageRangeQueryTaskStoredProcedure","LSMEBTaskCreationSource","MAWEBRestoreTrackingUtils","MAWMainTraceUtils","MAWOfflineQueueStatus","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWEncryptedBackupsFirstRestoreUpsellTime","MWEncryptedBackupsProcessBackupIdsDEPRECATED","Promise","QPLEvent","QPLUserFlow","ReQL","WAJids","WATagsLogger","WebSession","gkx","isInstamadilloEB","promiseDone","qex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m=c("gkx")("23961"),n=c("qex")._("121")===!0;function a(a){function b(){var b=d("ReQL").fromTableAscending(a.tables.encrypted_backups),e=b.subscribe(function(a,b){if(b.operation==="delete"||!(j||(j=d("I64"))).equal(b.value.authorityLevel,(k||(k=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").AUTHORITATIVE)))return;e();c("QPLUserFlow").getActiveFlowIDs().includes((l||(l=d("QPLEvent"))).getMarkerId(d("MWChatEncryptedBackupsQPLEvents").fetchBackupIdsQPLEvent))&&d("MWChatEncryptedBackupsLogging").endSuccess({event:d("MWChatEncryptedBackupsQPLEvents").fetchBackupIdsQPLEvent})});b=d("MWEncryptedBackupsFirstRestoreUpsellTime").getFirstRestoreUpsellTime();c("QPLUserFlow").getActiveFlowIDs().includes((l||(l=d("QPLEvent"))).getMarkerId(d("MWChatEncryptedBackupsQPLEvents").fetchBackupIdsQPLEvent))||c("QPLUserFlow").start(d("MWChatEncryptedBackupsQPLEvents").fetchBackupIdsQPLEvent,{annotations:{string:{ebSessionIdentifier:b,fetchBackupIdsVersion:"msys",sessionTabId:d("WebSession").getId()}}});c("promiseDone")(a.runInTransaction(function(a){return c("LSFetchBackupIdsStoredProcedure")(c("LSFactory")(a),{backupTenancy:(k||(k=d("LSIntEnum"))).ofNumber(c("LSEncryptedBackupsBackupTenancy").PRODUCTION),isUiBlocking:!1})},"readwrite",void 0,void 0,f.id+":93"),function(){return p(a)})}(n||c("isInstamadilloEB")())&&b();var e=d("ReQL").fromTableAscending(a.tables.encrypted_backups_status_trigger);return e.subscribe(b)}function o(a){return a.runInTransaction(function(a){var e=d("MAWOfflineQueueStatus").getAllThreadsWithOfflineQueueIncomplete();return(i||(i=b("Promise"))).all(e.map(function(b){var e=d("WAJids").threadIdForChatJid(b),f=d("MAWMainTraceUtils").createTraceId();c("promiseDone")(d("MAWMainTraceUtils").startTraceWithTxn(a,(j||(j=d("I64"))).of_float(Date.now()),f,(k||(k=d("LSIntEnum"))).ofNumber(c("LSDataTraceType").ENCRYPTED_BACKUPS_RESTORE)));e={isPointQuery:!1,newerNumMessages:j.zero,numMessages:j.of_int32(20),source:k.ofNumber(c("LSMEBTaskCreationSource").UNKNOWN),threadId:e,traceId:f};d("WATagsLogger").TAGS(["labyrinth_web","eb_prefetch",f]).LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[EB Prefetch] Issuing message range query for thread "," with params ",""])),b,JSON.stringify(e));d("MAWEBRestoreTrackingUtils").markEBRestoreFrontloaded(c("LSMEBTaskCreationSource").UNKNOWN,f,!1);return c("LSIssueMessageRangeQueryTaskStoredProcedure")(c("LSFactory")(a),e)}))},"readonly",void 0,void 0,f.id+":122")}function p(a){var b=d("MAWOfflineQueueStatus").isOfflineQueueComplete();m&&!b&&c("promiseDone")(d("MWEncryptedBackupsProcessBackupIdsDEPRECATED").processBackupIdsStoredProcedure(a),function(b){if(d("EBAPIWorkerCheck").runningInWorker())return;b===3&&c("promiseDone")(o(a))})}e={listenForChangesToBackupState:a,preloadEBData:p};g["default"]=e}),98);
__d("MWPlatformTaskSystem",["LSPlatformRequestScheduler","MWPlatformTaskUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b){var e=this;this.$1=a;this.$2=b;this.$3=new(c("LSPlatformRequestScheduler"))();this.$4=d("MWPlatformTaskUtils").checkQueuesWhenPendingTaskTableUpdates(a,function(b){var c=b.queueName;b=b.transportKey;return e.$6(a,c,b,!1)});this.$5=d("MWPlatformTaskUtils").checkQueuesWhenPendingFireForgetTaskTableUpdates(a,function(b){var c=b.queueName;b=b.transportKey;return e.$6(a,c,b,!0)});this.$7()}var b=a.prototype;b.$6=async function(a,b,c,d){await this.$2.decideWhatToDoWithTask(a,b,c,d)};b.$7=function(){var a=this;d("MWPlatformTaskUtils").checkAllPendingTasksForWork(this.$1,function(b){b=b.queueName;return a.$6(a.$1,b)})};b.cleanup=function(){this.$4.forEach(function(a){return a()}),this.$5.forEach(function(a){return a()}),this.$2.cleanup()};return a}();g.default=a}),98);/*FB_PKG_DELIM*/
__d("LSFetchOTCEligibleEBDevicesV2",["LSIssueNewEbTaskAndGetTaskIDV2"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(a){return c.sequence([function(a){return c.forEach(c.db.table(261).fetch(),function(a){return a["delete"]()})},function(a){return d[0]="",c.forEach(c.filter(c.db.table(261).fetch([[[d[0]]]]),function(a){return a.deviceId===d[0]&&c.i64.lt(a.authorityLevel,c.i64.cast([0,20]))}),function(a){return a["delete"]()})},function(a){return c.db.table(261).add({deviceId:d[0],authorityLevel:c.i64.cast([0,20])})},function(a){return d[1]=new c.Map(),d[2]=c.toJSON(d[1]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),"meb_fetch_otc_eligible_devices",c.i64.cast([0,50028]),d[2],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[3]=a[0],a})}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsFetchOTCEligibleEBDevicesV2StoredProcedure";a.__tables__=["encrypted_backups_otc_devices"];e.exports=a}),null);
__d("LSFetchOTCEligibleEBDevicesV2StoredProcedure",["LSFetchOTCEligibleEBDevicesV2","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a){a=a.storedProcedure(c("LSFetchOTCEligibleEBDevicesV2"));return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("MWChatEncryptedBackupsAddonIcon.react",["MWAddOnCircleContainer.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(3),e=a.ariaHidden;a=a.icon;var f;b[0]!==e||b[1]!==a?(f=i.jsx(c("MWAddOnCircleContainer.react"),{ariaHidden:e,size:36,children:a}),b[0]=e,b[1]=a,b[2]=f):f=b[2];return f}g["default"]=a}),98);
__d("MWChatEncryptedBackupsChevronRightIconMedium.react",["MWXIconChevronRight","MWXIconStrict.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(2);a=a.disabled;a=a===void 0?!1:a;a=a?"disabled":"primary";var e;b[0]!==a?(e=i.jsx(c("MWXIconStrict.react"),{color:a,icon:c("MWXIconChevronRight"),size:24}),b[0]=a,b[1]=e):e=b[1];return e}g["default"]=a}),98);
__d("MWChatEncryptedBackupsInterstitialIcon.react",["ix","CometImageFromIXValue.react","gkx","react","react-compiler-runtime","stylex","useCurrentDisplayMode"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||d("react");function a(a){var b=d("react-compiler-runtime").c(9),e=a.alt,f=a.ref;a=a.xstyle;var g=c("useCurrentDisplayMode")();g=g==="dark";var j;b[0]!==g?(j=c("gkx")("23219")?g?h("230225"):h("230227"):h("835202"),b[0]=g,b[1]=j):j=b[1];g=j;b[2]!==e||b[3]!==f||b[4]!==g?(j=k.jsx(c("CometImageFromIXValue.react"),{alt:e,ref:f,source:g}),b[2]=e,b[3]=f,b[4]=g,b[5]=j):j=b[5];e=j;b[6]!==e||b[7]!==a?(f=a==null?e:k.jsx("div",babelHelpers["extends"]({},(i||(i=c("stylex"))).props(a),{children:e})),b[6]=e,b[7]=a,b[8]=f):f=b[8];return f}g["default"]=a}),98);
__d("MWChatEncryptedBackupsLayout.react",["FocusRegion.react","MWXColumn.react","MWXColumnItem.react","MWXRow.react","MWXRowItem.react","MWXText.react","react","xplatToDOMRef"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=a.actionsDirection;b=b===void 0?"row":b;var e=a.children,f=a.focusRegionId,g=a.icon,h=a.innerContentPaddingHorizontal;h=h===void 0?20:h;var j=a.innerContentPaddingVertical;j=j===void 0?20:j;var k=a.outerContentPaddingHorizontal;k=k===void 0?20:k;var l=a.outerContentPaddingVertical;l=l===void 0?20:l;var m=a.primaryAction,n=a.ref,o=a.secondaryAction,p=a.showTopMargin;p=p===void 0?!0:p;var q=a.showTopMarginSmall;q=q===void 0?!1:q;var r=a.tertiaryAction,s=a.title,t=a.useBigTitle;t=t===void 0?!1:t;var u=a.useCompressedIcon;u=u===void 0?!1:u;var v=a.useScrollBar;v=v===void 0?!1:v;var w=a.useStretchContent;w=w===void 0?!1:w;a=a.useTightTitle;a=a===void 0?!1:a;f=f==null?m:i.jsx(d("FocusRegion.react").FocusRegion,{id:f,children:m});t=g!=null||t?"headlineEmphasized2":"headlineEmphasized3";a=i.jsx("div",babelHelpers["extends"]({},{0:{},1:{className:"x106a9eq x1xnnf8n"}}[!!a<<0],{children:i.jsx(c("MWXText.react"),{align:"center",type:t,children:s})}));return i.jsxs(c("MWXColumn.react"),{align:"center",paddingHorizontal:k,paddingVertical:l,ref:d("xplatToDOMRef").xplatToDOMRef(n),spacing:16,children:[g&&i.jsx(c("MWXColumnItem.react"),{children:i.jsx("div",babelHelpers["extends"]({},{0:{className:"x1sy10c2 x1y1aw1k xwib8y2"},1:{className:"x4arcmf x1cxtvei x6mlq2k x4m0w28"}}[!!u<<0],{children:g}))}),s!=null&&i.jsx(c("MWXColumnItem.react"),{align:"center",children:g!=null?a:i.jsx("div",babelHelpers["extends"]({},{0:{className:"x1iorvi4 x1lr1uin"},2:{className:"x4i7bpe x1lr1uin"},1:{className:"x1xy6bms x1lr1uin"},3:{className:"x1xy6bms x1lr1uin"}}[!!p<<1|!!q<<0],{children:a}))}),i.jsx(c("MWXColumnItem.react"),{align:w?"stretch":"center",paddingHorizontal:h,paddingVertical:j,children:i.jsx("div",babelHelpers["extends"]({},{0:{className:"xvc51xn x1dqj196 x2b8uid"},2:{className:"x1lziwak x14z9mp"},1:{className:"xvc51xn x1dqj196 x2b8uid x1jcbksy x1odjw0f"},3:{className:"x1lziwak x14z9mp x1jcbksy x1odjw0f"}}[!!w<<1|!!v<<0],{children:e}))}),(m!=null||o!=null||r!=null)&&i.jsx(c("MWXColumnItem.react"),{align:"stretch",children:b==="row"?i.jsxs(c("MWXRow.react"),{expanding:!0,paddingHorizontal:0,paddingVertical:0,spacing:8,children:[r!=null&&i.jsx(c("MWXRowItem.react"),{expanding:!0,children:r}),o!=null&&i.jsx(c("MWXRowItem.react"),{expanding:!0,children:o}),i.jsx(c("MWXRowItem.react"),{expanding:!0,children:f})]}):i.jsxs(c("MWXColumn.react"),{paddingHorizontal:0,paddingVertical:0,spacing:8,children:[i.jsx(c("MWXColumnItem.react"),{children:f}),o!=null&&i.jsx(c("MWXColumnItem.react"),{children:o}),r!=null&&i.jsx(c("MWXColumnItem.react"),{align:"center",children:r})]})})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncryptedBackupsRecoveryCodeIcon.react",["ix","CometImageFromIXValue.react","react","react-compiler-runtime","stylex","useCurrentDisplayMode"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||d("react");function a(a){var b=d("react-compiler-runtime").c(9),e=a.alt,f=a.ref;a=a.xstyle;var g=c("useCurrentDisplayMode")();g=g==="dark";var j;b[0]!==g?(j=g?h("232768"):h("232770"),b[0]=g,b[1]=j):j=b[1];g=j;b[2]!==e||b[3]!==f||b[4]!==g?(j=k.jsx(c("CometImageFromIXValue.react"),{alt:e,ref:f,source:g}),b[2]=e,b[3]=f,b[4]=g,b[5]=j):j=b[5];e=j;b[6]!==e||b[7]!==a?(f=a==null?e:k.jsx("div",babelHelpers["extends"]({},(i||(i=c("stylex"))).props(a),{children:e})),b[6]=e,b[7]=a,b[8]=f):f=b[8];return f}g["default"]=a}),98);
__d("MWChatEncryptedBackupsRestoreEndOfRoadDialog.react",["fbt","MWChatEncryptedBackupsInterstitialIcon.react","MWChatEncryptedBackupsLayout.react","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWXButton.react","MWXIconCalendar","MWXIconDocument","MWXIconStrict.react","MWXLink.react","MWXListCell.react","MWXTextPairing.react","QPLUserFlow","react","react-compiler-runtime","useEncryptedBackupsQplImpressionRef"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react"),k="https://www.facebook.com/help/messenger-app/431055522328649?ref=learn_more";function a(a){var b=d("react-compiler-runtime").c(16),e=a.onClose,f=a.onDontRestore;a=c("useEncryptedBackupsQplImpressionRef")(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_END_OF_ROAD_IMPRESSION");var g;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(g=j.jsx(c("MWChatEncryptedBackupsInterstitialIcon.react"),{}),b[0]=g):g=b[0];var i;b[1]===Symbol["for"]("react.memo_cache_sentinel")?(i=h._(/*BTDS*/"Go to chats"),b[1]=i):i=b[1];b[2]!==e||b[3]!==f?(i=j.jsx(c("MWXButton.react"),{label:i,onPress:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_END_OF_THE_ROAD_ACTION_GO_TO_CHATS"),f==null||f(),d("MWChatEncryptedBackupsLogging").cancelFlow({cancelEndPoint:"END_OF_THE_ROAD_GO_TO_CHATS",event:d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent}),e()}}),b[2]=e,b[3]=f,b[4]=i):i=b[4];var m,n;b[5]===Symbol["for"]("react.memo_cache_sentinel")?(m=h._(/*BTDS*/"Other steps you can take to restore your messages"),n={className:"xfdjxqc"},b[5]=m,b[6]=n):(m=b[5],n=b[6]);var o;b[7]===Symbol["for"]("react.memo_cache_sentinel")?(o=j.jsx(c("MWXIconStrict.react"),{backgroundEnabled:!0,color:"primary",icon:c("MWXIconCalendar"),size:36}),b[7]=o):o=b[7];var p;b[8]===Symbol["for"]("react.memo_cache_sentinel")?(p=h._(/*BTDS*/"Skip restoring for now and try again later from Settings."),b[8]=p):p=b[8];b[9]===Symbol["for"]("react.memo_cache_sentinel")?(o=j.jsx(c("MWXListCell.react"),{addOnStart:o,content:j.jsx(c("MWXTextPairing.react"),{body:p,bodyColor:"secondary",headline:h._(/*BTDS*/"Restore messages later"),headlineColor:"primary",level:4})}),b[9]=o):o=b[9];b[10]===Symbol["for"]("react.memo_cache_sentinel")?(p=j.jsx(c("MWXIconStrict.react"),{backgroundEnabled:!0,color:"primary",icon:c("MWXIconDocument"),size:36}),b[10]=p):p=b[10];var q;b[11]===Symbol["for"]("react.memo_cache_sentinel")?(q=h._(/*BTDS*/"Find other ways to restore your messages in the {helpCenterLink}.",[h._param("helpCenterLink",j.jsx(c("MWXLink.react"),{display_DEPRECATED:"inline",href:k,onClick:l,rel:"noreferrer",target:"_blank",children:j.jsx("b",{children:h._(/*BTDS*/"Help Center")})}))]),b[11]=q):q=b[11];b[12]===Symbol["for"]("react.memo_cache_sentinel")?(n=j.jsxs("div",babelHelpers["extends"]({},n,{children:[o,j.jsx(c("MWXListCell.react"),{addOnEndVerticalAlign:"center",addOnStart:p,addOnStartVerticalAlign:"center",content:j.jsx(c("MWXTextPairing.react"),{body:q,bodyColor:"secondary",headline:h._(/*BTDS*/"See all restore options"),headlineColor:"primary",level:4})})]})),b[12]=n):n=b[12];b[13]!==a||b[14]!==i?(o=j.jsx(c("MWChatEncryptedBackupsLayout.react"),{icon:g,primaryAction:i,ref:a,title:m,children:n}),b[13]=a,b[14]=i,b[15]=o):o=b[15];return o}function l(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_END_OF_THE_ROAD_ACTION_OPEN_HELP_CENTER_LINK")}g["default"]=a}),226);
__d("PAKECleanupSessionReasonEnum",[],(function(a,b,c,d,e,f){a=Object.freeze({FLOW_ABANDONED:0,TIMEOUT:1});f["default"]=a}),66);
__d("pakeCpace",["Promise"],(function(a,b,c,d,e,f){var g,h=function(){var a=typeof document!=="undefined"&&document.currentScript?document.currentScript.src:void 0;return function(c){c=c||{};var c=typeof c!=="undefined"?c:{},d=Object.assign,i,j;c.ready=new(g||(g=b("Promise")))(function(a,b){i=a,j=b});var k=d({},c),l=[],m="./this.program";(function(a,b){throw b});var n=!0,o=!1,p="";function aa(a){return c.locateFile?c.locateFile(a,p):p+a}var ba,ca,da;(n||o)&&(o?p=self.location.href:typeof document!=="undefined"&&document.currentScript&&(p=document.currentScript.src),a&&(p=a),p.indexOf("blob:")!==0?p=p.substr(0,p.replace(/[?#].*/,"").lastIndexOf("/")+1):p="",(ba=function(a){var b=new XMLHttpRequest();b.open("GET",a,!1);b.send(null);return b.responseText},o&&(da=function(a){var b=new XMLHttpRequest();b.open("GET",a,!1);b.responseType="arraybuffer";b.send(null);return new Uint8Array(b.response)}),ca=function(a,b,c){var d=new XMLHttpRequest();d.open("GET",a,!0);d.responseType="arraybuffer";d.onload=function(){if(d.status==200||d.status==0&&d.response){b(d.response);return}c()};d.onerror=c;d.send(null)}),function(a){return document.title=a});var ea=c.print||emptyFunction.bind(console),q=c.printErr||emptyFunction.bind(console);d(c,k);k=null;c.arguments&&(l=c.arguments);c.thisProgram&&(m=c.thisProgram);c.quit&&c.quit;var fa=0,r=function(a){fa=a},ga=function(){return fa},s;c.wasmBinary&&(s=c.wasmBinary);c.noExitRuntime||!0;typeof WebAssembly!=="object"&&A("no native wasm support detected");var ha,ia=!1;function ja(a,b){a||A(b)}var ka=typeof TextDecoder!=="undefined"?new TextDecoder("utf8"):void 0;function t(a,b,c){c=b+c;var d=b;while(a[d]&&!(d>=c))++d;if(d-b>16&&a.subarray&&ka)return ka.decode(a.subarray(b,d));else{c="";while(b<d){var e=a[b++];if(!(e&128)){c+=String.fromCharCode(e);continue}var f=a[b++]&63;if((e&224)==192){c+=String.fromCharCode((e&31)<<6|f);continue}var g=a[b++]&63;(e&240)==224?e=(e&15)<<12|f<<6|g:e=(e&7)<<18|f<<12|g<<6|a[b++]&63;if(e<65536)c+=String.fromCharCode(e);else{f=e-65536;c+=String.fromCharCode(55296|f>>10,56320|f&1023)}}}return c}function la(a,b){return a?t(v,a,b):""}function ma(a,b,c,d){if(!(d>0))return 0;var e=c;d=c+d-1;for(var f=0;f<a.length;++f){var g=a.charCodeAt(f);if(g>=55296&&g<=57343){var h=a.charCodeAt(++f);g=65536+((g&1023)<<10)|h&1023}if(g<=127){if(c>=d)break;b[c++]=g}else if(g<=2047){if(c+1>=d)break;b[c++]=192|g>>6;b[c++]=128|g&63}else if(g<=65535){if(c+2>=d)break;b[c++]=224|g>>12;b[c++]=128|g>>6&63;b[c++]=128|g&63}else{if(c+3>=d)break;b[c++]=240|g>>18;b[c++]=128|g>>12&63;b[c++]=128|g>>6&63;b[c++]=128|g&63}}b[c]=0;return c-e}function na(a,b,c){return ma(a,v,b,c)}function oa(a){var b=0;for(var c=0;c<a.length;++c){var d=a.charCodeAt(c);d>=55296&&d<=57343&&(d=65536+((d&1023)<<10)|a.charCodeAt(++c)&1023);d<=127?++b:d<=2047?b+=2:d<=65535?b+=3:b+=4}return b}var pa=typeof TextDecoder!=="undefined"?new TextDecoder("utf-16le"):void 0;function qa(a,b){var c=a,d=c>>1,e=d+b/2;while(!(d>=e)&&za[d])++d;c=d<<1;if(c-a>32&&pa)return pa.decode(v.subarray(a,c));else{e="";for(d=0;!(d>=b/2);++d){c=w[a+d*2>>1];if(c==0)break;e+=String.fromCharCode(c)}return e}}function ra(a,b,c){c===void 0&&(c=2147483647);if(c<2)return 0;c-=2;var d=b;c=c<a.length*2?c/2:a.length;for(var e=0;e<c;++e){var f=a.charCodeAt(e);w[b>>1]=f;b+=2}w[b>>1]=0;return b-d}function sa(a){return a.length*2}function ta(a,b){var c=0,d="";while(!(c>=b/4)){var e=x[a+c*4>>2];if(e==0)break;++c;if(e>=65536){var f=e-65536;d+=String.fromCharCode(55296|f>>10,56320|f&1023)}else d+=String.fromCharCode(e)}return d}function ua(a,b,c){c===void 0&&(c=2147483647);if(c<4)return 0;var d=b;c=d+c-4;for(var e=0;e<a.length;++e){var f=a.charCodeAt(e);if(f>=55296&&f<=57343){var g=a.charCodeAt(++e);f=65536+((f&1023)<<10)|g&1023}x[b>>2]=f;b+=4;if(b+4>c)break}x[b>>2]=0;return b-d}function va(a){var b=0;for(var c=0;c<a.length;++c){var d=a.charCodeAt(c);d>=55296&&d<=57343&&++c;b+=4}return b}function wa(b,a){u.set(b,a)}function xa(b,a,c){for(var d=0;d<b.length;++d)u[a++>>0]=b.charCodeAt(d);c||(u[a>>0]=0)}var ya,u,v,w,za,x,y,Aa,Ba;function Ca(a){ya=a,c.HEAP8=u=new Int8Array(a),c.HEAP16=w=new Int16Array(a),c.HEAP32=x=new Int32Array(a),c.HEAPU8=v=new Uint8Array(a),c.HEAPU16=za=new Uint16Array(a),c.HEAPU32=y=new Uint32Array(a),c.HEAPF32=Aa=new Float32Array(a),c.HEAPF64=Ba=new Float64Array(a)}c.INITIAL_MEMORY||16777216;var Da,Ea=[],Fa=[],Ga=[];function Ha(){if(c.preRun){typeof c.preRun=="function"&&(c.preRun=[c.preRun]);while(c.preRun.length)Ka(c.preRun.shift())}Xa(Ea)}function Ia(){!c.noFSInit&&!K.init.initialized&&K.init(),K.ignorePermissions=!1,I.init(),Xa(Fa)}function Ja(){if(c.postRun){typeof c.postRun=="function"&&(c.postRun=[c.postRun]);while(c.postRun.length)Ma(c.postRun.shift())}Xa(Ga)}function Ka(a){Ea.unshift(a)}function La(a){Fa.unshift(a)}function Ma(a){Ga.unshift(a)}var z=0,Na=null,Oa=null;function Pa(a){return a}function Qa(a){z++,c.monitorRunDependencies&&c.monitorRunDependencies(z)}function Ra(a){z--;c.monitorRunDependencies&&c.monitorRunDependencies(z);if(z==0){Na!==null&&(clearInterval(Na),Na=null);if(Oa){a=Oa;Oa=null;a()}}}c.preloadedImages={};c.preloadedAudios={};function A(a){c.onAbort&&c.onAbort(a);a="Aborted("+a+")";q(a);ia=!0;a+=". Build with -s ASSERTIONS=1 for more info.";a=new WebAssembly.RuntimeError(a);j(a);throw a}var Sa="data:application/octet-stream;base64,";function Ta(a){return a.startsWith(Sa)}var B;B="pakeCpace.wasm";Ta(B)||(B=aa(B));function Ua(a){try{if(a==B&&s)return new Uint8Array(s);if(da)return da(a);else throw"both async and sync fetching of the wasm failed"}catch(a){A(a)}}function Va(){return!s&&(n||o)&&typeof fetch==="function"?fetch(B,{credentials:"same-origin"}).then(function(a){if(!a.ok)throw"failed to load wasm binary file at '"+B+"'";return a.arrayBuffer()})["catch"](function(){return Ua(B)}):(g||(g=b("Promise"))).resolve().then(function(){return Ua(B)})}function Wa(){var b={a:vd};function d(b,a){a=b.exports;c.asm=a;ha=c.asm.ha;Ca(ha.buffer);Da=c.asm.ka;La(c.asm.ia);Ra("wasm-instantiate")}Qa("wasm-instantiate");function g(a){d(a.instance)}function h(a){return Va().then(function(a){return WebAssembly.instantiate(a,b)}).then(function(a){return a}).then(a,function(a){q("failed to asynchronously prepare wasm: "+a),A(a)})}function i(){if(!s&&typeof WebAssembly.instantiateStreaming==="function"&&!Ta(B)&&typeof fetch==="function")return fetch(B,{credentials:"same-origin"}).then(function(a){a=WebAssembly.instantiateStreaming(a,b);return a.then(g,function(a){q("wasm streaming compile failed: "+a);q("falling back to ArrayBuffer instantiation");return h(g)})});else return h(g)}if(c.instantiateWasm)try{var a=c.instantiateWasm(b,d);return a}catch(a){q("Module.instantiateWasm callback failed with error: "+a);return!1}i()["catch"](j);return{}}var C,D;function Xa(a){while(a.length>0){var b=a.shift();if(typeof b=="function"){b(c);continue}var d=b.func;typeof d==="number"?b.arg===void 0?E(d)():E(d)(b.arg):d(b.arg===void 0?null:b.arg)}}function E(a){return Da.get(a)}function Ya(a){return wd(a+16)+16}function Za(a){this.excPtr=a,this.ptr=a-16,this.set_type=function(a){x[this.ptr+4>>2]=a},this.get_type=function(){return x[this.ptr+4>>2]},this.set_destructor=function(a){x[this.ptr+8>>2]=a},this.get_destructor=function(){return x[this.ptr+8>>2]},this.set_refcount=function(a){x[this.ptr>>2]=a},this.set_caught=function(a){a=a?1:0,u[this.ptr+12>>0]=a},this.get_caught=function(){return u[this.ptr+12>>0]!=0},this.set_rethrown=function(a){a=a?1:0,u[this.ptr+13>>0]=a},this.get_rethrown=function(){return u[this.ptr+13>>0]!=0},this.init=function(a,b){this.set_type(a),this.set_destructor(b),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var a=x[this.ptr>>2];x[this.ptr>>2]=a+1},this.release_ref=function(){var a=x[this.ptr>>2];x[this.ptr>>2]=a-1;return a===1}}function $a(a){this.free=function(){X(this.ptr),this.ptr=0},this.set_base_ptr=function(a){x[this.ptr>>2]=a},this.get_base_ptr=function(){return x[this.ptr>>2]},this.set_adjusted_ptr=function(a){x[this.ptr+4>>2]=a},this.get_adjusted_ptr_addr=function(){return this.ptr+4},this.get_adjusted_ptr=function(){return x[this.ptr+4>>2]},this.get_exception_ptr=function(){var a=zd(this.get_exception_info().get_type());if(a)return x[this.get_base_ptr()>>2];a=this.get_adjusted_ptr();return a!==0?a:this.get_base_ptr()},this.get_exception_info=function(){return new Za(this.get_base_ptr())},a===void 0?(this.ptr=wd(8),this.set_adjusted_ptr(0)):this.ptr=a}var ab=[];function bb(a){a.add_ref()}var cb=0;function db(a){a=new $a(a);var b=a.get_exception_info();b.get_caught()||(b.set_caught(!0),cb--);b.set_rethrown(!1);ab.push(a);bb(b);return a.get_exception_ptr()}var F=0;function eb(a){try{return X(new Za(a).ptr)}catch(a){}}function fb(a){if(a.release_ref()&&!a.get_rethrown()){var b=a.get_destructor();b&&E(b)(a.excPtr);eb(a.excPtr)}}function gb(){Y(0);var a=ab.pop();fb(a.get_exception_info());a.free();F=0}function hb(a){a=new $a(a);var b=a.get_base_ptr();F||(F=b);a.free();throw b}function ib(){var a=F;if(!a){r(0);return 0|0}var b=new Za(a),c=b.get_type(),d=new $a();d.set_base_ptr(a);d.set_adjusted_ptr(a);if(!c){r(0);return d.ptr|0}var e=Array.prototype.slice.call(arguments);for(var f=0;f<e.length;f++){var g=e[f];if(g===0||g===c)break;if(yd(g,c,d.get_adjusted_ptr_addr())){r(g);return d.ptr|0}}r(c);return d.ptr|0}function jb(){var a=F;if(!a){r(0);return 0|0}var b=new Za(a),c=b.get_type(),d=new $a();d.set_base_ptr(a);d.set_adjusted_ptr(a);if(!c){r(0);return d.ptr|0}var e=Array.prototype.slice.call(arguments);for(var f=0;f<e.length;f++){var g=e[f];if(g===0||g===c)break;if(yd(g,c,d.get_adjusted_ptr_addr())){r(g);return d.ptr|0}}r(c);return d.ptr|0}function kb(){var a=ab.pop();a||A("no exception to throw");var b=a.get_exception_info(),c=a.get_base_ptr();!b.get_rethrown()?(ab.push(a),b.set_rethrown(!0),b.set_caught(!1),cb++):a.free();F=c;throw c}function lb(a,b,c){var d=new Za(a);d.init(b,c);F=a;cb++;throw a}function mb(){return cb}var G={splitPath:function(a){var b=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return b.exec(a).slice(1)},normalizeArray:function(a,b){var c=0;for(var d=a.length-1;d>=0;d--){var e=a[d];e==="."?a.splice(d,1):e===".."?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c;c--)a.unshift("..");return a},normalize:function(a){var b=a.charAt(0)==="/",c=a.substr(-1)==="/";a=G.normalizeArray(a.split("/").filter(function(a){return!!a}),!b).join("/");!a&&!b&&(a=".");a&&c&&(a+="/");return(b?"/":"")+a},dirname:function(a){a=G.splitPath(a);var b=a[0];a=a[1];if(!b&&!a)return".";a&&(a=a.substr(0,a.length-1));return b+a},basename:function(a){if(a==="/")return"/";a=G.normalize(a);a=a.replace(/\/$/,"");var b=a.lastIndexOf("/");return b===-1?a:a.substr(b+1)},extname:function(a){return G.splitPath(a)[3]},join:function(){var a=Array.prototype.slice.call(arguments,0);return G.normalize(a.join("/"))},join2:function(a,b){return G.normalize(a+"/"+b)}};function nb(){if(typeof crypto==="object"&&typeof crypto.getRandomValues==="function"){var a=new Uint8Array(1);return function(){crypto.getRandomValues(a);return a[0]}}else return function(){A("randomDevice")}}var H={resolve:function(){var a="",b=!1;for(var c=arguments.length-1;c>=-1&&!b;c--){var d=c>=0?arguments[c]:K.cwd();if(typeof d!=="string")throw new TypeError("Arguments to path.resolve must be strings");else if(!d)return"";a=d+"/"+a;b=d.charAt(0)==="/"}a=G.normalizeArray(a.split("/").filter(function(a){return!!a}),!b).join("/");return(b?"/":"")+a||"."},relative:function(a,b){a=H.resolve(a).substr(1);b=H.resolve(b).substr(1);function c(a){var b=0;for(;b<a.length;b++)if(a[b]!=="")break;var c=a.length-1;for(;c>=0;c--)if(a[c]!=="")break;return b>c?[]:a.slice(b,c-b+1)}a=c(a.split("/"));c=c(b.split("/"));b=Math.min(a.length,c.length);var d=b;for(var e=0;e<b;e++)if(a[e]!==c[e]){d=e;break}b=[];for(var e=d;e<a.length;e++)b.push("..");b=b.concat(c.slice(d));return b.join("/")}},I={ttys:[],init:function(){},shutdown:function(){},register:function(a,b){I.ttys[a]={input:[],output:[],ops:b},K.registerDevice(a,I.stream_ops)},stream_ops:{open:function(a){var b=I.ttys[a.node.rdev];if(!b)throw new K.ErrnoError(43);a.tty=b;a.seekable=!1},close:function(a){a.tty.ops.flush(a.tty)},flush:function(a){a.tty.ops.flush(a.tty)},read:function(b,a,c,d,e){if(!b.tty||!b.tty.ops.get_char)throw new K.ErrnoError(60);e=0;for(var f=0;f<d;f++){var g;try{g=b.tty.ops.get_char(b.tty)}catch(a){throw new K.ErrnoError(29)}if(g===void 0&&e===0)throw new K.ErrnoError(6);if(g===null||g===void 0)break;e++;a[c+f]=g}e&&(b.node.timestamp=Date.now());return e},write:function(b,a,c,d,e){if(!b.tty||!b.tty.ops.put_char)throw new K.ErrnoError(60);try{for(var f=0;f<d;f++)b.tty.ops.put_char(b.tty,a[c+f])}catch(a){throw new K.ErrnoError(29)}d&&(b.node.timestamp=Date.now());return f}},default_tty_ops:{get_char:function(a){if(!a.input.length){var b=null;typeof window!="undefined"&&typeof window.prompt=="function"?(b=window.prompt("Input: "),b!==null&&(b+="\n")):typeof readline=="function"&&(b=readline(),b!==null&&(b+="\n"));if(!b)return null;a.input=ud(b,!0)}return a.input.shift()},put_char:function(a,b){b===null||b===10?(ea(t(a.output,0)),a.output=[]):b!=0&&a.output.push(b)},flush:function(a){a.output&&a.output.length>0&&(ea(t(a.output,0)),a.output=[])}},default_tty1_ops:{put_char:function(a,b){b===null||b===10?(q(t(a.output,0)),a.output=[]):b!=0&&a.output.push(b)},flush:function(a){a.output&&a.output.length>0&&(q(t(a.output,0)),a.output=[])}}};function ob(a){A()}var J={ops_table:null,mount:function(a){return J.createNode(null,"/",16384|511,0)},createNode:function(a,b,c,d){if(K.isBlkdev(c)||K.isFIFO(c))throw new K.ErrnoError(63);J.ops_table||(J.ops_table={dir:{node:{getattr:J.node_ops.getattr,setattr:J.node_ops.setattr,lookup:J.node_ops.lookup,mknod:J.node_ops.mknod,rename:J.node_ops.rename,unlink:J.node_ops.unlink,rmdir:J.node_ops.rmdir,readdir:J.node_ops.readdir,symlink:J.node_ops.symlink},stream:{llseek:J.stream_ops.llseek}},file:{node:{getattr:J.node_ops.getattr,setattr:J.node_ops.setattr},stream:{llseek:J.stream_ops.llseek,read:J.stream_ops.read,write:J.stream_ops.write,allocate:J.stream_ops.allocate,mmap:J.stream_ops.mmap,msync:J.stream_ops.msync}},link:{node:{getattr:J.node_ops.getattr,setattr:J.node_ops.setattr,readlink:J.node_ops.readlink},stream:{}},chrdev:{node:{getattr:J.node_ops.getattr,setattr:J.node_ops.setattr},stream:K.chrdev_stream_ops}});c=K.createNode(a,b,c,d);K.isDir(c.mode)?(c.node_ops=J.ops_table.dir.node,c.stream_ops=J.ops_table.dir.stream,c.contents={}):K.isFile(c.mode)?(c.node_ops=J.ops_table.file.node,c.stream_ops=J.ops_table.file.stream,c.usedBytes=0,c.contents=null):K.isLink(c.mode)?(c.node_ops=J.ops_table.link.node,c.stream_ops=J.ops_table.link.stream):K.isChrdev(c.mode)&&(c.node_ops=J.ops_table.chrdev.node,c.stream_ops=J.ops_table.chrdev.stream);c.timestamp=Date.now();a&&(a.contents[b]=c,a.timestamp=c.timestamp);return c},getFileDataAsTypedArray:function(a){if(!a.contents)return new Uint8Array(0);return a.contents.subarray?a.contents.subarray(0,a.usedBytes):new Uint8Array(a.contents)},expandFileStorage:function(a,b){var c=a.contents?a.contents.length:0;if(c>=b)return;var d=1024*1024;b=Math.max(b,c*(c<d?2:1.125)>>>0);c!=0&&(b=Math.max(b,256));d=a.contents;a.contents=new Uint8Array(b);a.usedBytes>0&&a.contents.set(d.subarray(0,a.usedBytes),0)},resizeFileStorage:function(a,b){if(a.usedBytes==b)return;if(b==0)a.contents=null,a.usedBytes=0;else{var c=a.contents;a.contents=new Uint8Array(b);c&&a.contents.set(c.subarray(0,Math.min(b,a.usedBytes)));a.usedBytes=b}},node_ops:{getattr:function(a){var b={};b.dev=K.isChrdev(a.mode)?a.id:1;b.ino=a.id;b.mode=a.mode;b.nlink=1;b.uid=0;b.gid=0;b.rdev=a.rdev;K.isDir(a.mode)?b.size=4096:K.isFile(a.mode)?b.size=a.usedBytes:K.isLink(a.mode)?b.size=a.link.length:b.size=0;b.atime=new Date(a.timestamp);b.mtime=new Date(a.timestamp);b.ctime=new Date(a.timestamp);b.blksize=4096;b.blocks=Math.ceil(b.size/b.blksize);return b},setattr:function(a,b){b.mode!==void 0&&(a.mode=b.mode),b.timestamp!==void 0&&(a.timestamp=b.timestamp),b.size!==void 0&&J.resizeFileStorage(a,b.size)},lookup:function(a,b){throw K.genericErrors[44]},mknod:function(a,b,c,d){return J.createNode(a,b,c,d)},rename:function(a,b,c){if(K.isDir(a.mode)){var d;try{d=K.lookupNode(b,c)}catch(a){}if(d)for(var e in d.contents)throw new K.ErrnoError(55)}delete a.parent.contents[a.name];a.parent.timestamp=Date.now();a.name=c;b.contents[c]=a;b.timestamp=a.parent.timestamp;a.parent=b},unlink:function(a,b){delete a.contents[b],a.timestamp=Date.now()},rmdir:function(a,b){var c=K.lookupNode(a,b);for(c in c.contents)throw new K.ErrnoError(55);delete a.contents[b];a.timestamp=Date.now()},readdir:function(a){var b=[".",".."];for(var c in a.contents){if(!Object.prototype.hasOwnProperty.call(a.contents,c))continue;b.push(c)}return b},symlink:function(a,b,c){a=J.createNode(a,b,511|40960,0);a.link=c;return a},readlink:function(a){if(!K.isLink(a.mode))throw new K.ErrnoError(28);return a.link}},stream_ops:{read:function(b,a,c,d,e){var f=b.node.contents;if(e>=b.node.usedBytes)return 0;b=Math.min(b.node.usedBytes-e,d);if(b>8&&f.subarray)a.set(f.subarray(e,e+b),c);else for(d=0;d<b;d++)a[c+d]=f[e+d];return b},write:function(b,a,c,d,e,f){if(!d)return 0;b=b.node;b.timestamp=Date.now();if(a.subarray&&(!b.contents||b.contents.subarray))if(f){b.contents=a.subarray(c,c+d);b.usedBytes=d;return d}else if(b.usedBytes===0&&e===0){b.contents=a.slice(c,c+d);b.usedBytes=d;return d}else if(e+d<=b.usedBytes){b.contents.set(a.subarray(c,c+d),e);return d}J.expandFileStorage(b,e+d);if(b.contents.subarray&&a.subarray)b.contents.set(a.subarray(c,c+d),e);else for(f=0;f<d;f++)b.contents[e+f]=a[c+f];b.usedBytes=Math.max(b.usedBytes,e+d);return d},llseek:function(a,b,c){b=b;c===1?b+=a.position:c===2&&(K.isFile(a.node.mode)&&(b+=a.node.usedBytes));if(b<0)throw new K.ErrnoError(28);return b},allocate:function(a,b,c){J.expandFileStorage(a.node,b+c),a.node.usedBytes=Math.max(a.node.usedBytes,b+c)},mmap:function(a,b,c,d,e,f){if(b!==0)throw new K.ErrnoError(28);if(!K.isFile(a.node.mode))throw new K.ErrnoError(43);e=a.node.contents;if(!(f&2)&&e.buffer===ya)b=!1,a=e.byteOffset;else{(d>0||d+c<e.length)&&(e.subarray?e=e.subarray(d,d+c):e=Array.prototype.slice.call(e,d,d+c));b=!0;a=ob(c);if(!a)throw new K.ErrnoError(48);u.set(e,a)}return{ptr:a,allocated:b}},msync:function(b,a,c,d,e){if(!K.isFile(b.node.mode))throw new K.ErrnoError(43);if(e&2)return 0;J.stream_ops.write(b,a,0,d,c,!1);return 0}}};function pb(a,b,c,d){var e=d?"":Pa("al "+a);ca(a,function(c){ja(c,'Loading data file "'+a+'" failed (no arrayBuffer).'),b(new Uint8Array(c)),e&&Ra(e)},function(b){if(c)c();else throw'Loading data file "'+a+'" failed.'});e&&Qa(e)}var K={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath:function(a,b){b===void 0&&(b={});a=H.resolve(K.cwd(),a);if(!a)return{path:"",node:null};var c={follow_mount:!0,recurse_count:0};for(var d in c)b[d]===void 0&&(b[d]=c[d]);if(b.recurse_count>8)throw new K.ErrnoError(32);c=G.normalizeArray(a.split("/").filter(function(a){return!!a}),!1);d=K.root;a="/";for(var e=0;e<c.length;e++){var f=e===c.length-1;if(f&&b.parent)break;d=K.lookupNode(d,c[e]);a=G.join2(a,c[e]);K.isMountpoint(d)&&((!f||f&&b.follow_mount)&&(d=d.mounted.root));if(!f||b.follow){f=0;while(K.isLink(d.mode)){var g=K.readlink(a);a=H.resolve(G.dirname(a),g);g=K.lookupPath(a,{recurse_count:b.recurse_count});d=g.node;if(f++>40)throw new K.ErrnoError(32)}}}return{path:a,node:d}},getPath:function(a){var b;while(!0){if(K.isRoot(a)){var c=a.mount.mountpoint;return!b?c:c[c.length-1]!=="/"?c+"/"+b:c+b}b=b?a.name+"/"+b:a.name;a=a.parent}},hashName:function(a,b){var c=0;for(var d=0;d<b.length;d++)c=(c<<5)-c+b.charCodeAt(d)|0;return(a+c>>>0)%K.nameTable.length},hashAddNode:function(a){var b=K.hashName(a.parent.id,a.name);a.name_next=K.nameTable[b];K.nameTable[b]=a},hashRemoveNode:function(a){var b=K.hashName(a.parent.id,a.name);if(K.nameTable[b]===a)K.nameTable[b]=a.name_next;else{b=K.nameTable[b];while(b){if(b.name_next===a){b.name_next=a.name_next;break}b=b.name_next}}},lookupNode:function(a,b){var c=K.mayLookup(a);if(c)throw new K.ErrnoError(c,a);c=K.hashName(a.id,b);for(c=K.nameTable[c];c;c=c.name_next){var d=c.name;if(c.parent.id===a.id&&d===b)return c}return K.lookup(a,b)},createNode:function(a,b,c,d){a=new K.FSNode(a,b,c,d);K.hashAddNode(a);return a},destroyNode:function(a){K.hashRemoveNode(a)},isRoot:function(a){return a===a.parent},isMountpoint:function(a){return!!a.mounted},isFile:function(a){return(a&61440)===32768},isDir:function(a){return(a&61440)===16384},isLink:function(a){return(a&61440)===40960},isChrdev:function(a){return(a&61440)===8192},isBlkdev:function(a){return(a&61440)===24576},isFIFO:function(a){return(a&61440)===4096},isSocket:function(a){return(a&49152)===49152},flagModes:{r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},modeStringToFlags:function(a){var b=K.flagModes[a];if(typeof b==="undefined")throw new Error("Unknown file open mode: "+a);return b},flagsToPermissionString:function(a){var b=["r","w","rw"][a&3];a&512&&(b+="w");return b},nodePermissions:function(a,b){if(K.ignorePermissions)return 0;if(b.includes("r")&&!(a.mode&292))return 2;else if(b.includes("w")&&!(a.mode&146))return 2;else if(b.includes("x")&&!(a.mode&73))return 2;return 0},mayLookup:function(a){var b=K.nodePermissions(a,"x");if(b)return b;return!a.node_ops.lookup?2:0},mayCreate:function(a,b){try{K.lookupNode(a,b);return 20}catch(a){}return K.nodePermissions(a,"wx")},mayDelete:function(a,b,c){var d;try{d=K.lookupNode(a,b)}catch(a){return a.errno}b=K.nodePermissions(a,"wx");if(b)return b;if(c){if(!K.isDir(d.mode))return 54;if(K.isRoot(d)||K.getPath(d)===K.cwd())return 10}else if(K.isDir(d.mode))return 31;return 0},mayOpen:function(a,b){if(!a)return 44;if(K.isLink(a.mode))return 32;else if(K.isDir(a.mode)&&(K.flagsToPermissionString(b)!=="r"||b&512))return 31;return K.nodePermissions(a,K.flagsToPermissionString(b))},MAX_OPEN_FDS:4096,nextfd:function(a,b){a===void 0&&(a=0);b===void 0&&(b=K.MAX_OPEN_FDS);for(a=a;a<=b;a++)if(!K.streams[a])return a;throw new K.ErrnoError(33)},getStream:function(a){return K.streams[a]},createStream:function(a,b,c){K.FSStream||(K.FSStream=function(){},K.FSStream.prototype={object:{get:function(){return this.node},set:function(a){this.node=a}},isRead:{get:function(){return(this.flags&2097155)!==1}},isWrite:{get:function(){return(this.flags&2097155)!==0}},isAppend:{get:function(){return this.flags&1024}}});var d=new K.FSStream();for(var e in a)d[e]=a[e];a=d;e=K.nextfd(b,c);a.fd=e;K.streams[e]=a;return a},closeStream:function(a){K.streams[a]=null},chrdev_stream_ops:{open:function(a){var b=K.getDevice(a.node.rdev);a.stream_ops=b.stream_ops;a.stream_ops.open&&a.stream_ops.open(a)},llseek:function(){throw new K.ErrnoError(70)}},major:function(a){return a>>8},minor:function(a){return a&255},makedev:function(a,b){return a<<8|b},registerDevice:function(a,b){K.devices[a]={stream_ops:b}},getDevice:function(a){return K.devices[a]},getMounts:function(a){var b=[];a=[a];while(a.length){var c=a.pop();b.push(c);a.push.apply(a,c.mounts)}return b},syncfs:function(a,b){typeof a==="function"&&(b=a,a=!1);K.syncFSRequests++;K.syncFSRequests>1&&q("warning: "+K.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var c=K.getMounts(K.root.mount),d=0;function e(a){K.syncFSRequests--;return b(a)}function f(a){if(a){if(!f.errored){f.errored=!0;return e(a)}return}++d>=c.length&&e(null)}c.forEach(function(b){if(!b.type.syncfs)return f(null);b.type.syncfs(b,a,f)})},mount:function(a,b,c){var d=c==="/",e=!c,f;if(d&&K.root)throw new K.ErrnoError(10);else if(!d&&!e){e=K.lookupPath(c,{follow_mount:!1});c=e.path;f=e.node;if(K.isMountpoint(f))throw new K.ErrnoError(10);if(!K.isDir(f.mode))throw new K.ErrnoError(54)}e={type:a,opts:b,mountpoint:c,mounts:[]};b=a.mount(e);b.mount=e;e.root=b;d?K.root=b:f&&(f.mounted=e,f.mount&&f.mount.mounts.push(e));return b},unmount:function(a){a=K.lookupPath(a,{follow_mount:!1});if(!K.isMountpoint(a.node))throw new K.ErrnoError(28);a=a.node;var b=a.mounted,c=K.getMounts(b);Object.keys(K.nameTable).forEach(function(a){a=K.nameTable[a];while(a){var b=a.name_next;c.includes(a.mount)&&K.destroyNode(a);a=b}});a.mounted=null;b=a.mount.mounts.indexOf(b);a.mount.mounts.splice(b,1)},lookup:function(a,b){return a.node_ops.lookup(a,b)},mknod:function(a,b,c){var d=K.lookupPath(a,{parent:!0});d=d.node;a=G.basename(a);if(!a||a==="."||a==="..")throw new K.ErrnoError(28);var e=K.mayCreate(d,a);if(e)throw new K.ErrnoError(e);if(!d.node_ops.mknod)throw new K.ErrnoError(63);return d.node_ops.mknod(d,a,b,c)},create:function(a,b){b=b!==void 0?b:438;b&=4095;b|=32768;return K.mknod(a,b,0)},mkdir:function(a,b){b=b!==void 0?b:511;b&=511|512;b|=16384;return K.mknod(a,b,0)},mkdirTree:function(a,b){a=a.split("/");var c="";for(var d=0;d<a.length;++d){if(!a[d])continue;c+="/"+a[d];try{K.mkdir(c,b)}catch(a){if(a.errno!=20)throw a}}},mkdev:function(a,b,c){typeof c==="undefined"&&(c=b,b=438);b|=8192;return K.mknod(a,b,c)},symlink:function(a,b){if(!H.resolve(a))throw new K.ErrnoError(44);var c=K.lookupPath(b,{parent:!0});c=c.node;if(!c)throw new K.ErrnoError(44);b=G.basename(b);var d=K.mayCreate(c,b);if(d)throw new K.ErrnoError(d);if(!c.node_ops.symlink)throw new K.ErrnoError(63);return c.node_ops.symlink(c,b,a)},rename:function(a,b){var c=G.dirname(a),d=G.dirname(b),e=G.basename(a),f=G.basename(b),g,h;g=K.lookupPath(a,{parent:!0});h=g.node;g=K.lookupPath(b,{parent:!0});g=g.node;if(!h||!g)throw new K.ErrnoError(44);if(h.mount!==g.mount)throw new K.ErrnoError(75);var i=K.lookupNode(h,e);a=H.relative(a,d);if(a.charAt(0)!==".")throw new K.ErrnoError(28);a=H.relative(b,c);if(a.charAt(0)!==".")throw new K.ErrnoError(55);var j;try{j=K.lookupNode(g,f)}catch(a){}if(i===j)return;d=K.isDir(i.mode);b=K.mayDelete(h,e,d);if(b)throw new K.ErrnoError(b);b=j?K.mayDelete(g,f,d):K.mayCreate(g,f);if(b)throw new K.ErrnoError(b);if(!h.node_ops.rename)throw new K.ErrnoError(63);if(K.isMountpoint(i)||j&&K.isMountpoint(j))throw new K.ErrnoError(10);if(g!==h){b=K.nodePermissions(h,"w");if(b)throw new K.ErrnoError(b)}K.hashRemoveNode(i);try{h.node_ops.rename(i,g,f)}catch(a){throw a}finally{K.hashAddNode(i)}},rmdir:function(a){var b=K.lookupPath(a,{parent:!0});b=b.node;a=G.basename(a);var c=K.lookupNode(b,a),d=K.mayDelete(b,a,!0);if(d)throw new K.ErrnoError(d);if(!b.node_ops.rmdir)throw new K.ErrnoError(63);if(K.isMountpoint(c))throw new K.ErrnoError(10);b.node_ops.rmdir(b,a);K.destroyNode(c)},readdir:function(a){a=K.lookupPath(a,{follow:!0});a=a.node;if(!a.node_ops.readdir)throw new K.ErrnoError(54);return a.node_ops.readdir(a)},unlink:function(a){var b=K.lookupPath(a,{parent:!0});b=b.node;if(!b)throw new K.ErrnoError(44);a=G.basename(a);var c=K.lookupNode(b,a),d=K.mayDelete(b,a,!1);if(d)throw new K.ErrnoError(d);if(!b.node_ops.unlink)throw new K.ErrnoError(63);if(K.isMountpoint(c))throw new K.ErrnoError(10);b.node_ops.unlink(b,a);K.destroyNode(c)},readlink:function(a){a=K.lookupPath(a);a=a.node;if(!a)throw new K.ErrnoError(44);if(!a.node_ops.readlink)throw new K.ErrnoError(28);return H.resolve(K.getPath(a.parent),a.node_ops.readlink(a))},stat:function(a,b){a=K.lookupPath(a,{follow:!b});b=a.node;if(!b)throw new K.ErrnoError(44);if(!b.node_ops.getattr)throw new K.ErrnoError(63);return b.node_ops.getattr(b)},lstat:function(a){return K.stat(a,!0)},chmod:function(a,b,c){if(typeof a==="string"){c=K.lookupPath(a,{follow:!c});c=c.node}else c=a;if(!c.node_ops.setattr)throw new K.ErrnoError(63);c.node_ops.setattr(c,{mode:b&4095|c.mode&-4096,timestamp:Date.now()})},lchmod:function(a,b){K.chmod(a,b,!0)},fchmod:function(a,b){a=K.getStream(a);if(!a)throw new K.ErrnoError(8);K.chmod(a.node,b)},chown:function(a,b,c,d){if(typeof a==="string"){b=K.lookupPath(a,{follow:!d});c=b.node}else c=a;if(!c.node_ops.setattr)throw new K.ErrnoError(63);c.node_ops.setattr(c,{timestamp:Date.now()})},lchown:function(a,b,c){K.chown(a,b,c,!0)},fchown:function(a,b,c){a=K.getStream(a);if(!a)throw new K.ErrnoError(8);K.chown(a.node,b,c)},truncate:function(a,b){if(b<0)throw new K.ErrnoError(28);if(typeof a==="string"){var c=K.lookupPath(a,{follow:!0});c=c.node}else c=a;if(!c.node_ops.setattr)throw new K.ErrnoError(63);if(K.isDir(c.mode))throw new K.ErrnoError(31);if(!K.isFile(c.mode))throw new K.ErrnoError(28);a=K.nodePermissions(c,"w");if(a)throw new K.ErrnoError(a);c.node_ops.setattr(c,{size:b,timestamp:Date.now()})},ftruncate:function(a,b){a=K.getStream(a);if(!a)throw new K.ErrnoError(8);if((a.flags&2097155)===0)throw new K.ErrnoError(28);K.truncate(a.node,b)},utime:function(a,b,c){a=K.lookupPath(a,{follow:!0});a=a.node;a.node_ops.setattr(a,{timestamp:Math.max(b,c)})},open:function(a,b,d,e,f){if(a==="")throw new K.ErrnoError(44);b=typeof b==="string"?K.modeStringToFlags(b):b;d=typeof d==="undefined"?438:d;b&64?d=d&4095|32768:d=0;var g;if(typeof a==="object")g=a;else{a=G.normalize(a);try{var h=K.lookupPath(a,{follow:!(b&131072)});g=h.node}catch(a){}}h=!1;if(b&64)if(g){if(b&128)throw new K.ErrnoError(20)}else g=K.mknod(a,d,0),h=!0;if(!g)throw new K.ErrnoError(44);K.isChrdev(g.mode)&&(b&=-513);if(b&65536&&!K.isDir(g.mode))throw new K.ErrnoError(54);if(!h){d=K.mayOpen(g,b);if(d)throw new K.ErrnoError(d)}b&512&&K.truncate(g,0);b&=~(128|512|131072);h=K.createStream({node:g,path:K.getPath(g),flags:b,seekable:!0,position:0,stream_ops:g.stream_ops,ungotten:[],error:!1},e,f);h.stream_ops.open&&h.stream_ops.open(h);c.logReadFiles&&!(b&1)&&(K.readFiles||(K.readFiles={}),a in K.readFiles||(K.readFiles[a]=1));return h},close:function(a){if(K.isClosed(a))throw new K.ErrnoError(8);a.getdents&&(a.getdents=null);try{a.stream_ops.close&&a.stream_ops.close(a)}catch(a){throw a}finally{K.closeStream(a.fd)}a.fd=null},isClosed:function(a){return a.fd===null},llseek:function(a,b,c){if(K.isClosed(a))throw new K.ErrnoError(8);if(!a.seekable||!a.stream_ops.llseek)throw new K.ErrnoError(70);if(c!=0&&c!=1&&c!=2)throw new K.ErrnoError(28);a.position=a.stream_ops.llseek(a,b,c);a.ungotten=[];return a.position},read:function(b,a,c,d,e){if(d<0||e<0)throw new K.ErrnoError(28);if(K.isClosed(b))throw new K.ErrnoError(8);if((b.flags&2097155)===1)throw new K.ErrnoError(8);if(K.isDir(b.node.mode))throw new K.ErrnoError(31);if(!b.stream_ops.read)throw new K.ErrnoError(28);var f=typeof e!=="undefined";if(!f)e=b.position;else if(!b.seekable)throw new K.ErrnoError(70);a=b.stream_ops.read(b,a,c,d,e);f||(b.position+=a);return a},write:function(b,a,c,d,e,f){if(d<0||e<0)throw new K.ErrnoError(28);if(K.isClosed(b))throw new K.ErrnoError(8);if((b.flags&2097155)===0)throw new K.ErrnoError(8);if(K.isDir(b.node.mode))throw new K.ErrnoError(31);if(!b.stream_ops.write)throw new K.ErrnoError(28);b.seekable&&b.flags&1024&&K.llseek(b,0,2);var g=typeof e!=="undefined";if(!g)e=b.position;else if(!b.seekable)throw new K.ErrnoError(70);a=b.stream_ops.write(b,a,c,d,e,f);g||(b.position+=a);return a},allocate:function(a,b,c){if(K.isClosed(a))throw new K.ErrnoError(8);if(b<0||c<=0)throw new K.ErrnoError(28);if((a.flags&2097155)===0)throw new K.ErrnoError(8);if(!K.isFile(a.node.mode)&&!K.isDir(a.node.mode))throw new K.ErrnoError(43);if(!a.stream_ops.allocate)throw new K.ErrnoError(138);a.stream_ops.allocate(a,b,c)},mmap:function(a,b,c,d,e,f){if((e&2)!==0&&(f&2)===0&&(a.flags&2097155)!==2)throw new K.ErrnoError(2);if((a.flags&2097155)===1)throw new K.ErrnoError(2);if(!a.stream_ops.mmap)throw new K.ErrnoError(43);return a.stream_ops.mmap(a,b,c,d,e,f)},msync:function(b,a,c,d,e){return!b||!b.stream_ops.msync?0:b.stream_ops.msync(b,a,c,d,e)},munmap:function(a){return 0},ioctl:function(a,b,c){if(!a.stream_ops.ioctl)throw new K.ErrnoError(59);return a.stream_ops.ioctl(a,b,c)},readFile:function(a,b){b===void 0&&(b={});b.flags=b.flags||0;b.encoding=b.encoding||"binary";if(b.encoding!=="utf8"&&b.encoding!=="binary")throw new Error('Invalid encoding type "'+b.encoding+'"');var c,d=K.open(a,b.flags);a=K.stat(a);a=a.size;var e=new Uint8Array(a);K.read(d,e,0,a,0);b.encoding==="utf8"?c=t(e,0):b.encoding==="binary"&&(c=e);K.close(d);return c},writeFile:function(a,b,c){c===void 0&&(c={});c.flags=c.flags||577;a=K.open(a,c.flags,c.mode);if(typeof b==="string"){var d=new Uint8Array(oa(b)+1),e=ma(b,d,0,d.length);K.write(a,d,0,e,void 0,c.canOwn)}else if(ArrayBuffer.isView(b))K.write(a,b,0,b.byteLength,void 0,c.canOwn);else throw new Error("Unsupported data type");K.close(a)},cwd:function(){return K.currentPath},chdir:function(a){a=K.lookupPath(a,{follow:!0});if(a.node===null)throw new K.ErrnoError(44);if(!K.isDir(a.node.mode))throw new K.ErrnoError(54);var b=K.nodePermissions(a.node,"x");if(b)throw new K.ErrnoError(b);K.currentPath=a.path},createDefaultDirectories:function(){K.mkdir("/tmp"),K.mkdir("/home"),K.mkdir("/home/web_user")},createDefaultDevices:function(){K.mkdir("/dev");K.registerDevice(K.makedev(1,3),{read:function(){return 0},write:function(b,a,c,d,e){return d}});K.mkdev("/dev/null",K.makedev(1,3));I.register(K.makedev(5,0),I.default_tty_ops);I.register(K.makedev(6,0),I.default_tty1_ops);K.mkdev("/dev/tty",K.makedev(5,0));K.mkdev("/dev/tty1",K.makedev(6,0));var a=nb();K.createDevice("/dev","random",a);K.createDevice("/dev","urandom",a);K.mkdir("/dev/shm");K.mkdir("/dev/shm/tmp")},createSpecialDirectories:function(){K.mkdir("/proc");var a=K.mkdir("/proc/self");K.mkdir("/proc/self/fd");K.mount({mount:function(){var b=K.createNode(a,"fd",16384|511,73);b.node_ops={lookup:function(a,b){a=+b;var c=K.getStream(a);if(!c)throw new K.ErrnoError(8);b={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:function(){return c.path}}};b.parent=b;return b}};return b}},{},"/proc/self/fd")},createStandardStreams:function(){c.stdin?K.createDevice("/dev","stdin",c.stdin):K.symlink("/dev/tty","/dev/stdin"),c.stdout?K.createDevice("/dev","stdout",null,c.stdout):K.symlink("/dev/tty","/dev/stdout"),c.stderr?K.createDevice("/dev","stderr",null,c.stderr):K.symlink("/dev/tty1","/dev/stderr"),K.open("/dev/stdin",0),K.open("/dev/stdout",1),K.open("/dev/stderr",1)},ensureErrnoError:function(){if(K.ErrnoError)return;K.ErrnoError=function(a,b){this.node=b,this.setErrno=function(a){this.errno=a},this.setErrno(a),this.message="FS error"};K.ErrnoError.prototype=new Error();K.ErrnoError.prototype.constructor=K.ErrnoError;[44].forEach(function(a){K.genericErrors[a]=new K.ErrnoError(a),K.genericErrors[a].stack="<generic error, no stack>"})},staticInit:function(){K.ensureErrnoError(),K.nameTable=new Array(4096),K.mount(J,{},"/"),K.createDefaultDirectories(),K.createDefaultDevices(),K.createSpecialDirectories(),K.filesystems={MEMFS:J}},init:function(a,b,d){K.init.initialized=!0,K.ensureErrnoError(),c.stdin=a||c.stdin,c.stdout=b||c.stdout,c.stderr=d||c.stderr,K.createStandardStreams()},quit:function(){K.init.initialized=!1;for(var a=0;a<K.streams.length;a++){var b=K.streams[a];if(!b)continue;K.close(b)}},getMode:function(a,b){var c=0;a&&(c|=292|73);b&&(c|=146);return c},findObject:function(a,b){a=K.analyzePath(a,b);if(a.exists)return a.object;else return null},analyzePath:function(a,b){try{var c=K.lookupPath(a,{follow:!b});a=c.path}catch(a){}var d={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var c=K.lookupPath(a,{parent:!0});d.parentExists=!0;d.parentPath=c.path;d.parentObject=c.node;d.name=G.basename(a);c=K.lookupPath(a,{follow:!b});d.exists=!0;d.path=c.path;d.object=c.node;d.name=c.node.name;d.isRoot=c.path==="/"}catch(a){d.error=a.errno}return d},createPath:function(a,b,c,d){a=typeof a==="string"?a:K.getPath(a);c=b.split("/").reverse();while(c.length){d=c.pop();if(!d)continue;var e=G.join2(a,d);try{K.mkdir(e)}catch(a){}a=e}return e},createFile:function(a,b,c,d,e){c=G.join2(typeof a==="string"?a:K.getPath(a),b);a=K.getMode(d,e);return K.create(c,a)},createDataFile:function(a,b,c,d,e,f){var g=b;a&&(a=typeof a==="string"?a:K.getPath(a),g=b?G.join2(a,b):a);b=K.getMode(d,e);a=K.create(g,b);if(c){if(typeof c==="string"){d=new Array(c.length);for(e=0,g=c.length;e<g;++e)d[e]=c.charCodeAt(e);c=d}K.chmod(a,b|146);e=K.open(a,577);K.write(e,c,0,c.length,0,f);K.close(e);K.chmod(a,b)}return a},createDevice:function(a,b,c,d){a=G.join2(typeof a==="string"?a:K.getPath(a),b);b=K.getMode(!!c,!!d);K.createDevice.major||(K.createDevice.major=64);var e=K.makedev(K.createDevice.major++,0);K.registerDevice(e,{open:function(a){a.seekable=!1},close:function(a){d&&d.buffer&&d.buffer.length&&d(10)},read:function(b,a,d,e,f){f=0;for(var g=0;g<e;g++){var h;try{h=c()}catch(a){throw new K.ErrnoError(29)}if(h===void 0&&f===0)throw new K.ErrnoError(6);if(h===null||h===void 0)break;f++;a[d+g]=h}f&&(b.node.timestamp=Date.now());return f},write:function(b,a,c,e,f){for(f=0;f<e;f++)try{d(a[c+f])}catch(a){throw new K.ErrnoError(29)}e&&(b.node.timestamp=Date.now());return f}});return K.mkdev(a,b,e)},forceLoadFile:function(a){if(a.isDevice||a.isFolder||a.link||a.contents)return!0;if(typeof XMLHttpRequest!=="undefined")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");else if(ba)try{a.contents=ud(ba(a.url),!0),a.usedBytes=a.contents.length}catch(a){throw new K.ErrnoError(29)}else throw new Error("Cannot load without read() or XMLHttpRequest.")},createLazyFile:function(a,b,c,d,e){function f(){this.lengthKnown=!1,this.chunks=[]}f.prototype.get=function(a){if(a>this.length-1||a<0)return void 0;var b=a%this.chunkSize;a=a/this.chunkSize|0;return this.getter(a)[b]};f.prototype.setDataGetter=function(a){this.getter=a};f.prototype.cacheLength=function(){var a=new XMLHttpRequest();a.open("HEAD",c,!1);a.send(null);if(!(a.status>=200&&a.status<300||a.status===304))throw new Error("Couldn't load "+c+". Status: "+a.status);var b=Number(a.getResponseHeader("Content-length")),d,e=(d=a.getResponseHeader("Accept-Ranges"))&&d==="bytes";a=(d=a.getResponseHeader("Content-Encoding"))&&d==="gzip";var f=1024*1024;e||(f=b);var g=function(d,e){if(d>e)throw new Error("invalid range ("+d+", "+e+") or no bytes requested!");if(e>b-1)throw new Error("only "+b+" bytes available! programmer error!");var a=new XMLHttpRequest();a.open("GET",c,!1);b!==f&&a.setRequestHeader("Range","bytes="+d+"-"+e);typeof Uint8Array!="undefined"&&(a.responseType="arraybuffer");a.overrideMimeType&&a.overrideMimeType("text/plain; charset=x-user-defined");a.send(null);if(!(a.status>=200&&a.status<300||a.status===304))throw new Error("Couldn't load "+c+". Status: "+a.status);if(a.response!==void 0)return new Uint8Array(a.response||[]);else return ud(a.responseText||"",!0)},h=this;h.setDataGetter(function(a){var c=a*f,d=(a+1)*f-1;d=Math.min(d,b-1);typeof h.chunks[a]==="undefined"&&(h.chunks[a]=g(c,d));if(typeof h.chunks[a]==="undefined")throw new Error("doXHR failed!");return h.chunks[a]});(a||!b)&&(f=b=1,b=this.getter(0).length,f=b,ea("LazyFiles on gzip forces download of the whole file when length is accessed"));this._length=b;this._chunkSize=f;this.lengthKnown=!0};if(typeof XMLHttpRequest!=="undefined"){if(!o)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";f=new f();Object.defineProperties(f,{length:{get:function(){this.lengthKnown||this.cacheLength();return this._length}},chunkSize:{get:function(){this.lengthKnown||this.cacheLength();return this._chunkSize}}});f={isDevice:!1,contents:f}}else var f={isDevice:!1,url:c};var g=K.createFile(a,b,f,d,e);f.contents?g.contents=f.contents:f.url&&(g.contents=null,g.url=f.url);Object.defineProperties(g,{usedBytes:{get:function(){return this.contents.length}}});var h={};a=Object.keys(g.stream_ops);a.forEach(function(a){var b=g.stream_ops[a];h[a]=function(){K.forceLoadFile(g);return b.apply(null,arguments)}});h.read=function(b,a,c,d,e){K.forceLoadFile(g);b=b.node.contents;if(e>=b.length)return 0;d=Math.min(b.length-e,d);if(b.slice)for(var f=0;f<d;f++)a[c+f]=b[e+f];else for(var f=0;f<d;f++)a[c+f]=b.get(e+f);return d};g.stream_ops=h;return g},createPreloadedFile:function(a,b,c,d,e,f,g,h,i,j){var k=b?H.resolve(G.join2(a,b)):a,l=Pa("cp "+k);function m(c){function m(c){j&&j(),h||K.createDataFile(a,b,c,d,e,i),f&&f(),Ra(l)}if(Browser.handledByPreloadPlugin(c,k,m,function(){g&&g(),Ra(l)}))return;m(c)}Qa(l);typeof c=="string"?pb(c,function(a){return m(a)},g):m(c)},indexedDB:function(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB},DB_NAME:function(){return"EM_FS_"+window.location.pathname},DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:function(a,b,c){b=b||function(){};c=c||function(){};var d=K.indexedDB();try{var e=d.open(K.DB_NAME(),K.DB_VERSION)}catch(a){return c(a)}e.onupgradeneeded=function(){ea("creating db");var a=e.result;a.createObjectStore(K.DB_STORE_NAME)};e.onsuccess=function(){var d=e.result;d=d.transaction([K.DB_STORE_NAME],"readwrite");var f=d.objectStore(K.DB_STORE_NAME),g=0,h=0,i=a.length;function j(){h==0?b():c()}a.forEach(function(a){a=f.put(K.analyzePath(a).object.contents,a);a.onsuccess=function(){g++,g+h==i&&j()};a.onerror=function(){h++,g+h==i&&j()}});d.onerror=c};e.onerror=c},loadFilesFromDB:function(a,b,c){b=b||function(){};c=c||function(){};var d=K.indexedDB();try{var e=d.open(K.DB_NAME(),K.DB_VERSION)}catch(a){return c(a)}e.onupgradeneeded=c;e.onsuccess=function(){var d=e.result;try{var f=d.transaction([K.DB_STORE_NAME],"readonly")}catch(a){c(a);return}var g=f.objectStore(K.DB_STORE_NAME),h=0,i=0,j=a.length;function k(){i==0?b():c()}a.forEach(function(a){var b=g.get(a);b.onsuccess=function(){K.analyzePath(a).exists&&K.unlink(a),K.createDataFile(G.dirname(a),G.basename(a),b.result,!0,!0,!0),h++,h+i==j&&k()};b.onerror=function(){i++,h+i==j&&k()}});f.onerror=c};e.onerror=c}},L={mappings:{},DEFAULT_POLLMASK:5,calculateAt:function(a,b,c){if(b[0]==="/")return b;var d;if(a===-100)d=K.cwd();else{a=K.getStream(a);if(!a)throw new K.ErrnoError(8);d=a.path}if(b.length==0){if(!c)throw new K.ErrnoError(44);return d}return G.join2(d,b)},doStat:function(a,b,c){try{var d=a(b)}catch(a){if(a&&a.node&&G.normalize(b)!==G.normalize(K.getPath(a.node)))return-54;throw a}x[c>>2]=d.dev;x[c+4>>2]=0;x[c+8>>2]=d.ino;x[c+12>>2]=d.mode;x[c+16>>2]=d.nlink;x[c+20>>2]=d.uid;x[c+24>>2]=d.gid;x[c+28>>2]=d.rdev;x[c+32>>2]=0;D=[d.size>>>0,(C=d.size,+Math.abs(C)>=1?C>0?(Math.min(+Math.floor(C/4294967296),4294967295)|0)>>>0:~~+Math.ceil((C-+(~~C>>>0))/4294967296)>>>0:0)],x[c+40>>2]=D[0],x[c+44>>2]=D[1];x[c+48>>2]=4096;x[c+52>>2]=d.blocks;x[c+56>>2]=d.atime.getTime()/1e3|0;x[c+60>>2]=0;x[c+64>>2]=d.mtime.getTime()/1e3|0;x[c+68>>2]=0;x[c+72>>2]=d.ctime.getTime()/1e3|0;x[c+76>>2]=0;D=[d.ino>>>0,(C=d.ino,+Math.abs(C)>=1?C>0?(Math.min(+Math.floor(C/4294967296),4294967295)|0)>>>0:~~+Math.ceil((C-+(~~C>>>0))/4294967296)>>>0:0)],x[c+80>>2]=D[0],x[c+84>>2]=D[1];return 0},doMsync:function(a,b,c,d,e){a=v.slice(a,a+c);K.msync(b,a,e,c,d)},doMkdir:function(a,b){a=G.normalize(a);a[a.length-1]==="/"&&(a=a.substr(0,a.length-1));K.mkdir(a,b,0);return 0},doMknod:function(a,b,c){switch(b&61440){case 32768:case 8192:case 24576:case 4096:case 49152:break;default:return-28}K.mknod(a,b,c);return 0},doReadlink:function(a,b,c){if(c<=0)return-28;a=K.readlink(a);var d=Math.min(c,oa(a)),e=u[b+d];na(a,b,c+1);u[b+d]=e;return d},doAccess:function(a,b){if(b&-8)return-28;a=K.lookupPath(a,{follow:!0});a=a.node;if(!a)return-44;var c="";b&4&&(c+="r");b&2&&(c+="w");b&1&&(c+="x");return c&&K.nodePermissions(a,c)?-2:0},doDup:function(a,b,c){var d=K.getStream(c);d&&K.close(d);return K.open(a,b,0,c,c).fd},doReadv:function(a,b,c,d){var e=0;for(var f=0;f<c;f++){var g=x[b+f*8>>2],h=x[b+(f*8+4)>>2];g=K.read(a,u,g,h,d);if(g<0)return-1;e+=g;if(g<h)break}return e},doWritev:function(a,b,c,d){var e=0;for(var f=0;f<c;f++){var g=x[b+f*8>>2],h=x[b+(f*8+4)>>2];g=K.write(a,u,g,h,d);if(g<0)return-1;e+=g}return e},varargs:void 0,get:function(){L.varargs+=4;var a=x[L.varargs-4>>2];return a},getStr:function(a){a=la(a);return a},getStreamFromFD:function(a){a=K.getStream(a);if(!a)throw new K.ErrnoError(8);return a},get64:function(a,b){return a}};function qb(a,b){try{if(b===0)return-28;var c=K.cwd(),d=oa(c);if(b<d+1)return-68;na(c,a,b);return a}catch(a){if(typeof K==="undefined"||!(a instanceof K.ErrnoError))throw a;return-a.errno}}function rb(a,b,c){L.varargs=c;try{a=L.getStr(a);c=c?L.get():0;a=K.open(a,b,c);return a.fd}catch(a){if(typeof K==="undefined"||!(a instanceof K.ErrnoError))throw a;return-a.errno}}function sb(a,b,c,d,e){}function tb(a){switch(a){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+a)}}function ub(){var a=new Array(256);for(var b=0;b<256;++b)a[b]=String.fromCharCode(b);vb=a}var vb=void 0;function M(a){var b="";a=a;while(v[a])b+=vb[v[a++]];return b}var N={},O={},wb={},xb=48,yb=57;function zb(a){if(void 0===a)return"_unknown";a=a.replace(/[^a-zA-Z0-9_]/g,"$");var b=a.charCodeAt(0);if(b>=xb&&b<=yb)return"_"+a;else return a}function Ab(a,b){zb(a);return function(){return b.apply(this,arguments)}}function Bb(a,b){var c=Ab(b,function(a){this.name=b;this.message=a;a=new Error(a).stack;a!==void 0&&(this.stack=this.toString()+"\n"+a.replace(/^Error(:[^\n]*)?\n/,""))});c.prototype=Object.create(a.prototype);c.prototype.constructor=c;c.prototype.toString=function(){if(this.message===void 0)return this.name;else return this.name+": "+this.message};return c}var P=void 0;function Q(a){throw new P(a)}var Cb=void 0;function Db(a){throw new Cb(a)}function R(a,b,c){a.forEach(function(a){wb[a]=b});function d(b){b=c(b);b.length!==a.length&&Db("Mismatched type converter count");for(var d=0;d<a.length;++d)S(a[d],b[d])}var e=new Array(b.length),f=[],g=0;b.forEach(function(a,b){Object.prototype.hasOwnProperty.call(O,a)?e[b]=O[a]:(f.push(a),Object.prototype.hasOwnProperty.call(N,a)||(N[a]=[]),N[a].push(function(){e[b]=O[a],++g,g===f.length&&d(e)}))});0===f.length&&d(e)}function S(a,b,c){c===void 0&&(c={});if(!("argPackAdvance"in b))throw new TypeError("registerType registeredInstance requires argPackAdvance");var d=b.name;a||Q('type "'+d+'" must have a positive integer typeid pointer');if(Object.prototype.hasOwnProperty.call(O,a))if(c.ignoreDuplicateRegistrations)return;else Q("Cannot register type '"+d+"' twice");O[a]=b;delete wb[a];if(Object.prototype.hasOwnProperty.call(N,a)){c=N[a];delete N[a];c.forEach(function(a){a()})}}function Eb(a,b,c,d,e){var f=tb(c);b=M(b);S(a,{name:b,fromWireType:function(a){return!!a},toWireType:function(a,b){return b?d:e},argPackAdvance:8,readValueFromPointer:function(a){var d;if(c===1)d=u;else if(c===2)d=w;else if(c===4)d=x;else throw new TypeError("Unknown boolean type size: "+b);return this.fromWireType(d[a>>f])},destructorFunction:null})}function Fb(a){if(!(this instanceof T))return!1;if(!(a instanceof T))return!1;var b=this.$$.ptrType.registeredClass,c=this.$$.ptr,d=a.$$.ptrType.registeredClass;a=a.$$.ptr;while(b.baseClass)c=b.upcast(c),b=b.baseClass;while(d.baseClass)a=d.upcast(a),d=d.baseClass;return b===d&&c===a}function Gb(a){return{count:a.count,deleteScheduled:a.deleteScheduled,preservePointerOnDelete:a.preservePointerOnDelete,ptr:a.ptr,ptrType:a.ptrType,smartPtr:a.smartPtr,smartPtrType:a.smartPtrType}}function Hb(a){function b(a){return a.$$.ptrType.registeredClass.name}Q(b(a)+" instance already deleted")}var Ib=!1;function Jb(a){}function Kb(a){a.smartPtr?a.smartPtrType.rawDestructor(a.smartPtr):a.ptrType.registeredClass.rawDestructor(a.ptr)}function Lb(a){a.count.value-=1;var b=0===a.count.value;b&&Kb(a)}function Mb(a){if("undefined"===typeof FinalizationGroup){Mb=function(a){return a};return a}Ib=new FinalizationGroup(function(a){for(var b=a.next();!b.done;b=a.next()){var c=b.value;c.ptr&&Lb(c)}});Mb=function(a){Ib.register(a,a.$$,a.$$);return a};Jb=function(a){Ib.unregister(a.$$)};return Mb(a)}function Nb(){this.$$.ptr||Hb(this);if(this.$$.preservePointerOnDelete){this.$$.count.value+=1;return this}else{var a=Mb(Object.create(Object.getPrototypeOf(this),{$$:{value:Gb(this.$$)}}));a.$$.count.value+=1;a.$$.deleteScheduled=!1;return a}}function Ob(){this.$$.ptr||Hb(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Q("Object already scheduled for deletion"),Jb(this),Lb(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function Pb(){return!this.$$.ptr}var Qb=void 0,Rb=[];function Sb(){while(Rb.length){var a=Rb.pop();a.$$.deleteScheduled=!1;a["delete"]()}}function Tb(){this.$$.ptr||Hb(this);this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Q("Object already scheduled for deletion");Rb.push(this);Rb.length===1&&Qb&&Qb(Sb);this.$$.deleteScheduled=!0;return this}function Ub(){T.prototype.isAliasOf=Fb,T.prototype.clone=Nb,T.prototype["delete"]=Ob,T.prototype.isDeleted=Pb,T.prototype.deleteLater=Tb}function T(){}var Vb={};function Wb(a,b,c){if(void 0===a[b].overloadTable){var d=a[b];a[b]=function(){Object.prototype.hasOwnProperty.call(a[b].overloadTable,arguments.length)||Q("Function '"+c+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+a[b].overloadTable+")!");return a[b].overloadTable[arguments.length].apply(this,arguments)};a[b].overloadTable=[];a[b].overloadTable[d.argCount]=d}}function Xb(a,b,d){Object.prototype.hasOwnProperty.call(c,a)?((void 0===d||void 0!==c[a].overloadTable&&void 0!==c[a].overloadTable[d])&&Q("Cannot register public name '"+a+"' twice"),Wb(c,a,a),Object.prototype.hasOwnProperty.call(c,d)&&Q("Cannot register multiple overloads of a function with the same number of arguments ("+d+")!"),c[a].overloadTable[d]=b):(c[a]=b,void 0!==d&&(c[a].numArguments=d))}function Yb(a,b,c,d,e,f,g,h){this.name=a,this.constructor=b,this.instancePrototype=c,this.rawDestructor=d,this.baseClass=e,this.getActualType=f,this.upcast=g,this.downcast=h,this.pureVirtualFunctions=[]}function Zb(a,b,c){while(b!==c)b.upcast||Q("Expected null or instance of "+c.name+", got an instance of "+b.name),a=b.upcast(a),b=b.baseClass;return a}function $b(a,b){if(b===null){this.isReference&&Q("null is not a valid "+this.name);return 0}b.$$||Q('Cannot pass "'+Lc(b)+'" as a '+this.name);b.$$.ptr||Q("Cannot pass deleted object as a pointer of type "+this.name);a=b.$$.ptrType.registeredClass;b=Zb(b.$$.ptr,a,this.registeredClass);return b}function ac(a,b){var c;if(b===null){this.isReference&&Q("null is not a valid "+this.name);if(this.isSmartPointer){c=this.rawConstructor();a!==null&&a.push(this.rawDestructor,c);return c}else return 0}b.$$||Q('Cannot pass "'+Lc(b)+'" as a '+this.name);b.$$.ptr||Q("Cannot pass deleted object as a pointer of type "+this.name);!this.isConst&&b.$$.ptrType.isConst&&Q("Cannot convert argument of type "+(b.$$.smartPtrType?b.$$.smartPtrType.name:b.$$.ptrType.name)+" to parameter type "+this.name);var d=b.$$.ptrType.registeredClass;c=Zb(b.$$.ptr,d,this.registeredClass);if(this.isSmartPointer){void 0===b.$$.smartPtr&&Q("Passing raw pointer to smart pointer is illegal");switch(this.sharingPolicy){case 0:b.$$.smartPtrType===this?c=b.$$.smartPtr:Q("Cannot convert argument of type "+(b.$$.smartPtrType?b.$$.smartPtrType.name:b.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:c=b.$$.smartPtr;break;case 2:if(b.$$.smartPtrType===this)c=b.$$.smartPtr;else{var e=b.clone();c=this.rawShare(c,Jc.toHandle(function(){e["delete"]()}));a!==null&&a.push(this.rawDestructor,c)}break;default:Q("Unsupporting sharing policy")}}return c}function bc(a,b){if(b===null){this.isReference&&Q("null is not a valid "+this.name);return 0}b.$$||Q('Cannot pass "'+Lc(b)+'" as a '+this.name);b.$$.ptr||Q("Cannot pass deleted object as a pointer of type "+this.name);b.$$.ptrType.isConst&&Q("Cannot convert argument of type "+b.$$.ptrType.name+" to parameter type "+this.name);a=b.$$.ptrType.registeredClass;b=Zb(b.$$.ptr,a,this.registeredClass);return b}function cc(a){return this.fromWireType(y[a>>2])}function dc(a){this.rawGetPointee&&(a=this.rawGetPointee(a));return a}function ec(a){this.rawDestructor&&this.rawDestructor(a)}function fc(a){a!==null&&a["delete"]()}function gc(a,b,c){if(b===c)return a;if(void 0===c.baseClass)return null;a=gc(a,b,c.baseClass);return a===null?null:c.downcast(a)}function hc(){return Object.keys(lc).length}function ic(){var a=[];for(var b in lc)Object.prototype.hasOwnProperty.call(lc,b)&&a.push(lc[b]);return a}function jc(a){Qb=a,Rb.length&&Qb&&Qb(Sb)}function kc(){c.getInheritedInstanceCount=hc,c.getLiveInheritedInstances=ic,c.flushPendingDeletes=Sb,c.setDelayFunction=jc}var lc={};function mc(a,b){b===void 0&&Q("ptr should not be undefined");while(a.baseClass)b=a.upcast(b),a=a.baseClass;return b}function nc(a,b){b=mc(a,b);return lc[b]}function oc(a,b){(!b.ptrType||!b.ptr)&&Db("makeClassHandle requires ptr and ptrType");var c=!!b.smartPtrType,d=!!b.smartPtr;c!==d&&Db("Both smartPtrType and smartPtr must be specified");b.count={value:1};return Mb(Object.create(a,{$$:{value:b}}))}function pc(a){var b=this.getPointee(a);if(!b){this.destructor(a);return null}var c=nc(this.registeredClass,b);if(void 0!==c)if(0===c.$$.count.value){c.$$.ptr=b;c.$$.smartPtr=a;return c.clone()}else{c=c.clone();this.destructor(a);return c}function d(){if(this.isSmartPointer)return oc(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:b,smartPtrType:this,smartPtr:a});else return oc(this.registeredClass.instancePrototype,{ptrType:this,ptr:a})}c=this.registeredClass.getActualType(b);c=Vb[c];if(!c)return d.call(this);var e;this.isConst?e=c.constPointerType:e=c.pointerType;c=gc(b,this.registeredClass,e.registeredClass);if(c===null)return d.call(this);if(this.isSmartPointer)return oc(e.registeredClass.instancePrototype,{ptrType:e,ptr:c,smartPtrType:this,smartPtr:a});else return oc(e.registeredClass.instancePrototype,{ptrType:e,ptr:c})}function qc(){U.prototype.getPointee=dc,U.prototype.destructor=ec,U.prototype.argPackAdvance=8,U.prototype.readValueFromPointer=cc,U.prototype.deleteObject=fc,U.prototype.fromWireType=pc}function U(a,b,c,d,e,f,g,h,i,j,k){this.name=a,this.registeredClass=b,this.isReference=c,this.isConst=d,this.isSmartPointer=e,this.pointeeType=f,this.sharingPolicy=g,this.rawGetPointee=h,this.rawConstructor=i,this.rawShare=j,this.rawDestructor=k,!e&&b.baseClass===void 0?d?(this.toWireType=$b,this.destructorFunction=null):(this.toWireType=bc,this.destructorFunction=null):this.toWireType=ac}function rc(a,b,d){Object.prototype.hasOwnProperty.call(c,a)||Db("Replacing nonexistant public symbol"),void 0!==c[a].overloadTable&&void 0!==d?c[a].overloadTable[d]=b:(c[a]=b,c[a].argCount=d)}function sc(a,b,d){a=c["dynCall_"+a];return d&&d.length?a.apply(null,[b].concat(d)):a.call(null,b)}function tc(a,b,c){return a.includes("j")?sc(a,b,c):E(b).apply(null,c)}function uc(a,b){var c=[];return function(){c.length=arguments.length;for(var d=0;d<arguments.length;d++)c[d]=arguments[d];return tc(a,b,c)}}function V(a,b){a=M(a);function c(){return a.includes("j")?uc(a,b):E(b)}c=c();typeof c!=="function"&&Q("unknown function pointer with signature "+a+": "+b);return c}var vc=void 0;function wc(a){a=xd(a);var b=M(a);X(a);return b}function xc(a,b){var c=[],d={};function e(a){if(d[a])return;if(O[a])return;if(wb[a]){wb[a].forEach(e);return}c.push(a);d[a]=!0}b.forEach(e);throw new vc(a+": "+c.map(wc).join([", "]))}function yc(a,b,c,d,e,f,g,h,i,j,k,l,m){k=M(k);f=V(e,f);h&&(h=V(g,h));j&&(j=V(i,j));m=V(l,m);var n=zb(k);Xb(n,function(){xc("Cannot construct "+k+" due to unbound types",[d])});R([a,b,c],d?[d]:[],function(b){b=b[0];var c;d?(c=b.registeredClass,b=c.instancePrototype):b=T.prototype;var e=Ab(n,function(){if(Object.getPrototypeOf(this)!==g)throw new P("Use 'new' to construct "+k);if(void 0===i.constructor_body)throw new P(k+" has no accessible constructor");var a=i.constructor_body[arguments.length];if(void 0===a)throw new P("Tried to invoke ctor of "+k+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(i.constructor_body).toString()+") parameters instead!");return a.apply(this,arguments)}),g=Object.create(b,{constructor:{value:e}});e.prototype=g;var i=new Yb(k,e,g,m,c,f,h,j);b=new U(k,i,!0,!1,!1);var l=new U(k+"*",i,!1,!1,!1),o=new U(k+" const*",i,!1,!0,!1);Vb[a]={pointerType:l,constPointerType:o};rc(n,e);return[b,l,o]})}function zc(a,b){var c=[];for(var d=0;d<a;d++)c.push(x[(b>>2)+d]);return c}function Ac(a){while(a.length){var b=a.pop(),c=a.pop();c(b)}}function Bc(a,b,c,d,e,f){ja(b>0);var g=zc(b,c);e=V(d,e);R([],[a],function(a){a=a[0];var c="constructor "+a.name;void 0===a.registeredClass.constructor_body&&(a.registeredClass.constructor_body=[]);if(void 0!==a.registeredClass.constructor_body[b-1])throw new P("Cannot register multiple constructors with identical number of parameters ("+(b-1)+") for class '"+a.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");a.registeredClass.constructor_body[b-1]=function(){xc("Cannot construct "+a.name+" due to unbound types",g)};R([],g,function(d){d.splice(1,0,null);a.registeredClass.constructor_body[b-1]=Cc(c,d,null,e,f);return[]});return[]})}function Cc(a,b,c,d,e){var f=b.length;f<2&&Q("argTypes array size mismatch! Must at least get return value and 'this' types!");var g=b[1]!==null&&c!==null,h=!1;for(c=1;c<b.length;++c)if(b[c]!==null&&b[c].destructorFunction===void 0){h=!0;break}var i=b[0].name!=="void",j=f-2,k=new Array(j),l=[],m=[];return function(){arguments.length!==j&&Q("function "+a+" called with "+arguments.length+" arguments, expected "+j+" args!");m.length=0;var c;l.length=g?2:1;l[0]=e;g&&(c=b[1].toWireType(m,this),l[1]=c);for(var f=0;f<j;++f)k[f]=b[f+2].toWireType(m,arguments[f]),l.push(k[f]);var n=d.apply(null,l);function o(d){if(h)Ac(m);else for(var a=g?1:2;a<b.length;a++){var e=a===1?c:k[a-2];b[a].destructorFunction!==null&&b[a].destructorFunction(e)}if(i)return b[0].fromWireType(d)}return o(n)}}function Dc(a,b,c,d,e,f,g,h){var i=zc(c,d);b=M(b);f=V(e,f);R([],[a],function(a){a=a[0];var d=a.name+"."+b;b.startsWith("@@")&&(b=Symbol[b.substring(2)]);h&&a.registeredClass.pureVirtualFunctions.push(b);function e(){xc("Cannot call "+d+" due to unbound types",i)}var j=a.registeredClass.instancePrototype,k=j[b];void 0===k||void 0===k.overloadTable&&k.className!==a.name&&k.argCount===c-2?(e.argCount=c-2,e.className=a.name,j[b]=e):(Wb(j,b,d),j[b].overloadTable[c-2]=e);R([],i,function(e){e=Cc(d,e,a,f,g);void 0===j[b].overloadTable?(e.argCount=c-2,j[b]=e):j[b].overloadTable[c-2]=e;return[]});return[]})}var Ec=[],W=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Fc(a){a>4&&0===--W[a].refcount&&(W[a]=void 0,Ec.push(a))}function Gc(){var a=0;for(var b=5;b<W.length;++b)W[b]!==void 0&&++a;return a}function Hc(){for(var a=5;a<W.length;++a)if(W[a]!==void 0)return W[a];return null}function Ic(){c.count_emval_handles=Gc,c.get_first_emval=Hc}var Jc={toValue:function(a){a||Q("Cannot use deleted val. handle = "+a);return W[a].value},toHandle:function(a){switch(a){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var b=Ec.length?Ec.pop():W.length;W[b]={refcount:1,value:a};return b}}};function Kc(a,b){b=M(b),S(a,{name:b,fromWireType:function(a){var b=Jc.toValue(a);Fc(a);return b},toWireType:function(a,b){return Jc.toHandle(b)},argPackAdvance:8,readValueFromPointer:cc,destructorFunction:null})}function Lc(a){if(a===null)return"null";var b=typeof a;if(b==="object"||b==="array"||b==="function")return a.toString();else return""+a}function Mc(a,b){switch(b){case 2:return function(a){return this.fromWireType(Aa[a>>2])};case 3:return function(a){return this.fromWireType(Ba[a>>3])};default:throw new TypeError("Unknown float type: "+a)}}function Nc(a,b,c){c=tb(c);b=M(b);S(a,{name:b,fromWireType:function(a){return a},toWireType:function(a,b){return b},argPackAdvance:8,readValueFromPointer:Mc(b,c),destructorFunction:null})}function Oc(a,b,c,d,e,f){var g=zc(b,c);a=M(a);e=V(d,e);Xb(a,function(){xc("Cannot call "+a+" due to unbound types",g)},b-1);R([],g,function(c){c=[c[0],null].concat(c.slice(1));rc(a,Cc(a,c,null,e,f),b-1);return[]})}function Pc(a,b,c){switch(b){case 0:return c?function(a){return u[a]}:function(a){return v[a]};case 1:return c?function(a){return w[a>>1]}:function(a){return za[a>>1]};case 2:return c?function(a){return x[a>>2]}:function(a){return y[a>>2]};default:throw new TypeError("Unknown integer type: "+a)}}function Qc(a,b,c,d,e){b=M(b);e===-1&&(e=4294967295);e=tb(c);var f=function(a){return a};if(d===0){var g=32-8*c;f=function(a){return a<<g>>>g}}c=b.includes("unsigned");var h=function(a,b){};c?c=function(a,b){h(b,this.name);return b>>>0}:c=function(a,b){h(b,this.name);return b};S(a,{name:b,fromWireType:f,toWireType:c,argPackAdvance:8,readValueFromPointer:Pc(b,e,d!==0),destructorFunction:null})}function Rc(a,b,c){var d=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],e=d[b];function f(a){a=a>>2;var b=y,c=b[a];b=b[a+1];return new e(ya,b,c)}c=M(c);S(a,{name:c,fromWireType:f,argPackAdvance:8,readValueFromPointer:f},{ignoreDuplicateRegistrations:!0})}function Sc(a,b){b=M(b);var c=b==="std::string";S(a,{name:b,fromWireType:function(a){var b=y[a>>2],d;if(c){var e=a+4;for(var f=0;f<=b;++f){var g=a+4+f;if(f==b||v[g]==0){var h=g-e;h=la(e,h);d===void 0?d=h:(d+=String.fromCharCode(0),d+=h);e=g+1}}}else{h=new Array(b);for(var f=0;f<b;++f)h[f]=String.fromCharCode(v[a+4+f]);d=h.join("")}X(a);return d},toWireType:function(a,b){b instanceof ArrayBuffer&&(b=new Uint8Array(b));var d,e=typeof b==="string";e||b instanceof Uint8Array||b instanceof Uint8ClampedArray||b instanceof Int8Array||Q("Cannot pass non-string to std::string");c&&e?d=function(){return oa(b)}:d=function(){return b.length};d=d();var f=wd(4+d+1);y[f>>2]=d;if(c&&e)na(b,f+4,d+1);else if(e)for(e=0;e<d;++e){var g=b.charCodeAt(e);g>255&&(X(f),Q("String has UTF-16 code units that do not fit in 8 bits"));v[f+4+e]=g}else for(e=0;e<d;++e)v[f+4+e]=b[e];a!==null&&a.push(X,f);return f},argPackAdvance:8,readValueFromPointer:cc,destructorFunction:function(a){X(a)}})}function Tc(a,b,c){c=M(c);var d,e,f,g,h;b===2?(d=qa,e=ra,g=sa,f=function(){return za},h=1):b===4&&(d=ta,e=ua,g=va,f=function(){return y},h=2);S(a,{name:c,fromWireType:function(a){var c=y[a>>2],e=f(),g,i=a+4;for(var j=0;j<=c;++j){var k=a+4+j*b;if(j==c||e[k>>h]==0){var l=k-i;l=d(i,l);g===void 0?g=l:(g+=String.fromCharCode(0),g+=l);i=k+b}}X(a);return g},toWireType:function(a,d){typeof d==="string"||Q("Cannot pass non-string to C++ string type "+c);var f=g(d),i=wd(4+f+b);y[i>>2]=f>>h;e(d,i+4,f+b);a!==null&&a.push(X,i);return i},argPackAdvance:8,readValueFromPointer:cc,destructorFunction:function(a){X(a)}})}function Uc(a,b){b=M(b),S(a,{isVoid:!0,name:b,argPackAdvance:0,fromWireType:function(){return void 0},toWireType:function(a,b){return void 0}})}function Vc(a){a>4&&(W[a].refcount+=1)}function Wc(a,b){var c=O[a];void 0===c&&Q(b+" has unknown type "+wc(a));return c}function Xc(a,b){a=Wc(a,"_emval_take_value");a=a.readValueFromPointer(b);return Jc.toHandle(a)}function Yc(){A("")}function Zc(a){A("OOM")}function $c(a){v.length,a=a>>>0,Zc(a)}var ad={};function bd(){return m||"./this.program"}function cd(){if(!cd.strings){var a=(typeof navigator==="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8";a={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:a,_:bd()};for(var b in ad)ad[b]===void 0?delete a[b]:a[b]=ad[b];var c=[];for(var b in a)c.push(b+"="+a[b]);cd.strings=c}return cd.strings}function dd(a,b){var c=0;cd().forEach(function(d,e){var f=b+c;x[a+e*4>>2]=f;xa(d,f);c+=d.length+1});return 0}function ed(a,b){var c=cd();x[a>>2]=c.length;var d=0;c.forEach(function(a){d+=a.length+1});x[b>>2]=d;return 0}function fd(a){try{a=L.getStreamFromFD(a);K.close(a);return 0}catch(a){if(typeof K==="undefined"||!(a instanceof K.ErrnoError))throw a;return a.errno}}function gd(a,b,c,d){try{a=L.getStreamFromFD(a);a=L.doReadv(a,b,c);x[d>>2]=a;return 0}catch(a){if(typeof K==="undefined"||!(a instanceof K.ErrnoError))throw a;return a.errno}}function hd(a,b,c,d,e){try{a=L.getStreamFromFD(a);var f=4294967296;c=c*f+(b>>>0);f=9007199254740992;if(c<=-f||c>=f)return-61;K.llseek(a,c,d);D=[a.position>>>0,(C=a.position,+Math.abs(C)>=1?C>0?(Math.min(+Math.floor(C/4294967296),4294967295)|0)>>>0:~~+Math.ceil((C-+(~~C>>>0))/4294967296)>>>0:0)],x[e>>2]=D[0],x[e+4>>2]=D[1];a.getdents&&c===0&&d===0&&(a.getdents=null);return 0}catch(a){if(typeof K==="undefined"||!(a instanceof K.ErrnoError))throw a;return a.errno}}function id(a,b,c,d){try{a=L.getStreamFromFD(a);a=L.doWritev(a,b,c);x[d>>2]=a;return 0}catch(a){if(typeof K==="undefined"||!(a instanceof K.ErrnoError))throw a;return a.errno}}function jd(){return ga()}function kd(a){r(a)}function ld(a){return a%4===0&&(a%100!==0||a%400===0)}function md(a,b){var c=0;for(var d=0;d<=b;c+=a[d++]);return c}var nd=[31,29,31,30,31,30,31,31,30,31,30,31],od=[31,28,31,30,31,30,31,31,30,31,30,31];function pd(a,b){a=new Date(a.getTime());while(b>0){var c=ld(a.getFullYear()),d=a.getMonth();c=(c?nd:od)[d];if(b>c-a.getDate())b-=c-a.getDate()+1,a.setDate(1),d<11?a.setMonth(d+1):(a.setMonth(0),a.setFullYear(a.getFullYear()+1));else{a.setDate(a.getDate()+b);return a}}return a}function qd(a,b,c,d){var e=x[d+40>>2];d={tm_sec:x[d>>2],tm_min:x[d+4>>2],tm_hour:x[d+8>>2],tm_mday:x[d+12>>2],tm_mon:x[d+16>>2],tm_year:x[d+20>>2],tm_wday:x[d+24>>2],tm_yday:x[d+28>>2],tm_isdst:x[d+32>>2],tm_gmtoff:x[d+36>>2],tm_zone:e?la(e):""};e=la(c);c={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var f in c)e=e.replace(new RegExp(f,"g"),c[f]);var g=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],h=["January","February","March","April","May","June","July","August","September","October","November","December"];function i(a,b,c){a=typeof a==="number"?a.toString():a||"";while(a.length<b)a=c[0]+a;return a}function j(a,b){return i(a,b,"0")}function k(a,b){function c(a){return a<0?-1:a>0?1:0}var d;(d=c(a.getFullYear()-b.getFullYear()))===0&&((d=c(a.getMonth()-b.getMonth()))===0&&(d=c(a.getDate()-b.getDate())));return d}function l(a){switch(a.getDay()){case 0:return new Date(a.getFullYear()-1,11,29);case 1:return a;case 2:return new Date(a.getFullYear(),0,3);case 3:return new Date(a.getFullYear(),0,2);case 4:return new Date(a.getFullYear(),0,1);case 5:return new Date(a.getFullYear()-1,11,31);case 6:return new Date(a.getFullYear()-1,11,30)}}function m(a){a=pd(new Date(a.tm_year+1900,0,1),a.tm_yday);var b=new Date(a.getFullYear(),0,4),c=new Date(a.getFullYear()+1,0,4);b=l(b);c=l(c);if(k(b,a)<=0)if(k(c,a)<=0)return a.getFullYear()+1;else return a.getFullYear();else return a.getFullYear()-1}c={"%a":function(a){return g[a.tm_wday].substring(0,3)},"%A":function(a){return g[a.tm_wday]},"%b":function(a){return h[a.tm_mon].substring(0,3)},"%B":function(a){return h[a.tm_mon]},"%C":function(a){a=a.tm_year+1900;return j(a/100|0,2)},"%d":function(a){return j(a.tm_mday,2)},"%e":function(a){return i(a.tm_mday,2," ")},"%g":function(a){return m(a).toString().substring(2)},"%G":function(a){return m(a)},"%H":function(a){return j(a.tm_hour,2)},"%I":function(a){a=a.tm_hour;a==0?a=12:a>12&&(a-=12);return j(a,2)},"%j":function(a){return j(a.tm_mday+md(ld(a.tm_year+1900)?nd:od,a.tm_mon-1),3)},"%m":function(a){return j(a.tm_mon+1,2)},"%M":function(a){return j(a.tm_min,2)},"%n":function(){return"\n"},"%p":function(a){if(a.tm_hour>=0&&a.tm_hour<12)return"AM";else return"PM"},"%S":function(a){return j(a.tm_sec,2)},"%t":function(){return"\t"},"%u":function(a){return a.tm_wday||7},"%U":function(a){var b=new Date(a.tm_year+1900,0,1),c=b.getDay()===0?b:pd(b,7-b.getDay());a=new Date(a.tm_year+1900,a.tm_mon,a.tm_mday);if(k(c,a)<0){var d=md(ld(a.getFullYear())?nd:od,a.getMonth()-1)-31,e=31-c.getDate();e=e+d+a.getDate();return j(Math.ceil(e/7),2)}return k(c,b)===0?"01":"00"},"%V":function(a){var b=new Date(a.tm_year+1900,0,4),c=new Date(a.tm_year+1901,0,4);b=l(b);c=l(c);var d=pd(new Date(a.tm_year+1900,0,1),a.tm_yday);if(k(d,b)<0)return"53";if(k(c,d)<=0)return"01";b.getFullYear()<a.tm_year+1900?c=a.tm_yday+32-b.getDate():c=a.tm_yday+1-b.getDate();return j(Math.ceil(c/7),2)},"%w":function(a){return a.tm_wday},"%W":function(a){var b=new Date(a.tm_year,0,1),c=b.getDay()===1?b:pd(b,b.getDay()===0?1:7-b.getDay()+1);a=new Date(a.tm_year+1900,a.tm_mon,a.tm_mday);if(k(c,a)<0){var d=md(ld(a.getFullYear())?nd:od,a.getMonth()-1)-31,e=31-c.getDate();e=e+d+a.getDate();return j(Math.ceil(e/7),2)}return k(c,b)===0?"01":"00"},"%y":function(a){return(a.tm_year+1900).toString().substring(2)},"%Y":function(a){return a.tm_year+1900},"%z":function(a){a=a.tm_gmtoff;var b=a>=0;a=Math.abs(a)/60;a=a/60*100+a%60;return(b?"+":"-")+String("0000"+a).slice(-4)},"%Z":function(a){return a.tm_zone},"%%":function(){return"%"}};for(var f in c)e.includes(f)&&(e=e.replace(new RegExp(f,"g"),c[f](d)));c=ud(e,!1);if(c.length>b)return 0;wa(c,a);return c.length-1}function rd(a,b,c,d){return qd(a,b,c,d)}d=function(a,b,c,d){a||(a=this),this.parent=a,this.mount=a.mount,this.mounted=null,this.id=K.nextInode++,this.name=b,this.mode=c,this.node_ops={},this.stream_ops={},this.rdev=d};var sd=292|73,td=146;Object.defineProperties(d.prototype,{read:{get:function(){return(this.mode&sd)===sd},set:function(a){a?this.mode|=sd:this.mode&=~sd}},write:{get:function(){return(this.mode&td)===td},set:function(a){a?this.mode|=td:this.mode&=~td}},isFolder:{get:function(){return K.isDir(this.mode)}},isDevice:{get:function(){return K.isChrdev(this.mode)}}});K.FSNode=d;K.staticInit();ub();P=c.BindingError=Bb(Error,"BindingError");Cb=c.InternalError=Bb(Error,"InternalError");Ub();qc();kc();vc=c.UnboundTypeError=Bb(Error,"UnboundTypeError");Ic();function ud(a,b,c){c=c>0?c:oa(a)+1;c=new Array(c);a=ma(a,c,0,c.length);b&&(c.length=a);return c}var vd={p:Ya,t:db,w:gb,b:ib,g:jb,x:eb,K:kb,u:lb,Y:mb,d:hb,ba:qb,_:rb,U:sb,da:Eb,z:yc,y:Bc,o:Dc,ca:Kc,N:Nc,ga:Oc,s:Qc,m:Rc,M:Sc,G:Tc,ea:Uc,fa:Fc,R:Vc,Q:Xc,C:Yc,Z:$c,$:dd,aa:ed,W:fd,L:gd,T:hd,F:id,a:jd,H:Qd,I:Pd,l:Rd,c:Dd,e:Gd,k:Hd,h:Md,X:Nd,q:Fd,J:Od,P:Jd,B:Td,S:Wd,i:Kd,r:Ed,f:Bd,j:Cd,D:Id,O:Ld,n:Sd,v:Ud,A:Vd,E:kd,V:rd};Wa();c.___wasm_call_ctors=function(){return(c.___wasm_call_ctors=c.asm.ia).apply(null,arguments)};c._bytearray_free=function(){return(c._bytearray_free=c.asm.ja).apply(null,arguments)};var X=c._free=function(){return(X=c._free=c.asm.la).apply(null,arguments)},wd=c._malloc=function(){return(wd=c._malloc=c.asm.ma).apply(null,arguments)},xd=c.___getTypeName=function(){return(xd=c.___getTypeName=c.asm.na).apply(null,arguments)};c.___embind_register_native_and_builtin_types=function(){return(c.___embind_register_native_and_builtin_types=c.asm.oa).apply(null,arguments)};var Y=c._setThrew=function(){return(Y=c._setThrew=c.asm.pa).apply(null,arguments)},Z=c.stackSave=function(){return(Z=c.stackSave=c.asm.qa).apply(null,arguments)},$=c.stackRestore=function(){return($=c.stackRestore=c.asm.ra).apply(null,arguments)},yd=c.___cxa_can_catch=function(){return(yd=c.___cxa_can_catch=c.asm.sa).apply(null,arguments)},zd=c.___cxa_is_pointer_type=function(){return(zd=c.___cxa_is_pointer_type=c.asm.ta).apply(null,arguments)};c.dynCall_ji=function(){return(c.dynCall_ji=c.asm.ua).apply(null,arguments)};c.dynCall_viijii=function(){return(c.dynCall_viijii=c.asm.va).apply(null,arguments)};c.dynCall_jiji=function(){return(c.dynCall_jiji=c.asm.wa).apply(null,arguments)};var Ad=c.dynCall_jiiii=function(){return(Ad=c.dynCall_jiiii=c.asm.xa).apply(null,arguments)};c.dynCall_iiiiij=function(){return(c.dynCall_iiiiij=c.asm.ya).apply(null,arguments)};c.dynCall_iiiiijj=function(){return(c.dynCall_iiiiijj=c.asm.za).apply(null,arguments)};c.dynCall_iiiiiijj=function(){return(c.dynCall_iiiiiijj=c.asm.Aa).apply(null,arguments)};function Bd(a,b,c){var d=Z();try{E(a)(b,c)}catch(a){$(d);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Cd(a,b,c,d){var e=Z();try{E(a)(b,c,d)}catch(a){$(e);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Dd(a,b){var c=Z();try{return E(a)(b)}catch(a){$(c);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Ed(a,b){var c=Z();try{E(a)(b)}catch(a){$(c);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Fd(a,b,c,d,e,f,g){var h=Z();try{return E(a)(b,c,d,e,f,g)}catch(a){$(h);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Gd(a,b,c){var d=Z();try{return E(a)(b,c)}catch(a){$(d);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Hd(a,b,c,d){var e=Z();try{return E(a)(b,c,d)}catch(a){$(e);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Id(a,b,c,d,e){var f=Z();try{E(a)(b,c,d,e)}catch(a){$(f);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Jd(a,b,c,d,e,f,g,h,i){var j=Z();try{return E(a)(b,c,d,e,f,g,h,i)}catch(a){$(j);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Kd(a){var b=Z();try{E(a)()}catch(a){$(b);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Ld(a,b,c,d,e,f){var g=Z();try{E(a)(b,c,d,e,f)}catch(a){$(g);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Md(a,b,c,d,e){var f=Z();try{return E(a)(b,c,d,e)}catch(a){$(f);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Nd(a,b,c,d,e,f){var g=Z();try{return E(a)(b,c,d,e,f)}catch(a){$(g);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Od(a,b,c,d,e,f,g,h){var i=Z();try{return E(a)(b,c,d,e,f,g,h)}catch(a){$(i);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Pd(a,b,c,d){var e=Z();try{return E(a)(b,c,d)}catch(a){$(e);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Qd(a,b,c,d){var e=Z();try{return E(a)(b,c,d)}catch(a){$(e);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Rd(a){var b=Z();try{return E(a)()}catch(a){$(b);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Sd(a,b,c,d,e,f,g,h){var i=Z();try{E(a)(b,c,d,e,f,g,h)}catch(a){$(i);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Td(a,b,c,d,e,f,g,h,i,j,k,l){var m=Z();try{return E(a)(b,c,d,e,f,g,h,i,j,k,l)}catch(a){$(m);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Ud(a,b,c,d,e,f,g,h,i,j,k){var l=Z();try{E(a)(b,c,d,e,f,g,h,i,j,k)}catch(a){$(l);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Vd(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var aa=Z();try{E(a)(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p)}catch(a){$(aa);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}function Wd(a,b,c,d,e){var f=Z();try{return Ad(a,b,c,d,e)}catch(a){$(f);if(a!==a+0&&a!=="longjmp")throw a;Y(1,0)}}var Xd;Oa=function a(){Xd||Yd(),Xd||(Oa=a)};function Yd(a){a||l;if(z>0)return;Ha();if(z>0)return;function b(){if(Xd)return;Xd=!0;c.calledRun=!0;if(ia)return;Ia();i(c);c.onRuntimeInitialized&&c.onRuntimeInitialized();Ja()}c.setStatus?(c.setStatus("Running..."),setTimeout(function(){setTimeout(function(){c.setStatus("")},1),b()},1)):b()}c.run=Yd;if(c.preInit){typeof c.preInit=="function"&&(c.preInit=[c.preInit]);while(c.preInit.length>0)c.preInit.pop()()}Yd();return c.ready}}();typeof f==="object"&&typeof e==="object"?e.exports=h:typeof define==="function"&&define.amd?define([],function(){return h}):typeof f==="object"&&(f.Module=h)}),null);
__d("PakeCpaceWasm",["PakeCpaceUtils","Promise","bx","err","pakeCpace"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var e={locateFile:function(){return c("bx").getURL(c("bx")("20913"))},wasmBinary:a};return new(h||(h=b("Promise")))(function(a){c("pakeCpace")(e).then(function(b){return a({clientBegin:function(a,c,d){var e=0;try{e=a.clientBegin(c,d);a=b.getInt8Array(e);return a}finally{b._bytearray_free(e)}},clientFinalize:function(a,c){var e=0,f=0;try{c=d("PakeCpaceUtils").uint8ArrayToVectorInt(b,c);a=a.clientFinalize(c);e=a.getKey1Ptr();c=b.getInt8Array(e);f=a.getKey2Ptr();a=b.getInt8Array(f);return{clientKey1:c,clientKey2:a}}finally{b._bytearray_free(e),b._bytearray_free(f)}},createCPaceClient:function(a){return new b.PAKEClient(a)},createCPaceServer:function(a){return new b.PAKEServer(a)},serverHandleClientStepOnePacket:function(a,c,e,f){var g=0,h=0,i=0;try{e=d("PakeCpaceUtils").uint8ArrayToVectorInt(b,e);a=a.handleClientStepOnePacket(c,e,f);g=a.getKey1Ptr();c=b.getInt8Array(g);h=a.getKey2Ptr();e=b.getInt8Array(h);i=a.getPacketPtr();f=b.getInt8Array(i);return{serverKey1:c,serverKey2:e,stepTwoPacket:f}}finally{b._bytearray_free(g),b._bytearray_free(h),b._bytearray_free(i)}}})})["catch"](function(a){throw c("err")("Failed to initialize wasm module, "+a)})})}g.PakeCPaceWasm=a}),98);
__d("useFetchOTCEligibleEBDevices",["FBLogger","LSAuthorityLevel","LSFactory","LSFetchOTCEligibleEBDevicesV2StoredProcedure","LSIntEnum","ReQL","ReQLSuspense","gkx","promiseDone","react","react-compiler-runtime","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;b=j||d("react");b.useCallback;var k=b.useEffect;b.useMemo;var l=b.useRef,m=c("gkx")("24064");function a(a){var b=d("react-compiler-runtime").c(30),e=a===void 0?"store-or-network":a,g=(h||(h=c("useReStore")))(),j=l(!1);b[0]!==g.tables.encrypted_backups_otc_devices?(a=function(){return d("ReQL").fromTableAscending(g.tables.encrypted_backups_otc_devices)},b[0]=g.tables.encrypted_backups_otc_devices,b[1]=a):a=b[1];var q;b[2]!==g?(q=[g],b[2]=g,b[3]=q):q=b[3];var r=d("ReQLSuspense").useArray(a,q,f.id+":42");b[4]!==g?(a=function(){return g.runInTransaction(p,"readwrite",void 0,void 0,f.id+":48")},b[4]=g,b[5]=a):a=b[5];var s=a;b[6]!==s?(q=function(){c("promiseDone")(s(),null,o)},b[6]=s,b[7]=q):q=b[7];var t=q;b[8]!==e||b[9]!==r.length||b[10]!==t?(a=function(){j.current!==!0&&(r.length===0||e==="network-only")&&(j.current=!0,t())},q=[e,r.length,t],b[8]=e,b[9]=r.length,b[10]=t,b[11]=a,b[12]=q):(a=b[11],q=b[12]);k(a,q);a=r.length>0&&(i||(i=d("LSIntEnum"))).toNumber(r[0].authorityLevel)===c("LSAuthorityLevel").OPTIMISTIC;q=a;a=!q&&r.length>0&&r[0].deviceId==="-1";var u=a;b[13]!==u?(a=function(){u&&c("FBLogger")("labyrinth_web").mustfix("Encrypted Backups OTC: Failed to fetch otc eligible devices.")},b[13]=u,b[14]=a):a=b[14];var v;b[15]!==u||b[16]!==s||b[17]!==e||b[18]!==q||b[19]!==r||b[20]!==t?(v=[u,s,e,q,r,t],b[15]=u,b[16]=s,b[17]=e,b[18]=q,b[19]=r,b[20]=t,b[21]=v):v=b[21];k(a,v);b[22]!==r?(a=r.filter(n),b[22]=r,b[23]=a):a=b[23];v=a;a=v;v=a.length>0||m;var w;b[24]!==u||b[25]!==q||b[26]!==a||b[27]!==v||b[28]!==t?(w={doesUserHaveOtcEligibleDevices:v,failedToFetchOtcDevices:u,isFetchOtcDevicesInFlight:q,otcEligibleDevices:a,triggerFetchOtcEligibleDevices:t},b[24]=u,b[25]=q,b[26]=a,b[27]=v,b[28]=t,b[29]=w):w=b[29];return w}function n(a){return(i||(i=d("LSIntEnum"))).toNumber(a.authorityLevel)!==c("LSAuthorityLevel").OPTIMISTIC&&a.deviceId!==""}function o(){c("FBLogger")("labyrinth_web").mustfix("Failed to fetch OTC eligible devices")}async function p(a){var b=await d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.encrypted_backups_otc_devices));b=b!=null&&(i||(i=d("LSIntEnum"))).toNumber(b.authorityLevel)===c("LSAuthorityLevel").OPTIMISTIC;if(!b)return c("LSFetchOTCEligibleEBDevicesV2StoredProcedure")(c("LSFactory")(a))}g.default=a}),98);/*FB_PKG_DELIM*/
__d("EBBridgedAPI",["IEBAPI"],(function(a,b,c,d,e,f,g){"use strict";b={getContactEpochHead:(a=d("IEBAPI")).makeBridgedApi("getContactEpochHead"),getMessageKeys:a.makeBridgedApi("getMessageKeys"),isEbEnabledEbSwitch:a.makeBridgedApi("isEbEnabledEbSwitch"),messageBulkPointQuery:a.makeBridgedApi("messageBulkPointQuery"),messageRangeQueryForIndexing:a.makeBridgedApi("messageRangeQueryForIndexing")};c=b;g["default"]=c}),98);
__d("FDSPhotoDownloadFilled16Icon",["cr:15408"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:15408")}),98);
__d("FDSPhotoDownloadFilled16PNGIcon.react",["ix","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";a=d("fbicon")._(h("1873235"),16);b=a;g["default"]=b}),98);
__d("LSIssueAttachmentsRangeQuery",["LSGetCursor","LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?d[0]=c.i64.cast([0,1]):(b=a.item,d[5]=b.syncGroup,c.i64.neq(d[5],void 0)?d[4]=d[5]:d[4]=c.i64.cast([0,1]),d[0]=d[4])})},function(a){return c.storedProcedure(b("LSGetCursor"),d[0]).then(function(a){return a=a,d[2]=a[0],a})},function(e){return c.db.table(17).fetch([[[a[0],a[1]]]]).next().then(function(e,f){var g=e.done;e=e.value;return g?c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[4]=c.i64.cast([0,1]):(e=b.item,d[9]=e.syncGroup,c.i64.neq(d[9],void 0)?d[8]=d[9]:d[8]=c.i64.cast([0,1]),d[4]=d[8])})},function(e){return d[6]=new c.Map(),d[6].set("thread_key",a[0]),d[6].set("media_group",a[1]),d[6].set("max_timestamp_ms",c.i64.cast([2328,1316134911])),d[6].set("cursor",d[2]),d[6].set("sync_group",d[4]),d[6].set("last_loaded_message_id",void 0),d[7]=c.toJSON(d[6]),c.storedProcedure(b("LSIssueNewTask"),"arq",c.i64.cast([0,105]),d[7],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}]):(f=e.item,f.hasMoreBefore?c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[4]=c.i64.cast([0,1]):(e=b.item,d[9]=e.syncGroup,c.i64.neq(d[9],void 0)?d[8]=d[9]:d[8]=c.i64.cast([0,1]),d[4]=d[8])})},function(e){return d[6]=new c.Map(),d[6].set("thread_key",a[0]),d[6].set("media_group",a[1]),d[6].set("max_timestamp_ms",f.minTimestampMs),d[6].set("cursor",d[2]),d[6].set("sync_group",d[4]),d[6].set("last_loaded_message_id",void 0),d[7]=c.toJSON(d[6]),c.storedProcedure(b("LSIssueNewTask"),"arq",c.i64.cast([0,105]),d[7],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}]):c.resolve())})}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxIssueAttachmentsRangeQueryStoredProcedure";a.__tables__=["threads","attachments_ranges_v2__generated"];e.exports=a}),null);
__d("LSIssueAttachmentsRangeQueryStoredProcedure",["LSIssueAttachmentsRangeQuery","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSIssueAttachmentsRangeQuery"),e.threadKey,e.mediaGroup);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("MAWFetchAndPersistMedia",["CurrentUser","EBAPI","EBBridgedAPI","EchoMessage","EchoMessageMediaFieldUtils","I64","LSDatabaseSingleton","LSIntEnum","LSMEBTaskCreationSource","MAWHandleEchoProtobufsRestoreApi","MAWJids","MAWJobDefinitions","MAWMediaRestoreEBRange","MAWMpsGating","MAWMsgType","MAWRestoreMessagesFromEncryptedBackupsDeferred","MAWRestoreProtobufsFromEncryptedBackupsDeferred","MSGDataclassTypes.flow","MpsOverBridge","MpsTypes","ReQL","WAJids","WALogger","WAResultOrError","gkx","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l;b=c("justknobx")._("3177");var m=c("justknobx")._("2538"),n=c("justknobx")._("3916"),o="timeout",p=b;function a(a,b,c,e){var f=d("MAWMediaRestoreEBRange").getMediaRestoreEBRange(),g=f.getRange(b),h=d("WAJids").threadIdForChatJid(a);if(g.hasMoreBefore===!1)return Promise.resolve();e==null||e.addPoint("eb_fetch_and_persist_start",{int:{mediaGalleryGroup:c}});return u({jid:a,nextTimestampMsBefore:g.nextTimestampMsBefore,numMessages:p,threadId:h}).then(function(a){var g=a.error;g!=null&&(e==null||e.addPoint("eb_fetch_and_persist_error",{string:{error:g}}));if(g!==o){f.updateRange(b,{hasMoreBefore:(g=a==null?void 0:a.hasMoreBefore)!=null?g:!1,nextTimestampMsBefore:(j||(j=d("I64"))).to_string((g=a==null?void 0:a.nextMessageTimestampMsBefore)!=null?g:(j||(j=d("I64"))).zero)})}return q(a,h).then(function(){e==null||e.addPoint("eb_fetch_and_persist_end");return t(b,c,{hasMoreBefore:!0})})})}function q(a,b){if(a.success===!1)return Promise.resolve();if(a.echoMessages!=null&&a.echoMessages.length>0)return r(a,b);return a.protobufMessages!=null&&a.protobufMessages.length>0?s(a,b):Promise.resolve()}function r(a,b){var e;e=(e=a==null?void 0:a.echoMessages)!=null?e:[];var f=[d("EchoMessageMediaFieldUtils").AttachmentType.IMAGE,d("EchoMessageMediaFieldUtils").AttachmentType.VIDEO],g=e.filter(function(a){var b;a=d("EchoMessage").decodeEchoMessage(a);return(a==null?void 0:a.contentType)===d("EchoMessage").EchoMessageContentType.MEDIA&&f.includes(a==null||(b=a.mediaData)==null?void 0:b.attachmentType)});e.length!==g.length&&(p=m);return d("MAWRestoreMessagesFromEncryptedBackupsDeferred").call("AdvancedCrypto",d("MAWJobDefinitions").toThreadJidPrimaryId(b),g,(e=a==null?void 0:a.hasMoreBefore)!=null?e:!1,void 0,(b=a==null?void 0:a.hasMoreAfter)!=null?b:!1,void 0,(g=a==null?void 0:a.isPointQuery)!=null?g:!1,a==null?void 0:a.requestId,a==null?void 0:a.referenceTimestamp,c("LSMEBTaskCreationSource").MEDIA_GALLERY_RESTORE).catch(function(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["MediaPersist Echo error: ",""])),a)})}function s(a,b){var e,f=d("MAWJids").toUserJid(c("CurrentUser").getAccountID());e=(e=a==null?void 0:a.protobufMessages)!=null?e:[];var g=[d("MAWMsgType").MSG_TYPE.IMAGE,d("MAWMsgType").MSG_TYPE.VIDEO],h=e.filter(function(a){a=d("MAWHandleEchoProtobufsRestoreApi").decodeDecryptedMessageProtobuf(a,f,void 0,new Set(),new Set(),new Map(),new Map(),new Map(),!0);return g.includes(a.msgType)});e.length!==h.length&&(p=m);return d("MAWRestoreProtobufsFromEncryptedBackupsDeferred").call("AdvancedCrypto",d("MAWJobDefinitions").toThreadJidPrimaryId(b),h,(e=a==null?void 0:a.hasMoreBefore)!=null?e:!1,void 0,(b=a==null?void 0:a.hasMoreAfter)!=null?b:!1,void 0,(h=a==null?void 0:a.isPointQuery)!=null?h:!1,a==null?void 0:a.requestId,a==null?void 0:a.referenceTimestamp,void 0,void 0,(j||(j=d("I64"))).of_int32(c("LSMEBTaskCreationSource").MEDIA_GALLERY_RESTORE)).catch(function(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["MediaPersist Protobuf error: ",""])),a)})}async function t(a,b,c){var e=await (k||(k=d("LSDatabaseSingleton"))).LSDatabaseSingleton;return e.runInTransaction(async function(f){var g=await d("ReQL").firstAsync(d("ReQL").fromTableAscending(e.tables.attachments_ranges_v2__generated).getKeyRange(a).filter(function(a){return(j||(j=d("I64"))).equal(a.mediaGroup,(l||(l=d("LSIntEnum"))).ofNumber(b))}));if(g==null)return;var h=babelHelpers.extends({},g,c);return f.attachments_ranges_v2__generated.upsert([g.threadKey,g.mediaGroup,g.minTimestampMs],h)},"readwrite","ui",void 0,f.id+":231")}async function u(a){var b,e=a.jid,f=a.nextTimestampMsBefore,g=a.numMessages;a=a.threadId;var h;d("MAWMpsGating").isSearchOnMpsEnabled()||d("MAWMpsGating").isFullMpsEnabled()?h=d("MpsOverBridge").mps().loadMessages({config:{persistToReverb:"no-persist",shouldFetchSupplementals:!1,shouldFetchTags:!0,shouldIgnoreLocalOnly:!0,strategy:"remote-only",tagsFilter:new Set([d("MSGDataclassTypes.flow").MpsMessageTag.Photo,d("MSGDataclassTypes.flow").MpsMessageTag.Video])},debug:{purpose:"MAWFetchAndPersistMedia"},direction:"desc",from:[d("MpsTypes").toTimestamp(Number(f)),null],numMessages:g,threadId:d("MpsTypes").toThreadId(e)}).then(function(a){var b,e;if(a.success===!1)return a;var g=a.value.messages.map(function(a){return{otid:a.toplevelProtobuf.messageId,supplementalProtobufs:new Map(a.supplementalProtobufs.entries().map(function(a){var b=a[0];a=a[1];return[b,{decryptedProtobuf:a.payload,protobufTimestampMS:a.timestampMs}]})),tags:a.tags,toplevelProtobuf:{decryptedProtobuf:a.toplevelProtobuf.payload,protobufTimestampMS:a.toplevelProtobuf.timestampMs}}});b=(b=a.value.cursorInfo.endCursor)==null?void 0:b[0];e=(e=a.value.cursorInfo.startCursor)==null?void 0:e[0];return d("WAResultOrError").makeResult({echoMessages:[],hasMoreAfter:a.value.cursorInfo.hasPrevious,hasMoreBefore:a.value.cursorInfo.hasNext,isPointQuery:!1,mpsMessageQuery:void 0,nextMessageTimestampMsAfter:e==null?void 0:(j||(j=d("I64"))).of_float(e),nextMessageTimestampMsBefore:b==null?void 0:(j||(j=d("I64"))).of_float(b),protobufMessages:g,referenceTimestamp:f,requestId:void 0,taskSource:c("LSMEBTaskCreationSource").MEDIA_GALLERY_RESTORE})}):h=c("gkx")("5431")?c("EBBridgedAPI").messageRangeQueryForIndexing({chatJid:e,direction:"before",numMessages:g,sortOrderMs:f,source:c("LSMEBTaskCreationSource").MEDIA_GALLERY_RESTORE}):c("EBAPI").messageRangeQueryForIndexing({chatJid:e,direction:"before",numMessages:g,sortOrderMs:f,source:c("LSMEBTaskCreationSource").MEDIA_GALLERY_RESTORE});var i=null;h=await Promise.race([h,new Promise(function(a){i=window.setTimeout(function(){return a(d("WAResultOrError").makeError(o))},n)})]);window.clearTimeout(i);if(h.success===!1)return h;h=h.value;b=(j||(j=d("I64"))).to_string((b=h==null?void 0:h.nextMessageTimestampMsBefore)!=null?b:(j||(j=d("I64"))).zero);return(h==null?void 0:h.referenceTimestamp)===b?g===m?d("WAResultOrError").makeError("Retried with max pageSize: "+m+". Still stuck"):u({jid:e,nextTimestampMsBefore:b,numMessages:m,threadId:a}):h}g.MAWFetchAndPersistMedia=a;g.updateLocalAttachmentsRange=t}),98);
__d("MDSShareSvgIcon.react",["MDSSvgIcon.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(4),e,f;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(e=i.jsx("path",{d:"M18.766 4.857a1 1 0 00-1.532 0L13.878 8.86a1 1 0 00.766 1.643H16.5a.25.25 0 01.25.25v10.75a1 1 0 001 1h.5a1 1 0 001-1v-10.75a.25.25 0 01.25-.25h1.856a1 1 0 00.766-1.643l-3.356-4.002z"}),f=i.jsx("path",{d:"M14.75 13.502a1 1 0 00-1-1H12.5a4 4 0 00-4 4v8.5a4 4 0 004 4h11a4 4 0 004-4v-8.5a4 4 0 00-4-4h-1.25a1 1 0 00-1 1v.5a1 1 0 001 1h1.25a1.5 1.5 0 011.5 1.5v8.5a1.5 1.5 0 01-1.5 1.5h-11a1.5 1.5 0 01-1.5-1.5v-8.5a1.5 1.5 0 011.5-1.5h1.25a1 1 0 001-1v-.5z"}),b[0]=e,b[1]=f):(e=b[0],f=b[1]);b[2]!==a?(e=i.jsxs(c("MDSSvgIcon.react"),babelHelpers["extends"]({},a,{children:[e,f]})),b[2]=a,b[3]=e):e=b[3];return e}g["default"]=a}),98);
__d("useMAWBulkMaybeAutoTriggerDownload",["MAWDownloadMediaInWorkerDeferred","MAWMediaDownloadStatus","MAWMediaManagerUiIntegrationCheck","cr:9434","cr:9449","emptyObject","gkx","justknobx","react","react-compiler-runtime","useAsyncReStore","useEmptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h;e=h||d("react");var i=e.useEffect;e.useMemo;var j=e.useRef,k=(f=b("cr:9434"))!=null?f:c("useEmptyFunction"),l=(e=b("cr:9449"))!=null?e:c("useEmptyFunction");function a(a,b,e,f){var g=d("react-compiler-runtime").c(16),h=k(a);f=(f=l(a,f))!=null?f:c("emptyObject");f=f.mawMediaStatuses;bb0:{var m;g[0]===Symbol["for"]("react.memo_cache_sentinel")?(m=[c("MAWMediaDownloadStatus").MISSING_FILE,c("MAWMediaDownloadStatus").MANUAL_RETRYABLE_FAILURE,c("MAWMediaDownloadStatus").DOWNLOADING].filter(Boolean),g[0]=m):m=g[0];var n=m;if(c("gkx")("8105")){g[1]!==a||g[2]!==e||g[3]!==f?(m=new Map(f==null?void 0:f.map(function(b,c){var f=(!d("MAWMediaManagerUiIntegrationCheck").getIsMediaManagerUiIntegrationEnabled()||e==null||e==="fullsize"||e==="fullsizeAndPreview")&&n.includes(b==null?void 0:b.mainMediaStatus);b=d("MAWMediaManagerUiIntegrationCheck").getIsMediaManagerUiIntegrationEnabled()&&e==="preview"&&n.includes(b==null?void 0:b.previewMediaStatus);b=b||f;return[a[c].attachment.attachmentFbid,b]})),g[1]=a,g[2]=e,g[3]=f,g[4]=m):m=g[4];f=m;break bb0}g[5]!==h||g[6]!==e?(m=new Map(h==null?void 0:h.map(function(a){var b,c,f=(!d("MAWMediaManagerUiIntegrationCheck").getIsMediaManagerUiIntegrationEnabled()||e==null||e==="fullsize"||e==="fullsizeAndPreview")&&n.includes(a==null||(b=a.status)==null?void 0:b.mainMediaStatus),g=d("MAWMediaManagerUiIntegrationCheck").getIsMediaManagerUiIntegrationEnabled()&&e==="preview"&&n.includes(a==null||(c=a.status)==null?void 0:c.previewMediaStatus);g=g||f;return[a.attachment.attachmentFbid,g]})),g[5]=h,g[6]=e,g[7]=m):m=g[7];f=m}var o=f;g[8]===Symbol["for"]("react.memo_cache_sentinel")?(h=new Map(),g[8]=h):h=g[8];var p=j(h),q=c("useAsyncReStore")();g[9]!==a||g[10]!==q||g[11]!==e||g[12]!==o||g[13]!==b?(m=function(){var f=[];a.forEach(function(a){var g,h,i=a.attachment;a=a.mediaRenderQpl;g=(g=o.get(i.attachmentFbid))!=null?g:!1;h=(h=p.current.get(i.attachmentFbid))!=null?h:!1;g&&!h&&(p.current.set(i.attachmentFbid,!0),!c("justknobx")._("3226")?d("MAWDownloadMediaInWorkerDeferred").maybeDownloadMediaInWorker({attachment:i,dbPromise:q,downloadType:e,mediaRenderQpl:a,triggerUIView:b}):f.push({attachment:i,mediaRenderQpl:a}))});f.length>0&&d("MAWDownloadMediaInWorkerDeferred").maybeBulkDownloadMediaInWorker({attachmentsWithQpl:f,dbPromise:q,downloadType:e,triggerUIView:b})},f=[a,q,e,p,o,b],g[9]=a,g[10]=q,g[11]=e,g[12]=o,g[13]=b,g[14]=m,g[15]=f):(m=g[14],f=g[15]);i(m,f)}g["default"]=a}),98);
__d("MWChatAttachmentMediaState.react",["$InternalEnum","I64","LSIntEnum","MAWClientMediaStatusUtils","MAWMediaManagerUiIntegrationCheck","MAWVideoAudioPlaybackErrorHandlerUtils","MessagingAttachmentType","RavenMessagingState","filterNulls","gkx","react","useClientMediaStatus","useMAWBulkMaybeAutoTriggerDownload","usePrevious"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=h||(h=d("react"));e=h;var l=e.createContext,m=e.useEffect,n=e.useMemo,o=e.useState,p=b("$InternalEnum")({Image:0,Video:1,AnimatedImage:2}),q=l({canMoveBackward:!1,canMoveForward:!1,card:void 0,cards:[],currentIndex:0,isImageExpanded:!1,moveBackward:function(){},moveForward:function(){},moveTo:function(){},numberOfCards:0,setIsImageExpanded:function(){},shouldTriggerLoadMore:!1});function r(a){var b=a.attachmentType;a=a.ephemeralMediaState;return a!=null&&(i||(i=d("I64"))).equal(b,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").EPHEMERAL_IMAGE))&&(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("RavenMessagingState").PERMANENT))}function s(a){var b=a.attachmentType;a=a.ephemeralMediaState;return a!=null&&(i||(i=d("I64"))).equal(b,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").EPHEMERAL_VIDEO))&&(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("RavenMessagingState").PERMANENT))}function t(a,b,c,d){return c?d.hasMedia:b(d,"isPlayableMedia")!=null&&a(d,"isPlayableMedia")!=null}function u(a,b,e,f){var g=f.attachmentType;return!t(a,b,e,f)?!1:r(f)||(i||(i=d("I64"))).equal(g,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))}function v(a,b,e,f){var g=f.attachmentType;return!t(a,b,e,f)?!1:(i||(i=d("I64"))).equal(g,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))}function w(a,b,e,f,g){var h=f.attachmentFbid,k=f.attachmentType,l=!1,m=!1;g=d("MAWClientMediaStatusUtils").getStatusDataFromLsdb({clientMediaStatus:g,statusKey:h});h=g.hasStatus;g=g.statusData;if(h){h=g!=null?g:{};g=h.validationResult;l=g!=null?d("MAWVideoAudioPlaybackErrorHandlerUtils").isInvalidVideo(f,g):!1;m=g!=null?d("MAWVideoAudioPlaybackErrorHandlerUtils").isUnsupportedVideo(f,g):!1}return!t(a,b,e,f)||l||m?!1:s(f)||(i||(i=d("I64"))).equal(k,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))}function x(a,b){m(function(){a.forEach(function(a){try{a.attachment.hasMedia&&!(i||(i=d("I64"))).equal(a.attachment.attachmentType,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))&&b(a.attachment,"usePreloadThumbnails");return}catch(a){return}})},[a,b])}function a(a){var b=a.attachments,e=a.children,f=a.getIsSecureThread,g=a.getPlayableUrl,h=a.getPreviewUrl;a=a.initialAttachment;a=o(a);var i=a[0],j=a[1];a=o(!1);var l=a[0],m=a[1];a=c("usePrevious")(i==null?void 0:i.messageId);var r=n(function(){return b.map(function(a){return{attachment:a,mediaRenderQpl:null,statusKey:a.attachmentFbid}})},[b]),s=c("useClientMediaStatus")(r),t=n(function(){return i!=null&&d("MAWMediaManagerUiIntegrationCheck").getIsMediaManagerUiIntegrationEnabled()?[{attachment:i,mediaRenderQpl:null,statusKey:i.attachmentFbid}]:[]},[i]);c("useMAWBulkMaybeAutoTriggerDownload")(r,"fullsize","preview",s);c("useMAWBulkMaybeAutoTriggerDownload")(t,"fullsize","fullsizeAndPreview",s);var y=n(function(){return c("filterNulls")(b.map(function(a){var b=f(a);if(v(g,h,b,a)&&c("gkx")("9525"))return{attachment:a,type:p.AnimatedImage};if(u(g,h,b,a))return{attachment:a,type:p.Image};return w(g,h,b,a,s)?{attachment:a,type:p.Video}:null}))},[b,s,f,g,h]),z=i==null?-1:y.findIndex(function(a){return a.attachment.attachmentFbid===i.attachmentFbid&&a.attachment.messageId===i.messageId}),A=a!=null&&(i==null?void 0:i.messageId)!==a&&z>y.length-5;x(y,h);r=n(function(){var a=Math.max(0,y.length-1);return{canMoveBackward:z>0&&z!==-1,canMoveForward:z<a&&z!==-1,card:y[z],cards:y,currentIndex:z,isImageExpanded:l,moveBackward:function(){var a=Math.max(z-1,0);j((a=y[a])==null?void 0:a.attachment)},moveForward:function(){var b=Math.min(z+1,a);j((b=y[b])==null?void 0:b.attachment)},moveTo:function(a){j(a.attachment)},numberOfCards:y.length,setIsImageExpanded:m,shouldTriggerLoadMore:A}},[y,z,A,l]);return k.jsx(q.Provider,{value:r,children:e})}a.displayName=a.name+" [from "+f.id+"]";g.AttachmentMediaType=p;g.context=q;g.MWChatAttachmentMediaStateProviderFromAttachments=a}),98);
__d("MWChatAttachmentMediaNavigationHotkeys.react",["fbt","CometKeys","MWChatAttachmentMediaState.react","justknobx","react","react-compiler-runtime","useLayerKeyCommands"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;var k=b.useContext;b.useMemo;var l={key:c("CometKeys").LEFT},m={key:c("CometKeys").RIGHT},n={key:c("CometKeys").ESCAPE},o=h._(/*BTDS*/"Next item"),p=h._(/*BTDS*/"Previous item"),q=h._(/*BTDS*/"Close");function a(a){var b=d("react-compiler-runtime").c(18),e=a.children,f=a.onClose;a=k(d("MWChatAttachmentMediaState.react").context);var g=a.isImageExpanded,h=a.moveBackward,i=a.moveForward,r=a.setIsImageExpanded;b[0]!==g||b[1]!==h?(a={command:l,description:o,handler:function(){g||h()}},b[0]=g,b[1]=h,b[2]=a):a=b[2];var s;b[3]!==g||b[4]!==i?(s={command:m,description:p,handler:function(){g||i()}},b[3]=g,b[4]=i,b[5]=s):s=b[5];var t;b[6]!==g||b[7]!==f||b[8]!==r?(t=f!=null?{command:n,description:q,handler:function(){if(g)return r(!1);f()}}:null,b[6]=g,b[7]=f,b[8]=r,b[9]=t):t=b[9];var u;b[10]!==a||b[11]!==s||b[12]!==t?(u=[a,s,t],b[10]=a,b[11]=s,b[12]=t,b[13]=u):u=b[13];a=u;b[14]!==a?(s=a.filter(Boolean),b[14]=a,b[15]=s):s=b[15];t=s;u=t;c("useLayerKeyCommands")(u);b[16]!==e?(a=c("justknobx")._("3491")?j.jsx(j.Fragment,{children:e!=null?e:null}):j.jsx("div",{children:e!=null?e:null}),b[16]=e,b[17]=a):a=b[17];return a}g.keyLeft=l;g.keyRight=m;g.keyEscape=n;g.MWChatAttachmentMediaNavigationHotkeys=a}),226);
__d("MWV2MediaViewerContext.react",["react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useMemo;var j=i.createContext({getDownloadUrl:function(){},getPlayableUrl:function(){},getPreviewUrl:function(){},heroLoggingComponent:function(a){return null},loadMore:function(){},media:[]});function a(a){var b=d("react-compiler-runtime").c(10),c=a.children,e=a.getDownloadUrl,f=a.getPlayableUrl,g=a.getPreviewUrl,h=a.heroLoggingComponent,k=a.loadMore;a=a.media;var l;b[0]!==e||b[1]!==f||b[2]!==g||b[3]!==h||b[4]!==k||b[5]!==a?(l={getDownloadUrl:e,getPlayableUrl:f,getPreviewUrl:g,heroLoggingComponent:h,loadMore:k,media:a},b[0]=e,b[1]=f,b[2]=g,b[3]=h,b[4]=k,b[5]=a,b[6]=l):l=b[6];e=l;f=e;b[7]!==c||b[8]!==f?(g=i.jsx(j.Provider,{value:f,children:c}),b[7]=c,b[8]=f,b[9]=g):g=b[9];return g}g.context=j;g.MWV2MediaViewerContextProvider=a}),98);
__d("MWChatAttachmentMediaThumbnails.react",["CometMediaViewerFilmstrip.react","CometPlaceholder.react","MWChatAttachmentMediaState.react","MWChatAttachmentMediaUtils","MWV2MediaViewerContext.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useContext,k=b.useDeferredValue;function l(a){var b,e,f=d("react-compiler-runtime").c(23),g=a.activeCard,h=a.cards,k=a.getPreviewUrl,l=a.onSetImage,m=j(d("MWV2MediaViewerContext.react").context);f[0]!==m?(a=function(a,b){return a==null?"":m.getDownloadUrl(a,b)},f[0]=m,f[1]=a):a=f[1];var n=a;if(f[2]!==h||f[3]!==n||f[4]!==k){f[6]!==n||f[7]!==k?(a=function(a){return d("MWChatAttachmentMediaUtils").toFilmstripThumbnail({card:a,getPlayableUrl:n,getPreviewUrl:k})},f[6]=n,f[7]=k,f[8]=a):a=f[8];a=h.map(a);f[2]=h;f[3]=n;f[4]=k;f[5]=a}else a=f[5];a=a;if(f[9]!==(g==null||(b=g.attachment)==null?void 0:b.attachmentFbid)||f[10]!==(g==null||(e=g.attachment)==null?void 0:e.messageId)||f[11]!==h){var o,p,q,r,s;if(f[13]!==(g==null||(o=g.attachment)==null?void 0:o.attachmentFbid)||f[14]!==(g==null||(p=g.attachment)==null?void 0:p.messageId)){var t,u;s=function(a){var b,c;return a.attachment.attachmentFbid===(g==null||(b=g.attachment)==null?void 0:b.attachmentFbid)&&a.attachment.messageId===(g==null||(c=g.attachment)==null?void 0:c.messageId)};f[13]=g==null||(t=g.attachment)==null?void 0:t.attachmentFbid;f[14]=g==null||(u=g.attachment)==null?void 0:u.messageId;f[15]=s}else s=f[15];s=h.findIndex(s);f[9]=g==null||(q=g.attachment)==null?void 0:q.attachmentFbid;f[10]=g==null||(r=g.attachment)==null?void 0:r.messageId;f[11]=h;f[12]=s}else s=f[12];s=s;var v;f[16]!==h||f[17]!==l?(v=function(a){return l(h[a])},f[16]=h,f[17]=l,f[18]=v):v=f[18];var w;f[19]!==s||f[20]!==a||f[21]!==v?(w=i.jsx(c("CometMediaViewerFilmstrip.react"),{activeIndex:s,images:a,onSetImage:v}),f[19]=s,f[20]=a,f[21]=v,f[22]=w):w=f[22];return w}function a(a){var b=d("react-compiler-runtime").c(10),e=a.getPreviewUrl;a=a.shouldHide;a=a===void 0?!1:a;var f=j(d("MWChatAttachmentMediaState.react").context),g=f.card,h=f.cards;f=f.moveTo;h=k(h);var m;b[0]!==a?(m={0:{className:"xdj266r x11t971q xat24cr xvc5jky x193iq5w x6ikm8r x10wlt62"},1:{className:"xdj266r x11t971q xat24cr xvc5jky x193iq5w x6ikm8r x10wlt62 x1s85apg"}}[!!a<<0],b[0]=a,b[1]=m):m=b[1];b[2]!==g||b[3]!==h||b[4]!==e||b[5]!==f?(a=i.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MWChatAttachmentMediaThumbnails",children:i.jsx(l,{activeCard:g,cards:h,getPreviewUrl:e,onSetImage:f})}),b[2]=g,b[3]=h,b[4]=e,b[5]=f,b[6]=a):a=b[6];b[7]!==m||b[8]!==a?(g=i.jsx("div",babelHelpers["extends"]({},m,{children:a})),b[7]=m,b[8]=a,b[9]=g):g=b[9];return g}g["default"]=a}),98);
__d("MWChatForwardCircleButton.react",["fbt","FDSCircleButton.react","MDSShareSvgIcon.react","ODS","SVGIcon","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=i||d("react");function a(a){var b=d("react-compiler-runtime").c(9),e=a.color,f=a.onOpenForwardDialog;a=a.type;var g;b[0]!==e?(g=d("SVGIcon").legacySVGIcon(function(){return k.jsx(c("MDSShareSvgIcon.react"),{color:e,size:24})}),b[0]=e,b[1]=g):g=b[1];var i;b[2]===Symbol["for"]("react.memo_cache_sentinel")?(i=h._(/*BTDS*/"Forward"),b[2]=i):i=b[2];var l;b[3]!==f?(l=function(){(j||(j=d("ODS"))).bumpEntityKey(3185,"mwchat_media_viewer","forward"),f()},b[3]=f,b[4]=l):l=b[4];bb0:{switch(a){case"deemphasized":a="deemphasized";break bb0;case"normal":a="normal";break bb0;case"overlay":a="overlay";break bb0;case"dark_overlay":a="dark-overlay";break bb0;case"deemphasized_overlay":case"overlay_raised":a="overlay-raised";break bb0;case"primary_background_overlay":a="primary-background-overlay";break bb0}a=void 0}b[5]!==g||b[6]!==l||b[7]!==a?(i=k.jsx(c("FDSCircleButton.react"),{icon:g,label:i,onPress:l,size:36,testid:void 0,type_DEPRECATED:a}),b[5]=g,b[6]=l,b[7]=a,b[8]=i):i=b[8];return i}g["default"]=a}),226);
__d("MWMediaViewerRenderQpl",["MWMediaRenderQplUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("MWMediaRenderQplUtils").useCommonMediaRenderQplForAttachment(a,b,"full_screen_view")}g.useMediaViewerRenderQpl=a}),98);
__d("MWSharedAttachmentsSectionHooks",["I64","LSIntEnum","LSThreadMediaGalleryGroup","MessagingAttachmentType","ReQL","ReQLSuspense","gkx","react","react-compiler-runtime","usePrevious","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=k||d("react");l.useCallback;var m=l.useEffect,n=l.useState;function a(a){var b=d("react-compiler-runtime").c(33),e=a.attachmentsRange,f=a.hasMore,g=a.loadMore,h=a.logLoadMediaCancel,i=a.logLoadMediaSuccess,j=a.media,k=a.skipInitialLoad;a=n(!1);var l=a[0],o=a[1],p=j.length,q=(a=c("usePrevious")(p))!=null?a:0,r=c("usePrevious")(f),s=(j=c("usePrevious")(l))!=null?j:!1,t=e!=null;b[0]!==t||b[1]!==g||b[2]!==k?(a=function(){!t&&k!==!0&&(g(),o(!0))},j=[t,g,k],b[0]=t,b[1]=g,b[2]=k,b[3]=a,b[4]=j):(a=b[3],j=b[4]);m(a,j);b[5]!==e||b[6]!==f||b[7]!==l||b[8]!==g||b[9]!==i||b[10]!==p||b[11]!==r||b[12]!==s||b[13]!==q?(a=function(){var a=q!==p,b=r===!0&&!f||e==null&&f===!1&&r===!1&&q===p;l&&(b||a)?(o(!1),i==null||i({fetchedMediaCount:p-q,startMediaCount:q})):q===p&&f&&l&&s===!0&&(i==null||i({fetchedMediaCount:p-q,isAlreadyPreloaded:!0,startMediaCount:q}),g())},b[5]=e,b[6]=f,b[7]=l,b[8]=g,b[9]=i,b[10]=p,b[11]=r,b[12]=s,b[13]=q,b[14]=a):a=b[14];b[15]!==e||b[16]!==f||b[17]!==l||b[18]!==g||b[19]!==h||b[20]!==i||b[21]!==p||b[22]!==r||b[23]!==s||b[24]!==q?(j=[p,f,l,q,r,e,g,s,i,h],b[15]=e,b[16]=f,b[17]=l,b[18]=g,b[19]=h,b[20]=i,b[21]=p,b[22]=r,b[23]=s,b[24]=q,b[25]=j):j=b[25];m(a,j);b[26]!==l||b[27]!==g?(h=function(){if(!l){g();return o(!0)}},b[26]=l,b[27]=g,b[28]=h):h=b[28];a=h;j=p>0||!l&&!f;b[29]!==j||b[30]!==l||b[31]!==a?(h=[l,a,j],b[29]=j,b[30]=l,b[31]=a,b[32]=h):h=b[32];return h}function o(a,b,e,g){var i=d("react-compiler-runtime").c(19),j;i[0]!==g?(j=g===void 0?{}:g,i[0]=g,i[1]=j):j=i[1];g=j;j=g.removeUnsentMessages;var k=j===void 0?!1:j,l=(h||(h=c("useReStore")))();g=t(a,b);j=g.attachmentsRange;b=g.hasMoreBefore;var m=g.minTimestampMs,n=g.query;i[2]!==l||i[3]!==e||i[4]!==k?(g=function(a){if(!e(a))return null;if(!k)return a;var b=d("ReQLSuspense").first(d("ReQL").fromTableAscending(l.tables.messages.index("messageId")).getKeyRange(a.messageId),f.id+":147");return b==null||b.isUnsent?null:a},i[2]=l,i[3]=e,i[4]=k,i[5]=g):g=i[5];var o=g;i[6]!==o||i[7]!==n?(g=function(){return n.map(o).filter(Boolean)},i[6]=o,i[7]=n,i[8]=g):g=i[8];var p;i[9]!==l||i[10]!==m||i[11]!==o||i[12]!==a?(p=[l,a,o,m],i[9]=l,i[10]=m,i[11]=o,i[12]=a,i[13]=p):p=i[13];a=d("ReQLSuspense").useArray(g,p,f.id+":160");i[14]!==a||i[15]!==j||i[16]!==b||i[17]!==m?(g=[a,j,m,b],i[14]=a,i[15]=j,i[16]=b,i[17]=m,i[18]=g):g=i[18];return g}function p(a){var b=a.attachmentType;a=a.defaultCtaType;return(i||(i=d("I64"))).equal(b,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA))?a==="xma_web_url"||a==="xma_open_native":!1}function b(a,b){var e=d("react-compiler-runtime").c(7),f;e[0]===Symbol["for"]("react.memo_cache_sentinel")?(f=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").LINKS),e[0]=f):f=e[0];a=o(a,f,p,b);f=a[0];b=a[1];var g=a[2];a=a[3];var h;e[1]===Symbol["for"]("react.memo_cache_sentinel")?(h=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").LINKS),e[1]=h):h=e[1];e[2]!==f||e[3]!==b||e[4]!==a||e[5]!==g?(h=[f,h,b,g,a],e[2]=f,e[3]=b,e[4]=a,e[5]=g,e[6]=h):h=e[6];return h}function q(a){a=a.attachmentType;return(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))||(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))&&c("gkx")("9525")}function e(a,b){var e=d("react-compiler-runtime").c(7),f;e[0]===Symbol["for"]("react.memo_cache_sentinel")?(f=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),e[0]=f):f=e[0];a=o(a,f,q,b);f=a[0];b=a[1];var g=a[2];a=a[3];var h;e[1]===Symbol["for"]("react.memo_cache_sentinel")?(h=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),e[1]=h):h=e[1];e[2]!==f||e[3]!==b||e[4]!==a||e[5]!==g?(h=[f,h,b,g,a],e[2]=f,e[3]=b,e[4]=a,e[5]=g,e[6]=h):h=e[6];return h}function r(a){a=a.attachmentType;return(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").FILE))}function s(a,b){var e=d("react-compiler-runtime").c(7),f;e[0]===Symbol["for"]("react.memo_cache_sentinel")?(f=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").FILES_ONLY),e[0]=f):f=e[0];a=o(a,f,r,b);f=a[0];b=a[1];var g=a[2];a=a[3];var h;e[1]===Symbol["for"]("react.memo_cache_sentinel")?(h=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").FILES_ONLY),e[1]=h):h=e[1];e[2]!==f||e[3]!==b||e[4]!==a||e[5]!==g?(h=[f,h,b,g,a],e[2]=f,e[3]=b,e[4]=a,e[5]=g,e[6]=h):h=e[6];return h}function t(a,b){var e=d("react-compiler-runtime").c(17),g=(h||(h=c("useReStore")))(),j;e[0]!==g.tables.attachments_ranges_v2__generated||e[1]!==b||e[2]!==a?(j=function(){return d("ReQL").fromTableDescending(g.tables.attachments_ranges_v2__generated).getKeyRange(a).filter(function(a){return(i||(i=d("I64"))).equal(a.mediaGroup,b)})},e[0]=g.tables.attachments_ranges_v2__generated,e[1]=b,e[2]=a,e[3]=j):j=e[3];var k;e[4]!==g||e[5]!==b||e[6]!==a?(k=[g,a,b],e[4]=g,e[5]=b,e[6]=a,e[7]=k):k=e[7];j=d("ReQLSuspense").useFirst(j,k,f.id+":293");k=j==null?void 0:j.minTimestampMs;var l=j==null?void 0:j.hasMoreBefore;if(e[8]!==g.tables.attachments||e[9]!==k||e[10]!==a){var m=d("ReQL").fromTableDescending(g.tables.attachments.index("fk_messages")).getKeyRange(a);m=k!=null&&(i||(i=d("I64"))).to_float(k)!==Number.MAX_SAFE_INTEGER?m.bounds({gte:d("ReQL").key(k)}):m;e[8]=g.tables.attachments;e[9]=k;e[10]=a;e[11]=m}else m=e[11];m=m;var n;e[12]!==j||e[13]!==l||e[14]!==k||e[15]!==m?(n={attachmentsRange:j,hasMoreBefore:l,minTimestampMs:k,query:m},e[12]=j,e[13]=l,e[14]=k,e[15]=m,e[16]=n):n=e[16];return n}g.useLoader=a;g.useQueryLinkAttachments=b;g.filterMediaAttachments=q;g.useQueryMediaAttachments=e;g.useQueryFileAttachments=s;g.useAttachmentsQuery=t}),98);
__d("MWV2MediaViewerControls.react",["fbt","FDSCircleButton.react","FDSPhotoDownloadFilled16Icon","Int64Hooks","LSMessagingThreadTypeUtil","MWChatForwardCircleButton.react","MWV2MediaViewerContext.react","MWXCircleButton.react","MWXIconCross","MWXIconDownload","MWXRow.react","MWXRowItem.react","MWXTooltip.react","MessengerWebUXLogger","cr:8987","cr:8988","cr:8989","cr:9742","gkx","react","react-compiler-runtime","useMWHasForwardAction","useMWV2MessageForwardAction"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react")),k=i.useContext,l=h._(/*BTDS*/"Download"),m=h._(/*BTDS*/"Close");function a(a){var e=d("react-compiler-runtime").c(32),f=a.attachment,g=a.message,h=a.onClose;a=a.thread;var i=k(d("MWV2MediaViewerContext.react").context),o=c("MessengerWebUXLogger").useInteractionLogger(),p;e[0]!==f||e[1]!==i?(p=i.getDownloadUrl(f,"MWV2MediaViewerControls"),e[0]=f,e[1]=i,e[2]=p):p=e[2];i=p;e[3]!==f||e[4]!==g?(p=g!=null&&f!=null&&b("cr:9742")!=null&&j.jsx(b("cr:9742"),{attachment:f,message:g}),e[3]=f,e[4]=g,e[5]=p):p=e[5];var q;e[6]!==g||e[7]!==h?(q=h!=null&&g!=null&&b("cr:8987")!=null&&j.jsx(b("cr:8987"),{message:g,onClose:h}),e[6]=g,e[7]=h,e[8]=q):q=e[8];var r;e[9]!==g||e[10]!==a?(r=g!=null&&b("cr:8988")!=null&&j.jsx(b("cr:8988"),{message:g,thread:a}),e[9]=g,e[10]=a,e[11]=r):r=e[11];var s;e[12]!==g||e[13]!==a?(s=g!=null&&b("cr:8989")!=null&&j.jsx(b("cr:8989"),{message:g,thread:a}),e[12]=g,e[13]=a,e[14]=s):s=e[14];var t;e[15]!==o||e[16]!==i?(t=i!=null?j.jsx(c("MWXRowItem.react"),{children:j.jsx(c("MWXTooltip.react"),{tooltip:l,children:c("gkx")("16207")?j.jsx(c("MWXCircleButton.react"),{icon:c("MWXIconDownload"),label:l,linkProps:{download:!0,target:"_blank",url:i},onPress:function(){o==null||o({eventName:"fsmv_download_click"})},size:36,type:"dark-overlay"}):j.jsx(c("FDSCircleButton.react"),{color_DEPRECATED:"white",icon:c("FDSPhotoDownloadFilled16Icon"),label:l,linkProps:{download:!0,target:"_blank",url:i},onPress:function(){o==null||o({eventName:"fsmv_download_click"})},size:36,type_DEPRECATED:"dark-overlay"})})}):null,e[15]=o,e[16]=i,e[17]=t):t=e[17];e[18]!==f||e[19]!==g||e[20]!==a?(i=g!=null?j.jsx(n,{attachment:f,message:g,thread:a}):null,e[18]=f,e[19]=g,e[20]=a,e[21]=i):i=e[21];e[22]!==h?(f=h!=null?j.jsx(c("MWXRowItem.react"),{children:j.jsx(c("MWXTooltip.react"),{tooltip:m,children:j.jsx(c("MWXCircleButton.react"),{icon:c("MWXIconCross"),label:m,onPress:h,size:36,type:"dark-overlay"})})}):null,e[22]=h,e[23]=f):f=e[23];e[24]!==p||e[25]!==q||e[26]!==r||e[27]!==s||e[28]!==t||e[29]!==i||e[30]!==f?(g=j.jsxs(c("MWXRow.react"),{paddingTop:0,spacing:8,children:[p,q,r,s,t,i,f]}),e[24]=p,e[25]=q,e[26]=r,e[27]=s,e[28]=t,e[29]=i,e[30]=f,e[31]=g):g=e[31];return g}function n(a){var b=d("react-compiler-runtime").c(9),e=a.attachment,f=a.message,g=a.thread;a=e==null?void 0:e.attachmentFbid;var i;b[0]!==g.threadType?(i=d("LSMessagingThreadTypeUtil").isArmadilloSecure(g.threadType),b[0]=g.threadType,b[1]=i):i=b[1];i=i;var k,l;b[2]!==g.threadType?(k=function(){return g.threadType},l=[g.threadType],b[2]=g.threadType,b[3]=k,b[4]=l):(k=b[3],l=b[4]);k=d("Int64Hooks").useMemoInt64(k,l);l=c("useMWV2MessageForwardAction")(i,f,k);i=c("useMWHasForwardAction")(g.threadType,f,e);k=i.hasForwardAction;f=i.shouldShowForwardAction;e=a!=null&&(c("gkx")("9525")?k:f);if(a==null||!e)return null;b[5]===Symbol["for"]("react.memo_cache_sentinel")?(i=h._(/*BTDS*/"Forward"),b[5]=i):i=b[5];b[6]!==a||b[7]!==l?(k=j.jsx(c("MWXRowItem.react"),{children:j.jsx(c("MWXTooltip.react"),{tooltip:i,children:j.jsx(c("MWChatForwardCircleButton.react"),{attachmentID:a,color:"white",onOpenForwardDialog:l,type:"dark_overlay"})})}),b[6]=a,b[7]=l,b[8]=k):k=b[8];return k}g["default"]=a}),226);
__d("MWV2MediaViewerControlsContainer.react",["CometPlaceholder.react","MWV2MediaViewerControls.react","MWV2MediaViewerControlsFallback.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(10),e=a.attachment,f=a.message,g=a.onClose;a=a.thread;var h;b[0]!==g?(h=g!=null?i.jsx(c("MWV2MediaViewerControlsFallback.react"),{onClose:g}):null,b[0]=g,b[1]=h):h=b[1];var j;b[2]!==e||b[3]!==f||b[4]!==g||b[5]!==a?(j=i.jsx(c("MWV2MediaViewerControls.react"),{attachment:e,message:f,onClose:g,thread:a}),b[2]=e,b[3]=f,b[4]=g,b[5]=a,b[6]=j):j=b[6];b[7]!==h||b[8]!==j?(e=i.jsx(c("CometPlaceholder.react"),{fallback:h,name:"MWV2MediaViewerContent.Controls",children:j}),b[7]=h,b[8]=j,b[9]=e):e=b[9];return e}g["default"]=a}),98);
__d("MWV2MediaViewerAspectRatioContainer.react",["BaseAspectRatioContainer.react","gkx","react","react-compiler-runtime","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||d("react"),k={containerMaxSize:function(a,b,c){return[{aspectRatio:b!=null?"x1f7gzso":b,marginTop:"xr1yuqi",marginInlineEnd:"x11t971q",marginBottom:"x4ii5y1",marginInlineStart:"xvc5jky",maxHeight:"x1kb659o",$$css:!0},{"--aspectRatio":b!=null?b:void 0,"--maxHeight":function(a){return typeof a==="number"?a+"px":a!=null?a:void 0}("min(calc(100vh - "+c+"px),"+(a!=null?a:1e4)+"px)")}]},expand:function(a,b){return[{aspectRatio:b!=null?"x1f7gzso":b,height:"x1f5funs",marginTop:"xr1yuqi",marginInlineEnd:"x11t971q",marginBottom:"x4ii5y1",marginInlineStart:"xvc5jky",$$css:!0},{"--aspectRatio":b!=null?b:void 0,"--height":function(a){return typeof a==="number"?a+"px":a!=null?a:void 0}(a+"px")}]}};function a(a){var b=d("react-compiler-runtime").c(18),e=a.children,f=a.height,g=a.imageContainerRef,i=a.imageExpansionFactor,m=a.isImageExpanded,n=a.onClickOutsideOfChildren,o=a.outsideContainerRef;a=a.width;i=i===void 0?1:i;m=m===void 0?!1:m;a=a!=null&&f!=null?a/f:1;var p=c("gkx")("16437")?112:76,q;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(q={className:"x5yr21d xh8yej3"},b[0]=q):q=b[0];var r;b[1]===Symbol["for"]("react.memo_cache_sentinel")?(r={className:"x1m82ljr x1dkd41z xbudbmw xr1yuqi x11t971q x4ii5y1 xvc5jky x1n2onr6 xwa60dl x11lhmoz"},b[1]=r):r=b[1];b[2]!==a||b[3]!==f||b[4]!==i||b[5]!==m?(p=(h||(h=c("stylex"))).props(m?k.expand((f!=null?f:0)*i,a):k.containerMaxSize(f,a,p)),b[2]=a,b[3]=f,b[4]=i,b[5]=m,b[6]=p):p=b[6];b[7]!==a||b[8]!==e?(f=j.jsx(c("BaseAspectRatioContainer.react"),{aspectRatio:a,children:e}),b[7]=a,b[8]=e,b[9]=f):f=b[9];b[10]!==g||b[11]!==p||b[12]!==f?(i=j.jsx("div",babelHelpers["extends"]({},r,{children:j.jsx("div",babelHelpers["extends"]({},p,{"aria-hidden":!0,onClick:l,ref:g,children:f}))})),b[10]=g,b[11]=p,b[12]=f,b[13]=i):i=b[13];b[14]!==n||b[15]!==o||b[16]!==i?(m=j.jsx("div",babelHelpers["extends"]({"aria-hidden":!0},q,{onClick:n,ref:o,children:i})),b[14]=n,b[15]=o,b[16]=i,b[17]=m):m=b[17];return m}function l(a){a.cancelBubble=!0,a.stopPropagation()}g["default"]=a}),98);
__d("MWV2MediaViewerItemImage.react",["fbt","BaseImage.react","I64","MWAnimatedImageControlsUtil","MWAnimatedImageThumbnailWithPlayButton.react","MWChatAttachmentMediaState.react","MWV2MediaViewerAspectRatioContainer.react","MWV2MediaViewerContext.react","MWXIconHd","MWXIconStrict.react","MWXPressable.react","MWXThreadThemeColor","MessagingAttachmentType","cr:8080","cr:8990","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=i||(i=d("react"));e=i;var l=e.useContext,m=e.useEffect,n=e.useRef,o=e.useState,p=2;function a(a){var e=d("react-compiler-runtime").c(40),f=a.attachment,g=a.mediaRenderQpl;a=a.onClickOutsideOfImage;var i=d("MWAnimatedImageControlsUtil").useGetMessengerAutoplaySetting(),r=l(d("MWChatAttachmentMediaState.react").context);r=r.isImageExpanded;var s=r?p:1,t=n(null),u=n(null),v=l(d("MWV2MediaViewerContext.react").context),w=v.getPlayableUrl;v=v.heroLoggingComponent;var x=n(null),y=o(!1),z=y[0],A=y[1],B;e[0]!==g?(y=function(){var a;x.current!=null&&(a=x.current)!=null&&a.complete&&g.endSuccess()},B=[g],e[0]=g,e[1]=y,e[2]=B):(y=e[1],B=e[2]);m(y,B);e[3]!==f.previewHeight||e[4]!==f.previewHeightLarge?(y=f.previewHeightLarge!=null?(j||(j=d("I64"))).to_float(f.previewHeightLarge):f.previewHeight!=null?(j||(j=d("I64"))).to_float(f.previewHeight):void 0,e[3]=f.previewHeight,e[4]=f.previewHeightLarge,e[5]=y):y=e[5];B=y;e[6]!==f.previewWidth||e[7]!==f.previewWidthLarge?(y=f.previewWidthLarge!=null?(j||(j=d("I64"))).to_float(f.previewWidthLarge):f.previewWidth!=null?(j||(j=d("I64"))).to_float(f.previewWidth):void 0,e[6]=f.previewWidth,e[7]=f.previewWidthLarge,e[8]=y):y=e[8];y=y;var C=(j||(j=d("I64"))).to_int32(f.attachmentType)===c("MessagingAttachmentType").ANIMATED_IMAGE,D;e[9]!==f||e[10]!==w||e[11]!==g?(D=w(f,"MediaViewerImage",g),e[9]=f,e[10]=w,e[11]=g,e[12]=D):D=e[12];w=D;if(w!=null){var E=C&&i!==d("MWAnimatedImageControlsUtil").MWAutoplayAnimationsSetting.ON;e[13]!==v?(D=v("MWV2MediaViewerImage"),e[13]=v,e[14]=D):D=e[14];e[15]!==f||e[16]!==B||e[17]!==C||e[18]!==z||e[19]!==g||e[20]!==E||e[21]!==w||e[22]!==y?(i=E?z===!1?k.jsx(d("MWAnimatedImageThumbnailWithPlayButton.react").MWAnimatedImageThumbnailWithPlayButton,{connectBottom:!1,connectTop:!1,dbAttachment:f,entryPoint:d("MWAnimatedImageThumbnailWithPlayButton.react").AnimatedImageEntryPoint.MediaViewer,mediaRenderQpl:g,message:null,onPlay:function(){return A(!0)},outgoing:!1,previewHeight:B,previewWidth:y}):k.jsx(c("MWXPressable.react"),{"aria-label":h._(/*BTDS*/"Pause GIF"),hideHoverOverlay:!0,onPress:function(){E&&A(!1)},children:k.jsx(c("BaseImage.react"),{height:"100%",objectFit:"contain",onError:function(){g.endFail("load-image-error")},onLoad:function(){g.endSuccess()},ref:x,src:w,width:"100%"})}):!C&&b("cr:8080")!=null?k.jsx(b("cr:8080"),{imageContainerRef:u,outsideContainerRef:t,children:k.jsx(c("BaseImage.react"),{height:"100%",objectFit:"contain",onError:function(){g.endFail("load-image-error")},onLoad:function(){g.endSuccess()},ref:x,src:w,width:"100%"})}):k.jsx(c("BaseImage.react"),{height:"100%",objectFit:"contain",onError:function(){g.endFail("load-image-error")},onLoad:function(){g.endSuccess()},ref:x,src:w,width:"100%"}),e[15]=f,e[16]=B,e[17]=C,e[18]=z,e[19]=g,e[20]=E,e[21]=w,e[22]=y,e[23]=i):i=e[23];e[24]!==f||e[25]!==r?(v=k.jsx(q,{attachment:f,shouldHide:r}),C=b("cr:8990")&&k.jsx(b("cr:8990"),{attachment:f,shouldHide:r}),e[24]=f,e[25]=r,e[26]=v,e[27]=C):(v=e[26],C=e[27]);e[28]!==D||e[29]!==i||e[30]!==v||e[31]!==C?(z=k.jsxs(k.Fragment,{children:[D,i,v,C]}),e[28]=D,e[29]=i,e[30]=v,e[31]=C,e[32]=z):z=e[32];e[33]!==B||e[34]!==s||e[35]!==r||e[36]!==a||e[37]!==z||e[38]!==y?(w=k.jsx(c("MWV2MediaViewerAspectRatioContainer.react"),{height:B,imageContainerRef:u,imageExpansionFactor:s,isImageExpanded:r,onClickOutsideOfChildren:a,outsideContainerRef:t,width:y,children:z}),e[33]=B,e[34]=s,e[35]=r,e[36]=a,e[37]=z,e[38]=y,e[39]=w):w=e[39];return w}else{g.endFail("missing-playable-url");return null}}function q(a){var b=d("react-compiler-runtime").c(6),e=a.attachment;a=a.shouldHide;a=a===void 0?!1:a;e=e;e=e.isHd===!0;if(!e)return null;b[0]!==a?(e={0:{className:"x78zum5 x5yr21d x47corl x10l6tqk xh8yej3"},1:{className:"x5yr21d x47corl x10l6tqk xh8yej3 x1s85apg"}}[!!a<<0],b[0]=a,b[1]=e):e=b[1];b[2]===Symbol["for"]("react.memo_cache_sentinel")?(a={className:"xdg88n9 x10l6tqk xomnu4r"},b[2]=a):a=b[2];b[3]===Symbol["for"]("react.memo_cache_sentinel")?(a=k.jsx("div",babelHelpers["extends"]({},a,{children:k.jsx(c("MWXIconStrict.react"),{color:d("MWXThreadThemeColor").mwxThreadThemeColor("rgba(255,255,255,0.7)"),icon:c("MWXIconHd"),size:24})})),b[3]=a):a=b[3];b[4]!==e?(a=k.jsx("div",babelHelpers["extends"]({},e,{children:a})),b[4]=e,b[5]=a):a=b[5];return a}g["default"]=a}),226);
__d("MWV2MediaViewerItemVideo.react",["MWChatVideoPlayer.react","MWV2MediaViewerContext.react","cr:9814","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useContext;function a(a){var e=d("react-compiler-runtime").c(15),f=a.attachment,g=a.isSecure;a=a.mediaRenderQpl;var h=j(d("MWV2MediaViewerContext.react").context);h=h.getPlayableUrl;var k;e[0]!==f||e[1]!==h||e[2]!==a?(k=h(f,"MediaViewerVideo",a),e[0]=f,e[1]=h,e[2]=a,e[3]=k):k=e[3];h=k;if(h!=null){e[4]===Symbol["for"]("react.memo_cache_sentinel")?(k={className:"x78zum5 x1iyjqo2 xmz0i5r"},e[4]=k):k=e[4];var l;e[5]!==f.attachmentFbid||e[6]!==g||e[7]!==a||e[8]!==h?(l=i.jsx(c("MWChatVideoPlayer.react"),{controls:"mwchat",fbid:f.attachmentFbid,hideExpandButton:!1,isMediaViewer:!0,isSecure:g,mediaRenderQpl:a,originalHeight:1e3,originalWidth:1e3,sdSrc:h,shouldForcePauseOnClick:!1}),e[5]=f.attachmentFbid,e[6]=g,e[7]=a,e[8]=h,e[9]=l):l=e[9];e[10]!==f?(g=b("cr:9814")&&i.jsx(b("cr:9814"),{attachment:f}),e[10]=f,e[11]=g):g=e[11];e[12]!==l||e[13]!==g?(h=i.jsxs("div",babelHelpers["extends"]({},k,{children:[l,g]})),e[12]=l,e[13]=g,e[14]=h):h=e[14];return h}else{a.endFail("missing-playable-url");return null}}g["default"]=a}),98);
__d("MWV2MediaViewerNullState.react",["fbt","CometColumn.react","CometColumnItem.react","FDSNullState.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(){var a=d("react-compiler-runtime").c(1),b;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b=j.jsx(c("CometColumn.react"),{expanding:!0,verticalAlign:"center",children:j.jsx(c("CometColumnItem.react"),{children:j.jsx(c("FDSNullState.react"),{headline:h._(/*BTDS*/"Sorry, this content isn't available right now")})})}),a[0]=b):b=a[0];return b}g["default"]=a}),226);
__d("MWV2MediaViewerItem.react",["I64","LSIntEnum","MWMediaViewerRenderQpl","MWV2MediaViewerItemImage.react","MWV2MediaViewerItemVideo.react","MWV2MediaViewerNullState.react","MessagingAttachmentType","gkx","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=h||d("react");function a(a){var b=d("react-compiler-runtime").c(12),e=a.attachment,f=a.isSecure,g=a.onClose;a=a.threadType;if(e==null){var h;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(h=k.jsx(c("MWV2MediaViewerNullState.react"),{}),b[0]=h):h=b[0];return h}h=e.attachmentType;if(!((i||(i=d("I64"))).equal(h,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(i||(i=d("I64"))).equal(h,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))||(i||(i=d("I64"))).equal(h,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO)))){b[1]===Symbol["for"]("react.memo_cache_sentinel")?(h=k.jsx(c("MWV2MediaViewerNullState.react"),{}),b[1]=h):h=b[1];return h}b[2]!==g?(h=c("gkx")("6691")&&k.jsx("div",babelHelpers["extends"]({"aria-hidden":!0},{className:"x1ey2m1c xtijo5x x1o0tod x10l6tqk x13vifvy"},{"data-testid":void 0,onClick:g})),b[2]=g,b[3]=h):h=b[3];var m;b[4]!==e||b[5]!==f||b[6]!==g||b[7]!==a?(m=k.jsx(l,{attachment:e,isSecure:f,onClose:g,threadType:a}),b[4]=e,b[5]=f,b[6]=g,b[7]=a,b[8]=m):m=b[8];b[9]!==h||b[10]!==m?(e=k.jsxs(k.Fragment,{children:[h,m]}),b[9]=h,b[10]=m,b[11]=e):e=b[11];return e}function l(a){var b=d("react-compiler-runtime").c(6),e=a.attachment,f=a.isSecure,g=a.onClose;a=a.threadType;a=d("MWMediaViewerRenderQpl").useMediaViewerRenderQpl(e,a);var h=e.attachmentType,l;b[0]!==e||b[1]!==f||b[2]!==a||b[3]!==g||b[4]!==h?(l=(i||(i=d("I64"))).equal(h,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(i||(i=d("I64"))).equal(h,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))?k.jsx(c("MWV2MediaViewerItemImage.react"),{attachment:e,mediaRenderQpl:a,onClickOutsideOfImage:g}):(i||(i=d("I64"))).equal(h,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))?k.jsx(c("MWV2MediaViewerItemVideo.react"),{attachment:e,isSecure:f,mediaRenderQpl:a}):null,b[0]=e,b[1]=f,b[2]=a,b[3]=g,b[4]=h,b[5]=l):l=b[5];return l}g["default"]=a}),98);
__d("MWV2MediaViewerContent.react",["fbt","CometHideLayerOnEscape.react","CometPlaceholder.react","FDSBlurredBackgroundImage.react","I64","LSIntEnum","LSMessagingThreadTypeUtil","MWChatAttachmentMediaNavigationHotkeys.react","MWChatAttachmentMediaState.react","MWChatAttachmentMediaThumbnails.react","MWChatMediaViewerNavigationTapTarget.react","MWV2MediaViewerContainer.react","MWV2MediaViewerContext.react","MWV2MediaViewerControlsContainer.react","MWV2MediaViewerItem.react","MWXColumn.react","MWXColumnItem.react","MWXRow.react","MWXRowItem.react","MessagingAttachmentType","ReQL","ReQLSuspense","cr:8986","cr:9125","gkx","justknobx","react","react-compiler-runtime","useReStore","useShouldShowPlaybackErrorFallback","useShouldShowUnsupportedCodecFallback"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l,m=j||(j=d("react"));e=j;var n=e.useContext,o=e.useEffect,p={mediaItem:{marginTop:"x14vqqas",marginInlineEnd:"xbmvrgn",marginBottom:"xod5an3",marginInlineStart:"x1diwwjn",$$css:!0},mediaRow:{minHeight:"x2lwn1j",$$css:!0},noOverflow:{maxWidth:"x193iq5w",overflowX:"x6ikm8r",overflowY:"x10wlt62",$$css:!0}};function q(a){var b=d("react-compiler-runtime").c(6);a=a.attachment;var e=n(d("MWV2MediaViewerContext.react").context);e=e.getPreviewUrl;if(a==null||(k||(k=d("I64"))).equal(a.attachmentType,(l||(l=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE)))return null;var f;b[0]!==a||b[1]!==e?(f=e(a,"BlurredBackground"),b[0]=a,b[1]=e,b[2]=f):f=b[2];a=f;if(a==null)return null;b[3]===Symbol["for"]("react.memo_cache_sentinel")?(e={className:"x1ey2m1c xtijo5x x1o0tod xuzhngd x10l6tqk x13vifvy"},b[3]=e):e=b[3];b[4]!==a?(f=m.jsx("div",babelHelpers["extends"]({},e,{children:m.jsx(c("FDSBlurredBackgroundImage.react"),{src:a})})),b[4]=a,b[5]=f):f=b[5];return f}function a(a){var e=d("react-compiler-runtime").c(75),g=a.initialAttachment,j=a.onClose,k=a.shouldShowMessengerLogo;a=a.thread;var l=n(d("MWChatAttachmentMediaState.react").context),r=l.canMoveBackward,s=l.canMoveForward,t=l.card,u=l.isImageExpanded,v=l.moveBackward,w=l.moveForward;l=l.shouldTriggerLoadMore;var x=n(d("MWV2MediaViewerContext.react").context),y=x.getPreviewUrl,z=x.loadMore,A=(i||(i=c("useReStore")))(),B=g==null?void 0:g.threadKey,C=g==null?void 0:g.messageId;e[0]!==A.tables.attachments||e[1]!==C||e[2]!==B?(x=function(){return d("ReQL").fromTableDescending(A.tables.attachments).getKeyRange(B,C)},e[0]=A.tables.attachments,e[1]=C,e[2]=B,e[3]=x):x=e[3];var D;e[4]!==A||e[5]!==C||e[6]!==B?(D=[A,C,B],e[4]=A,e[5]=C,e[6]=B,e[7]=D):D=e[7];x=d("ReQLSuspense").useFirst(x,D,f.id+":117")!=null;var E=t!=null?t.attachment:x?g:void 0;e[8]!==E||e[9]!==A.tables.messages?(D=function(){return(E==null?void 0:E.messageId)==null?d("ReQL").empty():d("ReQL").fromTableAscending(A.tables.messages.index("messageId")).getKeyRange(E.messageId)},e[8]=E,e[9]=A.tables.messages,e[10]=D):D=e[10];t=E==null?void 0:E.messageId;e[11]!==A.tables.messages||e[12]!==t?(x=[t,A.tables.messages],e[11]=A.tables.messages,e[12]=t,e[13]=x):x=e[13];g=d("ReQLSuspense").useFirst(D,x,f.id+":133");var F=l;e[14]!==z||e[15]!==F?(t=function(){F&&z()},D=[F,z],e[14]=z,e[15]=F,e[16]=t,e[17]=D):(t=e[16],D=e[17]);o(t,D);x=c("gkx")("1775");l=c("useShouldShowUnsupportedCodecFallback")(E);t=c("useShouldShowPlaybackErrorFallback")(E);e[18]!==E||e[19]!==t||e[20]!==l||e[21]!==j||e[22]!==a?(D=!l&&!t?m.jsx(c("MWV2MediaViewerItem.react"),{attachment:E,isSecure:d("LSMessagingThreadTypeUtil").isArmadilloSecure(a.threadType),onClose:j,threadType:a.threadType}):null,e[18]=E,e[19]=t,e[20]=l,e[21]=j,e[22]=a,e[23]=D):D=e[23];t=D;e[24]===Symbol["for"]("react.memo_cache_sentinel")?(l=c("justknobx")._("3491"),e[24]=l):l=e[24];D=l;e[25]!==E||e[26]!==g||e[27]!==j||e[28]!==a?(l=m.jsx(c("MWV2MediaViewerControlsContainer.react"),{attachment:E,message:g,onClose:j,thread:a}),e[25]=E,e[26]=g,e[27]=j,e[28]=a,e[29]=l):l=e[29];var G;e[30]!==g||e[31]!==a?(G=b("cr:8986")!=null&&m.jsx(b("cr:8986"),{message:g,thread:a}),e[30]=g,e[31]=a,e[32]=G):G=e[32];e[33]!==j?(a=D?null:m.jsx(d("MWChatAttachmentMediaNavigationHotkeys.react").MWChatAttachmentMediaNavigationHotkeys,{onClose:x?j:void 0}),e[33]=j,e[34]=a):a=e[34];var H;e[35]!==E?(H=m.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MWV2MediaViewerContent.BlurredBackground",children:m.jsx(q,{attachment:E})}),e[35]=E,e[36]=H):H=e[36];var I;e[37]===Symbol["for"]("react.memo_cache_sentinel")?(I=[p.mediaRow,x&&p.noOverflow],e[37]=I):I=e[37];var J;e[38]===Symbol["for"]("react.memo_cache_sentinel")?(J=h._(/*BTDS*/"Previous photo"),e[38]=J):J=e[38];r=!r;e[39]!==u||e[40]!==v||e[41]!==r?(J=m.jsx(c("MWXRowItem.react"),{children:m.jsx(c("MWChatMediaViewerNavigationTapTarget.react"),{direction:"previous",label:J,onClick:v,shouldHide:r,shouldHideWithoutTransition:u,testid:void 0})}),e[39]=u,e[40]=v,e[41]=r,e[42]=J):J=e[42];e[43]!==t?(v=m.jsx(c("MWXRowItem.react"),{expanding:!0,verticalAlign:"stretch",xstyle:x&&p.mediaItem,children:m.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MWV2MediaViewerContent.MediaContent",children:t})}),e[43]=t,e[44]=v):v=e[44];e[45]===Symbol["for"]("react.memo_cache_sentinel")?(r=h._(/*BTDS*/"Next photo"),e[45]=r):r=e[45];t=!s;e[46]!==u||e[47]!==w||e[48]!==t?(s=m.jsx(c("MWXRowItem.react"),{children:m.jsx(c("MWChatMediaViewerNavigationTapTarget.react"),{direction:"next",label:r,onClick:w,shouldHide:t,shouldHideWithoutTransition:u,testid:void 0})}),e[46]=u,e[47]=w,e[48]=t,e[49]=s):s=e[49];e[50]!==J||e[51]!==v||e[52]!==s?(r=m.jsx(c("MWXColumnItem.react"),{expanding:!0,verticalAlign:"center",children:m.jsxs(c("MWXRow.react"),{align:"justify",expanding:!0,paddingHorizontal:0,paddingVertical:0,spacingHorizontal:x?0:void 0,verticalAlign:"stretch",xstyle:I,children:[J,v,s]})}),e[50]=J,e[51]=v,e[52]=s,e[53]=r):r=e[53];e[54]!==y||e[55]!==u||e[56]!==g?(w=m.jsx(c("MWXColumnItem.react"),{children:b("cr:9125")!=null?m.jsx(b("cr:9125"),{getPreviewUrl:y,message:g,shouldHide:u}):m.jsx(c("MWChatAttachmentMediaThumbnails.react"),{getPreviewUrl:y,shouldHide:u})}),e[54]=y,e[55]=u,e[56]=g,e[57]=w):w=e[57];e[58]!==r||e[59]!==w?(t=m.jsxs(c("MWXColumn.react"),{align:"stretch",expanding:!0,paddingHorizontal:0,verticalAlign:"space-between",children:[r,w]}),e[58]=r,e[59]=w,e[60]=t):t=e[60];e[61]!==u||e[62]!==k||e[63]!==l||e[64]!==G||e[65]!==a||e[66]!==H||e[67]!==t?(I=m.jsxs(c("MWV2MediaViewerContainer.react"),{actions:l,hideActions:u,senderAttribution:G,shouldShowMessengerLogo:k,children:[a,H,t]}),e[61]=u,e[62]=k,e[63]=l,e[64]=G,e[65]=a,e[66]=H,e[67]=t,e[68]=I):I=e[68];J=I;if(j!=null&&!x){e[69]!==J||e[70]!==j?(v=m.jsx(c("CometHideLayerOnEscape.react"),{onHide:j,children:J}),e[69]=J,e[70]=j,e[71]=v):v=e[71];return v}else{if(D){s=x?j:void 0;e[72]!==J||e[73]!==s?(y=m.jsx(d("MWChatAttachmentMediaNavigationHotkeys.react").MWChatAttachmentMediaNavigationHotkeys,{onClose:s,children:J}),e[72]=J,e[73]=s,e[74]=y):y=e[74];return y}return J}}g["default"]=a}),226);
__d("useLoadMoreThreadSharedAttachments.react",["Int64Hooks","LSFactory","LSIssueAttachmentsRangeQueryStoredProcedure","MAWThreadCutover","MWThreadKey.react","promiseDone","react-compiler-runtime","useAsyncReStore"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e){var g=d("react-compiler-runtime").c(6),h=c("useAsyncReStore")(),i=d("MWThreadKey.react").useMWThreadKeyMemoized();i==null&&(i=b);b=d("MAWThreadCutover").useGetCutoverOpenThreadKey(i);var j=b!=null?b:i;g[0]!==h||g[1]!==j||g[2]!==e||g[3]!==a?(b=function(){e==null||e(),c("promiseDone")(h,function(b){return b.runInTransaction(function(b){return c("LSIssueAttachmentsRangeQueryStoredProcedure")(c("LSFactory")(b),{mediaGroup:a,threadKey:j})},"readwrite",void 0,void 0,f.id+":40")})},i=[e,h,a,j],g[0]=h,g[1]=j,g[2]=e,g[3]=a,g[4]=b,g[5]=i):(b=g[4],i=g[5]);return d("Int64Hooks").useCallbackInt64(b,i)}g["default"]=a}),98);
__d("useMAWLoadMoreThreadSharedAttachments",["I64","Int64Hooks","MAWBridgeSendAndReceive","MAWMediaGalleryEBTaggingUtils","MAWMiActOnActThreadReady","Promise","cr:20241","promiseDone","react-compiler-runtime","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function a(a){var e=d("react-compiler-runtime").c(16),f=a.earliestLoadedMediaMessageId,g=a.hasMoreBefore,k=a.mediaGalleryGroup,l=a.minTimestampMs,m=a.pageSize,n=a.qplLogger,o=a.threadKey,p=(j||(j=c("useReStore")))(),q;e[0]!==g||e[1]!==l?(a=function(){return g!=null&&g&&l!=null?(i||(i=d("I64"))).to_float(l):Number.MAX_SAFE_INTEGER},q=[g,l],e[0]=g,e[1]=l,e[2]=a,e[3]=q):(a=e[2],q=e[3]);var r=d("Int64Hooks").useCallbackInt64(a,q);e[4]!==k?(a=d("MAWMediaGalleryEBTaggingUtils").isMediaGalleryGroupSupportedForTaggedRestore(k),e[4]=k,e[5]=a):a=e[5];var s=a;e[6]!==p.tables||e[7]!==f||e[8]!==r||e[9]!==s||e[10]!==k||e[11]!==m||e[12]!==n||e[13]!==o?(q=function(){o!=null&&(n==null||n.logLoadMediaStart==null||n.logLoadMediaStart(),c("promiseDone")(d("MAWMiActOnActThreadReady").onActThreadReady(p.tables,o,"useMAWLoadMoreThreadSharedAttachments",function(a,c){return(b("cr:20241")!=null&&s?b("cr:20241").MAWFetchAndPersistMedia(c,o,k,n):(h||(h=b("Promise"))).resolve()).then(function(){n==null||n.addPoint("fetch_from_maw_db",{"int":{mediaGalleryGroup:k}});return d("MAWBridgeSendAndReceive").sendAndReceive("backend","loadMoreMedia",{earliestLoadedMediaMessageId:f,earliestLoadedMediaTs:r(),mediaGalleryGroup:k,pageSize:m,threadJid:c})})})))},a=[o,p.tables,s,k,n,f,r,m],e[6]=p.tables,e[7]=f,e[8]=r,e[9]=s,e[10]=k,e[11]=m,e[12]=n,e[13]=o,e[14]=q,e[15]=a):(q=e[14],a=e[15]);return d("Int64Hooks").useCallbackInt64(q,a)}g["default"]=a}),98);
__d("useMAWQuerySecureMediaAttachments",["I64","LSIntEnum","LSThreadMediaGalleryGroup","MWSharedAttachmentsSectionHooks","ReQL","ReQLSuspense","gkx","justknobx","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;b=k||d("react");var l=b.useCallback,m=b.useMemo;function a(a,b,e){e=e===void 0?{}:e;e=e.removeUnsentMessages;var g=e===void 0?!1:e,k=(h||(h=c("useReStore")))(),o=b==null||!c("gkx")("9247")?c("justknobx")._("1132"):b;e=d("MWSharedAttachmentsSectionHooks").useAttachmentsQuery(a,(i||(i=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS));b=e.attachmentsRange;var q=e.hasMoreBefore,r=e.minTimestampMs,s=e.query,t=l(function(a){if(!d("MWSharedAttachmentsSectionHooks").filterMediaAttachments(a))return null;var b=d("ReQLSuspense").first(d("ReQL").fromTableAscending(k.tables.messages.index("messageId")).getKeyRange(a.messageId),f.id+":79");if(g&&(b==null||b.isUnsent))return null;return b==null?{attachment:a}:{attachment:a,message:b}},[k,g]),u=d("ReQLSuspense").useArray(function(){var a=s.map(t).filter(Boolean);(r==null||(j||(j=d("I64"))).equal(r,(j||(j=d("I64"))).zero))&&(a=a.take(o));return a},[k,a,t,r],f.id+":97"),v=m(function(){var a=n(u);a.sort(p);return a},[u]);e=m(function(){return v.map(function(a){a=a.attachment;return a})},[v]);return[e,i.ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),b,r,q]}function n(a){var b=o(a);return a.map(function(a){var c=a.attachment;a=a.message;var e=a==null?void 0:a.groupId,f=b.get(e!=null?e:"");if(e==null||f==null){return{attachment:c,message:a,sortKey:{sortingMessageGroupIndex:Number.MAX_SAFE_INTEGER,sortingMessageId:c.messageId,sortingMessagePrimarySortTS:(e=a==null?void 0:a.primarySortKey)!=null?e:c.timestampMs,sortingMessageSecondarySortTS:(e=(e=a==null?void 0:a.secondarySortKey)!=null?e:a==null?void 0:a.timestampMs)!=null?e:c.timestampMs}}}return{attachment:c,message:a,sortKey:{sortingMessageGroupIndex:(j||(j=d("I64"))).to_int32((e=a==null?void 0:a.groupIndex)!=null?e:(j||(j=d("I64"))).zero),sortingMessageId:f.messageId,sortingMessagePrimarySortTS:f.primarySortTs,sortingMessageSecondarySortTS:f.secondarySortTs}}})}function o(a){var b=new Map();a.forEach(function(a){var c;a=a.message;if(!a||a.groupId==null||a.groupIndex==null)return;var e=a.groupId,f=(j||(j=d("I64"))).to_int32(a.groupIndex);c=Math.min((c=(c=b.get(e))==null?void 0:c.groupIndex)!=null?c:Number.MAX_SAFE_INTEGER,f);f=f===c?{groupIndex:f,messageId:a.messageId,primarySortTs:a.primarySortKey,secondarySortTs:(c=a.secondarySortKey)!=null?c:a.timestampMs}:b.get(e);f&&b.set(e,f)});return b}function p(a,b){var c=a.sortKey,e=b.sortKey;a=a.message;b=b.message;if(!(j||(j=d("I64"))).equal(c.sortingMessagePrimarySortTS,e.sortingMessagePrimarySortTS))return(j||(j=d("I64"))).compare(e.sortingMessagePrimarySortTS,c.sortingMessagePrimarySortTS);if(!(j||(j=d("I64"))).equal(e.sortingMessageSecondarySortTS,c.sortingMessageSecondarySortTS))return(j||(j=d("I64"))).compare(e.sortingMessageSecondarySortTS,c.sortingMessageSecondarySortTS);if(c.sortingMessageId!==e.sortingMessageId)return e.sortingMessageId.localeCompare(c.sortingMessageId);return(a==null?void 0:a.groupId)!=null&&(b==null?void 0:b.groupId)!=null&&a.groupId===b.groupId?e.sortingMessageGroupIndex-c.sortingMessageGroupIndex:0}g["default"]=a}),98);
__d("useMWMediaLoadingQplLogger",["MWMediaRenderQplUtils","QPLUserFlow","QuickPerformanceLogger","Random","qpl","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i;b=i||d("react");b.useCallback;var j=b.useEffect;b.useMemo;function a(a){var b=d("react-compiler-runtime").c(11),e=a.entrypoint,f=a.threadType;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(a=o(),b[0]=a):a=b[0];a=a;var g=a;b[1]!==e||b[2]!==f?(a=function(a){var b;k({entrypoint:e,instanceKey:g,isCutoverThread:(b=a==null?void 0:a.isCutoverThread)!=null?b:!1,isPreCutoverMedia:(b=a==null?void 0:a.isPreCutoverMedia)!=null?b:!1,threadType:f})},b[1]=e,b[2]=f,b[3]=a):a=b[3];a=a;var i;b[4]===Symbol["for"]("react.memo_cache_sentinel")?(i=function(a){var b=a.fetchedMediaCount,c=a.isAlreadyPreloaded;a=a.startMediaCount;l({fetchedMediaCount:b,instanceKey:g,isAlreadyPreloaded:c,startMediaCount:a})},b[4]=i):i=b[4];i=i;var p;b[5]===Symbol["for"]("react.memo_cache_sentinel")?(p=function(){m({instanceKey:g})},b[5]=p):p=b[5];var q=p;b[6]===Symbol["for"]("react.memo_cache_sentinel")?(p=function(a,b){n({annotations:b,instanceKey:g,name:a})},b[6]=p):p=b[6];p=p;var r,s;b[7]===Symbol["for"]("react.memo_cache_sentinel")?(r=function(){return function(){var a=(h||(h=c("QuickPerformanceLogger"))).isMarkerOn(c("qpl")._(25300395,"1954"),g);a&&q()}},s=[g,q],b[7]=r,b[8]=s):(r=b[7],s=b[8]);j(r,s);b[9]!==a?(r={addPoint:p,logLoadMediaCancel:q,logLoadMediaStart:a,logLoadMediaSuccess:i},b[9]=a,b[10]=r):r=b[10];s=r;return s}function k(a){var b=a.entrypoint,e=a.instanceKey,f=a.isCutoverThread;f=f===void 0?!1:f;var g=a.isPreCutoverMedia;g=g===void 0?!1:g;a=a.threadType;c("QPLUserFlow").start(c("qpl")._(25300395,"1954"),{annotations:{bool:{isCutoverThread:f,isPreCutoverMedia:g},string:{entrypoint:b,threadType:d("MWMediaRenderQplUtils").getThreadTypeStringFromEnum(a)}},cancelOnUnload:!0,instanceKey:e,timeoutInMs:60*1e3})}function l(a){var b=a.fetchedMediaCount,d=a.instanceKey,e=a.isAlreadyPreloaded;a=a.startMediaCount;c("QPLUserFlow").endSuccess(c("qpl")._(25300395,"1954"),{annotations:{bool:{isAlreadyPreloaded:e!=null?e:!1},"int":{fetchedMediaCount:b,startMediaCount:a}},instanceKey:d})}function m(a){a=a.instanceKey;c("QPLUserFlow").endCancel(c("qpl")._(25300395,"1954"),{instanceKey:a})}function n(a){var b=a.annotations,d=a.instanceKey;a=a.name;c("QPLUserFlow").addPoint(c("qpl")._(25300395,"1954"),a,{data:b,instanceKey:d})}function o(){return Date.now()+Math.round(d("Random").random()*1e4)}g["default"]=a}),98);
__d("useMAWLoadMoreCutoverThreadSharedAttachments",["MAWDbMsg","MWSharedAttachmentsSectionHooks","gkx","react","react-compiler-runtime","useLoadMoreThreadSharedAttachments.react","useMAWLoadMoreThreadSharedAttachments","useMAWQuerySecureMediaAttachments","useMWMediaLoadingQplLogger"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(a,b,e,f,g,h,j){var k=d("react-compiler-runtime").c(55),l=c("useMAWQuerySecureMediaAttachments")(a,j),m=l[0],n=l[1],o=l[2],p=l[3];l=l[4];var q;k[0]!==(o==null?void 0:o.lastLoadedMessageId)?(q=(o==null?void 0:o.lastLoadedMessageId)!=null?d("MAWDbMsg").toMsgId(o==null?void 0:o.lastLoadedMessageId):void 0,k[0]=o==null?void 0:o.lastLoadedMessageId,k[1]=q):q=k[1];q=q;var r=l!=null?l:!0,s;k[2]!==f.entrypoint||k[3]!==e?(s={entrypoint:f.entrypoint,threadType:e},k[2]=f.entrypoint,k[3]=e,k[4]=s):s=k[4];var t=c("useMWMediaLoadingQplLogger")(s);k[5]!==t?(f=function(){t.logLoadMediaStart({isCutoverThread:!0,isPreCutoverMedia:!1})},k[5]=t,k[6]=f):f=k[6];e=f;s=q!=null?q:void 0;k[7]!==e||k[8]!==t?(f=babelHelpers["extends"]({},t,{logLoadMediaStart:e}),k[7]=e,k[8]=t,k[9]=f):f=k[9];k[10]!==l||k[11]!==g||k[12]!==p||k[13]!==j||k[14]!==a||k[15]!==s||k[16]!==f?(q={earliestLoadedMediaMessageId:s,hasMoreBefore:l,mediaGalleryGroup:g,minTimestampMs:p,pageSize:j,qplLogger:f,threadKey:a},k[10]=l,k[11]=g,k[12]=p,k[13]=j,k[14]=a,k[15]=s,k[16]=f,k[17]=q):q=k[17];e=c("useMAWLoadMoreThreadSharedAttachments")(q);l=d("MWSharedAttachmentsSectionHooks").useQueryMediaAttachments(b);g=l[0];p=l[2];j=l[4];a=j!=null?j:c("gkx")("6241");k[18]!==t?(s=function(){t.logLoadMediaStart({isCutoverThread:!0,isPreCutoverMedia:!0})},k[18]=t,k[19]=s):s=k[19];f=s;q=c("useLoadMoreThreadSharedAttachments.react")(n,b,f);k[20]!==o||k[21]!==r||k[22]!==e||k[23]!==m||k[24]!==t.logLoadMediaCancel||k[25]!==t.logLoadMediaSuccess?(l={attachmentsRange:o,hasMore:r,loadMore:e,logLoadMediaCancel:t.logLoadMediaCancel,logLoadMediaSuccess:t.logLoadMediaSuccess,media:m},k[20]=o,k[21]=r,k[22]=e,k[23]=m,k[24]=t.logLoadMediaCancel,k[25]=t.logLoadMediaSuccess,k[26]=l):l=k[26];j=d("MWSharedAttachmentsSectionHooks").useLoader(l);s=j[0];n=j[1];b=j[2];f=r||s;k[27]!==p||k[28]!==a||k[29]!==q||k[30]!==g||k[31]!==t.logLoadMediaCancel||k[32]!==t.logLoadMediaSuccess||k[33]!==f?(o={attachmentsRange:p,hasMore:a,loadMore:q,logLoadMediaCancel:t.logLoadMediaCancel,logLoadMediaSuccess:t.logLoadMediaSuccess,media:g,skipInitialLoad:f},k[27]=p,k[28]=a,k[29]=q,k[30]=g,k[31]=t.logLoadMediaCancel,k[32]=t.logLoadMediaSuccess,k[33]=f,k[34]=o):o=k[34];e=d("MWSharedAttachmentsSectionHooks").useLoader(o);l=e[0];j=e[1];p=e[2];if(r||s||h===!0){k[35]!==b||k[36]!==r||k[37]!==s||k[38]!==m||k[39]!==n?(q={attachments:m,completedFirstLoad:b,hasMore:r,isLoadingMore:s,onLoadMore:n},k[35]=b,k[36]=r,k[37]=s,k[38]=m,k[39]=n,k[40]=q):q=k[40];return q}else if(a||l){k[41]!==g||k[42]!==m?(f=m.concat(g),k[41]=g,k[42]=m,k[43]=f):f=k[43];k[44]!==p||k[45]!==a||k[46]!==l||k[47]!==j||k[48]!==f?(o={attachments:f,completedFirstLoad:p,hasMore:a,isLoadingMore:l,onLoadMore:j},k[44]=p,k[45]=a,k[46]=l,k[47]=j,k[48]=f,k[49]=o):o=k[49];return o}else{k[50]!==g||k[51]!==m?(e=m.concat(g),k[50]=g,k[51]=m,k[52]=e):e=k[52];k[53]!==e?(h={attachments:e,completedFirstLoad:!0,hasMore:!1,isLoadingMore:!1,onLoadMore:i},k[53]=e,k[54]=h):h=k[54];return h}}function i(){}g["default"]=a}),98);
__d("useMWMaybeInboxMediaRestoreLoop",["cr:20239","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var c=d("react-compiler-runtime").c(2);a=b("cr:20239")(a);var e;c[0]!==a?(e=a!=null?a:{onEBOnboarded:i,startMediaSync:h},c[0]=a,c[1]=e):e=c[1];return e}function h(){}function i(){}g["default"]=a}),98);
__d("useMWV2MediaViewerOpenPlayableUrl",["I64","LSIntEnum","LSMediaUrlAttachment","MessagingAttachmentType","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;(h||d("react")).useCallback;function a(){return k}function k(a){if(a==null)return;return(i||(i=d("I64"))).equal(a.attachmentType,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))?d("LSMediaUrlAttachment").previewUrl(a):d("LSMediaUrlAttachment").playableUrl(a)}g["default"]=a}),98);
__d("useMWV2MediaViewerOpenDownloadUrl",["react","react-compiler-runtime","useMWV2MediaViewerOpenPlayableUrl"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(){var a=d("react-compiler-runtime").c(2),b=c("useMWV2MediaViewerOpenPlayableUrl")(),e;a[0]!==b?(e=function(a,c,d){a=b(a,c,d);if(a==null)return;c=new URL(a);c.searchParams.set("dl","1");return c.toString()},a[0]=b,a[1]=e):e=a[1];return e}g["default"]=a}),98);
__d("useMWV2MediaViewerOpenPreviewUrl",["LSMediaUrlAttachment","react"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(){return i}function i(a){return a!=null?d("LSMediaUrlAttachment").previewUrl(a):void 0}g["default"]=a}),98);
__d("useMWV2MediaViewerSecurePreviewUrl_CausesSuspense",["cr:5931","react"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(){return i}function i(a,c,d){return b("cr:5931")==null?void 0:b("cr:5931").getThumbnailBlob_CausesSuspense(a,c,d)}g["default"]=a}),98);
__d("MWV2MediaViewerCutoverWrapper.react",["LSThreadMediaGalleryGroup","MWChatAttachmentMediaState.react","MWMessageSearchStatusTypes","MWV2MediaViewerContext.react","emptyFunction","justknobx","react","react-compiler-runtime","useMAWLoadMoreCutoverThreadSharedAttachments","useMWMaybeInboxMediaRestoreLoop","useMWMediaGalleryRestoreStatus","useMWV2MediaViewerOpenDownloadUrl","useMWV2MediaViewerOpenPlayableUrl","useMWV2MediaViewerOpenPreviewUrl","useMWV2MediaViewerSecurePlayableUrl_CausesSuspense","useMWV2MediaViewerSecurePreviewUrl_CausesSuspense"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useCallback;function a(a){var b=d("react-compiler-runtime").c(30),e=a.children,f=a.initialAttachment,g=a.openThreadKey,h=a.secureThreadKey;a=a.threadType;var k;b[0]!==h||b[1]!==a?(k={threadKey:h,threadType:a},b[0]=h,b[1]=a,b[2]=k):k=b[2];c("useMWMaybeInboxMediaRestoreLoop")(k);b[3]!==h||b[4]!==a?(k={threadKey:h,threadType:a},b[3]=h,b[4]=a,b[5]=k):k=b[5];k=c("useMWMediaGalleryRestoreStatus")(k);k=k===d("MWMessageSearchStatusTypes").RestoreStatus.IN_PROGRESS;var l;b[6]===Symbol["for"]("react.memo_cache_sentinel")?(l={entrypoint:"media_viewer"},b[6]=l):l=b[6];var m;b[7]===Symbol["for"]("react.memo_cache_sentinel")?(m=c("justknobx")._("3233"),b[7]=m):m=b[7];h=c("useMAWLoadMoreCutoverThreadSharedAttachments")(h,g,a,l,c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS,k,m);g=h.attachments;a=h.onLoadMore;var n=j,o=c("useMWV2MediaViewerOpenPreviewUrl")(),p=c("useMWV2MediaViewerOpenPlayableUrl")(),q=c("useMWV2MediaViewerOpenDownloadUrl")(),r=c("useMWV2MediaViewerSecurePreviewUrl_CausesSuspense")(),s=c("useMWV2MediaViewerSecurePlayableUrl_CausesSuspense")();b[8]!==o||b[9]!==r?(l=function(a,b,c){if(!a)return"";return!n(a)?o(a,b,c):r(a,b,c)},b[8]=o,b[9]=r,b[10]=l):l=b[10];k=l;b[11]!==p||b[12]!==s?(m=function(a,b,c){if(a==null)return"";return!n(a)?p(a,b,c):s(a,b,c)},b[11]=p,b[12]=s,b[13]=m):m=b[13];h=m;b[14]!==q||b[15]!==s?(l=function(a,b,c){if(a==null)return"";return!n(a)?q(a,b,c):s(a,b,c)},b[14]=q,b[15]=s,b[16]=l):l=b[16];m=l;b[17]!==g||b[18]!==e||b[19]!==h||b[20]!==k||b[21]!==f?(l=i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:g,getIsSecureThread:n,getPlayableUrl:h,getPreviewUrl:k,initialAttachment:f,children:e}),b[17]=g,b[18]=e,b[19]=h,b[20]=k,b[21]=f,b[22]=l):l=b[22];b[23]!==g||b[24]!==m||b[25]!==h||b[26]!==k||b[27]!==a||b[28]!==l?(e=i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:m,getPlayableUrl:h,getPreviewUrl:k,heroLoggingComponent:c("emptyFunction"),loadMore:a,media:g,children:l}),b[23]=g,b[24]=m,b[25]=h,b[26]=k,b[27]=a,b[28]=l,b[29]=e):e=b[29];return e}function j(a){return!((a==null?void 0:a.transportKey)==="FBBroker"||(a==null?void 0:a.transportKey)==="FBLegacyBroker")}g["default"]=a}),98);
__d("MWV2MediaViewerOpenWrapper.react",["CometHero.react","MWChatAttachmentMediaState.react","MWSharedAttachmentsSectionHooks","MWV2MediaViewerContext.react","react","react-compiler-runtime","useLoadMoreThreadSharedAttachments.react","useMWMediaLoadingQplLogger","useMWV2MediaViewerOpenDownloadUrl","useMWV2MediaViewerOpenPlayableUrl","useMWV2MediaViewerOpenPreviewUrl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useCallback;function a(a){var b=d("react-compiler-runtime").c(22),e=a.children,f=a.initialAttachment;a=a.thread;var g=d("MWSharedAttachmentsSectionHooks").useQueryMediaAttachments(a.threadKey),h=g[0],l=g[1],m=g[2];g=g[4];var n;b[0]!==a.threadType?(n={entrypoint:"media_viewer",threadType:a.threadType},b[0]=a.threadType,b[1]=n):n=b[1];n=c("useMWMediaLoadingQplLogger")(n);l=c("useLoadMoreThreadSharedAttachments.react")(l,a.threadKey,n.logLoadMediaStart);a=g!=null?g:!0;b[2]!==m||b[3]!==l||b[4]!==h||b[5]!==n.logLoadMediaCancel||b[6]!==n.logLoadMediaSuccess||b[7]!==a?(g={attachmentsRange:m,hasMore:a,loadMore:l,logLoadMediaCancel:n.logLoadMediaCancel,logLoadMediaSuccess:n.logLoadMediaSuccess,media:h},b[2]=m,b[3]=l,b[4]=h,b[5]=n.logLoadMediaCancel,b[6]=n.logLoadMediaSuccess,b[7]=a,b[8]=g):g=b[8];m=d("MWSharedAttachmentsSectionHooks").useLoader(g);l=m[1];n=c("useMWV2MediaViewerOpenPreviewUrl")();a=c("useMWV2MediaViewerOpenPlayableUrl")();g=c("useMWV2MediaViewerOpenDownloadUrl")();m=k;b[9]!==e||b[10]!==a||b[11]!==n||b[12]!==f||b[13]!==h?(m=i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:h,getIsSecureThread:m,getPlayableUrl:a,getPreviewUrl:n,initialAttachment:f,children:e}),b[9]=e,b[10]=a,b[11]=n,b[12]=f,b[13]=h,b[14]=m):m=b[14];b[15]!==g||b[16]!==a||b[17]!==n||b[18]!==l||b[19]!==h||b[20]!==m?(e=i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:g,getPlayableUrl:a,getPreviewUrl:n,heroLoggingComponent:j,loadMore:l,media:h,children:m}),b[15]=g,b[16]=a,b[17]=n,b[18]=l,b[19]=h,b[20]=m,b[21]=e):e=b[21];return e}function j(a){return i.jsx(c("CometHero.react"),{description:a})}j.displayName=j.name+" [from "+f.id+"]";function k(){return!1}g["default"]=a}),98);
__d("MWV2MediaViewerSecureWrapper.react",["LSThreadMediaGalleryGroup","MAWDbMsg","MWChatAttachmentMediaState.react","MWSharedAttachmentsSectionHooks","MWV2MediaViewerContext.react","MWV2MediaViewerNullState.react","cr:5709","cr:5931","cr:5970","emptyFunction","justknobx","react","react-compiler-runtime","useMAWQuerySecureMediaAttachments","useMWMaybeInboxMediaRestoreLoop","useMWMediaLoadingQplLogger","useMWV2MediaViewerSecurePlayableUrl_CausesSuspense","useMWV2MediaViewerSecurePreviewUrl_CausesSuspense"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useCallback;function a(a){return j}function j(){}var k=b("cr:5709")==null?a:b("cr:5709");function e(a){var e=d("react-compiler-runtime").c(34),f=a.children,g=a.initialAttachment;a=a.thread;var h;e[0]===Symbol["for"]("react.memo_cache_sentinel")?(h=c("justknobx")._("3233"),e[0]=h):h=e[0];h=h;var j=c("useMAWQuerySecureMediaAttachments")(a.threadKey,h),m=j[0],n=j[2],o=j[3];j=j[4];c("useMWMaybeInboxMediaRestoreLoop")(a);var p=j!=null?j:!0;e[1]!==a.threadType?(j={entrypoint:"media_viewer",threadType:a.threadType},e[1]=a.threadType,e[2]=j):j=e[2];j=c("useMWMediaLoadingQplLogger")(j);if(e[3]!==(n==null?void 0:n.lastLoadedMessageId)){var q;q=(q=d("MAWDbMsg").toMsgId((q=n==null?void 0:n.lastLoadedMessageId)!=null?q:""))!=null?q:void 0;e[3]=n==null?void 0:n.lastLoadedMessageId;e[4]=q}else q=e[4];e[5]!==p||e[6]!==o||e[7]!==j||e[8]!==q||e[9]!==a.threadKey?(h={earliestLoadedMediaMessageId:q,hasMoreBefore:p,mediaGalleryGroup:c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS,minTimestampMs:o,pageSize:h,qplLogger:j,threadKey:a.threadKey},e[5]=p,e[6]=o,e[7]=j,e[8]=q,e[9]=a.threadKey,e[10]=h):h=e[10];var r=k(h);e[11]!==p||e[12]!==r?(o=function(){p&&r()},e[11]=p,e[12]=r,e[13]=o):o=e[13];q=o;e[14]!==n||e[15]!==p||e[16]!==q||e[17]!==m||e[18]!==j.logLoadMediaCancel||e[19]!==j.logLoadMediaSuccess?(a={attachmentsRange:n,hasMore:p,loadMore:q,logLoadMediaCancel:j.logLoadMediaCancel,logLoadMediaSuccess:j.logLoadMediaSuccess,media:m},e[14]=n,e[15]=p,e[16]=q,e[17]=m,e[18]=j.logLoadMediaCancel,e[19]=j.logLoadMediaSuccess,e[20]=a):a=e[20];h=d("MWSharedAttachmentsSectionHooks").useLoader(a);o=h[1];n=c("useMWV2MediaViewerSecurePreviewUrl_CausesSuspense")();q=c("useMWV2MediaViewerSecurePlayableUrl_CausesSuspense")();j=l;if(b("cr:5970")==null||b("cr:5931")==null){e[21]===Symbol["for"]("react.memo_cache_sentinel")?(a=i.jsx(c("MWV2MediaViewerNullState.react"),{}),e[21]=a):a=e[21];return a}e[22]!==f||e[23]!==q||e[24]!==n||e[25]!==g||e[26]!==m?(h=i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:m,getIsSecureThread:j,getPlayableUrl:q,getPreviewUrl:n,initialAttachment:g,children:f}),e[22]=f,e[23]=q,e[24]=n,e[25]=g,e[26]=m,e[27]=h):h=e[27];e[28]!==q||e[29]!==n||e[30]!==o||e[31]!==m||e[32]!==h?(a=i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:q,getPlayableUrl:q,getPreviewUrl:n,heroLoggingComponent:c("emptyFunction"),loadMore:o,media:m,children:h}),e[28]=q,e[29]=n,e[30]=o,e[31]=m,e[32]=h,e[33]=a):a=e[33];return a}function l(){return!0}g["default"]=e}),98);
__d("MWV2MediaViewer.react",["FBLogger","FocusRegion.react","FocusWithinHandler.react","I64","LSMessagingThreadTypeUtil","MAWThreadCutover","MWFocusTable.react","MWLSThread","MWPThreadCapabilitiesContext","MWV2MediaViewerContent.react","MWV2MediaViewerCutoverWrapper.react","MWV2MediaViewerNullState.react","MWV2MediaViewerOpenWrapper.react","MWV2MediaViewerSecureWrapper.react","XPlatReactFocusRegion.react","focusScopeQueries","justknobx","react","react-compiler-runtime","useMWMediaViewerOpenQPLLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||(h=d("react"));b=h;b.useCallback;var k=b.useEffect,l=b.useId;function a(a){var b=d("react-compiler-runtime").c(57),e=a.attachment,f=a.onClose;a=a.shouldShowMessengerLogo;var g=d("useMWMediaViewerOpenQPLLogger").useMWMediaViewerOpenQPLLogger(),h=g.endSuccess,m;b[0]!==h?(g=function(){h()},m=[h],b[0]=h,b[1]=g,b[2]=m):(g=b[1],m=b[2]);k(g,m);g=d("MWLSThread").useThread(e.threadKey);m=d("MWPThreadCapabilitiesContext").Provider;var n=l(),o;b[3]!==n?(o=function(a){a||d("FocusRegion.react").focusRegionById(n,d("MWFocusTable.react").tabbableScopeQuery)},b[3]=n,b[4]=o):o=b[4];o=o;var p=d("MAWThreadCutover").useGetCutoverOpenThreadKey(e.threadKey),q=d("MAWThreadCutover").useCutoverSecureThreadKeyForOpenThreadKey(p==null?e.threadKey:void 0);if(g==null){c("FBLogger")("messenger_web_media").mustfix("Thread is null in media viewer for attachment with threadKey: %s",(i||(i=d("I64"))).to_string(e.threadKey));var r;b[5]===Symbol["for"]("react.memo_cache_sentinel")?(r=j.jsx(c("MWV2MediaViewerNullState.react"),{}),b[5]=r):r=b[5];return r}r=d("LSMessagingThreadTypeUtil").isArmadilloSecure(g.threadType);if(p!=null||q!=null){p=p!=null?p:g.threadKey;q=q!=null?q:g.threadKey;var s;b[6]!==f?(s=function(){f&&f()},b[6]=f,b[7]=s):s=b[7];var t;b[8]!==e||b[9]!==a||b[10]!==s||b[11]!==g?(t=j.jsx(c("MWV2MediaViewerContent.react"),{initialAttachment:e,onClose:s,shouldShowMessengerLogo:a,thread:g}),b[8]=e,b[9]=a,b[10]=s,b[11]=g,b[12]=t):t=b[12];b[13]!==e||b[14]!==p||b[15]!==q||b[16]!==t||b[17]!==g.threadType?(s=j.jsx(c("MWV2MediaViewerCutoverWrapper.react"),{initialAttachment:e,openThreadKey:p,secureThreadKey:q,threadType:g.threadType,children:t}),b[13]=e,b[14]=p,b[15]=q,b[16]=t,b[17]=g.threadType,b[18]=s):s=b[18];p=s;b[19]!==p||b[20]!==g?(q=j.jsx(m,{thread:g,children:p}),b[19]=p,b[20]=g,b[21]=q):q=b[21];t=q;b[22]!==t||b[23]!==n?(s=j.jsx(c("XPlatReactFocusRegion.react"),{autoFocusQuery:d("MWFocusTable.react").tabbableScopeQuery,containFocusQuery:d("MWFocusTable.react").tabbableScopeQuery,id:n,recoverFocusQuery:d("focusScopeQueries").headerFirstTabbableSecondScopeQuery,children:t}),b[22]=t,b[23]=n,b[24]=s):s=b[24];p=s;b[25]!==p||b[26]!==o?(q=c("justknobx")._("3588")?j.jsx(c("FocusWithinHandler.react"),{onFocusChange:o,onFocusVisibleChange:o,children:p}):p,b[25]=p,b[26]=o,b[27]=q):q=b[27];return q}if(r){b[28]!==f?(t=function(){f&&f()},b[28]=f,b[29]=t):t=b[29];b[30]!==e||b[31]!==a||b[32]!==t||b[33]!==g?(s=j.jsx(c("MWV2MediaViewerContent.react"),{initialAttachment:e,onClose:t,shouldShowMessengerLogo:a,thread:g}),b[30]=e,b[31]=a,b[32]=t,b[33]=g,b[34]=s):s=b[34];b[35]!==e||b[36]!==s||b[37]!==g?(p=j.jsx(c("MWV2MediaViewerSecureWrapper.react"),{initialAttachment:e,thread:g,children:s}),b[35]=e,b[36]=s,b[37]=g,b[38]=p):p=b[38];q=p;b[39]!==q||b[40]!==g?(r=j.jsx(m,{thread:g,children:q}),b[39]=q,b[40]=g,b[41]=r):r=b[41];t=r;b[42]!==t||b[43]!==n?(s=j.jsx(c("XPlatReactFocusRegion.react"),{autoFocusQuery:d("MWFocusTable.react").tabbableScopeQuery,containFocusQuery:d("MWFocusTable.react").tabbableScopeQuery,id:n,recoverFocusQuery:d("focusScopeQueries").headerFirstTabbableSecondScopeQuery,children:t}),b[42]=t,b[43]=n,b[44]=s):s=b[44];p=s;b[45]!==p||b[46]!==o?(m=c("justknobx")._("3588")?j.jsx(c("FocusWithinHandler.react"),{onFocusChange:o,onFocusVisibleChange:o,children:p}):p,b[45]=p,b[46]=o,b[47]=m):m=b[47];return m}b[48]!==e||b[49]!==f||b[50]!==a||b[51]!==g?(q=j.jsx(c("MWV2MediaViewerContent.react"),{initialAttachment:e,onClose:f,shouldShowMessengerLogo:a,thread:g}),b[48]=e,b[49]=f,b[50]=a,b[51]=g,b[52]=q):q=b[52];b[53]!==e||b[54]!==q||b[55]!==g?(r=j.jsx(c("MWV2MediaViewerOpenWrapper.react"),{initialAttachment:e,thread:g,children:q}),b[53]=e,b[54]=q,b[55]=g,b[56]=r):r=b[56];return r}g["default"]=a}),98);
__d("useMWInboxMediaRestoreLoop",["Int64Hooks","LSMessagingThreadTypeUtil","MAWMiActOnActThreadReadyDeferred","promiseDone","react","react-compiler-runtime","requireDeferred","useAsyncReStore"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");b.useCallback;var i=b.useState,j=c("requireDeferred")("MAWFTSRestoreSync").__setRef("useMWInboxMediaRestoreLoop");function a(a){var b=d("react-compiler-runtime").c(14),e=a.threadKey,f=c("useAsyncReStore")(),g=i(null),h=g[0],k=g[1],l;b[0]!==f||b[1]!==h||b[2]!==a.threadType||b[3]!==e?(g=function(){var b=async function(){var a=await f;c("promiseDone")(c("MAWMiActOnActThreadReadyDeferred")(a,e,"mediaRestore",function(a,b){j.onReady(function(a){a=a.getMediaRestoreSync;a().setActiveThreadId(b);c("promiseDone")(a().startMediaSyncingLoop());k(a())});return Promise.resolve()}))};d("LSMessagingThreadTypeUtil").isArmadilloSecure(a.threadType)&&c("promiseDone")(b());return function(){h==null||h.setIsStarted(!1),h==null||h.setShouldPauseRestore(!0)}},l=[f,h,a.threadType,e],b[0]=f,b[1]=h,b[2]=a.threadType,b[3]=e,b[4]=g,b[5]=l):(g=b[4],l=b[5]);d("Int64Hooks").useEffectInt64(g,l);b[6]!==h?(g=function(){h!=null&&(h.resetEBAvailability(),h.isStarted()||c("promiseDone")(h.startMediaSyncingLoop()))},b[6]=h,b[7]=g):g=b[7];var m=g;b[8]!==h?(l=function(){h!=null&&(h.isStarted()||c("promiseDone")(h.startMediaSyncingLoop()))},b[8]=h,b[9]=l):l=b[9];var n=l;b[10]!==m||b[11]!==n?(g=function(){return{onEBOnboarded:m,startMediaSync:n}},l=[m,n],b[10]=m,b[11]=n,b[12]=g,b[13]=l):(g=b[12],l=b[13]);return d("Int64Hooks").useMemoInt64(g,l)}g.default=a}),98);/*FB_PKG_DELIM*/
__d("LSBeginHandlingSyncForSyncGroup",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(e){return b.sequence([function(d){return b.db.table(1).fetch([[[a[0]]]]).next().then(function(a,d){var e=a.done;a=a.value;return e?c[0]=void 0:(d=a.item,c[9]=new b.Map(),c[9].set("group_id",d.groupId),c[9].set("current_cursor",d.currentCursor),c[9].set("sync_status",d.syncStatus),c[9].set("sync_params",d.syncParams),c[9].set("send_sync_params",d.sendSyncParams),c[9].set("min_time_to_sync_timestamp_ms",d.minTimeToSyncTimestampMs),c[9].set("can_ignore_timestamp",d.canIgnoreTimestamp),c[9].set("sync_channel",d.syncChannel),c[9].set("last_sync_request_timestamp_ms",d.lastSyncRequestTimestampMs),c[0]=c[9])})},function(d){return c[0]?c[2]=!1:c[2]=!0,c[2]?b.resolve((d=[a[0],void 0,b.i64.cast([0,4]),void 0,!1],c[3]=d[0],c[4]=d[1],c[5]=d[2],c[6]=d[3],c[7]=d[4],d)):b.sequence([function(a){return c[9]=c[0].get("group_id"),b.filter(b.db.table(3).fetch(),function(a){return b.i64.neq(a.epochId,void 0)&&b.i64.eq(a.syncDatabaseId,c[9])}).next().then(function(a,b){b=a.done;a=a.value;return b?c[10]=!1:(a.item,c[10]=!0)})},function(d){return c[10]?b.resolve((c[17]=c[0].get("group_id"),d=[c[17],void 0,b.i64.cast([0,4]),void 0,!1],c[12]=d[0],c[13]=d[1],c[14]=d[2],c[15]=d[3],c[16]=d[4])):b.sequence([function(d){return c[17]=b.i64.of_float(Date.now()),c[18]=c[0].get("min_time_to_sync_timestamp_ms"),c[19]=c[0].get("last_sync_request_timestamp_ms"),c[20]=c[0].get("can_ignore_timestamp"),c[20]&&a[1]||b.i64.ge(c[17],c[18])?b.sequence([function(d){return a[1]?b.resolve(c[28]=b.i64.cast([0,0])):b.sequence([function(a){return c[29]=c[0].get("group_id"),b.db.table(3).fetch([[["",c[29]]]]).next().then(function(a,d){var e=a.done;a=a.value;return e?c[30]=b.i64.cast([0,0]):(d=a.item,c[30]=d.failureCount)})},function(a){return c[32]=b.i64.mul(b.i64.sub(b.i64.lsl_(b.i64.cast([0,1]),b.i64.to_int32(b.i64.lt(b.i64.cast([0,15]),c[30])?b.i64.cast([0,15]):c[30])),b.i64.cast([0,1])),b.i64.cast([0,500])),c[33]=b.i64.sub(b.i64.add(c[19]==null?b.i64.cast([0,0]):c[19],b.i64.lt(c[32],b.i64.cast([0,3e4]))?c[32]:b.i64.cast([0,3e4])),c[17]),c[28]=b.i64.gt(c[33],b.i64.cast([0,0]))?c[33]:b.i64.cast([0,0])}])},function(a){return c[21]=c[28]}]):b.resolve(c[21]=b.i64.sub(c[18],c[17]))},function(a){return c[22]=c[0].get("group_id"),b.i64.gt(c[21],b.i64.cast([0,0]))?b.sequence([function(a){return c[28]=b.i64.of_float(Date.now()),b.forEach(b.filter(b.db.table(3).fetch(),function(a){return b.i64.eq(a.syncDatabaseId,c[22])}),function(a){var b=a.update;a.item;return b({lastDelayedRequestTimestampMs:c[28]})})},function(a){return a=[c[22],c[21],b.i64.cast([0,3]),void 0,!1],c[23]=a[0],c[24]=a[1],c[25]=a[2],c[26]=a[3],c[27]=a[4],a}]):b.sequence([function(a){return c[28]=b.i64.of_float(Date.now()),b.forEach(b.db.table(1).fetch([[[c[22]]]]),function(a){var b=a.update;a.item;return b({lastSyncRequestTimestampMs:c[28]})})},function(a){return c[29]=b.i64.of_float(Date.now()),b.forEach(b.filter(b.db.table(3).fetch(),function(a){return b.i64.eq(a.syncDatabaseId,c[22])}),function(a){var b=a.update;a.item;return b({lastSyncRequestTimestampMs:c[29]})})},function(a){return c[30]=c[0].get("group_id"),c[31]=b.i64.of_float(Date.now()),c[32]=b.i64.random(),c[45]=b.i64.and_(b.i64.or_(b.i64.lsl_(c[31],b.i64.to_int32(b.i64.cast([0,22]))),b.i64.and_(c[32],b.i64.cast([0,4194303]))),b.i64.cast([2147483647,4294967295])),b.db.table(3).fetch([[["",c[30]]]]).next().then(function(a,d){d=a.done;a=a.value;return d?b.db.table(3).add({syncDatabaseId:c[30],taskQueueName:"",failureCount:b.i64.cast([0,0]),lastSentTimestampMs:b.i64.cast([0,0]),lastSyncRequestTimestampMs:b.i64.cast([0,0]),epochId:c[45]}):(a.item,b.forEach(b.db.table(3).fetch([[["",c[30]]]]),function(a){var b=a.update;a.item;return b({epochId:c[45]})}))})},function(a){return c[34]=c[0].get("group_id"),b.db.table(3).fetch([[["",c[34]]]]).next().then(function(a,d){var e=a.done;a=a.value;return e?c[35]=b.i64.cast([0,0]):(d=a.item,c[35]=d.failureCount)})},function(a){return c[37]=c[0].get("send_sync_params"),c[38]=c[0].get("sync_params"),c[39]=c[0].get("current_cursor"),c[40]=new b.Map(),c[40].set("database",c[34]),c[40].set("version",b.i64.cast([-1,4294967295])),c[40].set("epoch_id",c[45]),c[40].set("last_applied_cursor",c[39]),c[40].set("sync_params",c[37]?c[38]:void 0),c[40].set("failure_count",b.i64.gt(c[35],b.i64.cast([0,0]))?c[35]:void 0),c[41]=c[0].get("current_cursor"),void 0===c[41]?c[42]=b.i64.cast([0,1]):c[42]=b.i64.cast([0,2]),c[43]=new b.Map(),c[43].set("type",c[42]),c[43].set("request_payload",c[40]),c[44]=c[0].get("sync_channel"),a=[c[30],void 0,b.i64.cast([0,1]),c[43],b.i64.eq(c[44],b.i64.cast([0,2]))],c[23]=a[0],c[24]=a[1],c[25]=a[2],c[26]=a[3],c[27]=a[4]}])},function(a){return a=[c[23],c[24],c[25],c[26],c[27]],c[12]=a[0],c[13]=a[1],c[14]=a[2],c[15]=a[3],c[16]=a[4],a}])},function(a){return a=[c[12],c[13],c[14],c[15],c[16]],c[3]=a[0],c[4]=a[1],c[5]=a[2],c[6]=a[3],c[7]=a[4],a}])},function(a){return c[8]=new b.Map(),c[8].set("sync_group_id",c[3]),c[8].set("next_sync_ms",c[4]),c[8].set("work_item_type",c[5]),c[8].set("network_payload",c[6]),c[8].set("skip_realtime_gateway",c[7]),d[0]=c[8]}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSCoreBeginHandlingSyncForSyncGroupStoredProcedure";a.__tables__=["sync_groups","network_requests"];e.exports=a}),null);
__d("LSBeginHandlingSync",["LSBeginHandlingSyncForSyncGroup"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.createArray(),c.forEach(c.db.table(1).fetch(),function(e){var f=e.item;return c.sequence([function(e){return c.storedProcedure(b("LSBeginHandlingSyncForSyncGroup"),f.groupId,a[0]).then(function(a){return a=a,d[1]=a[0],a})},function(a){return d[2]=(d[0].push(d[1]),d[0])}])})},function(a){return e[0]=d[0]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSCoreBeginHandlingSyncStoredProcedure";a.__tables__=["sync_groups"];e.exports=a}),null);
__d("LSBeginHandlingSyncForSyncGroupStoredProcedure",["LSBeginHandlingSyncForSyncGroup","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSBeginHandlingSyncForSyncGroup"),e.syncGroupId,e.ignoreSoftDelay);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSBeginHandlingSyncStoredProcedure",["LSBeginHandlingSync","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSBeginHandlingSync"),e.ignoreSoftDelay);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSCometSSRDatabase",["LSJSInMemoryStorage","LSMetadata"],(function(a,b,c,d,e,f,g){"use strict";a=c("LSJSInMemoryStorage")(d("LSMetadata").schema);g["default"]=a}),98);
__d("LSPlatformSyncSystemMaybeEagerly",["LSEagerlyLoadOnMessenger","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("LSPlatformSyncSystem").__setRef("LSPlatformSyncSystemMaybeEagerly");function a(){return d("LSEagerlyLoadOnMessenger").eagerlyLoadOnMessenger(h).load()}g["default"]=a}),98);
__d("LSPlatformClientInit",["LSClearEpochBeforeResumeSync","LSDataTraceFlushDeferred","LSDatabaseAfterInitSyncSingleton","LSDeleteAllAndInsertConnectivityStatusStoredProcedure","LSFactory","LSIntEnum","LSInternetConnectionState","LSPlatformHardcodedInitSync","LSPlatformLsInitLog","LSPlatformRealtimeTransport","LSPlatformSyncSystemMaybeEagerly","LSPlatformTaskSystemTransport","MWPlatformTaskSystem","MessengerLogHistory","cr:3411","cr:7705","emptyFunction","gkx","promiseDone","recoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("MessengerLogHistory").getInstance("client_init");function j(a){var d=c("emptyFunction");b("cr:7705")!=null&&c("gkx")("23914")&&(d=b("cr:7705").listenForChangesToBackupState(a));return function(){d&&d()}}function k(a,b){var e=b==="Connected"?(h||(h=d("LSIntEnum"))).ofNumber(c("LSInternetConnectionState").CONNECTED):(h||(h=d("LSIntEnum"))).ofNumber(c("LSInternetConnectionState").NOT_CONNECTED);i.debug("Platform client sync connection status: ",b);c("promiseDone")(a.runInTransaction(function(a){return c("LSDeleteAllAndInsertConnectivityStatusStoredProcedure")(c("LSFactory")(a),{internetConnectionState:e})},"readwrite",void 0,void 0,f.id+":76"),function(){i.debug("Platform client sync connection status set successfully")},function(a){i.error("Platform client sync connection status set failed: "+(a==null?void 0:a.message));throw a})}async function a(a,e,f,g,h,l){var m;i.debug("Platform client sync starting...");(m=d("LSPlatformLsInitLog")).addPoint("onstart_callback");g();m.addPoint("onstart_callback_end");i.debug("Getting datascript evaluator...");m.addPoint("ds_eval_registration");g=await e.getEval();i.debug("Getting datascript evaluator success");var n;try{n=b("cr:3411")!=null?b("cr:3411").registerEval(g)()(a):g()(a)}catch(b){c("recoverableViolation")("fail to register datascriptEvaluator","ls_web_init",{error:b}),n=g()(a)}d("LSPlatformLsInitLog").addPoint("ds_eval_registration_end");i.debug("Clearing epoch before resume sync...");l.didEvaluateInitSyncEagerly||(await d("LSClearEpochBeforeResumeSync").call(a),i.debug("Clearing epoch before resume sync success"),d("LSPlatformLsInitLog").addPoint("create_client_end"),e.sendHardcodedInitSync&&(i.debug("Starting hard-coded init sync..."),await d("LSPlatformHardcodedInitSync").sendHardcodedInitSync(e,n,a,f),i.debug("Starting hard-coded init sync success")));d("LSDatabaseAfterInitSyncSingleton").resolveInitSync(Promise.resolve(a));i.debug("Starting realtime transport");m=await e.realtimeUnderylingTransport();var o=d("LSPlatformRealtimeTransport").LSPlatformRealtimeTransport(m,e.appId,f);i.debug("Starting task system");var p=new(c("MWPlatformTaskSystem"))(a,new(c("LSPlatformTaskSystemTransport"))(a,o,n,e.schemaVersion));i.debug("Starting sync system");var q=null;c("promiseDone")(c("LSPlatformSyncSystemMaybeEagerly")(),function(b){q=b(a,o,n,e.schemaVersion,f,e.executeGraphQLLightSpeedRequest)});i.debug("Starting backup state listeners");var r=j(a),s;i.debug("Watching for expired traces");c("promiseDone")(d("LSDataTraceFlushDeferred").watchForExpiredTraces(a).then(function(a){s=a}));i.debug("Subscribing to mqtt sync status change events");o.onConnectionStatusChange(function(b){k(a,b)});i.debug("Platform client sync starting sucess");d("LSPlatformLsInitLog").endSuccess();return{cleanup:function(){var b;i.debug("Platform client sync cleaning up");h(a);p==null||p.cleanup();(b=q)==null||b.cleanup();o.cleanup();r();s==null||s()},db:a}}g.init=a}),98);
__d("LSPlatformClient",["ExecutionEnvironment","FBLogger","LSCometSSRDatabase","LSDatabaseProviderType","LSPlatformClientInit","LSPlatformDeviceId","LSPlatformLsInitLog","MAWMIC","MAWMICSchema","cr:10018","emptyFunction","getErrorSafe"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("emptyFunction").thatReturns(Promise.resolve());function j(a,b,e){var f,g=async function(){var g=d("LSPlatformDeviceId").getDeviceIdForProviderType("ephemeral");f=await d("LSPlatformClientInit").init(a,b,g,c("emptyFunction"),c("emptyFunction"),e)};return{cleanup:function(){var a;(a=f)==null||a.cleanup()},db:a,start:g}}async function k(a,e,f){if(b("cr:10018")==null)throw c("FBLogger")("messenger_web").mustfixThrow("LSPlatformClientWithLock is null for PDB enabled");e=await b("cr:10018").make(a,e,f);e.isTabWithoutClient()===!0&&(d("MAWMIC").addPoint("ls_init_end"),d("MAWMIC").addPoint(d("MAWMICSchema").POINTS.thread_mapping_end),d("MAWMIC").addBoolAnnotation("LsInitSkipped",!0),d("LSPlatformLsInitLog").addPoint("no_ls_sync"),d("LSPlatformLsInitLog").endSuccess());return{cleanup:c("emptyFunction"),db:a,start:i}}async function a(a,e){d("LSPlatformLsInitLog").addPoint("make_client");if((h||(h=c("ExecutionEnvironment"))).canUseDOM){d("LSPlatformLsInitLog").addPoint("create_client_get_db");var f=await a.getDb();d("LSPlatformLsInitLog").addPoint("create_client_start");if(d("LSDatabaseProviderType").isProviderPersisted(f)&&b("cr:10018")!==null)try{return k(f,a,e)}catch(a){d("LSPlatformLsInitLog").addAnnotations({string:{client_for_pdb_error:c("getErrorSafe")(a).message}});d("LSPlatformLsInitLog").fail("client_for_pdb_error");throw a}return j(f,a,e)}return{cleanup:c("emptyFunction"),db:c("LSCometSSRDatabase"),start:i}}g.make=a}),98);
__d("LSPlatformDGWTransport",["DGWClient","DGWLoggingContext","DGWStream","DGWStreamGroupCallbacks","FBLogger","LSIntEnum","LSLogHistory","LSPlatformDGWHostnameOverride","LSPlatformRealtimeTransport","LSStreamGroupRef","MWPBumpEntityKey","MessengerWebRegion","MqttConfig","NetworkStatus","QuickPerformanceLogger","Random","gkx","promiseDone","qex","qpl","setTimeout","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("gkx")("3218"),k=c("gkx")("12101"),l=(b=c("qex")._("4523"))!=null?b:!1,m=(e=c("qex")._("4859"))!=null?e:!1,n=(f=c("qex")._("4860"))!=null?f:!1,o=(b=c("qex")._("3293"))!=null?b:!1,p=(e=c("qex")._("3269"))!=null?e:!1,q=c("qpl")._(701246226,"1285"),r=15,s=0,t=!1,u=new Map(),v=null,w=!1,x=!1,y=null;function z(a){a=1*Math.pow(2,a);a=Math.max(a,1);a=Math.min(a,64);return Math.ceil(a*(1e3+d("Random").random()*200))}function A(a,b,e,f){var g;if(w){var h;(h=d("LSStreamGroupRef").streamGroupRef.current)==null||h.streamGroupLoggingContext.logWarn(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"SkipReconnectAttempt","","deviceId:"+a);return}w=!0;h=z(s++);n&&s>r&&(s=0);var i="deviceId:"+a+", reconnectMs:"+h+", attempt:"+s+", isClosedLocally:"+String(x);(g=d("LSStreamGroupRef").streamGroupRef.current)==null||g.streamGroupLoggingContext.logWarn(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"ScheduleReconnect","",i);d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"scheduleReconnect");y=c("setTimeout")(function(){B(a,b,e,f),w=!1},h)}function B(a,b,e,f){var g=c("uuidv4")(),h={authToken:e,authType:f,deviceId:a,keepAliveMs:15e3,loggingId:g,serviceId:"lightspeed",streamGroupAppHeaders:{},verboseLoggingEnabled:j};k&&(h.trafficTracing=g);d("MessengerWebRegion").regionNullable!=null&&(h.regionHint=d("MessengerWebRegion").regionNullable);g={onStreamGroupError:function(b){var c;d("LSStreamGroupRef").streamGroupRef.status!=="Disconnected"&&(d("LSStreamGroupRef").streamGroupRef.status="Disconnected",d("LSStreamGroupRef").streamGroupRef.connectionStatusChangeHandler&&d("LSStreamGroupRef").streamGroupRef.connectionStatusChangeHandler("Disconnected","Stream Group Error"));(c=d("LSStreamGroupRef").streamGroupRef.current)==null||c.streamGroupLoggingContext.logError(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"onStreamGroupError",d("DGWStreamGroupCallbacks").DGWStreamGroupError.getName(b),"deviceId:"+a);d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,d("DGWStreamGroupCallbacks").DGWStreamGroupError.getName(b));d("DGWStreamGroupCallbacks").isRetryableError(b)?(d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"StreamGroupError.isRetryableError"),A(a,"reconnect_on_streamgrouperror."+d("DGWStreamGroupCallbacks").DGWStreamGroupError.getName(b),e,f)):d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"StreamGroupError.isNotRetryableError")},onStreamGroupMustDrain:function(b){var c;d("MWPBumpEntityKey").bumpEntityKeyWithAppId("messenger.lightspeed","LSPlatformDGWTransport.onStreamGroupMustDrain."+b);(c=d("LSStreamGroupRef").streamGroupRef.current)==null||c.streamGroupLoggingContext.logError(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"onStreamGroupMustDrain",b,"deviceId:"+a);A(a,"reconnect_on_streamgroupmustdrain",e,f)},onStreamGroupTransportClose:function(){var b;d("LSStreamGroupRef").streamGroupRef.status!=="Disconnected"&&(d("LSStreamGroupRef").streamGroupRef.status="Disconnected",d("LSStreamGroupRef").streamGroupRef.connectionStatusChangeHandler&&d("LSStreamGroupRef").streamGroupRef.connectionStatusChangeHandler("Disconnected","Stream Group Close"));(b=d("LSStreamGroupRef").streamGroupRef.current)==null||b.streamGroupLoggingContext.logError(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"onStreamGroupTransportClose","","deviceId:"+a);A(a,"onStreamGroupTransportClose",e,f)}};u.clear();d("LSStreamGroupRef").streamGroupRef.status="Connecting";g=c("DGWClient")().createStreamGroup(g,h);h="deviceId:"+a+", runtime_site_is_comet_fb_web:"+String(c("gkx")("2116"))+", endpoint:"+c("MqttConfig").endpoint+", reason:"+b;g.streamGroupLoggingContext.logWarn(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"CreatingStreamGroupTransport","",h);c("promiseDone")(g.initTransport(),function(c){d("LSLogHistory").log("StreamGroupTransport Connected","debug");d("LSStreamGroupRef").streamGroupRef.status!=="Connected"&&(d("LSStreamGroupRef").streamGroupRef.status="Connected",d("LSStreamGroupRef").streamGroupRef.connectionStatusChangeHandler&&d("LSStreamGroupRef").streamGroupRef.connectionStatusChangeHandler("Connected"));t&&(d("LSStreamGroupRef").streamGroupRef.reconnectHandler&&d("LSStreamGroupRef").streamGroupRef.reconnectHandler(3));t=!0;(c=d("LSStreamGroupRef").streamGroupRef.current)==null||c.streamGroupLoggingContext.logWarn(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"StreamGroupTransportOnOpen","","deviceId:"+a+", reason:"+b);(c=d("LSStreamGroupRef").streamGroupRef.current)==null||c.streamGroupLoggingContext.logWarn(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"BufferFlushed","",String(d("LSStreamGroupRef").streamGroupRef.publishBuffer.size));s=0;d("LSStreamGroupRef").streamGroupRef.publishBuffer.forEach(function(a,b,c){a.resolve(),d("LSStreamGroupRef").streamGroupRef.publishBuffer.delete(b)})},function(b){var c;d("LSLogHistory").log("StreamGroupTransport onError","debug");d("LSStreamGroupRef").streamGroupRef.publishBuffer.clear();d("LSStreamGroupRef").streamGroupRef.status!=="Disconnected"&&(d("LSStreamGroupRef").streamGroupRef.status="Disconnected",d("LSStreamGroupRef").streamGroupRef.connectionStatusChangeHandler&&d("LSStreamGroupRef").streamGroupRef.connectionStatusChangeHandler("Disconnected",b));(c=d("LSStreamGroupRef").streamGroupRef.current)==null||c.streamGroupLoggingContext.logError(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"StreamGroupTransportOnError",String(b),"deviceId:"+a);d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"WebSocketOnError");b!==d("DGWStream").StreamError.UNAUTHORIZED&&A(a,"reconnect_on_streamgrouptransportonerror."+String(b),e,f)});d("LSStreamGroupRef").streamGroupRef.current=g;return d("LSStreamGroupRef").streamGroupRef.current}async function C(a,b,e,f){e===void 0&&(e=!0);var g=d("LSStreamGroupRef").streamGroupRef.current;if(g==null)throw c("FBLogger")("ls_web_init").mustfixThrow("LS Stream Group not initialized");var h=new TextDecoder(),i={};d("LSPlatformDGWHostnameOverride").useHostNameOverride&&d("LSPlatformDGWHostnameOverride").hostNameOverride!=null&&(i["javascript-sandbox"]=d("LSPlatformDGWHostnameOverride").hostNameOverride);try{var k=c("uuidv4")();g=await g.establishStream({groupedStreamHeaders:i,loggingId:k,verboseLoggingEnabled:j},{onClose:function(){d("LSLogHistory").log("Stream closed","debug")},onDataReceived:function(a){var b=h.decode(a);b.length>0&&d("LSStreamGroupRef").streamGroupRef.subscribers.forEach(function(a){a(b)})},onError:function(a){d("LSLogHistory").log("Stream onError. Disconnected","debug")},onServerHasFinishedSendingData:function(a){d("LSLogHistory").log("Stream finished sending data","debug"),a.loggingContext().logEvent(d("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"onServerHasFinishedSendingData"),a.close()},onStreamMustDrain:function(a){d("MWPBumpEntityKey").bumpEntityKeyWithAppId("messenger.lightspeed","LSPlatformDGWTransport.onStreamMustDrain"),d("LSLogHistory").log("Stream must drain","debug"),a.loggingContext().logEvent(d("DGWLoggingContext").DGWLoggingComponent.GROUPED_STREAM_COMPONENT,"onStreamMustDrain"),a.close()}},b,e,f);d("LSLogHistory").log("Stream Connected","debug");return g}catch(b){d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"initStreamFailure."+a);d("LSLogHistory").log("Error Establishing Stream. Disconnected","debug");throw b}}var D="Disconnected";f=function(){return D};function a(a,b,c,d){v||(v=E(a,b,"init_single_transport_instance",c,d));return v}function E(a,b,e,f,g){var j=new TextEncoder();B(b,e,f,g);var k=c("NetworkStatus").onChange(function(a){a=a.online;m&&a&&(y!=null&&(window.clearTimeout(y),y=null,w=!1,s=0,A(b,"network_status_change",f,g)))});return{cleanup:function(){var a;x=!0;k.remove();(a=d("LSStreamGroupRef").streamGroupRef.current)==null||a.close();d("LSStreamGroupRef").streamGroupRef.reconnectHandler=null;d("LSStreamGroupRef").streamGroupRef.connectionStatusChangeHandler=null;d("LSStreamGroupRef").streamGroupRef.publishBuffer.clear();d("LSStreamGroupRef").streamGroupRef.subscribers.clear()},logEvent:function(a){var b;(b=d("LSStreamGroupRef").streamGroupRef.current)==null||b.streamGroupLoggingContext.logEvent(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,a)},onConnectionStatusChange:function(a){d("LSStreamGroupRef").streamGroupRef.connectionStatusChangeHandler=a;return function(){d("LSStreamGroupRef").streamGroupRef.connectionStatusChangeHandler=null}},onReconnect:function(a){d("LSStreamGroupRef").streamGroupRef.reconnectHandler=a;return function(){d("LSStreamGroupRef").streamGroupRef.reconnectHandler=null}},publish:async function(a,e,k){var m=Date.now()+(Math.round(d("Random").random()*1e4)+1e4);(i||(i=c("QuickPerformanceLogger"))).markerStart(q,m);i.markerAnnotate(q,{string:{streamGroupId:d("LSStreamGroupRef").getTransportId()}},{instanceKey:m});var n=(h||(h=d("LSIntEnum"))).toNumber(e);try{d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"initStream."+(h||(h=d("LSIntEnum"))).toNumber(e));d("LSStreamGroupRef").streamGroupRef.status!=="Connected"&&(p&&d("LSStreamGroupRef").streamGroupRef.status==="Disconnected"&&(y!=null&&(window.clearTimeout(y),y=null,s=0,w=!1),(i||(i=c("QuickPerformanceLogger"))).markerPoint(q,"reconnect",{instanceKey:m}),B(b,"reconnect_when_publish",f,g)),(i||(i=c("QuickPerformanceLogger"))).markerPoint(q,"wait_for_connection",{instanceKey:m}),await F().then(function(){}).catch(function(){var a;d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"ConnectionTimeout."+n);(a=d("LSStreamGroupRef").streamGroupRef.current)==null||a.streamGroupLoggingContext.logError(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"Publish","ConnectionTimeout",String(n));return Promise.reject({RE_EXN_ID:d("LSPlatformRealtimeTransport").NotConnected})}));(i||(i=c("QuickPerformanceLogger"))).markerPoint(q,"send_message",{instanceKey:m});var r=1===(h||(h=d("LSIntEnum"))).unwrapIntEnum(e)||2===(h||(h=d("LSIntEnum"))).unwrapIntEnum(e);if(r&&u.has(k)){var t=u.get(k);await (t==null?void 0:t.send(j.encode(a)))}else{t=4!==(h||(h=d("LSIntEnum"))).unwrapIntEnum(e);var v={int:{databaseType:k,requestType:n}};a=await C(n,j.encode(a),t,v);t&&(i||(i=c("QuickPerformanceLogger"))).markerPoint(q,"send_message_acked",{instanceKey:m});(i||(i=c("QuickPerformanceLogger"))).markerEnd(q,2,m);r&&u.set(k,a)}}catch(a){a===d("DGWStream").StreamError.ACK_TIMEOUT&&(i||(i=c("QuickPerformanceLogger"))).markerPoint(q,"ack_timeout",{instanceKey:m});(i||(i=c("QuickPerformanceLogger"))).markerEnd(q,3,m);if(a.message==="Max number of stream IDs reached"){d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"StreamIdLimitExceeded."+n);(v=d("LSStreamGroupRef").streamGroupRef.current)==null||v.streamGroupLoggingContext.logError(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"initStream","StreamIdLimitExceeded",n.toString())}d("DGWLoggingContext").DGWLoggingContext.bumpODSKey(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"initStreamError."+n);(t=d("LSStreamGroupRef").streamGroupRef.current)==null||t.streamGroupLoggingContext.logError(d("DGWLoggingContext").DGWLoggingComponent.STREAM_GROUP_COMPONENT,"Publish","Failed to publish payload",n.toString());r=l&&3===(h||(h=d("LSIntEnum"))).unwrapIntEnum(e);if(r)return Promise.resolve();else{o&&a===d("DGWStream").StreamError.ACK_TIMEOUT&&(d("LSStreamGroupRef").streamGroupRef.status="Disconnected",y!=null&&(window.clearTimeout(y),y=null,s=0,w=!1),B(b,"stream_ack_timeout",f,g));return Promise.reject(a)}}},subscribe:function(a){d("LSStreamGroupRef").streamGroupRef.subscribers.set(a,a);return function(){d("LSStreamGroupRef").streamGroupRef.subscribers.delete(a)}}}}function F(){var a={reject:function(){},resolve:function(){}},b=d("Random").uint32(),c=new Promise(function(b,c){a.resolve=b,a.reject=c});d("LSStreamGroupRef").streamGroupRef.publishBuffer.set(b,a);return c}g.getStatusForDebugging=f;g.LSPlatformDGWTransport=a}),98);
__d("LSPlatformSyncSystem",["FBLogger","I64","LSBeginHandlingSyncForSyncGroupStoredProcedure","LSBeginHandlingSyncStoredProcedure","LSDatabaseProviderType","LSFactory","LSIntEnum","LSJson","LSMailboxInitialSyncCursor","LSPlatformGraphQLTransport","LSPlatformRealtimeTransport","LSPlatformRequestId","LSPlatformRequestScheduler","LSPlatformServerResponseHandler","LSShape","LSVec","MWPBumpEntityKey","MessengerLogHistory","ReQL","gkx","promiseDone","qex","recoverableViolation","throttle"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,b,e,g,j,k){var l=d("MessengerLogHistory").getInstance("client_sync"),m=new(c("LSPlatformServerResponseHandler"))(e),n=d("LSDatabaseProviderType").isProviderPersisted(a),o=function(b){return a.runInTransaction(async function(a){var c=await d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.network_requests).getKeyRange("",b));c!=null&&await a.network_requests.put({epochId:void 0,failureCount:(h||(h=d("I64"))).add(c.failureCount,h.one),lastDelayedRequestTimestampMs:c.lastDelayedRequestTimestampMs,lastSentTimestampMs:c.lastSentTimestampMs,lastSyncRequestTimestampMs:c.lastSyncRequestTimestampMs,networkTaskIdentifier:c.networkTaskIdentifier,syncDatabaseId:c.syncDatabaseId,taskQueueName:c.taskQueueName})},"readwrite",void 0,void 0,f.id+":79")},p=new(c("LSPlatformRequestScheduler"))(),q=async function(f,l){l=d("LSShape").toRecord(l);var o=d("LSShape").toRecord(l.request_payload);l=l.type;var p=c("LSPlatformRequestId").generate(),q=d("LSJson").stringify(d("LSShape").ofRecord({database:o.database,epoch_id:o.epoch_id,failure_count:o.failure_count,last_applied_cursor:o.last_applied_cursor,sync_params:o.sync_params,version:(h||(h=d("I64"))).of_string(g)})),r=(h||(h=d("I64"))).equal(f.sync_group_id,(i||(i=d("LSIntEnum"))).ofNumber(1))&&c("gkx")("26386")===!0;if(!r&&f.skip_realtime_gateway){r=await d("LSPlatformGraphQLTransport").publish(j,p,l,q,k);var s=r[0],t=r[1],u=r[2];r=r[3];u={experiments:u,syncScript:t,target:r};return n?m.maybeEvalInOrderReceived(s,u):e(u)}else{t=await d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.tables.sync_groups).getKeyRange(f.sync_group_id));r=t!=null?t.syncChannel:d("LSMailboxInitialSyncCursor").syncChannel;t!=null&&(i||(i=d("LSIntEnum"))).toNumber(t.syncChannel)!==(h||(h=d("I64"))).to_int32(d("LSMailboxInitialSyncCursor").syncChannel)&&b.logEvent("Sync channel mismatch between "+(i||(i=d("LSIntEnum"))).toNumber(t.syncChannel)+" and "+(h||(h=d("I64"))).to_int32(d("LSMailboxInitialSyncCursor").syncChannel));s=c("qex")._("789");if(t!=null&&s!=null&&s!=="default"){u=(i||(i=d("LSIntEnum"))).unwrapIntEnum(l);if(1===u||2===u||5===u){f=s+"."+(i||(i=d("LSIntEnum"))).toNumber(r)+"."+i.toNumber(l)+"."+i.toNumber(t.groupId);d("MWPBumpEntityKey").bumpEntityKeyWithAppId("messenger.lightspeed",f)}}u=(h||(h=d("I64"))).to_int32(o.database);return b.publish({databaseType:u,payload:q,queueName:void 0,requestId:p,syncChannel:r,type_:l}).then(function(){return Promise.resolve()})}},r=function(b){var e=function(b){return a.runInTransaction(function(a){return c("LSBeginHandlingSyncForSyncGroupStoredProcedure")(c("LSFactory")(a),{ignoreSoftDelay:!1,syncGroupId:b})},"readwrite",void 0,void 0,f.id+":219").then(function(a){return r(a[0])})},g=function(a,b){p.schedule(function(){c("promiseDone")(e(a))},(h||(h=d("I64"))).to_string(a),h.to_float(b))},j=d("LSShape").toRecord(b);b=j.work_item_type;if((h||(h=d("I64"))).equal(b,(i||(i=d("LSIntEnum"))).ofNumber(1))||(h||(h=d("I64"))).equal(b,(i||(i=d("LSIntEnum"))).ofNumber(5))){var k=c("qex")._("789");if(k!=null&&k!=="default"){var m=k+"."+(i||(i=d("LSIntEnum"))).toNumber(d("LSMailboxInitialSyncCursor").syncChannel);d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_sync",m)}var n=j.network_payload;if(n!=null)return q(j,n).catch(function(a){if(k!=null&&k!=="default"){var b=k+"."+(i||(i=d("LSIntEnum"))).toNumber(d("LSMailboxInitialSyncCursor").syncChannel);d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_sync",b+".exception");a.RE_EXN_ID===d("LSPlatformRealtimeTransport").Timeout?d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_sync",b+".exception.timeout"):a.RE_EXN_ID===d("LSPlatformRealtimeTransport").NotConnected&&d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_sync",b+".exception.notconnected")}if(a.message===d("LSPlatformGraphQLTransport").ServerError)d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_sync","send_sync_request_graphql_error");else if(a.RE_EXN_ID===d("LSPlatformRealtimeTransport").Timeout||a.RE_EXN_ID===d("LSPlatformRealtimeTransport").NotConnected)d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_sync","send_sync_request_timeout_or_disc"),l.debug("Publish timed out");else{d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_sync","send_sync_request_other_error");if(a instanceof Error)c("FBLogger")("messenger_web").catching(a).mustfix("Encountered an JS error while publishing a LS sync request");else{b="";try{b=JSON.stringify(a)}catch(a){}c("FBLogger")("messenger_web").mustfix("Encountered an JS error while publishing a LS sync request %s",b)}}d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_sync","handleSyncFailure."+(i||(i=d("LSIntEnum"))).toNumber(d("LSShape").toRecord(n).type)+"."+i.toNumber(j.sync_group_id));return o(j.sync_group_id).then(function(){return e(j.sync_group_id)})});else{c("recoverableViolation")("Expected networkpayload for sync request but didn't get any","ls_web_init");return Promise.resolve()}}if(!(h||(h=d("I64"))).equal(b,(i||(i=d("LSIntEnum"))).ofNumber(3)))if((h||(h=d("I64"))).equal(b,(i||(i=d("LSIntEnum"))).ofNumber(4))||!(h||(h=d("I64"))).equal(b,(i||(i=d("LSIntEnum"))).ofNumber(2)))return Promise.resolve();else{c("recoverableViolation")("Native handling for sync group not implemented yet","ls_web_init");return Promise.resolve()}m=j.next_sync_ms;if(m!=null){g(j.sync_group_id,m);return Promise.resolve()}else{c("recoverableViolation")("Expected delay for delayed sync request but didn't get any","ls_web_init");return Promise.resolve()}},s=function(a){return Promise.all(c("LSVec").toArray(a[0]).map(function(a){return r(a)}))},t=function(){c("promiseDone")(a.runInTransaction(function(a){return c("LSBeginHandlingSyncStoredProcedure")(c("LSFactory")(a),{ignoreSoftDelay:!1})},"readwrite",void 0,void 0,f.id+":400").then(s))},u=c("throttle")(t,500);t=function(){return d("ReQL").fromTableAscending(a.tables.sync_groups).subscribe(function(){return u()})};var v=function(){return b.subscribeToNonTaskResponses(function(a,b){var f=b.ex,g=b.payload;f={experiments:f,sp:b.sp,syncScript:g,target:b.target};c("promiseDone")(n?m.maybeEvalInOrderReceived(a,f):c("gkx")("10470")?m.maybeEvalInOrderReceived(a,f):e(f),function(){return u()},function(a){d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_sync","handle_sync_response_failure");if(a instanceof Error)c("FBLogger")("messenger_web").catching(a).mustfix("JS error encountered handling response from MQTT (pdb=%s): %s",n,a.message);else{var b="";try{b=JSON.stringify(a)}catch(a){}c("FBLogger")("messenger_web").mustfix("JS error encountered handling response from MQTT (pdb=%s): %s",n,b)}})})},w=function(){return b.onReconnect(function(b){d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_sync","resume_sync_reconnect");if(d("LSMailboxInitialSyncCursor").isWebApp&&1===b&&c("qex")._("4375")===!0&&c("qex")._("3195")===!0)return;l.debug("Sync System reconnecting");c("promiseDone")(a.runInTransaction(async function(b){var e;e=await (e=d("ReQL")).toArrayAsync(e.mergeJoin(e.fromTableAscending(a.tables.sync_groups),e.fromTableAscending(a.tables.network_requests).getKeyRange("")));await Promise.all(e.map(function(a){a=a[1];return b.network_requests.put({epochId:void 0,failureCount:a.failureCount,lastDelayedRequestTimestampMs:a.lastDelayedRequestTimestampMs,lastSentTimestampMs:a.lastSentTimestampMs,lastSyncRequestTimestampMs:a.lastSyncRequestTimestampMs,networkTaskIdentifier:a.networkTaskIdentifier,syncDatabaseId:a.syncDatabaseId,taskQueueName:a.taskQueueName})}));return c("LSBeginHandlingSyncStoredProcedure")(c("LSFactory")(b),{ignoreSoftDelay:!1})},"readwrite",void 0,void 0,f.id+":504").then(s))})},x=t(),y=v(),z=w();u();return{cleanup:function(){x(),z(),y()}}}g.default=a}),98);
__d("MDSLegacyStyleXDarkTheme",[],(function(a,b,c,d,e,f){a=Object.freeze({accent:"hsl(214, 100%, 59%)","alert-banner-corner-radius":"8px","always-black":"black","always-dark-gradient":"linear-gradient(rgba(0,0,0,0), rgba(0,0,0,0.6))","always-dark-overlay":"rgba(0, 0, 0, 0.4)","always-gray-40":"#65676B","always-gray-75":"#BCC0C4","always-gray-95":"#F0F2F5","always-light-overlay":"rgba(255, 255, 255, 0.4)","always-white":"white","attachment-footer-background":"rgba(255,255,255,0.1)","background-deemphasized":"rgba(255,255,255,0.1)","badge-accent":"#429AFF","badge-background-color-blue":"var(--accent)","badge-background-color-dark-gray":"var(--secondary-icon)","badge-background-color-gray":"var(--disabled-icon)","badge-background-color-green":"var(--positive)","badge-background-color-light-blue":"var(--highlight-bg)","badge-background-color-red":"var(--notification-badge)","badge-background-color-yellow":"var(--base-lemon)","base-blue":"#1877F2","base-cherry":"#F3425F","base-grape":"#9360F7","base-lemon":"#F7B928","base-lime":"#45BD62","base-pink":"#FF66BF","base-seafoam":"#54C7EC","base-teal":"#2ABBA7","base-tomato":"#FB724B","blue-link":"#4599FF","blue-primary":"rgb(0,136,244)","blue-secondary":"rgb(235,245,255)","blue-tertiary":"rgb(4,59,114)","blueprint-button-height-large":"48px","blueprint-button-height-medium":"40px","border-focused":"#8A8D91","button-corner-radius":"6px","button-corner-radius-large":"12px","button-corner-radius-medium":"10px","button-height-large":"40px","button-height-medium":"36px","button-icon-padding-large":"16px","button-icon-padding-medium":"16px","button-inner-icon-spacing-large":"3px","button-inner-icon-spacing-medium":"3px","button-padding-horizontal-large":"16px","button-padding-horizontal-medium":"16px","button-padding-icon-only":"16px","card-background":"#2E2E2E","card-background-flat":"#323436","card-box-shadow":"0 12px 28px 0 var(--shadow-2), 0 2px 4px 0 var(--shadow-1)","card-corner-radius":"12px","card-padding-horizontal":"10px","card-padding-vertical":"20px","chartreuse-primary":"rgb(106,147,22)","chartreuse-secondary":"rgb(226,255,152)","chartreuse-tertiary":"rgb(50,65,19)","chat-bubble-border-radius":"18px","chat-bubble-emphasis-ring-after":"white","chat-bubble-emphasis-ring-before":"black","chat-bubble-padding-horizontal":"12px","chat-bubble-padding-vertical":"8px","chat-incoming-message-bubble-background-color":"#4C4C4C","chat-outgoing-message-bubble-background-color":"var(--accent)","chat-replied-message-background-color":"rgba(255, 255, 255, 0.12)","chat-text-blockquote-color-background-line":"rgba(255, 255, 255, 0.19)","chat-text-blockquote-color-text-primary-media":"rgba(255, 255, 255, 0.7)","chip-button-green":"#24832C","chip-corner-radius":"6px","circle-button-green-background-color":"#30A13A","circle-button-normal-background-color":"rgba(255, 255, 255, 0.18)","circle-button-overlay-raised-background-color":"#1F1F1F","circle-button-overlay-raised-shadow-color":"rgba(255, 255, 255, 0.18)","circle-button-red-background-color":"#E91D16","circle-button-secondary-on-media-background-color":"rgba(0, 0, 0, 0.6)","comment-background":"#3A3B3C","comment-bubble":"18px","comment-footer-background":"#4E4F50","cyan-primary":"rgb(0,142,213)","cyan-secondary":"rgb(231,245,255)","cyan-tertiary":"rgb(15,63,93)","dataviz-orange":"#D06C14","dataviz-primary-1":"rgb(0,174,143)","dataviz-primary-2":"rgb(156,219,255)","dataviz-primary-3":"rgb(73,156,255)","dataviz-secondary-1":"rgb(92,87,210)","dataviz-secondary-2":"rgb(142,129,255)","dataviz-secondary-3":"rgb(119,45,88)","dataviz-supplementary-1":"rgb(253,91,67)","dataviz-supplementary-2":"rgb(161,132,0)","dataviz-supplementary-3":"rgb(36,131,44)","dataviz-supplementary-4":"rgb(232,234,238)","destructive-button-background":"#E91D16","destructive-button-text":"#FFFFFF","dialog-anchor-horizontal-padding":"8px","dialog-anchor-vertical-padding":"64px","dialog-border-radius":"12px","dialog-box-shadow":"0 12px 28px 0 var(--shadow-2), 0 2px 4px 0 var(--shadow-1), inset 0 0 0 1px var(--shadow-inset)","dialog-corner-radius":"8px","dialog-size-medium-width":"100%","dialog-size-small-width":"100%","disabled-button-background":"rgba(255, 255, 255, 0.18)","disabled-button-text":"rgba(255, 255, 255, 0.34)","disabled-icon":"rgba(255, 255, 255, 0.3)","disabled-text":"rgba(255, 255, 255, 0.3)",divider:"#3E4042","event-date":"#F3425F","fb-logo":"#0866FF","fb-wordmark":"#FFFFFF","fds-animation-enter-exit-in":"cubic-bezier(0.14, 1, 0.34, 1)","fds-animation-enter-exit-out":"cubic-bezier(0.45, 0.1, 0.2, 1)","fds-animation-expand-collapse-in":"cubic-bezier(0.17, 0.17, 0, 1)","fds-animation-expand-collapse-out":"cubic-bezier(0.17, 0.17, 0, 1)","fds-animation-fade-in":"cubic-bezier(0, 0, 1, 1)","fds-animation-fade-out":"cubic-bezier(0, 0, 1, 1)","fds-animation-move-in":"cubic-bezier(0.17, 0.17, 0, 1)","fds-animation-move-out":"cubic-bezier(0.17, 0.17, 0, 1)","fds-animation-passive-move-in":"cubic-bezier(0.5, 0, 0.1, 1)","fds-animation-passive-move-out":"cubic-bezier(0.5, 0, 0.1, 1)","fds-animation-quick-move-in":"cubic-bezier(0.1, 0.9, 0.2, 1)","fds-animation-quick-move-out":"cubic-bezier(0.1, 0.9, 0.2, 1)","fds-animation-swap-shuffle-in":"cubic-bezier(0.14, 1, 0.34, 1)","fds-animation-swap-shuffle-out":"cubic-bezier(0.45, 0.1, 0.2, 1)","fds-black":"black","fds-black-alpha-05":"rgba(0, 0, 0, 0.05)","fds-black-alpha-10":"rgba(0, 0, 0, 0.1)","fds-black-alpha-15":"rgba(0, 0, 0, 0.15)","fds-black-alpha-20":"rgba(0, 0, 0, 0.2)","fds-black-alpha-30":"rgba(0, 0, 0, 0.3)","fds-black-alpha-40":"rgba(0, 0, 0, 0.4)","fds-black-alpha-50":"rgba(0, 0, 0, 0.5)","fds-black-alpha-60":"rgba(0, 0, 0, 0.6)","fds-black-alpha-80":"rgba(0, 0, 0, 0.8)","fds-blue-05":"black","fds-blue-30":"black","fds-blue-40":"black","fds-blue-60":"black","fds-blue-70":"black","fds-blue-80":"black","fds-button-text":"black","fds-comment-background":"black","fds-dark-mode-gray-100":"black","fds-dark-mode-gray-35":"black","fds-dark-mode-gray-50":"black","fds-dark-mode-gray-70":"black","fds-dark-mode-gray-80":"black","fds-dark-mode-gray-90":"black","fds-duration-extra-extra-short-in":"100ms","fds-duration-extra-extra-short-out":"100ms","fds-duration-extra-long-in":"1000ms","fds-duration-extra-long-out":"1000ms","fds-duration-extra-short-in":"200ms","fds-duration-extra-short-out":"150ms","fds-duration-long-in":"500ms","fds-duration-long-out":"350ms","fds-duration-medium-in":"400ms","fds-duration-medium-out":"350ms","fds-duration-none":"0ms","fds-duration-short-in":"280ms","fds-duration-short-out":"200ms","fds-fast":"200ms","fds-gray-00":"black","fds-gray-05":"black","fds-gray-10":"black","fds-gray-100":"black","fds-gray-20":"black","fds-gray-25":"black","fds-gray-30":"black","fds-gray-45":"black","fds-gray-70":"black","fds-gray-80":"black","fds-gray-90":"black","fds-green-55":"black","fds-green-65":"black","fds-highlight":"black","fds-highlight-cell-background":"black","fds-primary-icon":"white","fds-primary-text":"white","fds-red-55":"black","fds-slow":"400ms","fds-soft":"cubic-bezier(.08,.52,.52,1)","fds-spectrum-aluminum-tint-70":"black","fds-spectrum-blue-gray-tint-70":"black","fds-spectrum-cherry":"black","fds-spectrum-cherry-tint-70":"black","fds-spectrum-grape-tint-70":"black","fds-spectrum-grape-tint-90":"black","fds-spectrum-lemon-dark-1":"black","fds-spectrum-lemon-tint-70":"black","fds-spectrum-lime":"black","fds-spectrum-lime-tint-70":"black","fds-spectrum-orange-tint-70":"black","fds-spectrum-orange-tint-90":"black","fds-spectrum-seafoam-tint-70":"black","fds-spectrum-slate-dark-2":"black","fds-spectrum-slate-tint-70":"black","fds-spectrum-teal":"black","fds-spectrum-teal-dark-1":"black","fds-spectrum-teal-dark-2":"black","fds-spectrum-teal-tint-70":"black","fds-spectrum-teal-tint-90":"black","fds-spectrum-tomato":"black","fds-spectrum-tomato-tint-30":"black","fds-spectrum-tomato-tint-90":"black","fds-strong":"cubic-bezier(.12,.8,.32,1)","fds-unified-blue-35":"black","fds-unified-gray-20":"black","fds-white":"black","fds-white-alpha-05":"rgba(255, 255, 255, 0.05)","fds-white-alpha-10":"rgba(255, 255, 255, 0.1)","fds-white-alpha-20":"rgba(255, 255, 255, 0.2)","fds-white-alpha-30":"rgba(255, 255, 255, 0.3)","fds-white-alpha-40":"rgba(255, 255, 255, 0.4)","fds-white-alpha-50":"rgba(255, 255, 255, 0.5)","fds-white-alpha-60":"rgba(255, 255, 255, 0.6)","fds-white-alpha-80":"rgba(255, 255, 255, 0.8)","fds-yellow-20":"black","filter-accent":"invert(40%) sepia(52%) saturate(200%) saturate(200%) saturate(200%) saturate(189%) hue-rotate(191deg) brightness(103%) contrast(102%)","filter-always-white":"invert(100%)","filter-blue-link-icon":"invert(73%) sepia(29%) saturate(200%) saturate(200%) saturate(200%) saturate(200%) saturate(200%) saturate(200%) saturate(103.25%) hue-rotate(189deg) brightness(101%) contrast(101%)","filter-disabled-icon":"invert(100%) opacity(30%)","filter-negative":"invert(25%) sepia(33%) saturate(200%) saturate(200%) saturate(200%) saturate(200%) saturate(200%) saturate(200%) saturate(110%) hue-rotate(345deg) brightness(132%) contrast(96%)","filter-placeholder-icon":"invert(59%) sepia(11%) saturate(200%) saturate(135%) hue-rotate(176deg) brightness(96%) contrast(94%)","filter-positive":"invert(37%) sepia(61%) saturate(200%) saturate(200%) saturate(200%) saturate(200%) saturate(115%) hue-rotate(91deg) brightness(97%) contrast(105%)","filter-primary-accent":"invert(40%) sepia(52%) saturate(200%) saturate(200%) saturate(200%) saturate(189%) hue-rotate(191deg) brightness(103%) contrast(102%)","filter-primary-deemphasized-button-icon":"brightness(0) saturate(100%) invert(63%) sepia(20%) saturate(1290%) hue-rotate(185deg) brightness(107%) contrast(101%)","filter-primary-icon":"invert(89%) sepia(6%) hue-rotate(185deg)","filter-secondary-button-icon-on-media":"invert(100%)","filter-secondary-icon":"invert(62%) sepia(98%) saturate(12%) hue-rotate(175deg) brightness(90%) contrast(96%)","filter-warning-icon":"invert(77%) sepia(29%) saturate(200%) saturate(200%) saturate(200%) saturate(200%) saturate(200%) saturate(128%) hue-rotate(359deg) brightness(102%) contrast(107%)","focus-ring-blue":"#429AFF","focus-ring-outline-forced-colors":"2px auto transparent !important","focus-ring-outline-link":"2px auto var(--focus-ring-blue)","focus-ring-shadow-default":"0 0 0 2px var(--always-white), 0 0 0 4px var(--focus-ring-blue)","focus-ring-shadow-inset":"0 0 0 2px var(--focus-ring-blue) inset, 0 0 0 4px var(--always-white) inset","font-family-apple":"system-ui, -apple-system, BlinkMacSystemFont, '.SFNSText-Regular', sans-serif","font-family-code":"ui-monospace, Menlo, Consolas, Monaco, monospace","font-family-default":"Helvetica, Arial, sans-serif","font-family-segoe":"Segoe UI Historic, Segoe UI, Helvetica, Arial, sans-serif","font-family-system-fds":"system-ui, -apple-system, BlinkMacSystemFont, Segoe UI Historic, Segoe UI, Helvetica, Arial, sans-serif","fuschia-primary":"rgb(250,45,138)","fuschia-secondary":"rgb(255,241,246)","fuschia-tertiary":"rgb(118,14,62)","glimmer-animation-direction":"alternate","glimmer-animation-duration":"1000ms","glimmer-animation-timing-function":"steps(10, end)","glimmer-base-opaque":"#FFFFFF","glimmer-corner-radius":"8px","glimmer-high-contrast-base-opaque":"#FFFFFF","glimmer-opacity-high-contrast-max":"0.48","glimmer-opacity-high-contrast-min":"0.1","glimmer-opacity-max":"1","glimmer-opacity-min":"0.25","glimmer-spinner-icon":"white","global-panel-width":"0px","global-panel-width-expanded":"0px","green-primary":"rgb(43,154,53)","green-secondary":"rgb(227,250,224)","green-tertiary":"rgb(26,68,27)","header-height":"0px","hero-banner-background":"#E85D07","highlight-bg":"rgba(24, 119, 242, .31)","hosted-view-selected-state":"rgba(45, 136, 255, 0.1)","hover-overlay":"rgba(255, 255, 255, 0.1)","icon-accent-color":"#429AFF","icon-destructive-color":"#FF4942","icon-inactive-color":"rgba(155, 160, 168, 0.75)","icon-nux-color":"rgba(255, 255, 255, 0.34)","icon-primary-color":"#FFFFFF","icon-secondary-color":"rgba(255, 255, 255, 0.45)","icon-selected-color":"rgba(255, 255, 255, 0.45)","icon-tertiary-color":"rgba(255, 255, 255, 0.19)","icon-white-color":"#FFFFFF","image-corner-radius":"4px","infochip-medium-radius":"12px","input-background":"#242526","input-background-active":"hsla(var(--accent-h), var(--accent-s), var(--accent-l), 0.05)","input-background-disabled":"#18191A","input-background-error-active":"hsla(var(--negative-h), var(--negative-s), var(--negative-l), 0.05)","input-background-error-hover":"hsla(var(--negative-h), var(--negative-s), var(--negative-l), 0.05)","input-background-hover":"var(--input-background)","input-background-warn-active":"hsla(var(--warning-h), var(--warning-s), var(--warning-l), 0.05)","input-background-warn-hover":"hsla(var(--warning-h), var(--warning-s), var(--warning-l), 0.05)","input-border-color":"#3E4042","input-border-color-hover":"var(--placeholder-text)","input-border-width":"1px","input-corner-radius":"6px","input-label-color-disabled":"var(--disabled-text)","input-label-color-error":"var(--negative)","input-label-color-highlighted":"hsl(214, 100%, 59%)","input-label-color-inside":"var(--secondary-text)","inverse-text":"var(--always-white)","last-active-state-background":"#1F391E","last-active-state-text":"#31CC46","list-cell-chevron":"#B0B3B8","list-cell-corner-radius":"8px","list-cell-min-height":"52px","list-cell-padding-vertical":"20px","list-cell-padding-vertical-with-addon":"14px","magenta-primary":"rgb(215,77,204)","magenta-secondary":"rgb(255,239,254)","magenta-tertiary":"rgb(96,36,91)","mds-green":"#31CC46","media-hover":"rgba(68, 73, 80, 0.15)","media-inner-border":"rgba(255, 255, 255, 0.05)","media-outer-border":"#33363A","media-pressed":"rgba(68, 73, 80, 0.35)","menu-base-list-item-padding-horizontal":"8px","menu-base-list-item-padding-vertical":"12px","menu-base-size-full-margin-end":"48px","menu-item-base-margin-horizontal":"8px","menu-item-base-margin-vertical":"0px","menu-item-base-overlay-radius":"4px","menu-item-base-padding-horizontal":"8px","menu-item-base-padding-vertical":"12px","menu-item-base-with-icon-padding-horizontal":"var(--menu-item-base-padding-horizontal)","messenger-application-max-width":"2560px","messenger-card-background":"#1F1F1F","messenger-card-box-shadow":"0px 0px 16px rgba(0, 0, 0, 0.3)","messenger-card-corner-radius":"12px","messenger-card-max-width":"480px","messenger-card-min-width":"300px","messenger-card-spacing":"16px","messenger-reply-background":"#18191A","messenger-sidebar-collapsed-width":"44px","messenger-sidebar-expanded-width":"240px","mwp-header-background-color":"var(--messenger-card-background)","mwp-header-button-color":"var(--accent)","mwp-message-row-background":"var(--messenger-card-background)","nav-bar-background":"#1A1A1A","nav-bar-background-gradient":"linear-gradient(to top, #242526, rgba(36,37,38,.9), rgba(36,37,38,.7), rgba(36,37,38,.4), rgba(36,37,38,0))","nav-bar-background-gradient-wash":"linear-gradient(to top, #18191A, rgba(24,25,26,.9), rgba(24,25,26,.7), rgba(24,25,26,.4), rgba(24,25,26,0))","nav-list-cell-corner-radius":"8px","nav-list-cell-min-height":"0px","nav-list-cell-padding-vertical":"16px","nav-list-cell-padding-vertical-with-addon":"16px",negative:"hsl(350, 87%, 55%)","negative-background":"hsl(350, 87%, 55%, 20%)","new-notification-background":"#E7F3FF","non-media-pressed":"rgba(68, 73, 80, 0.15)","non-media-pressed-on-dark":"rgba(255, 255, 255, 0.3)","notification-badge":"#e41e3f","nux-card-body-padding-end":"24px","orange-primary":"rgb(208,108,20)","orange-secondary":"rgb(255,241,239)","orange-tertiary":"rgb(94,49,14)","overlay-alpha-80":"rgba(11, 11, 11, 0.8)","overlay-on-media":"rgba(0, 0, 0, 0.6)","page-footer-padding-vertical":"16px","placeholder-icon":"#8A8D91","placeholder-image":"rgb(164, 167, 171)","placeholder-text":"#8A8D91","placeholder-text-on-media":"rgba(255, 255, 255, 0.5)","popover-background":"#3E4042","popover-border-color":"transparent","popover-border-style":"none","popover-border-width":"0px","popover-card-background":"var(--card-background)",positive:"#31A24C","positive-background":"#1F3520","press-overlay":"rgba(255, 255, 255, 0.2)","pressable-background-color-hover":"rgba(255, 255, 255, 0.18)","pressable-background-color-selected":"rgba(255, 255, 255, 0.12)","primary-button-background":"#0070F6","primary-button-icon":"#FFFFFF","primary-button-pressed":"#77A7FF","primary-button-text":"#FFFFFF","primary-deemphasized-button-background":"#0D1F3A","primary-deemphasized-button-pressed":"rgba(24, 119, 242, 0.2)","primary-deemphasized-button-pressed-overlay":"rgba(25, 110, 255, 0.15)","primary-deemphasized-button-text":"#429AFF","primary-icon":"#E4E6EB","primary-text":"#E4E6EB","primary-text-on-media":"white","primary-web-focus-indicator":"#D24294","progress-ring-blue-background":"rgba(45, 136, 255, 0.2)","progress-ring-blue-foreground":"hsl(214, 100%, 59%)","progress-ring-disabled-background":"rgba(122,125,130, 0.2)","progress-ring-disabled-foreground":"#7A7D82","progress-ring-neutral-background":"rgba(255, 255, 255, 0.2)","progress-ring-neutral-foreground":"#ffffff","progress-ring-on-media-background":"rgba(255, 255, 255, 0.2)","progress-ring-on-media-foreground":"#FFFFFF","purple-primary":"rgb(125,116,255)","purple-secondary":"rgb(245,241,255)","purple-tertiary":"rgb(55,50,121)","qp-card-box-shadow":"0 4px 8px 0 rgba(0,0,0,0.08)","radio-border-color":"var(--primary-icon)","radio-border-color-disabled":"var(--disabled-button-background)","radio-border-color-selected":"var(--accent)","radio-border-width":"2px","radio-checked-icon-color":"var(--accent)","radio-checked-icon-color-disabled":"var(--disabled-button-background)","radio-checked-icon-size-large":"12px","radio-checked-icon-size-medium":"12px","radio-size-large":"24px","radio-size-medium":"20px","rating-star-active":"#FF9831","red-primary":"rgb(251,60,68)","red-secondary":"rgb(255,241,239)","red-tertiary":"rgb(118,22,27)","scroll-shadow":"0 1px 2px rgba(0, 0, 0, 0.1), 0 -1px rgba(255, 255, 255, 0.05) inset","scroll-thumb":"rgba(255, 255, 255, 0.45)","scrollbar-thumb-color":"rgba(255, 255, 255, 0.19)","scrollbar-track-color":"transparent","secondary-button-background":"rgba(255, 255, 255, 0.18)","secondary-button-background-floating":"#4B4C4F","secondary-button-background-on-dark":"rgba(255, 255, 255, 0.4)","secondary-button-pressed":"rgba(0, 0, 0, 0.05)","secondary-button-stroke":"transparent","secondary-button-text":"#FFFFFF","secondary-deemphasized-button-background":"rgba(0, 0, 0, 0)","secondary-icon":"#B0B3B8","secondary-text":"#B0B3B8","secondary-text-on-media":"rgba(255, 255, 255, 0.9)","section-header-addOnEnd-button-padding-horizontal":"0px","section-header-addOnEnd-button-padding-vertical":"0px","section-header-addOnEnd-margin-horizontal":"8px","section-header-addOnStart-margin-horizontal":"12px","section-header-padding-vertical":"16px","section-header-subtitle-margin-vertical":"14px","section-header-subtitle-with-addOnEnd-margin-vertical":"6px","section-header-text":"#BCC0C4","separator-menu-item-margin-horizontal":"16px","separator-menu-item-margin-vertical":"4px","shadow-1":"rgba(0, 0, 0, 0.1)","shadow-2":"rgba(0, 0, 0, 0.2)","shadow-5":"rgba(0, 0, 0, 0.5)","shadow-8":"rgba(0, 0, 0, 0.8)","shadow-base":"0 1px 2px var(--shadow-2)","shadow-elevated":"0 8px 20px 0 rgba(0, 0, 0, 0.2), 0 2px 4px 0 rgba(0, 0, 0, 0.1)","shadow-emphasis":"0 2px 12px var(--shadow-2)","shadow-inset":"rgba(255, 255, 255, 0.05)","shadow-on-media":"0px 0px 1px rgba(0, 0, 0, 0.62)","shadow-persistent":"0px 0px 12px rgba(28, 43, 51, 0.6)","shadow-primary":"0px 0px 12px rgba(28, 43, 51, 0.1)","shadow-responsive":"0px 8px 16px 0px rgba(0, 0, 0, 0.1)","story-seen":"#84878B","story-unseen":"#0866FF","surface-background":"#1F1F1F","switch-active":"hsl(214, 100%, 59%)","switch-inactive":"#3E4042","switch-unchecked-background-color":"#6F7276","tab-height":"60px","tab-icon-padding-end":"0px","tab-text-icon-gap":"4px","tab-underline-color":"transparent","tab-underline-height":"3px","teal-primary":"rgb(0,152,124)","teal-secondary":"rgb(227,247,241)","teal-tertiary":"rgb(10,68,56)","text-accent":"#429AFF","text-badge-attention-background":"hsl(40, 89%, 52%)","text-badge-corner-radius":"4px","text-badge-critical-background":"#e41e3f","text-badge-info-background":"hsl(214, 100%, 59%)","text-badge-padding-horizontal":"6px","text-badge-padding-vertical":"6px","text-badge-success-background":"#31A24C","text-blue-link":"#429AFF","text-disabled":"rgba(255, 255, 255, 0.34)","text-highlight":"rgba(24, 119, 242, 0.45)","text-input-active-text":"#3E93F8","text-input-caption-margin-top":"10px","text-input-field-font-family":"Placeholder Font","text-input-field-font-size":"1rem","text-input-field-font-stretch":"initial","text-input-field-font-weight":"500","text-input-field-line-height":"1.2941","text-input-label-font-family":"Placeholder Font","text-input-label-font-size":"17px","text-input-label-font-size-scale-multiplier":"0.75","text-input-label-font-stretch":"initial","text-input-label-font-weight":"400","text-input-label-line-height":"1.2941","text-input-multi-padding-between-text-scrollbar":"20px","text-input-multi-padding-scrollbar":"16px","text-input-outside-label":"#FFFFFF","text-input-padding-vertical":"12px","text-negative":"#FF4942","text-placeholder":"rgba(255, 255, 255, 0.5)","text-positive":"#31CC46","text-primary":"#FFFFFF","text-primary-on-media":"#FFFFFF","text-secondary":"rgba(255, 255, 255, 0.5)","text-secondary-on-media":"rgba(255, 255, 255, 0.8)","text-white":"#FFFFFF","toast-addon-padding-horizontal":"6px","toast-addon-padding-vertical":"6px","toast-background":"#242526","toast-border-color":"transparent","toast-border-style":"none","toast-border-width":"0px","toast-container-max-width":"100%","toast-container-min-width":"288px","toast-container-padding-horizontal":"10px","toast-container-padding-vertical":"16px","toast-corner-radius":"8px","toast-text":"#FFFFFF","toast-text-link":"#4599FF","toaster-view-max-width":"328px","toggle-active-background":"rgb(45, 136, 255)","toggle-active-icon":"#FFFFFF","toggle-active-text":"#FFFFFF","toggle-button-active-background":"#E6F2FF","toggle-handle-off":"#FFFFFF","toggle-handle-on":"#FFFFFF","toggle-track-off":"rgba(255, 255, 255, 0.45)","toggle-track-on":"#0070F6","tombstoned-message-border-color":"rgba(255, 255, 255, 0.18)","tooltip-background":"rgba(11, 11, 11, 0.8)","tooltip-box-shadow":"0 2px 4px 0 var(--shadow-5)","tooltip-corner-radius":"8px","typeahead-list-outer-padding-vertical":"2px",warning:"hsl(40, 89%, 52%)",wash:"#3E4042","web-wash":"#1A1A1A","yellow-primary":"rgb(161,132,0)","yellow-secondary":"rgb(255,246,161)","yellow-tertiary":"rgb(72,59,12)"});f["default"]=a}),66);
__d("MDSLegacyStyleXLightTheme",[],(function(a,b,c,d,e,f){a=Object.freeze({accent:"#0099FF","alert-banner-corner-radius":"8px","always-black":"black","always-dark-gradient":"linear-gradient(rgba(0,0,0,0), rgba(0,0,0,0.6))","always-dark-overlay":"rgba(0, 0, 0, 0.4)","always-gray-40":"#65676B","always-gray-75":"#BCC0C4","always-gray-95":"#F0F2F5","always-light-overlay":"rgba(255, 255, 255, 0.4)","always-white":"#FFFFFF","attachment-footer-background":"#F0F2F5","background-deemphasized":"#F0F2F5","badge-accent":"#0070F6","badge-background-color-blue":"var(--accent)","badge-background-color-dark-gray":"var(--secondary-icon)","badge-background-color-gray":"var(--disabled-icon)","badge-background-color-green":"var(--positive)","badge-background-color-light-blue":"var(--highlight-bg)","badge-background-color-red":"var(--notification-badge)","badge-background-color-yellow":"var(--base-lemon)","base-blue":"#1877F2","base-cherry":"#F3425F","base-grape":"#9360F7","base-lemon":"#F7B928","base-lime":"#45BD62","base-pink":"#FF66BF","base-seafoam":"#54C7EC","base-teal":"#2ABBA7","base-tomato":"#FB724B","blue-link":"#216FDB","blue-primary":"rgb(0,136,244)","blue-secondary":"rgb(4,59,114)","blue-tertiary":"rgb(235,245,255)","blueprint-button-height-large":"48px","blueprint-button-height-medium":"40px","border-focused":"#65676B","button-corner-radius":"6px","button-corner-radius-large":"12px","button-corner-radius-medium":"10px","button-height-large":"40px","button-height-medium":"36px","button-icon-padding-large":"16px","button-icon-padding-medium":"16px","button-inner-icon-spacing-large":"3px","button-inner-icon-spacing-medium":"3px","button-padding-horizontal-large":"16px","button-padding-horizontal-medium":"16px","button-padding-icon-only":"16px","card-background":"#FFFFFF","card-background-flat":"#F7F8FA","card-box-shadow":"0 12px 28px 0 var(--shadow-2), 0 2px 4px 0 var(--shadow-1)","card-corner-radius":"12px","card-padding-horizontal":"10px","card-padding-vertical":"20px","chartreuse-primary":"rgb(106,147,22)","chartreuse-secondary":"rgb(50,65,19)","chartreuse-tertiary":"rgb(226,255,152)","chat-bubble-border-radius":"18px","chat-bubble-emphasis-ring-after":"black","chat-bubble-emphasis-ring-before":"white","chat-bubble-padding-horizontal":"12px","chat-bubble-padding-vertical":"8px","chat-incoming-message-bubble-background-color":"#F0F0F0","chat-outgoing-message-bubble-background-color":"var(--accent)","chat-replied-message-background-color":"rgba(0, 0, 0, 0.03)","chat-text-blockquote-color-background-line":"rgba(0, 0, 0, 0.12)","chat-text-blockquote-color-text-primary-media":"rgba(255, 255, 255, 0.7)","chip-button-green":"#24832C","chip-corner-radius":"6px","circle-button-green-background-color":"#30A13A","circle-button-normal-background-color":"rgba(0, 0, 0, 0.04)","circle-button-overlay-raised-background-color":"#FFFFFF","circle-button-overlay-raised-shadow-color":"rgba(0, 0, 0, 0.12)","circle-button-red-background-color":"#E91D16","circle-button-secondary-on-media-background-color":"rgba(0, 0, 0, 0.6)","comment-background":"rgba(134, 142, 153, 0.1)","comment-bubble":"18px","comment-footer-background":"#F6F9FA","cyan-primary":"rgb(0,142,213)","cyan-secondary":"rgb(15,63,93)","cyan-tertiary":"rgb(231,245,255)","dataviz-orange":"#D06C14","dataviz-primary-1":"rgb(0,174,143)","dataviz-primary-2":"rgb(156,219,255)","dataviz-primary-3":"rgb(73,156,255)","dataviz-secondary-1":"rgb(83,78,191)","dataviz-secondary-2":"rgb(103,96,228)","dataviz-secondary-3":"rgb(119,45,88)","dataviz-supplementary-1":"rgb(253,91,67)","dataviz-supplementary-2":"rgb(161,132,0)","dataviz-supplementary-3":"rgb(36,131,44)","dataviz-supplementary-4":"rgb(51,51,52)","destructive-button-background":"#E91D16","destructive-button-text":"#FFFFFF","dialog-anchor-horizontal-padding":"8px","dialog-anchor-vertical-padding":"64px","dialog-border-radius":"12px","dialog-box-shadow":"0 12px 28px 0 var(--shadow-2), 0 2px 4px 0 var(--shadow-1), inset 0 0 0 1px var(--shadow-inset)","dialog-corner-radius":"8px","dialog-size-medium-width":"100%","dialog-size-small-width":"100%","disabled-button-background":"rgba(0, 0, 0, 0.04)","disabled-button-text":"rgba(0, 0, 0, 0.2)","disabled-icon":"#BCC0C4","disabled-text":"#BCC0C4",divider:"#CED0D4","event-date":"#F3425F","fb-logo":"#0866FF","fb-wordmark":"#0866FF","fds-animation-enter-exit-in":"cubic-bezier(0.14, 1, 0.34, 1)","fds-animation-enter-exit-out":"cubic-bezier(0.45, 0.1, 0.2, 1)","fds-animation-expand-collapse-in":"cubic-bezier(0.17, 0.17, 0, 1)","fds-animation-expand-collapse-out":"cubic-bezier(0.17, 0.17, 0, 1)","fds-animation-fade-in":"cubic-bezier(0, 0, 1, 1)","fds-animation-fade-out":"cubic-bezier(0, 0, 1, 1)","fds-animation-move-in":"cubic-bezier(0.17, 0.17, 0, 1)","fds-animation-move-out":"cubic-bezier(0.17, 0.17, 0, 1)","fds-animation-passive-move-in":"cubic-bezier(0.5, 0, 0.1, 1)","fds-animation-passive-move-out":"cubic-bezier(0.5, 0, 0.1, 1)","fds-animation-quick-move-in":"cubic-bezier(0.1, 0.9, 0.2, 1)","fds-animation-quick-move-out":"cubic-bezier(0.1, 0.9, 0.2, 1)","fds-animation-swap-shuffle-in":"cubic-bezier(0.14, 1, 0.34, 1)","fds-animation-swap-shuffle-out":"cubic-bezier(0.45, 0.1, 0.2, 1)","fds-black":"#000000","fds-black-alpha-05":"rgba(0, 0, 0, 0.05)","fds-black-alpha-10":"rgba(0, 0, 0, 0.1)","fds-black-alpha-15":"rgba(0, 0, 0, 0.15)","fds-black-alpha-20":"rgba(0, 0, 0, 0.2)","fds-black-alpha-30":"rgba(0, 0, 0, 0.3)","fds-black-alpha-40":"rgba(0, 0, 0, 0.4)","fds-black-alpha-50":"rgba(0, 0, 0, 0.5)","fds-black-alpha-60":"rgba(0, 0, 0, 0.6)","fds-black-alpha-80":"rgba(0, 0, 0, 0.8)","fds-blue-05":"#ECF3FF","fds-blue-30":"#AAC9FF","fds-blue-40":"#77A7FF","fds-blue-60":"#1877F2","fds-blue-70":"#2851A3","fds-blue-80":"#1D3C78","fds-button-text":"#444950","fds-comment-background":"#F2F3F5","fds-dark-mode-gray-100":"#1C1C1C","fds-dark-mode-gray-35":"#CCCCCC","fds-dark-mode-gray-50":"#828282","fds-dark-mode-gray-70":"#4A4A4A","fds-dark-mode-gray-80":"#373737","fds-dark-mode-gray-90":"#282828","fds-duration-extra-extra-short-in":"100ms","fds-duration-extra-extra-short-out":"100ms","fds-duration-extra-long-in":"1000ms","fds-duration-extra-long-out":"1000ms","fds-duration-extra-short-in":"200ms","fds-duration-extra-short-out":"150ms","fds-duration-long-in":"500ms","fds-duration-long-out":"350ms","fds-duration-medium-in":"400ms","fds-duration-medium-out":"350ms","fds-duration-none":"0ms","fds-duration-short-in":"280ms","fds-duration-short-out":"200ms","fds-fast":"200ms","fds-gray-00":"#F5F6F7","fds-gray-05":"#F2F3F5","fds-gray-10":"#EBEDF0","fds-gray-100":"#1C1E21","fds-gray-20":"#DADDE1","fds-gray-25":"#CCD0D5","fds-gray-30":"#BEC3C9","fds-gray-45":"#8D949E","fds-gray-70":"#606770","fds-gray-80":"#444950","fds-gray-90":"#303338","fds-green-55":"#00A400","fds-green-65":"#51CE70","fds-highlight":"#3578E5","fds-highlight-cell-background":"#ECF3FF","fds-primary-icon":"#1C1E21","fds-primary-text":"#1C1E21","fds-red-55":"#FA383E","fds-slow":"400ms","fds-soft":"cubic-bezier(.08,.52,.52,1)","fds-spectrum-aluminum-tint-70":"#E4F0F6","fds-spectrum-blue-gray-tint-70":"#CFD1D5","fds-spectrum-cherry":"#F35369","fds-spectrum-cherry-tint-70":"#FBCCD2","fds-spectrum-grape-tint-70":"#DDD5F0","fds-spectrum-grape-tint-90":"#F4F1FA","fds-spectrum-lemon-dark-1":"#F5C33B","fds-spectrum-lemon-tint-70":"#FEF2D1","fds-spectrum-lime":"#A3CE71","fds-spectrum-lime-tint-70":"#E4F0D5","fds-spectrum-orange-tint-70":"#FCDEC5","fds-spectrum-orange-tint-90":"#FEF4EC","fds-spectrum-seafoam-tint-70":"#CAEEF9","fds-spectrum-slate-dark-2":"#89A1AC","fds-spectrum-slate-tint-70":"#EAEFF2","fds-spectrum-teal":"#6BCEBB","fds-spectrum-teal-dark-1":"#4DBBA6","fds-spectrum-teal-dark-2":"#31A38D","fds-spectrum-teal-tint-70":"#D2F0EA","fds-spectrum-teal-tint-90":"#F0FAF8","fds-spectrum-tomato":"#FB724B","fds-spectrum-tomato-tint-30":"#F38E7B","fds-spectrum-tomato-tint-90":"#FDEFED","fds-strong":"cubic-bezier(.12,.8,.32,1)","fds-unified-blue-35":"#1455B0","fds-unified-gray-20":"#323436","fds-white":"#FFFFFF","fds-white-alpha-05":"rgba(255, 255, 255, 0.05)","fds-white-alpha-10":"rgba(255, 255, 255, 0.1)","fds-white-alpha-20":"rgba(255, 255, 255, 0.2)","fds-white-alpha-30":"rgba(255, 255, 255, 0.3)","fds-white-alpha-40":"rgba(255, 255, 255, 0.4)","fds-white-alpha-50":"rgba(255, 255, 255, 0.5)","fds-white-alpha-60":"rgba(255, 255, 255, 0.6)","fds-white-alpha-80":"rgba(255, 255, 255, 0.8)","fds-yellow-20":"#FFBA00","filter-accent":"invert(50%) sepia(94%) saturate(3979%) hue-rotate(183deg) brightness(104%) contrast(103%)","filter-always-white":"invert(100%)","filter-blue-link-icon":"invert(30%) sepia(98%) saturate(200%) saturate(200%) saturate(200%) saturate(166.5%) hue-rotate(192deg) brightness(91%) contrast(101%)","filter-disabled-icon":"invert(80%) sepia(6%) saturate(200%) saturate(120%) hue-rotate(173deg) brightness(98%) contrast(89%)","filter-negative":"invert(25%) sepia(33%) saturate(200%) saturate(200%) saturate(200%) saturate(200%) saturate(200%) saturate(200%) saturate(110%) hue-rotate(345deg) brightness(132%) contrast(96%)","filter-placeholder-icon":"invert(59%) sepia(11%) saturate(200%) saturate(135%) hue-rotate(176deg) brightness(96%) contrast(94%)","filter-positive":"invert(37%) sepia(61%) saturate(200%) saturate(200%) saturate(200%) saturate(200%) saturate(115%) hue-rotate(91deg) brightness(97%) contrast(105%)","filter-primary-accent":"invert(39%) sepia(57%) saturate(200%) saturate(200%) saturate(200%) saturate(200%) saturate(200%) saturate(147.75%) hue-rotate(202deg) brightness(97%) contrast(96%)","filter-primary-deemphasized-button-icon":"invert(28%) sepia(100%) saturate(6042%) hue-rotate(202deg) brightness(96%) contrast(101%)","filter-primary-icon":"invert(8%) sepia(10%) saturate(200%) saturate(200%) saturate(166%) hue-rotate(177deg) brightness(104%) contrast(91%)","filter-secondary-button-icon-on-media":"invert(100%)","filter-secondary-icon":"invert(39%) sepia(21%) saturate(200%) saturate(109.5%) hue-rotate(174deg) brightness(94%) contrast(86%)","filter-warning-icon":"invert(77%) sepia(29%) saturate(200%) saturate(200%) saturate(200%) saturate(200%) saturate(200%) saturate(128%) hue-rotate(359deg) brightness(102%) contrast(107%)","focus-ring-blue":"#0070F6","focus-ring-outline-forced-colors":"2px auto transparent !important","focus-ring-outline-link":"2px auto var(--focus-ring-blue)","focus-ring-shadow-default":"0 0 0 2px var(--always-white), 0 0 0 4px var(--focus-ring-blue)","focus-ring-shadow-inset":"0 0 0 2px var(--focus-ring-blue) inset, 0 0 0 4px var(--always-white) inset","font-family-apple":"system-ui, -apple-system, BlinkMacSystemFont, '.SFNSText-Regular', sans-serif","font-family-code":"ui-monospace, Menlo, Consolas, Monaco, monospace","font-family-default":"Helvetica, Arial, sans-serif","font-family-segoe":"Segoe UI Historic, Segoe UI, Helvetica, Arial, sans-serif","font-family-system-fds":"system-ui, -apple-system, BlinkMacSystemFont, Segoe UI Historic, Segoe UI, Helvetica, Arial, sans-serif","fuschia-primary":"rgb(250,45,138)","fuschia-secondary":"rgb(118,14,62)","fuschia-tertiary":"rgb(255,241,246)","glimmer-animation-direction":"alternate","glimmer-animation-duration":"1000ms","glimmer-animation-timing-function":"steps(10, end)","glimmer-base-opaque":"#979A9F","glimmer-corner-radius":"8px","glimmer-high-contrast-base-opaque":"#65686C","glimmer-opacity-high-contrast-max":"1","glimmer-opacity-high-contrast-min":"0.08","glimmer-opacity-max":"1","glimmer-opacity-min":"0.25","glimmer-spinner-icon":"#65676B","global-panel-width":"0px","global-panel-width-expanded":"0px","green-primary":"rgb(43,154,53)","green-secondary":"rgb(26,68,27)","green-tertiary":"rgb(227,250,224)","header-height":"0px","hero-banner-background":"#FFFFFF","highlight-bg":"#E7F3FF","hosted-view-selected-state":"rgba(0, 0, 0, 0.04)","hover-overlay":"rgba(0, 0, 0, 0.05)","icon-accent-color":"#0070F6","icon-destructive-color":"#E91D16","icon-inactive-color":"rgba(134, 142, 153, 0.75)","icon-nux-color":"rgba(0, 0, 0, 0.2)","icon-primary-color":"#000000","icon-secondary-color":"rgba(0, 0, 0, 0.44)","icon-selected-color":"rgba(0, 0, 0, 0.44)","icon-tertiary-color":"rgba(0, 0, 0, 0.2)","icon-white-color":"#FFFFFF","image-corner-radius":"4px","infochip-medium-radius":"12px","input-background":"#FFFFFF","input-background-active":"hsla(var(--accent-h), var(--accent-s), var(--accent-l), 0.05)","input-background-disabled":"#F0F2F5","input-background-error-active":"hsla(var(--negative-h), var(--negative-s), var(--negative-l), 0.05)","input-background-error-hover":"hsla(var(--negative-h), var(--negative-s), var(--negative-l), 0.05)","input-background-hover":"var(--input-background)","input-background-warn-active":"hsla(var(--warning-h), var(--warning-s), var(--warning-l), 0.05)","input-background-warn-hover":"hsla(var(--warning-h), var(--warning-s), var(--warning-l), 0.05)","input-border-color":"#CED0D4","input-border-color-hover":"var(--placeholder-text)","input-border-width":"1px","input-corner-radius":"6px","input-label-color-disabled":"var(--disabled-text)","input-label-color-error":"var(--negative)","input-label-color-highlighted":"hsl(214, 89%, 52%)","input-label-color-inside":"var(--secondary-text)","inverse-text":"var(--always-white)","last-active-state-background":"#E8FBE2","last-active-state-text":"#1B7027","list-cell-chevron":"#65676B","list-cell-corner-radius":"8px","list-cell-min-height":"52px","list-cell-padding-vertical":"20px","list-cell-padding-vertical-with-addon":"14px","magenta-primary":"rgb(215,77,204)","magenta-secondary":"rgb(96,36,91)","magenta-tertiary":"rgb(255,239,254)","mds-green":"#31CC46","media-hover":"rgba(68, 73, 80, 0.15)","media-inner-border":"rgba(0, 0, 0, 0.1)","media-outer-border":"#FFFFFF","media-pressed":"rgba(68, 73, 80, 0.35)","menu-base-list-item-padding-horizontal":"8px","menu-base-list-item-padding-vertical":"12px","menu-base-size-full-margin-end":"48px","menu-item-base-margin-horizontal":"8px","menu-item-base-margin-vertical":"0px","menu-item-base-overlay-radius":"4px","menu-item-base-padding-horizontal":"8px","menu-item-base-padding-vertical":"12px","menu-item-base-with-icon-padding-horizontal":"var(--menu-item-base-padding-horizontal)","messenger-application-max-width":"2560px","messenger-card-background":"#FFFFFF","messenger-card-box-shadow":"0px 0px 8px rgba(52,72,84,.05)","messenger-card-corner-radius":"12px","messenger-card-max-width":"480px","messenger-card-min-width":"300px","messenger-card-spacing":"16px","messenger-reply-background":"#F0F2F5","messenger-sidebar-collapsed-width":"44px","messenger-sidebar-expanded-width":"240px","mwp-header-background-color":"var(--messenger-card-background)","mwp-header-button-color":"var(--accent)","mwp-message-row-background":"var(--messenger-card-background)","nav-bar-background":"#F5F5F5","nav-bar-background-gradient":"linear-gradient(to top, #FFFFFF, rgba(255,255,255.9), rgba(255,255,255,.7), rgba(255,255,255,.4), rgba(255,255,255,0))","nav-bar-background-gradient-wash":"linear-gradient(to top, #F0F2F5, rgba(240,242,245.9), rgba(240,242,245,.7), rgba(240,242,245,.4), rgba(240,242,245,0))","nav-list-cell-corner-radius":"8px","nav-list-cell-min-height":"0px","nav-list-cell-padding-vertical":"16px","nav-list-cell-padding-vertical-with-addon":"16px",negative:"hsl(350, 87%, 55%)","negative-background":"hsl(350, 87%, 55%, 20%)","new-notification-background":"#E7F3FF","non-media-pressed":"rgba(68, 73, 80, 0.15)","non-media-pressed-on-dark":"rgba(255, 255, 255, 0.3)","notification-badge":"#e41e3f","nux-card-body-padding-end":"24px","orange-primary":"rgb(208,108,20)","orange-secondary":"rgb(94,49,14)","orange-tertiary":"rgb(255,241,239)","overlay-alpha-80":"rgba(244, 244, 244, 0.8)","overlay-on-media":"rgba(0, 0, 0, 0.6)","page-footer-padding-vertical":"16px","placeholder-icon":"#65676B","placeholder-image":"rgb(164, 167, 171)","placeholder-text":"#65676B","placeholder-text-on-media":"rgba(255, 255, 255, 0.5)","popover-background":"#FFFFFF","popover-border-color":"transparent","popover-border-style":"none","popover-border-width":"0px","popover-card-background":"var(--card-background)",positive:"#5AD539","positive-background":"#DEEFE1","press-overlay":"rgba(0, 0, 0, 0.10)","pressable-background-color-hover":"rgba(0, 0, 0, 0.04)","pressable-background-color-selected":"rgba(0, 0, 0, 0.06)","primary-button-background":"#0070F6","primary-button-icon":"#FFFFFF","primary-button-pressed":"#77A7FF","primary-button-text":"#FFFFFF","primary-deemphasized-button-background":"#EAF3FE","primary-deemphasized-button-pressed":"rgba(0, 0, 0, 0.05)","primary-deemphasized-button-pressed-overlay":"rgba(25, 110, 255, 0.15)","primary-deemphasized-button-text":"#0069E0","primary-icon":"#050505","primary-text":"#050505","primary-text-on-media":"#FFFFFF","primary-web-focus-indicator":"#D24294","progress-ring-blue-background":"rgba(24, 119, 242, 0.2)","progress-ring-blue-foreground":"hsl(214, 89%, 52%)","progress-ring-disabled-background":"rgba(190,195,201, 0.2)","progress-ring-disabled-foreground":"#BEC3C9","progress-ring-neutral-background":"rgba(0, 0, 0, 0.2)","progress-ring-neutral-foreground":"#000000","progress-ring-on-media-background":"rgba(255, 255, 255, 0.2)","progress-ring-on-media-foreground":"#FFFFFF","purple-primary":"rgb(125,116,255)","purple-secondary":"rgb(55,50,121)","purple-tertiary":"rgb(245,241,255)","qp-card-box-shadow":"0 4px 8px 0 rgba(0,0,0,0.1)","radio-border-color":"var(--primary-icon)","radio-border-color-disabled":"var(--disabled-button-background)","radio-border-color-selected":"#000000","radio-border-width":"2px","radio-checked-icon-color":"#000000","radio-checked-icon-color-disabled":"var(--disabled-button-background)","radio-checked-icon-size-large":"12px","radio-checked-icon-size-medium":"12px","radio-size-large":"24px","radio-size-medium":"20px","rating-star-active":"#EB660D","red-primary":"rgb(251,60,68)","red-secondary":"rgb(118,22,27)","red-tertiary":"rgb(255,241,239)","scroll-shadow":"0 1px 2px rgba(0, 0, 0, 0.1), 0 -1px rgba(0, 0, 0, 0.1) inset","scroll-thumb":"rgba(0, 0, 0, 0.44)","scrollbar-thumb-color":"rgba(0, 0, 0, 0.2)","scrollbar-track-color":"transparent","secondary-button-background":"rgba(0, 0, 0, 0.04)","secondary-button-background-floating":"#ffffff","secondary-button-background-on-dark":"rgba(0, 0, 0, 0.4)","secondary-button-pressed":"rgba(0, 0, 0, 0.05)","secondary-button-stroke":"transparent","secondary-button-text":"#000000","secondary-deemphasized-button-background":"rgba(0, 0, 0, 0)","secondary-icon":"#65676B","secondary-text":"#65676B","secondary-text-on-media":"rgba(255, 255, 255, 0.9)","section-header-addOnEnd-button-padding-horizontal":"0px","section-header-addOnEnd-button-padding-vertical":"0px","section-header-addOnEnd-margin-horizontal":"8px","section-header-addOnStart-margin-horizontal":"12px","section-header-padding-vertical":"16px","section-header-subtitle-margin-vertical":"14px","section-header-subtitle-with-addOnEnd-margin-vertical":"6px","section-header-text":"#4B4C4F","separator-menu-item-margin-horizontal":"16px","separator-menu-item-margin-vertical":"4px","shadow-1":"rgba(0, 0, 0, 0.1)","shadow-2":"rgba(0, 0, 0, 0.2)","shadow-5":"rgba(0, 0, 0, 0.5)","shadow-8":"rgba(0, 0, 0, 0.8)","shadow-base":"0 1px 2px var(--shadow-2)","shadow-elevated":"0 8px 20px 0 rgba(0, 0, 0, 0.2), 0 2px 4px 0 rgba(0, 0, 0, 0.1)","shadow-emphasis":"0 2px 12px var(--shadow-2)","shadow-inset":"rgba(255, 255, 255, 0.5)","shadow-on-media":"0px 0px 1px rgba(0, 0, 0, 0.62)","shadow-persistent":"0px 0px 12px rgba(52, 72, 84, 0.05)","shadow-primary":"0px 5px 12px rgba(52, 72, 84, 0.2)","shadow-responsive":"0px 8px 16px 0px rgba(0, 0, 0, 0.1)","story-seen":"#84878B","story-unseen":"#0866FF","surface-background":"#FFFFFF","switch-active":"hsl(214, 89%, 52%)","switch-inactive":"#CED0D4","switch-unchecked-background-color":"#8F9297","tab-height":"60px","tab-icon-padding-end":"0px","tab-text-icon-gap":"4px","tab-underline-color":"transparent","tab-underline-height":"3px","teal-primary":"rgb(0,152,124)","teal-secondary":"rgb(10,68,56)","teal-tertiary":"rgb(227,247,241)","text-accent":"#0A7CFF","text-badge-attention-background":"hsl(40, 89%, 52%)","text-badge-corner-radius":"4px","text-badge-critical-background":"#e41e3f","text-badge-info-background":"hsl(214, 89%, 52%)","text-badge-padding-horizontal":"6px","text-badge-padding-vertical":"6px","text-badge-success-background":"#31A24C","text-blue-link":"#0069E0","text-disabled":"rgba(0, 0, 0, 0.2)","text-highlight":"rgba(24, 119, 242, 0.2)","text-input-active-text":"#0064D1","text-input-caption-margin-top":"10px","text-input-field-font-family":"Placeholder Font","text-input-field-font-size":"1rem","text-input-field-font-stretch":"initial","text-input-field-font-weight":"500","text-input-field-line-height":"1.2941","text-input-label-font-family":"Placeholder Font","text-input-label-font-size":"17px","text-input-label-font-size-scale-multiplier":"0.75","text-input-label-font-stretch":"initial","text-input-label-font-weight":"400","text-input-label-line-height":"1.2941","text-input-multi-padding-between-text-scrollbar":"20px","text-input-multi-padding-scrollbar":"16px","text-input-outside-label":"#000000","text-input-padding-vertical":"12px","text-negative":"#D41A14","text-placeholder":"rgba(0, 0, 0, 0.55)","text-positive":"#1B7027","text-primary":"#000000","text-primary-on-media":"#FFFFFF","text-secondary":"rgba(0, 0, 0, 0.55)","text-secondary-on-media":"rgba(255, 255, 255, 0.8)","text-white":"#FFFFFF","toast-addon-padding-horizontal":"6px","toast-addon-padding-vertical":"6px","toast-background":"#FFFFFF","toast-border-color":"transparent","toast-border-style":"none","toast-border-width":"0px","toast-container-max-width":"100%","toast-container-min-width":"288px","toast-container-padding-horizontal":"10px","toast-container-padding-vertical":"16px","toast-corner-radius":"8px","toast-text":"#1C2B33","toast-text-link":"#216FDB","toaster-view-max-width":"328px","toggle-active-background":"#E7F3FF","toggle-active-icon":"rgb(24, 119, 242)","toggle-active-text":"rgb(24, 119, 242)","toggle-button-active-background":"#E7F3FF","toggle-handle-off":"#FFFFFF","toggle-handle-on":"#FFFFFF","toggle-track-off":"rgba(0, 0, 0, 0.44)","toggle-track-on":"#0070F6","tombstoned-message-border-color":"rgba(0, 0, 0, 0.12)","tooltip-background":"rgba(244, 244, 244, 0.8)","tooltip-box-shadow":"0 2px 4px 0 var(--shadow-5)","tooltip-corner-radius":"8px","typeahead-list-outer-padding-vertical":"2px",warning:"hsl(40, 89%, 52%)",wash:"#E4E6EB","web-wash":"#F5F5F5","yellow-primary":"rgb(161,132,0)","yellow-secondary":"rgb(72,59,12)","yellow-tertiary":"rgb(255,246,161)"});f["default"]=a}),66);
__d("MDSThemeConfig",["cr:5386","cr:5559"],(function(a,b,c,d,e,f,g){"use strict";a={dark:b("cr:5386"),light:b("cr:5559"),type:"VARIABLES"};g["default"]=a}),98);
__d("MDSTheme.react",["BaseTheme.react","MDSThemeConfig","react","react-compiler-runtime","useCurrentDisplayMode"],(function(a,b,c,d,e,f,g){"use strict";var h=["displayMode"],i,j=i||(i=d("react"));i.useMemo;var k={root:{boxSizing:"x1afcbsf",position:"x1uhb9sk",zIndex:"x1swf91x",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(6),e,f;b[0]!==a?(e=a.displayMode,f=babelHelpers.objectWithoutPropertiesLoose(a,h),b[0]=a,b[1]=e,b[2]=f):(e=b[1],f=b[2]);a=c("useCurrentDisplayMode")();var g;bb0:{if(e==="invert"){g=a==="dark"?"light":"dark";break bb0}g=e!=null?e:a}e=g;b[3]!==f||b[4]!==e?(a=j.jsx(c("BaseTheme.react"),babelHelpers["extends"]({config:c("MDSThemeConfig"),displayMode:e,xstyle:k.root},f)),b[3]=f,b[4]=e,b[5]=a):a=b[5];return a}g["default"]=a}),98);
__d("MDSTooltipImpl.react",["BaseAnchorPositioningUtils","BaseContextualLayerLayerAdjustmentContext","CometPlaceholder.react","FDSProgressRingIndeterminate.react","MDSText.react","MDSTheme.react","clearTimeout","cr:20267","cr:20391","react","react-compiler-runtime","setTimeout","stylex","useCometDisplayTimingTrackerForInteraction"],(function(a,b,c,d,e,f,g){"use strict";var h=["align","contentColor","contentKey","contentType","delayContentMs","headline","id","isVisible","themeWrapper","tooltip","tooltipTheme"],i,j,k=j||(j=d("react"));e=j;var l=e.useContext,m=e.useLayoutEffect,n=e.useRef,o=e.useState,p={arrowAbove:{backgroundColor:"xlhe6ec",borderEndEndRadius:"xt6ovg4",bottom:"xuvo3zv",clipPath:"xinh0ix",height:"x1v9usgg",insetInlineStart:"x3nj053",left:null,right:null,position:"x10l6tqk",transform:"x1158fpu",width:"x6jxa94",$$css:!0},arrowBelow:{backgroundColor:"xlhe6ec",borderStartStartRadius:"x1fqc64z",clipPath:"x1ii9esy",height:"x1v9usgg",insetInlineStart:"x3nj053",left:null,right:null,position:"x10l6tqk",top:"x1ans9ou",transform:"x1158fpu",width:"x6jxa94",$$css:!0},contextualLayer:{$$css:!0},outerContainerArrowAboveMarginSpacing:{marginBottom:"xvrx75z",marginTop:"xr9ek0c",$$css:!0},outerContainerArrowBelowMarginSpacing:{marginBottom:"xjpr12u",marginTop:"x1is9kpn",$$css:!0}};function q(a){var b=d("react-compiler-runtime").c(4),c=a.contextualLayerRef;b[0]!==c.current?(a=function(){var a=c.current;a&&a.reposition({autoflip:!0})},b[0]=c.current,b[1]=a):a=b[1];var e;b[2]!==c?(e=[c],b[2]=c,b[3]=e):e=b[3];m(a,e);return null}function r(a){var b,e=d("react-compiler-runtime").c(8);a=a.position;b=(b=l(c("BaseContextualLayerLayerAdjustmentContext")))!=null?b:0;if(a==null)return null;var f=a==="above"&&p.arrowAbove;a=a==="below"&&p.arrowBelow;var g;e[0]!==f||e[1]!==a?(g=(i||(i=c("stylex")))(f,a),e[0]=f,e[1]=a,e[2]=g):g=e[2];f="translate("+-b+"px, 0px) rotate(45deg)";e[3]!==f?(a={transform:f},e[3]=f,e[4]=a):a=e[4];e[5]!==g||e[6]!==a?(b=k.jsx("div",{className:g,style:a}),e[5]=g,e[6]=a,e[7]=b):b=e[7];return b}function a(a){var e,f=d("react-compiler-runtime").c(52),g;if(f[0]!==a){var j=a.align;a.contentColor;var l=a.contentKey;a.contentType;var s=a.delayContentMs;a.headline;var t=a.id,u=a.isVisible;a.themeWrapper;var v=a.tooltip,w=a.tooltipTheme,x=babelHelpers.objectWithoutPropertiesLoose(a,h);j=j;l=l;s=s;t=t;g=u;u=v;v=w;w=x;f[0]=a;f[1]=j;f[2]=l;f[3]=t;f[4]=g;f[5]=w;f[6]=s;f[7]=v;f[8]=u}else j=f[1],l=f[2],t=f[3],g=f[4],w=f[5],s=f[6],v=f[7],u=f[8];var y=s===void 0?0:s;x=v===void 0?"invert":v;a=w;s=a.position;v=n(null);a=c("useCometDisplayTimingTrackerForInteraction")("ToolTip");var z=n(null),A=n(g),B;f[9]!==y||f[10]!==g?(B=function(){return g===!0&&A.current===!1&&y>0},f[9]=y,f[10]=g,f[11]=B):B=f[11];B=o(B);var C=B[0],D=B[1];B=n(null);var E=w.anchorPosName;e=(e=w.anchorPosRef)!=null?e:B;f[12]!==j||f[13]!==s?(B=d("BaseAnchorPositioningUtils").contextualLayerToAnchorPositionAreaCompat(s,j),f[12]=j,f[13]=s,f[14]=B):B=f[14];j=B;B=j[0];j=j[1];var F;f[15]!==B||f[16]!==j?(F={blockPositionArea:B,inlinePositionArea:j,tryFallbacks:"flip-block"},f[15]=B,f[16]=j,f[17]=F):F=f[17];B=b("cr:20267")(E,e,F);j=d("BaseAnchorPositioningUtils").passesAnchorPositionExperiment();var G,H;B!=null&&j&&(G=B[0],H=B[1]);f[18]!==a||f[19]!==w?(E=babelHelpers["extends"]({align:"middle"},w,{imperativeRef:v,ref:a,xstyle:p.contextualLayer}),f[18]=a,f[19]=w,f[20]=E):E=f[20];e=E;f[21]!==y||f[22]!==g?(F=function(){if(g===!0&&A.current===!1&&y>0){D(!0);z.current=c("setTimeout")(function(){D(!1),z.current=null},y);return function(){c("clearTimeout")(z.current),z.current=null}}else z.current!=null&&(D(!1),c("clearTimeout")(z.current),z.current=null);A.current=g},j=[y,g],f[21]=y,f[22]=g,f[23]=F,f[24]=j):(F=f[23],j=f[24]);m(F,j);if(u==null||!g)return null;f[25]===Symbol["for"]("react.memo_cache_sentinel")?(B=k.jsx("div",babelHelpers["extends"]({className:"x78zum5 xl56j7k"},{children:k.jsx(c("FDSProgressRingIndeterminate.react"),{color:"dark",size:20})})),f[25]=B):B=f[25];a=B;w=H;f[26]!==G||f[27]!==s?(E=(i||(i=c("stylex"))).props(s==="below"&&p.outerContainerArrowBelowMarginSpacing,s==="above"&&p.outerContainerArrowAboveMarginSpacing,G),f[26]=G,f[27]=s,f[28]=E):E=f[28];f[29]!==g?(F={0:{className:"xlhe6ec x1obq294 x5a5i1n xde0f50 x15x8krk x152obne x17o27uk xg01cxk xz9dl7a xpdmqnj xsag5q8 x1g0dm76 x1n2onr6"},1:{className:"xlhe6ec x1obq294 x5a5i1n xde0f50 x15x8krk x152obne x17o27uk xz9dl7a xpdmqnj xsag5q8 x1g0dm76 x1n2onr6 x1hc1fzr"}}[!!g<<0],f[29]=g,f[30]=F):F=f[30];f[31]!==l||f[32]!==C||f[33]!==u?(j=k.jsx(c("MDSText.react"),{type:"body4",children:C?a:k.jsxs(c("CometPlaceholder.react"),{fallback:a,name:"MDSTooltipImpl",children:[k.jsx(q,{contextualLayerRef:v}),u]},l)}),f[31]=l,f[32]=C,f[33]=u,f[34]=j):j=f[34];f[35]!==s?(B=k.jsx(r,{position:s}),f[35]=s,f[36]=B):B=f[36];f[37]!==t||f[38]!==F||f[39]!==j||f[40]!==B?(a=k.jsxs("div",babelHelpers["extends"]({},F,{"data-testid":void 0,id:t,role:"tooltip",children:[j,B]})),f[37]=t,f[38]=F,f[39]=j,f[40]=B,f[41]=a):a=f[41];f[42]!==H||f[43]!==E||f[44]!==a?(v=k.jsx("div",babelHelpers["extends"]({ref:w},E,{children:a})),f[42]=H,f[43]=E,f[44]=a,f[45]=v):v=f[45];f[46]!==v||f[47]!==x?(l=k.jsx(c("MDSTheme.react"),{displayMode:x,children:v}),f[46]=v,f[47]=x,f[48]=l):l=f[48];C=l;f[49]!==e||f[50]!==C?(u=k.jsx(b("cr:20391"),babelHelpers["extends"]({},e,{children:C})),f[49]=e,f[50]=C,f[51]=u):u=f[51];return u}g["default"]=a}),98);
__d("useSearchCometGlobalTypeaheadInitializeDataSource",["SearchCometTypeaheadEventEmitterContext","react","react-compiler-runtime","searchCometGlobalTypeahead.config","useSearchCometEventEmitterContext","useSearchCometGlobalTypeaheadCompositeDataSource","useSearchCometGlobalTypeaheadNullStateDataSource"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useEffect;function a(){var a=d("react-compiler-runtime").c(17),b=c("useSearchCometGlobalTypeaheadNullStateDataSource")(),e;a[0]!==b?(e={config:c("searchCometGlobalTypeahead.config"),recentDataSource:b},a[0]=b,a[1]=e):e=a[1];var f=c("useSearchCometGlobalTypeaheadCompositeDataSource")(e);e=(b=c("useSearchCometEventEmitterContext")(c("SearchCometTypeaheadEventEmitterContext")))!=null?b:{};var g=e.subscribeToClearGlobalRecentSearches,h=e.subscribeToRecentSearchEntryAdded,j=e.subscribeToRefreshRecentSearches;a[2]!==f||a[3]!==h?(b=function(){return h==null?void 0:h(function(a){f.addRecentEntry(a)})},e=[f,h],a[2]=f,a[3]=h,a[4]=b,a[5]=e):(b=a[4],e=a[5]);i(b,e);a[6]!==f||a[7]!==g?(b=function(){return g==null?void 0:g(function(){f.clearRecentSearches()})},e=[f,g],a[6]=f,a[7]=g,a[8]=b,a[9]=e):(b=a[8],e=a[9]);i(b,e);a[10]!==f||a[11]!==j?(b=function(){return j==null?void 0:j(function(){f.refreshRecentSearches()})},e=[f,j],a[10]=f,a[11]=j,a[12]=b,a[13]=e):(b=a[12],e=a[13]);i(b,e);a[14]!==f?(b=function(){f.bootstrap()},e=[f],a[14]=f,a[15]=b,a[16]=e):(b=a[15],e=a[16]);i(b,e)}g["default"]=a}),98);
__d("SearchCometGlobalTypeaheadDataSourceLoader.react",["CometVisualCompletionAttributes","react","react-compiler-runtime","useSearchCometGlobalTypeaheadInitializeDataSource"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(){var a=d("react-compiler-runtime").c(1);c("useSearchCometGlobalTypeaheadInitializeDataSource")();var b;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b=i.jsx("div",babelHelpers["extends"]({"data-testid":void 0},c("CometVisualCompletionAttributes").IGNORE)),a[0]=b):b=a[0];return b}g["default"]=a}),98);/*FB_PKG_DELIM*/
__d("LSSendOTCNotifications",["LSIssueNewEbTaskAndGetTaskIDV2"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(a){return c.forEach(c.db.table(285).fetch(),function(a){return a["delete"]()})},function(a){return c.forEach(c.filter(c.db.table(285).fetch([[[c.i64.cast([0,1])]]]),function(a){return c.i64.eq(a.pk,c.i64.cast([0,1]))&&c.i64.lt(a.authorityLevel,c.i64.cast([0,20]))}),function(a){return a["delete"]()})},function(a){return c.db.table(285).add({pk:c.i64.cast([0,1]),notificationSendingStatus:c.i64.cast([0,2]),authorityLevel:c.i64.cast([0,20])})},function(e){return d[0]=new c.Map(),d[0].set("device_ids",a[0]),d[1]=c.toJSON(d[0]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),"meb_send_otc_notifications",c.i64.cast([0,50032]),d[1],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),void 0,c.i64.cast([0,0])).then(function(a){return a=a,d[2]=a[0],a})}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsSendOTCNotificationsStoredProcedure";a.__tables__=["encrypted_backups_otc_notification_sending_status"];e.exports=a}),null);
__d("LSSendOTCNotificationsStoredProcedure",["LSSendOTCNotifications","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSSendOTCNotifications"),e.deviceIds);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("MAWEncryptedBackupsRestoreDialogContexts_query.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MAWEncryptedBackupsRestoreDialogContexts_query",selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"xfb_backup",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"useMWEncryptedBackupsGetVirtualDevicesPreloaded_xfbEncryptedBackup"},{alias:null,args:[{kind:"Literal",name:"family_device_id",value:""}],kind:"ScalarField",name:"has_otc_eligible_devices",storageKey:'has_otc_eligible_devices(family_device_id:"")'}],storageKey:null},{kind:"RequiredField",field:{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerDefaultEncryptedBackup",kind:"LinkedField",name:"messenger_default_encrypted_backup",plural:!1,selections:[{alias:null,args:null,concreteType:"VestaGetUserInfoResponse",kind:"LinkedField",name:"vesta_user_info",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"useMWChatEncryptedBackupsVestaUserInfo_vestaGetUserInfoResponse"}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"encrypted_backup",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"has_seen_eb_auto_restore_notice",storageKey:null}],storageKey:null}],storageKey:null},action:"THROW",path:"viewer"}],type:"Query",abstractKey:null};e.exports=a}),null);
__d("MWChatEncryptedBackupsDismissalDialogContext",["react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h||d("react");b=a.createContext({isDismissedDisabled:!1,setIsDismissedDisabled:function(){}});g["default"]=b}),98);
__d("MWChatEncryptedBackupsDismissalDialogContextProvider.react",["MWChatEncryptedBackupsDismissalDialogContext","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useMemo;var j=b.useState;function a(a){var b=d("react-compiler-runtime").c(5),e=a.children;a=a.isDismissedDisabledValue;a=j(a);var f=a[0];a=a[1];b[0]!==f?(a={isDismissedDisabled:f,setIsDismissedDisabled:a},b[0]=f,b[1]=a):a=b[1];f=a;a=f;b[2]!==e||b[3]!==a?(f=i.jsx(c("MWChatEncryptedBackupsDismissalDialogContext").Provider,{value:a,children:e}),b[2]=e,b[3]=a,b[4]=f):f=b[4];return f}g["default"]=a}),98);
__d("MWChatEncryptedBackupsRestoreUpsellDialogContextProvider.react",["MWChatEncryptedBackupsSetIsDialogPersistedContext","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useMemo;function a(a){var b=d("react-compiler-runtime").c(5),e=a.children;a=a.setIsDialogPersisted;var f;b[0]!==a?(f={setIsDialogPersisted:a},b[0]=a,b[1]=f):f=b[1];f=f;f=f;if(a!=null){b[2]!==e||b[3]!==f?(a=i.jsx(c("MWChatEncryptedBackupsSetIsDialogPersistedContext").Provider,{value:f,children:e}),b[2]=e,b[3]=f,b[4]=a):a=b[4];return a}return e}g["default"]=a}),98);
__d("MWEBHasSeenAutoRestoreNoticeContextProvider.react",["MWEBHasSeenAutoRestoreNoticeContext","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useMemo;function a(a){var b=d("react-compiler-runtime").c(5),e=a.children;a=a.hasSeenNotice;var f;b[0]!==a?(f={hasSeenNotice:a},b[0]=a,b[1]=f):f=b[1];a=f;f=a;b[2]!==e||b[3]!==f?(a=i.jsx(c("MWEBHasSeenAutoRestoreNoticeContext").Provider,{value:f,children:e}),b[2]=e,b[3]=f,b[4]=a):a=b[4];return a}g["default"]=a}),98);
__d("MAWEncryptedBackupsRestoreDialogContexts.react",["CometRelay","CometTransientDialogProvider.react","MAWEncryptedBackupsRestoreDialogContexts_query.graphql","MWChatEncryptedBackupsDismissalDialogContextProvider.react","MWChatEncryptedBackupsRestoreUpsellDialogContextProvider.react","MWEBFlowSourceContextProvider.react","MWEBHasSeenAutoRestoreNoticeContextProvider.react","MWEBVestaUserInfoContext.react","MWEBVirtualDevicesContextProvider.react","react","react-compiler-runtime","useMWChatEncryptedBackupsVestaUserInfo","useMWEncryptedBackupsGetVirtualDevicesPreloaded"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||(i=d("react"));i.useMemo;function a(a){var e,f=d("react-compiler-runtime").c(30),g=a.children,i=a.query,k=a.setIsDialogPersisted;a=a.source;i=d("CometRelay").useFragment(h!==void 0?h:h=b("MAWEncryptedBackupsRestoreDialogContexts_query.graphql"),i);e=(e=i.viewer.messenger_default_encrypted_backup)==null?void 0:e.vesta_user_info;var l;f[0]!==e?(l={vestaGetUserInfoResponse$key:e},f[0]=e,f[1]=l):l=f[1];e=c("useMWChatEncryptedBackupsVestaUserInfo")(l);f[2]!==i.xfb_backup?(l={encryptedBackup:i.xfb_backup},f[2]=i.xfb_backup,f[3]=l):l=f[3];l=c("useMWEncryptedBackupsGetVirtualDevicesPreloaded")(l);l=l.getVirtualDevices;var m;f[4]!==l?(m=l(),f[4]=l,f[5]=m):m=f[5];l=m;m=l.offlineDevicesCount;l=l.vestaClientID;var n;f[6]!==e.attemptsRemaining||f[7]!==e.loginTimeoutRemainingSecs?(n={attemptsRemaining:e.attemptsRemaining,loginTimeoutRemainingSecs:e.loginTimeoutRemainingSecs,vestaClientID:null},f[6]=e.attemptsRemaining,f[7]=e.loginTimeoutRemainingSecs,f[8]=n):n=f[8];e=n;n=e;e=(e=(e=i.xfb_backup)==null?void 0:e.has_otc_eligible_devices)!=null?e:void 0;i=(i=(i=i.viewer.encrypted_backup)==null?void 0:i.has_seen_eb_auto_restore_notice)!=null?i:!1;var o;f[9]!==k?(o=function(a){k==null||k(a)},f[9]=k,f[10]=o):o=f[10];var p;f[11]!==g?(p=j.jsx(c("CometTransientDialogProvider.react"),{children:g}),f[11]=g,f[12]=p):p=f[12];f[13]!==p||f[14]!==n?(g=j.jsx(d("MWEBVestaUserInfoContext.react").MWEBVestaUserInfoContext.Provider,{value:n,children:p}),f[13]=p,f[14]=n,f[15]=g):g=f[15];f[16]!==g||f[17]!==o?(p=j.jsx(c("MWChatEncryptedBackupsDismissalDialogContextProvider.react"),{isDismissedDisabledValue:!1,children:j.jsx(c("MWChatEncryptedBackupsRestoreUpsellDialogContextProvider.react"),{setIsDialogPersisted:o,children:g})}),f[16]=g,f[17]=o,f[18]=p):p=f[18];f[19]!==a||f[20]!==p?(n=j.jsx(c("MWEBFlowSourceContextProvider.react"),{source:a,children:p}),f[19]=a,f[20]=p,f[21]=n):n=f[21];f[22]!==n||f[23]!==i?(g=j.jsx(c("MWEBHasSeenAutoRestoreNoticeContextProvider.react"),{hasSeenNotice:i,children:n}),f[22]=n,f[23]=i,f[24]=g):g=f[24];f[25]!==m||f[26]!==g||f[27]!==e||f[28]!==l?(o=j.jsx(c("MWEBVirtualDevicesContextProvider.react"),{hasOtcEligibleDevicesInitialValue:e,offlineDevicesCountInitialValue:m,vestaClientIDInitialValue:l,children:g}),f[25]=m,f[26]=g,f[27]=e,f[28]=l,f[29]=o):o=f[29];return o}g["default"]=a}),98);
__d("MWEBLazyLoadResetPinPage",["JSResourceForInteraction","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h=c("JSResourceForInteraction")("MWEBPushResetPinPage").__setRef("MWEBLazyLoadResetPinPage");function a(a,b){c("promiseDone")(h.load().then(function(c){return c(a,b)}))}g["default"]=a}),98);
__d("MWEBPinCodeUpsellDialog.entrypoint",["JSResourceForInteraction"],(function(a,b,c,d,e,f,g){"use strict";a={getPreloadProps:function(){return{queries:{}}},root:c("JSResourceForInteraction")("MWEBPinCodeUpsellDialog.react").__setRef("MWEBPinCodeUpsellDialog.entrypoint")};g["default"]=a}),98);
__d("MWEBRestoreOTCFirstDialogStepDeferred.react",["deferredLoadComponent","react","react-compiler-runtime","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j=c("deferredLoadComponent")(c("requireDeferred")("MWEBRestoreOTCFirstStep.react").__setRef("MWEBRestoreOTCFirstDialogStepDeferred.react"));function a(a){var b=d("react-compiler-runtime").c(2),c;b[0]!==a?(c=i.jsx(j,babelHelpers["extends"]({},a)),b[0]=a,b[1]=c):c=b[1];return c}g["default"]=a}),98);
__d("usePushFDSMultiStepDialogEntryPointPage",["BaseMultiPageEntryPointImpl.react","CometRelay","FDSMultiStepDialogPushPageContext.react","react","react-compiler-runtime","useCometRelayEntrypointContextualEnvironmentProvider"],(function(a,b,c,d,e,f,g){"use strict";var h=["fallback"],i,j=i||(i=d("react"));b=i;b.useCallback;var k=b.useContext,l=b.useTransition;function a(a,b){var e=d("react-compiler-runtime").c(8),f=l(),g=f[0],i=f[1],m=c("useCometRelayEntrypointContextualEnvironmentProvider")(),n=k(d("FDSMultiStepDialogPushPageContext.react").FDSMultiStepDialogPushPageContext);e[0]!==m||e[1]!==a||e[2]!==b||e[3]!==n?(f=function(e,f){if(b==null)return;i(function(){var g=d("CometRelay").loadEntryPoint(m,a,b),i=f!=null?f:{},k=i.fallback;i=babelHelpers.objectWithoutPropertiesLoose(i,h);n(function(){return j.jsx(c("BaseMultiPageEntryPointImpl.react"),{entryPoint:a,environmentProvider:m,fallback:k,loadedEntryPoint:g,otherProps:e,preloadParams:b,usePlaceholder:k!=null})},i)})},e[0]=m,e[1]=a,e[2]=b,e[3]=n,e[4]=f):f=e[4];f=f;var o;e[5]!==g||e[6]!==f?(o=[g,f],e[5]=g,e[6]=f,e[7]=o):o=e[7];return o}g["default"]=a}),98);
__d("MAWEncryptedBackupsRestoreStep.react",["EOTRTypes","MWChatEncryptedBackupsQPLSource.enum","MWEBLazyLoadResetPinPage","MWEBOTCDialogStepDeferred.react","MWEBPinCodeUpsellDialog.entrypoint","MWEBRestoreOTCFirstDialogStepDeferred.react","MWEBVestaUserInfoContext.react","MWEBVirtualDevicesContext.react","MWEncryptedBackupsOtcRestoreSteps","deferredLoadComponent","gkx","react","react-compiler-runtime","requireDeferred","requireDeferredForDisplay","useEOTRPhaseTwoAndThree","usePushFDSMultiStepDialogEntryPointPage"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useCallback;var j=c("deferredLoadComponent")(c("requireDeferred")("MWChatEncryptedBackupsAccessCodeInputStep.react").__setRef("MAWEncryptedBackupsRestoreStep.react")),k=c("deferredLoadComponent")(c("requireDeferredForDisplay")("MWChatEncryptedBackupsPinCodeRestoreStep.react").__setRef("MAWEncryptedBackupsRestoreStep.react")),l=c("deferredLoadComponent")(c("requireDeferred")("MWChatEncryptedBackupsKVSOnlyRestoreStep.react").__setRef("MAWEncryptedBackupsRestoreStep.react"));function m(a){var b=d("react-compiler-runtime").c(28),e=a.offlineDevicesCount,f=a.onClose,g=a.onComplete,h=a.onForgotRC,k=a.onSkip,m=a.pushPage,n=a.shouldShowForgotButton;a=a.source;var o=d("MWEBVirtualDevicesContext.react").useMWEBVirtualDevices();o=o.virtualDeviceInfo;var p=c("useEOTRPhaseTwoAndThree")();if(o.doesUserHaveOtcEligibleDevices){o=a===c("MWChatEncryptedBackupsQPLSource.enum").INBOX_INTERSTITIAL_SOFTBLOCK;if(o){b[0]!==f||b[1]!==g||b[2]!==k||b[3]!==m?(a=i.jsx(c("MWEBRestoreOTCFirstDialogStepDeferred.react"),{onCloseDialog:f,onComplete:g,onSkip:k,pushPage:m}),b[0]=f,b[1]=g,b[2]=k,b[3]=m,b[4]=a):a=b[4];return a}b[5]!==m?(o=function(a){a=a.onResendCodeFailure;return d("MWEncryptedBackupsOtcRestoreSteps").pushViewOtcEligibleDevicesPage({onResendCodeFailure:a,pushPage:m})},b[5]=m,b[6]=o):o=b[6];b[7]!==f||b[8]!==g||b[9]!==k||b[10]!==m||b[11]!==o?(a=i.jsx(c("MWEBOTCDialogStepDeferred.react"),{onClose:f,onComplete:g,onSkip:k,onViewAllDevices:o,pushPage:m}),b[7]=f,b[8]=g,b[9]=k,b[10]=m,b[11]=o,b[12]=a):a=b[12];return a}if(e!==null&&e>=1){b[13]!==f||b[14]!==g||b[15]!==h||b[16]!==k||b[17]!==m||b[18]!==n?(o=i.jsx(j,{onClose:f,onComplete:g,onForgotRC:h,onSkip:k,pushPage:m,shouldShowForgotButton:n}),b[13]=f,b[14]=g,b[15]=h,b[16]=k,b[17]=m,b[18]=n,b[19]=o):o=b[19];return o}if(p===d("EOTRTypes").EOTRFlow.UNTRUSTED_MOBILE){b[20]!==f||b[21]!==g||b[22]!==m?(a=i.jsx(l,{onClose:f,onComplete:g,pushPage:m}),b[20]=f,b[21]=g,b[22]=m,b[23]=a):a=b[23];return a}b[24]!==f||b[25]!==g||b[26]!==m?(e=i.jsx(l,{onClose:f,onComplete:g,pushPage:m}),b[24]=f,b[25]=g,b[26]=m,b[27]=e):e=b[27];return e}function a(a){var b=d("react-compiler-runtime").c(41),e=a.clientID,f=a.offlineDevicesCount,g=a.onClose,h=a.onComplete,j=a.onForgotRC,l=a.onSkip,n=a.pushPage,o=a.shouldShowForgotButton;a=a.source;var p=d("MWEBVestaUserInfoContext.react").useMWEBIsCooldownOrLockOutState(),q=d("MWEBVirtualDevicesContext.react").useMWEBVirtualDevices();q=q.virtualDeviceInfo;q=q.doesUserHaveOtcEligibleDevices;var r;b[0]!==h||b[1]!==n?(r=function(){c("MWEBLazyLoadResetPinPage")(h,n)},b[0]=h,b[1]=n,b[2]=r):r=b[2];r=r;var s;b[3]===Symbol["for"]("react.memo_cache_sentinel")?(s={},b[3]=s):s=b[3];s=c("usePushFDSMultiStepDialogEntryPointPage")(c("MWEBPinCodeUpsellDialog.entrypoint"),s);var t=s[1];b[4]!==h||b[5]!==l||b[6]!==t?(s=function(){t({onClose:l,onComplete:h},{withoutBackButton:!0})},b[4]=h,b[5]=l,b[6]=t,b[7]=s):s=b[7];s=s;if(e!=null&&p&&q){b[8]!==f||b[9]!==g||b[10]!==r||b[11]!==j||b[12]!==l||b[13]!==n||b[14]!==o||b[15]!==a?(p=i.jsx(m,{offlineDevicesCount:f,onClose:g,onComplete:r,onForgotRC:j,onSkip:l,pushPage:n,shouldShowForgotButton:o,source:a}),b[8]=f,b[9]=g,b[10]=r,b[11]=j,b[12]=l,b[13]=n,b[14]=o,b[15]=a,b[16]=p):p=b[16];return p}else if(e!=null){b[17]!==g||b[18]!==h||b[19]!==l||b[20]!==n||b[21]!==o?(q=i.jsx(k,{onClose:g,onComplete:h,onSkip:l,pushPage:n,shouldShowForgotButton:o}),b[17]=g,b[18]=h,b[19]=l,b[20]=n,b[21]=o,b[22]=q):q=b[22];return q}else if(c("gkx")("13248")){b[23]!==f||b[24]!==g||b[25]!==s||b[26]!==j||b[27]!==l||b[28]!==n||b[29]!==o||b[30]!==a?(r=i.jsx(m,{offlineDevicesCount:f,onClose:g,onComplete:s,onForgotRC:j,onSkip:l,pushPage:n,shouldShowForgotButton:o,source:a}),b[23]=f,b[24]=g,b[25]=s,b[26]=j,b[27]=l,b[28]=n,b[29]=o,b[30]=a,b[31]=r):r=b[31];return r}b[32]!==f||b[33]!==g||b[34]!==h||b[35]!==j||b[36]!==l||b[37]!==n||b[38]!==o||b[39]!==a?(p=i.jsx(m,{offlineDevicesCount:f,onClose:g,onComplete:h,onForgotRC:j,onSkip:l,pushPage:n,shouldShowForgotButton:o,source:a}),b[32]=f,b[33]=g,b[34]=h,b[35]=j,b[36]=l,b[37]=n,b[38]=o,b[39]=a,b[40]=p):p=b[40];return p}g["default"]=a}),98);
__d("MAWPinCodeGating",["gkx","justknobx"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("gkx")("3955")&&c("justknobx")._("1015")}g.isPinCodeEnabled=a}),98);
__d("MWEBQPResetPIN.react",["ix","CometImageFromIXValue.react","gkx","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react"),k=c("gkx")("23433");function a(a){var b=d("react-compiler-runtime").c(5),e=a.alt,f=a.ref;a=a.xstyle;var g;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(g=k?h("421464"):h("421459"),b[0]=g):g=b[0];g=g;b[1]!==e||b[2]!==f||b[3]!==a?(g=j.jsx(c("CometImageFromIXValue.react"),{alt:e,ref:f,source:g,xstyle:a}),b[1]=e,b[2]=f,b[3]=a,b[4]=g):g=b[4];return g}g["default"]=a}),98);
__d("useWAInfraMobileDeviceList",["react","react-compiler-runtime","useWAInfraDeviceList"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useMemo;function a(){var a=d("react-compiler-runtime").c(2),b=c("useWAInfraDeviceList")(),e;a[0]!==b?(e=b.filter(i),a[0]=b,a[1]=e):e=a[1];b=e;a=b;return a}function i(a){var b;return a.platform==="Messenger"&&!["Mac OS X","Windows"].includes(a.manufacturer)&&!["Chrome","Safari","Firefox","Edge","System Product Name"].includes(a.model)&&!(a.manufacturer==="Apple"&&(b=a.model)!=null&&b.includes("Mac"))}g["default"]=a}),98);
__d("MWChatEncryptedBackupsPinCodeRestoreStep.react",["fbt","CometPlaceholder.react","FocusRegion.react","JSResourceForInteraction","MWChatEBPinCodeVerifyIndicator.react","MWChatEncryptedBackupsNumericCodeErrorWrapper.react","MWChatEncryptedBackupsNumericCodeInput.react","MWChatEncryptedBackupsQPLEvents","MWEBQPResetPIN.react","MWEBVestaUserInfoContext.react","MWEBVirtualDevicesContext.react","MWEncryptedBackupsForgotPinStep","MWEncryptedBackupsOtcRestoreSteps","MWLogInteraction","MWXColumn.react","MWXColumnItem.react","MWXDialogPageLegacy.react","MWXLink.react","MWXMultiStepDialogHeader.react","MWXText.react","QPLUserFlow","cr:6247","focusScopeQueries","gkx","lazyLoadComponent","nullthrows","promiseDone","react","react-compiler-runtime","useEncryptedBackupsQplImpressionRef","useMWChatEncryptedBackupsPinCodeRestore","useWAInfraMobileDeviceList","xplatToDOMRef"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));e=i;e.useCallback;var k=e.useEffect,l=e.useState,m=c("gkx")("23219"),n=c("JSResourceForInteraction")("MWChatEncryptedBackupsPinCodeBlockedStep.react").__setRef("MWChatEncryptedBackupsPinCodeRestoreStep.react"),o="chat-encrypted-backups-dialog-layout-restore-step";function a(a){var e=d("react-compiler-runtime").c(45),f=a.onClose,g=a.onComplete,i=a.onSkip,q=a.pushPage;a=a.shouldShowForgotButton;a=a===void 0?!0:a;var r=l(null),s=r[0];r=r[1];var t=d("MWEBVirtualDevicesContext.react").useMWEBVirtualDevices();t=t.virtualDeviceInfo;t=t.vestaClientID;var u;e[0]!==t?(u=c("nullthrows")(t),e[0]=t,e[1]=u):u=e[1];e[2]!==g||e[3]!==u?(t={clientID:u,focusRegionId:o,onVestaComplete:g},e[2]=g,e[3]=u,e[4]=t):t=e[4];u=d("useMWChatEncryptedBackupsPinCodeRestore").useMWChatEncryptedBackupsPinCodeRestore(t);var v=u.focusOnInput;t=u.inputProps;var w=u.invalidKeyPressedError,x=u.isInProgress,y=u.isLabyrinthError,z=u.isPinCodeIncorrect;u=u.isVestaError;var A=l(!1),B=A[0];A=A[1];x=x||B;e[5]===Symbol["for"]("react.memo_cache_sentinel")?(B=h._(/*BTDS*/"Some messages are missing. Enter your PIN to restore your chat history."),e[5]=B):B=e[5];B=B;var C=d("MWEBVestaUserInfoContext.react").useMWEBVestaUserInfo(),D=C.attemptsRemaining;C=C.loginTimeoutRemainingSecs;var E=D===0,F=d("MWEBVestaUserInfoContext.react").useMWEBIsCooldownOrLockOutState(),G=c("useEncryptedBackupsQplImpressionRef")(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"PIN_CODE_RESTORE_SCREEN",void 0,function(){v(),N!=null&&c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_OPTION_DISPLAYED_RESTORE_SCREEN")}),H=d("MWEBVirtualDevicesContext.react").useMWEBVirtualDevices();H=H.virtualDeviceInfo;var I=H.doesUserHaveOtcEligibleDevices;H=H.offlineDevicesCount;var J=c("useWAInfraMobileDeviceList")();J=J.length>0;var K;e[6]!==H||e[7]!==f||e[8]!==g||e[9]!==q||e[10]!==J?(K={hasMobileDevices:J,offlineDevicesCount:H,onClose:f,onComplete:g,pushPage:q},e[6]=H,e[7]=f,e[8]=g,e[9]=q,e[10]=J,e[11]=K):K=e[11];var L=d("MWEncryptedBackupsForgotPinStep").useForgotPinLinkPushPageProps(K);e[12]!==L||e[13]!==F||e[14]!==x||e[15]!==a?(H=a?j.jsx(c("MWXText.react"),{color:F||x?"disabled":"highlight",type:"button2",children:j.jsx(c("MWXLink.react"),babelHelpers["extends"]({},L,{disabled:F||x,onClick:function(a){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"PIN_CODE_RESTORE_FORGOT_PIN_CLICK"),L==null||L.onClick==null||L.onClick(a)},testid:void 0}))}):null,e[12]=L,e[13]=F,e[14]=x,e[15]=a,e[16]=H):H=e[16];J=H;e[17]!==f||e[18]!==g||e[19]!==i||e[20]!==q?(K=function(){d("MWEncryptedBackupsOtcRestoreSteps").pushByOneTimeCodePage({onClose:f,onOtcComplete:g,onSkip:i,pushPage:q})},e[17]=f,e[18]=g,e[19]=i,e[20]=q,e[21]=K):K=e[21];var M=K,N=I?j.jsx(c("MWXText.react"),{color:F||x?"disabled":"highlight",type:"button2",children:j.jsx(c("MWXLink.react"),{disabled:F||x,onClick:function(){d("MWLogInteraction").logPopoverOpenCancel("initiate_restore"),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_USE_ONE_TIME_CODE_CLICK"),M()},rel:"noreferrer",testid:void 0,children:h._(/*BTDS*/"Use a one-time code instead")})}):null;a=N!=null?N:J;e[22]===Symbol["for"]("react.memo_cache_sentinel")?(H=h._(/*BTDS*/"Enter your PIN to restore your chat history"),e[22]=H):H=e[22];K=H;e[23]===Symbol["for"]("react.memo_cache_sentinel")?(I=c("lazyLoadComponent")(n),e[23]=I):I=e[23];J=I;if(e[24]!==D||e[25]!==t||e[26]!==w||e[27]!==F||e[28]!==x||e[29]!==y||e[30]!==z||e[31]!==u||e[32]!==C||e[33]!==E||e[34]!==f||e[35]!==g||e[36]!==s||e[37]!==G||e[38]!==a||e[39]!==N){I=F?j.jsx(J,{attemptsRemaining:D,loginTimeoutRemainingSecs:C,onClose:f,onComplete:g}):j.jsx(c("MWXDialogPageLegacy.react"),{callToActionGroupLayout:"expanded",includeFDSContentPadding_REMOVE_THIS_AFTER_CONTENT_PADDING_MIGRATION:!1,ref:d("xplatToDOMRef").xplatToDOMRef(G),children:j.jsxs(c("MWXColumn.react"),{align:"center",paddingHorizontal:16,paddingVertical:16,spacing:0,children:[j.jsx(c("MWXColumnItem.react"),{align:"center",paddingTop:16,children:j.jsx("div",babelHelpers["extends"]({className:"xg87l8a"},{children:j.jsx(c("MWEBQPResetPIN.react"),{})}))}),j.jsx(c("MWXColumnItem.react"),{align:"center",paddingVertical:16,children:j.jsx(c("MWXText.react"),{align:"center",isSemanticHeading:!0,type:"headlineEmphasized2",children:K})}),j.jsx(c("MWXColumnItem.react"),{align:"center",children:j.jsx(c("MWXText.react"),{align:"center",color:"secondary",type:"body3",children:j.jsx("div",babelHelpers["extends"]({className:"x1l90r2v x2b8uid"},{children:B}))})}),j.jsx(c("MWXColumnItem.react"),{align:"center",children:j.jsx(c("MWChatEncryptedBackupsNumericCodeErrorWrapper.react"),{error:(H=w!=null?w:s)!=null?H:z&&N!=null?h._(/*BTDS*/"Incorrect PIN. Try again or use a one-time code."):z?h._(/*BTDS*/"Incorrect PIN. Try again."):y||u?h._(/*BTDS*/"There was an error while using the PIN Code, please try again"):void 0,children:j.jsx(d("FocusRegion.react").FocusRegion,{autoFocusQuery:d("focusScopeQueries").tabbableScopeQuery,id:o,children:j.jsx(c("MWChatEncryptedBackupsNumericCodeInput.react"),babelHelpers["extends"]({},t,{disabled:C!=null||E||x,testid:void 0}))})})}),x&&j.jsx(c("MWXColumnItem.react"),{align:"center",children:j.jsx(c("MWChatEBPinCodeVerifyIndicator.react"),{isMessenger:m})}),!x&&j.jsx(c("MWXColumnItem.react"),{align:"center",children:j.jsx("div",babelHelpers["extends"]({className:"x1y1aw1k"},{children:a}))}),b("cr:6247")!=null&&j.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MWChatEncryptedBackupsPinCodeRestoreStep",children:j.jsx(b("cr:6247"),{onComplete:g,onError:r,setIsLoading:A})})]})});e[24]=D;e[25]=t;e[26]=w;e[27]=F;e[28]=x;e[29]=y;e[30]=z;e[31]=u;e[32]=C;e[33]=E;e[34]=f;e[35]=g;e[36]=s;e[37]=G;e[38]=a;e[39]=N;e[40]=I}else I=e[40];J=I;e[41]===Symbol["for"]("react.memo_cache_sentinel")?(K=[],e[41]=K):K=e[41];k(p,K);e[42]===Symbol["for"]("react.memo_cache_sentinel")?(B=j.jsx(c("MWXMultiStepDialogHeader.react"),{withCloseButton:!1,withoutBackButton:!0}),e[42]=B):B=e[42];e[43]!==J?(H=j.jsxs(j.Fragment,{children:[B,J]}),e[43]=J,e[44]=H):H=e[44];return H}function p(){c("promiseDone")(n.load())}g["default"]=a}),226);
__d("MWEBEOTRDialog.entrypoint",["JSResourceForInteraction"],(function(a,b,c,d,e,f,g){"use strict";a=c("JSResourceForInteraction")("MWEBEOTRDialog.react").__setRef("MWEBEOTRDialog.entrypoint");b={getPreloadProps:function(){return{queries:{}}},root:a};g["default"]=b}),98);
__d("MWEBErrorStatePhoneInterstitialIcon.react",["ix","MWXImage.react","gkx","react","react-compiler-runtime","useCurrentDisplayMode"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(a){var b=d("react-compiler-runtime").c(5);a=a.alt;var e=c("useCurrentDisplayMode")();e=e==="dark";var f;b[0]!==e?(f=c("gkx")("23219")?e?h("210369"):h("210371"):h("433676"),b[0]=e,b[1]=f):f=b[1];e=f;b[2]!==a||b[3]!==e?(f=j.jsx(c("MWXImage.react"),{alt:a,src:e}),b[2]=a,b[3]=e,b[4]=f):f=b[4];return f}g["default"]=a}),98);
__d("MWEBNoMobileEOTRResetEBDialog.entrypoint",["JSResourceForInteraction"],(function(a,b,c,d,e,f,g){"use strict";a={getPreloadProps:function(){return{queries:{}}},root:c("JSResourceForInteraction")("MWEBNoMobileEOTRResetEBDialog.react").__setRef("MWEBNoMobileEOTRResetEBDialog.entrypoint")};g["default"]=a}),98);
__d("useMWAbandonRestoreConfirmationDialog",["fbt","EOTRTypes","MWChatEncryptedBackupsQPLEvents","QPLUserFlow","gkx","react","react-compiler-runtime","useEOTRPhaseTwoAndThree","useMWXConfirmationDialog"],(function(a,b,c,d,e,f,g,h){"use strict";var i;(i||d("react")).useCallback;function a(a){var b=d("react-compiler-runtime").c(4),e=c("useEOTRPhaseTwoAndThree")(),f=e===d("EOTRTypes").EOTRFlow.NO_MOBILE||e===d("EOTRTypes").EOTRFlow.UNTRUSTED_MOBILE,g=c("useMWXConfirmationDialog")(),i=c("gkx")("23219");b[0]!==f||b[1]!==a||b[2]!==g?(e=function(){g({body:f?h._(/*BTDS*/"Your chats won't be backed up, and you won't be able to restore them if you switch devices."):i?h._(/*BTDS*/"This means that you won't see your full chat history on this device."):h._(/*BTDS*/"This means you won't see your full chat history on this device and new messages you send or receive may not load on other new devices."),cancel:f?h._(/*BTDS*/"Go back"):void 0,confirm:f?h._(/*BTDS*/"Close"):h._(/*BTDS*/"Don't restore messages"),title:f?h._(/*BTDS*/"Are you sure?"):h._(/*BTDS*/"Continue without restoring?")},function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"DONT_RESTORE_CONFIRMATION_CLICK"),a==null||a()},j)},b[0]=f,b[1]=a,b[2]=g,b[3]=e):e=b[3];return e}function j(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"DONT_RESTORE_CANCEL_CLICK")}g["default"]=a}),226);
__d("MWEBNoMobileEOTRInformationalDialog.react",["fbt","AddOnStartOverride.react","MWChatEncryptedBackupsQPLEvents","MWEBErrorStatePhoneInterstitialIcon.react","MWEBNoMobileEOTRResetEBDialog.entrypoint","MWXColumn.react","MWXColumnItem.react","MWXDialogFooter.react","MWXDialogHeader.react","MWXDialogPage.react","MWXIconCloudUpload","MWXIconForListCell.react","MWXIconMenuItemTrash","MWXIconMobile","MWXList.react","MWXListCell.react","MWXText.react","MWXTextPairing.react","QPLUserFlow","react","react-compiler-runtime","useMWAbandonRestoreConfirmationDialog","usePopPage","usePushPage","useVisibilityObserver"],(function(a,b,c,d,e,f,g,h){"use strict";var i=["onHighIntent"],j,k=j||(j=d("react"));j.useCallback;function l(a){var b=d("react-compiler-runtime").c(20),e=a.onClose,f=a.onCloseConfirm,g=a.onComplete;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(a={},b[0]=a):a=b[0];a=c("usePushPage")(c("MWEBNoMobileEOTRResetEBDialog.entrypoint"),a);var j=a[0];a=a[1];if(b[1]!==a){a.onHighIntent;var l=babelHelpers.objectWithoutPropertiesLoose(a,i);l=l;b[1]=a;b[2]=l}else l=b[2];b[3]!==e||b[4]!==f||b[5]!==g||b[6]!==j?(a=function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"PIN_CODE_RESTORE_NO_MOBILE_RESET_CLICK"),j({onClose:e,onCloseConfirm:f,onComplete:g})},b[3]=e,b[4]=f,b[5]=g,b[6]=j,b[7]=a):a=b[7];a=a;var m;b[8]!==e?(m=function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"PIN_CODE_RESTORE_NO_MOBILE_NOT_NOW_CLICK"),e==null||e()},b[8]=e,b[9]=m):m=b[9];m=m;var n;b[10]===Symbol["for"]("react.memo_cache_sentinel")?(n=h._(/*BTDS*/"Reset chat history"),b[10]=n):n=b[10];b[11]!==a||b[12]!==l?(n=babelHelpers["extends"]({label:n},l,{onPress:a}),b[11]=a,b[12]=l,b[13]=n):n=b[13];b[14]===Symbol["for"]("react.memo_cache_sentinel")?(a=h._(/*BTDS*/"Not now"),b[14]=a):a=b[14];b[15]!==m?(l={label:a,onPress:m},b[15]=m,b[16]=l):l=b[16];b[17]!==n||b[18]!==l?(a=k.jsx(c("MWXDialogFooter.react"),{callToActionGroupDirection:"backward",primaryCallToAction:n,secondaryCallToAction:l}),b[17]=n,b[18]=l,b[19]=a):a=b[19];return a}function a(a){var b=d("react-compiler-runtime").c(33),e=a.closeOnComplete,f=a.onClose,g=a.onComplete,i=e===void 0?!1:e;a=c("usePopPage")();b[0]!==f?(e=function(){f==null||f()},b[0]=f,b[1]=e):e=b[1];e=c("useMWAbandonRestoreConfirmationDialog")(e);var j;b[2]!==i||b[3]!==f||b[4]!==g?(j=function(){g==null||g(),i&&(f==null||f())},b[2]=i,b[3]=f,b[4]=g,b[5]=j):j=b[5];j=j;var n;b[6]===Symbol["for"]("react.memo_cache_sentinel")?(n={onVisible:m},b[6]=n):n=b[6];n=c("useVisibilityObserver")(n);var o;b[7]!==f||b[8]!==e||b[9]!==j?(o=k.jsx(l,{onClose:f,onCloseConfirm:e,onComplete:j}),b[7]=f,b[8]=e,b[9]=j,b[10]=o):o=b[10];e=a!=null?a:void 0;j=a!=null;a=f!=null;var p;b[11]!==f||b[12]!==e||b[13]!==j||b[14]!==a?(p=k.jsx(c("MWXDialogHeader.react"),{mdsTitleLayout:"block",onBack:e,onClose:f,withBackButton:j,withCloseButton:a,withoutDivider:!0}),b[11]=f,b[12]=e,b[13]=j,b[14]=a,b[15]=p):p=b[15];b[16]===Symbol["for"]("react.memo_cache_sentinel")?(e=k.jsx(c("MWXColumnItem.react"),{align:"center",children:k.jsx(c("MWEBErrorStatePhoneInterstitialIcon.react"),{})}),b[16]=e):e=b[16];b[17]===Symbol["for"]("react.memo_cache_sentinel")?(j=k.jsx(c("MWXColumnItem.react"),{children:k.jsx(c("MWXText.react"),{align:"center",type:"headlineEmphasized2",children:h._(/*BTDS*/"Reset chat history to access new messages on any device")})}),b[17]=j):j=b[17];b[18]===Symbol["for"]("react.memo_cache_sentinel")?(a=k.jsx(c("AddOnStartOverride.react"),{children:k.jsx(c("MWXIconForListCell.react"),{icon:c("MWXIconMenuItemTrash"),size:"large"})}),b[18]=a):a=b[18];var q;b[19]===Symbol["for"]("react.memo_cache_sentinel")?(q=h._(/*BTDS*/"End-to-end encrypted messages will be deleted from your backup and you won\u2019t be able to restore them."),b[19]=q):q=b[19];b[20]===Symbol["for"]("react.memo_cache_sentinel")?(a=k.jsx(c("MWXListCell.react"),{addOnStart:a,content:k.jsx(c("MWXTextPairing.react"),{body:q,bodyColor:"secondary",headline:h._(/*BTDS*/"Messages currently saved in your backup will be deleted"),level:4})}),b[20]=a):a=b[20];b[21]===Symbol["for"]("react.memo_cache_sentinel")?(q=k.jsx(c("AddOnStartOverride.react"),{children:k.jsx(c("MWXIconForListCell.react"),{icon:c("MWXIconCloudUpload"),size:"large"})}),b[21]=q):q=b[21];var r;b[22]===Symbol["for"]("react.memo_cache_sentinel")?(r=h._(/*BTDS*/"Resetting your chat history lets you back up new messages in secure storage."),b[22]=r):r=b[22];b[23]===Symbol["for"]("react.memo_cache_sentinel")?(q=k.jsx(c("MWXListCell.react"),{addOnStart:q,content:k.jsx(c("MWXTextPairing.react"),{body:r,bodyColor:"secondary",headline:h._(/*BTDS*/"New messages will be backed up so you can restore them"),level:4})}),b[23]=q):q=b[23];b[24]===Symbol["for"]("react.memo_cache_sentinel")?(r=k.jsx(c("AddOnStartOverride.react"),{children:k.jsx(c("MWXIconForListCell.react"),{icon:c("MWXIconMobile"),size:"large"})}),b[24]=r):r=b[24];var s;b[25]===Symbol["for"]("react.memo_cache_sentinel")?(s=h._(/*BTDS*/"You need a PIN to restore your chat history when you switch devices."),b[25]=s):s=b[25];b[26]===Symbol["for"]("react.memo_cache_sentinel")?(a=k.jsx(c("MWXColumnItem.react"),{paddingHorizontal:0,children:k.jsxs(c("MWXList.react"),{children:[a,q,k.jsx(c("MWXListCell.react"),{addOnStart:r,content:k.jsx(c("MWXTextPairing.react"),{body:s,bodyColor:"secondary",headline:h._(/*BTDS*/"You\u2019ll create a PIN to access your chats on any device"),level:4})})]})}),b[26]=a):a=b[26];b[27]!==n?(q=k.jsxs(c("MWXColumn.react"),{paddingHorizontal:16,ref:n,spacing:20,children:[e,j,a]}),b[27]=n,b[28]=q):q=b[28];b[29]!==q||b[30]!==o||b[31]!==p?(r=k.jsx(c("MWXDialogPage.react"),{footer:o,header:p,children:q}),b[29]=q,b[30]=o,b[31]=p,b[32]=r):r=b[32];return r}function m(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"PIN_CODE_RESTORE_NO_MOBILE_INFORMATION_SCREEN")}g["default"]=a}),226);
__d("MWEBOTCErrorMessages",["fbt"],(function(a,b,c,d,e,f,g,h){"use strict";a=function(){return h._(/*BTDS*/"Incorrect code. Try again.")};b=function(){return h._(/*BTDS*/"Code not found. Try resending a new code.")};c=function(){return h._(/*BTDS*/"Too many attempts. Try again later.")};d=function(){return h._(/*BTDS*/"Code expired. Try generating a new code.")};e=function(){return h._(/*BTDS*/"Something went wrong. Please try again.")};f=function(){return h._(/*BTDS*/"Couldn't send code. Please try again.")};var i=function(){return h._(/*BTDS*/"Couldn't load trusted devices. Please try again.")};g.getOtcIsWrongErrorMessage=a;g.getNoSessionOngoingErrorMessage=b;g.getMaxAttemptsReachedErrorMessage=c;g.getSessionExpiredErrorMessage=d;g.getGeneralErrorMessage=e;g.getNotificationFailedToSendErrorMessage=f;g.getFailedToFetchOtcDevicesErrorMessage=i}),226);
__d("MWEBOTCGating",[],(function(a,b,c,d,e,f){"use strict";function a(){return!0}function b(){return!0}function c(){return!0}f.showDevicesPopover=a;f.showResendButton=b;f.showNewTitle=c}),66);
__d("MWEBQPOneTimeCode.react",["ix","CometImageFromIXValue.react","gkx","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react"),k=c("gkx")("23433");function a(a){var b=d("react-compiler-runtime").c(5),e=a.alt,f=a.ref;a=a.xstyle;var g;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(g=k?h("421460"):h("421458"),b[0]=g):g=b[0];g=g;b[1]!==e||b[2]!==f||b[3]!==a?(g=j.jsx(c("CometImageFromIXValue.react"),{alt:e,ref:f,source:g,xstyle:a}),b[1]=e,b[2]=f,b[3]=a,b[4]=g):g=b[4];return g}g["default"]=a}),98);
__d("MWEBUntrustedMobileEOTRResetPendingEBDialog.entrypoint",["JSResourceForInteraction"],(function(a,b,c,d,e,f,g){"use strict";a={getPreloadProps:function(){return{queries:{}}},root:c("JSResourceForInteraction")("MWEBUntrustedMobileEOTRResetPendingEBDialog.react").__setRef("MWEBUntrustedMobileEOTRResetPendingEBDialog.entrypoint")};g["default"]=a}),98);
__d("useMWEBSendMobileResetNotificationMutation_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="24435129696180525"}),null);
__d("useMWEBSendMobileResetNotificationMutation.graphql",["useMWEBSendMobileResetNotificationMutation_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{alias:null,args:null,concreteType:"NetworkVerificationRestoreSendNotificationResponse",kind:"LinkedField",name:"xfb_mweb_send_mobile_reset_notification",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"client_mutation_id",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useMWEBSendMobileResetNotificationMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"useMWEBSendMobileResetNotificationMutation",selections:a},params:{id:b("useMWEBSendMobileResetNotificationMutation_facebookRelayOperation"),metadata:{},name:"useMWEBSendMobileResetNotificationMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("useMWEBSendMobileResetNotification",["fbt","CometRelay","FBLogger","MWXIconCheckmarkCircle","react","react-compiler-runtime","useMWEBSendMobileResetNotificationMutation.graphql","useMWXPushToast"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j;(j||d("react")).useCallback;function a(){var a=d("react-compiler-runtime").c(4),e;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(e=i!==void 0?i:i=b("useMWEBSendMobileResetNotificationMutation.graphql"),a[0]=e):e=a[0];e=d("CometRelay").useMutation(e);var f=e[0],g=c("useMWXPushToast")();a[1]!==f||a[2]!==g?(e=function(){f({onCompleted:function(){g({icon:c("MWXIconCheckmarkCircle"),title:h._(/*BTDS*/"Request sent")})},onError:k,variables:{}})},a[1]=f,a[2]=g,a[3]=e):e=a[3];return e}function k(){c("FBLogger")("labyrinth_web").mustfix("[labyrinth_web][EOTR-Untrusted Mobile] Failed to sent notification to user's devices")}g["default"]=a}),226);
__d("MWEBUntrustedMobileEOTRInformationalDialog.react",["fbt","AddOnStartOverride.react","MWChatEncryptedBackupsQPLEvents","MWEBErrorStatePhoneInterstitialIcon.react","MWEBUntrustedMobileEOTRResetPendingEBDialog.entrypoint","MWXColumn.react","MWXColumnItem.react","MWXDialogFooter.react","MWXDialogHeader.react","MWXDialogPage.react","MWXIconCloudUpload","MWXIconForListCell.react","MWXIconMenuItemTrash","MWXIconMobile","MWXList.react","MWXListCell.react","MWXText.react","MWXTextPairing.react","QPLUserFlow","react","react-compiler-runtime","useMWAbandonRestoreConfirmationDialog","useMWEBSendMobileResetNotification","usePopPage","usePushPage","useVisibilityObserver"],(function(a,b,c,d,e,f,g,h){"use strict";var i=["onHighIntent"],j,k=j||d("react");function l(a){var b=d("react-compiler-runtime").c(20),e=a.onClose,f=a.onCloseConfirm,g=a.onComplete,j=a.pushPage;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(a={},b[0]=a):a=b[0];a=c("usePushPage")(c("MWEBUntrustedMobileEOTRResetPendingEBDialog.entrypoint"),a);var l=a[0];a=a[1];if(b[1]!==a){a.onHighIntent;var m=babelHelpers.objectWithoutPropertiesLoose(a,i);m=m;b[1]=a;b[2]=m}else m=b[2];var n=c("useMWEBSendMobileResetNotification")();b[3]!==e||b[4]!==f||b[5]!==g||b[6]!==l||b[7]!==j||b[8]!==n?(a=function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"PIN_CODE_RESTORE_UNTRUSTED_DEVICE_SEND_REQUEST_CLICK"),n(),l({onClose:e,onCloseConfirm:f,onComplete:g,pushPage:j})},b[3]=e,b[4]=f,b[5]=g,b[6]=l,b[7]=j,b[8]=n,b[9]=a):a=b[9];a=a;var o;b[10]===Symbol["for"]("react.memo_cache_sentinel")?(o=h._(/*BTDS*/"Send request"),b[10]=o):o=b[10];b[11]!==a||b[12]!==m?(o=babelHelpers["extends"]({label:o},m,{onPress:a}),b[11]=a,b[12]=m,b[13]=o):o=b[13];b[14]===Symbol["for"]("react.memo_cache_sentinel")?(a=h._(/*BTDS*/"Not now"),b[14]=a):a=b[14];b[15]!==e?(m={label:a,onPress:e},b[15]=e,b[16]=m):m=b[16];b[17]!==o||b[18]!==m?(a=k.jsx(c("MWXDialogFooter.react"),{callToActionGroupDirection:"backward",primaryCallToAction:o,secondaryCallToAction:m}),b[17]=o,b[18]=m,b[19]=a):a=b[19];return a}function a(a){var b=d("react-compiler-runtime").c(30),e=a.onClose,f=a.onComplete,g=a.pushPage;a=a.showBackButton;a=a===void 0?!0:a;var i=c("usePopPage")();i=a?i:null;var j;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(j={onVisible:m},b[0]=j):j=b[0];j=c("useVisibilityObserver")(j);var n;b[1]!==e?(n=function(){e==null||e()},b[1]=e,b[2]=n):n=b[2];n=c("useMWAbandonRestoreConfirmationDialog")(n);var o;b[3]!==e||b[4]!==n||b[5]!==f||b[6]!==g?(o=k.jsx(l,{onClose:e,onCloseConfirm:n,onComplete:f,pushPage:g}),b[3]=e,b[4]=n,b[5]=f,b[6]=g,b[7]=o):o=b[7];n=i!=null?i:void 0;f=a&&i!=null;g=e!=null;b[8]!==e||b[9]!==n||b[10]!==f||b[11]!==g?(a=k.jsx(c("MWXDialogHeader.react"),{mdsTitleLayout:"block",onBack:n,onClose:e,withBackButton:f,withCloseButton:g,withoutDivider:!0}),b[8]=e,b[9]=n,b[10]=f,b[11]=g,b[12]=a):a=b[12];b[13]===Symbol["for"]("react.memo_cache_sentinel")?(i=k.jsx(c("MWXColumnItem.react"),{align:"center",children:k.jsx(c("MWEBErrorStatePhoneInterstitialIcon.react"),{})}),b[13]=i):i=b[13];b[14]===Symbol["for"]("react.memo_cache_sentinel")?(n=k.jsx(c("MWXColumnItem.react"),{children:k.jsx(c("MWXText.react"),{align:"center",type:"headlineEmphasized2",children:h._(/*BTDS*/"Reset chat history on your mobile device to start backing up new messages")})}),b[14]=n):n=b[14];b[15]===Symbol["for"]("react.memo_cache_sentinel")?(f=k.jsx(c("AddOnStartOverride.react"),{children:k.jsx(c("MWXIconForListCell.react"),{icon:c("MWXIconMenuItemTrash"),size:"large"})}),b[15]=f):f=b[15];b[16]===Symbol["for"]("react.memo_cache_sentinel")?(g=h._(/*BTDS*/"End-to-end encrypted messages will be deleted from your backup and you won\u2019t be able to restore them."),b[16]=g):g=b[16];b[17]===Symbol["for"]("react.memo_cache_sentinel")?(f=k.jsx(c("MWXListCell.react"),{addOnStart:f,content:k.jsx(c("MWXTextPairing.react"),{body:g,bodyColor:"secondary",headline:h._(/*BTDS*/"Messages currently saved in your backup will be deleted"),level:4})}),b[17]=f):f=b[17];b[18]===Symbol["for"]("react.memo_cache_sentinel")?(g=k.jsx(c("AddOnStartOverride.react"),{children:k.jsx(c("MWXIconForListCell.react"),{icon:c("MWXIconCloudUpload"),size:"large"})}),b[18]=g):g=b[18];var p;b[19]===Symbol["for"]("react.memo_cache_sentinel")?(p=h._(/*BTDS*/"You\u2019ll create a PIN to access your chats on any device."),b[19]=p):p=b[19];b[20]===Symbol["for"]("react.memo_cache_sentinel")?(g=k.jsx(c("MWXListCell.react"),{addOnStart:g,content:k.jsx(c("MWXTextPairing.react"),{body:p,bodyColor:"secondary",headline:h._(/*BTDS*/"New messages will be backed up so you can restore them"),level:4})}),b[20]=g):g=b[20];b[21]===Symbol["for"]("react.memo_cache_sentinel")?(p=k.jsx(c("AddOnStartOverride.react"),{children:k.jsx(c("MWXIconForListCell.react"),{icon:c("MWXIconMobile"),size:"large"})}),b[21]=p):p=b[21];var q;b[22]===Symbol["for"]("react.memo_cache_sentinel")?(q=h._(/*BTDS*/"You can send a notification to the Messenger app on your mobile device to reset your chat history."),b[22]=q):q=b[22];b[23]===Symbol["for"]("react.memo_cache_sentinel")?(f=k.jsx(c("MWXColumnItem.react"),{paddingHorizontal:0,children:k.jsxs(c("MWXList.react"),{children:[f,g,k.jsx(c("MWXListCell.react"),{addOnStart:p,content:k.jsx(c("MWXTextPairing.react"),{body:q,bodyColor:"secondary",headline:h._(/*BTDS*/"Send a request to your mobile device to get started"),level:4})})]})}),b[23]=f):f=b[23];b[24]!==j?(g=k.jsxs(c("MWXColumn.react"),{paddingHorizontal:16,ref:j,spacing:20,children:[i,n,f]}),b[24]=j,b[25]=g):g=b[25];b[26]!==g||b[27]!==o||b[28]!==a?(p=k.jsx(c("MWXDialogPage.react"),{footer:o,header:a,children:g}),b[26]=g,b[27]=o,b[28]=a,b[29]=p):p=b[29];return p}function m(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"PIN_CODE_RESTORE_UNTRUSTED_DEVICE_SEND_REQUEST_SCREEN")}g["default"]=a}),226);
__d("PAKEClientTypeEnum",[],(function(a,b,c,d,e,f){a=Object.freeze({PAKE_TEST:-1,ENCRYPTED_BACKUPS:0,EB_MULTI_USER_OTC:1});f["default"]=a}),66);
__d("MWEBRestoreDialog.react",["EOTRTypes","InteractionTracing.xplat","MAWEncryptedBackupsRestoreStep.react","MAWPinCodeGating","MWChatEncryptedBackupsDismissalDialogContext","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsQPLSource.enum","MWEBHasSeenAutoRestoreNoticeContext","MWEBNoMobileEOTRInformationalDialog.react","MWEBUntrustedMobileEOTRInformationalDialog.react","MWEBVirtualDevicesContext.react","MWEncryptedBackupsDeviceRegistrationId","MWEncryptedBackupsForgotRCStep","MWEncryptedBackupsRetrieveQplLoggingAnnotations","MWXMultiStepDialog_DEPRECATED.react","PAKECleanupSessionReasonEnum","PAKEClientTypeEnum","QPLUserFlow","cr:6320","cr:6321","promiseDone","react","requireDeferred","useEOTRPhaseTwoAndThree","useLabyrinthLogging","useMWAbandonRestoreConfirmationDialog","useMWEBFlowSourceContext","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||(i=d("react"));e=i;var k=e.useCallback,l=e.useContext,m=e.useEffect,n=e.useRef,o=c("requireDeferred")("CleanupPakeSession").__setRef("MWEBRestoreDialog.react"),p=c("requireDeferred")("mwEBCheckIfEBKeysExistInDisk").__setRef("MWEBRestoreDialog.react");function a(a){var e=a.cancellable;e=e===void 0?!0:e;var f=a.onClose,g=a.onDismissUpsell;a=a.skipToForgotPINStep;var i=a===void 0?!1:a,q=c("useEOTRPhaseTwoAndThree")(),r=n(!1),s=(h||(h=c("useReStore")))();a=d("useLabyrinthLogging").useLabyrinthLoggingFlow();var t=a.startFlow,u=c("useMWEBFlowSourceContext")();a=l(c("MWChatEncryptedBackupsDismissalDialogContext"));a=a.isDismissedDisabled;var v=d("MWEBVirtualDevicesContext.react").useMWEBVirtualDevices(),w=v.virtualDeviceInfo;v=l(c("MWEBHasSeenAutoRestoreNoticeContext"));var x=v.hasSeenNotice,y=k(function(){g==null||g(),w.doesUserHaveOtcEligibleDevices===!0&&o.onReady(function(a){c("promiseDone")(a({cleanupReason:c("PAKECleanupSessionReasonEnum").FLOW_ABANDONED,clientType:c("PAKEClientTypeEnum").ENCRYPTED_BACKUPS,deviceId:d("MWEncryptedBackupsDeviceRegistrationId").getDeviceRegistrationId(),storage:s}))})},[g,w.doesUserHaveOtcEligibleDevices,s]);v=k(function(){d("MWChatEncryptedBackupsLogging").closeDialogCancelFlow({event:d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,onClose:function(){return f()}}),y()},[f,y]);var z=c("useMWAbandonRestoreConfirmationDialog")(v),A=k(function(){d("MWChatEncryptedBackupsLogging").cancelFlow({cancelEndPoint:"reset_skip",event:d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent}),f(),y()},[f,y]),B=b("cr:6320")==null?void 0:b("cr:6320")(),C=b("cr:6321")==null?void 0:b("cr:6321")(),D=w.vestaClientID!=null;m(function(){r.current||(r.current=!0,d("MWEncryptedBackupsRetrieveQplLoggingAnnotations").encryptedBackupsRetrieveQplLoggingAnnotations({db:s,onFetch:function(a){var b=a.ebsmWiped,e=a.firstUpsellTime,f=a.hasEbKeysLocally,g=a.hasEBSM,h=a.hasPDB,i=a.hasUserRestoredBefore;a=a.hasUserRestoredBeforeTemp;var j=u();t({additionalAnnotations:{eb_session_identifier:e,ebsm_wiped:b,has_eb_keys_locally:f,has_ebsm:g,has_pdb:h,has_user_restored_before:i,has_user_restored_before_temp:a,restore_upsell_first_impression_time:e},event:d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,source:j});j===c("MWChatEncryptedBackupsQPLSource.enum").INBOX_INTERSTITIAL_SOFTBLOCK&&(c("InteractionTracing.xplat").getPendingInteractions().forEach(function(a){a.addAnnotationBoolean("eb_soft_block",!0)}),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"INBOX_SOFTBLOCK_RESTORE_SCREEN"));c("promiseDone")(p.load(),function(a){return a(f)})}}))},[u,t,s]);return j.jsx(c("MWXMultiStepDialog_DEPRECATED.react"),{onClose:a?f:z,size:"small",withCloseButton:e,children:function(a){var b=function(b){return B!=null?B({onNextStep:b,pushPage:a}):C!=null?C({hasSeenNotice:x,onNextStep:b,pushPage:a}):f()};return i?q===d("EOTRTypes").EOTRFlow.NO_MOBILE?j.jsx(c("MWEBNoMobileEOTRInformationalDialog.react"),{closeOnComplete:!0,onClose:f,onComplete:function(){b(f)}}):j.jsx(c("MWEBUntrustedMobileEOTRInformationalDialog.react"),{onClose:f,onComplete:function(){b(f)},pushPage:a}):j.jsx(c("MAWEncryptedBackupsRestoreStep.react"),{clientID:d("MAWPinCodeGating").isPinCodeEnabled()&&D?w.vestaClientID:null,offlineDevicesCount:w.offlineDevicesCount,onClose:z,onComplete:function(){b(f)},onForgotRC:function(){d("MWEncryptedBackupsForgotRCStep").pushForgotRCPage({onClose:f,onComplete:f,pushPage:a})},onSkip:A,pushPage:a,shouldShowForgotButton:!0,source:u()})}})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWEBRestoreInterstitialDialogWrapper_query.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MWEBRestoreInterstitialDialogWrapper_query",selections:[{args:null,kind:"FragmentSpread",name:"MAWEncryptedBackupsRestoreDialogContexts_query"}],type:"Query",abstractKey:null};e.exports=a}),null);
__d("MWEBRestoreInterstitialDialogWrapper.react",["CometRelay","MAWEncryptedBackupsRestoreDialogContexts.react","MWChatEncryptedBackupsQPLSource.enum","MWEBRestoreDialog.react","MWEBRestoreInterstitialDialogWrapper_query.graphql","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||d("react");function a(a){var e=d("react-compiler-runtime").c(9),f=a.query,g=a.setIsClosed,i=a.setIsDialogPersisted;a=a.setIsDismissed;f=d("CometRelay").useFragment(h!==void 0?h:h=b("MWEBRestoreInterstitialDialogWrapper_query.graphql"),f);var k=c("MWChatEncryptedBackupsQPLSource.enum").INBOX_INTERSTITIAL_SOFTBLOCK,l;e[0]!==g?(l=function(){return g(!0)},e[0]=g,e[1]=l):l=e[1];var m;e[2]!==a||e[3]!==l?(m=j.jsx(c("MWEBRestoreDialog.react"),{onClose:l,onDismissUpsell:a}),e[2]=a,e[3]=l,e[4]=m):m=e[4];e[5]!==f||e[6]!==i||e[7]!==m?(a=j.jsx(c("MAWEncryptedBackupsRestoreDialogContexts.react"),{query:f,setIsDialogPersisted:i,source:k,children:m}),e[5]=f,e[6]=i,e[7]=m,e[8]=a):a=e[8];return a}g["default"]=a}),98);
__d("MWEncryptedBackupsOTCShowNotificationSentToast",["fbt","FDSCheckmarkFilled24Icon","MWChatEncryptedBackupsQPLEvents","QPLUserFlow","SVGIcon","cr:4027","cr:6570","mwPushToast","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(){var a=b("cr:6570")?j.jsx(b("cr:6570"),{icon:c("FDSCheckmarkFilled24Icon")}):void 0,e=b("cr:4027")?d("SVGIcon").svgIcon(b("cr:4027")):void 0;d("mwPushToast").mwPushToast({body:h._(/*BTDS*/"Code sent."),icon:{comet:a,mds:e},testid:"mw-chat-encrypted-backups-otc-notification-sent-successful-toast"});c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_NOTIFICATION_SENT_SUCCESSFUL_TOAST")}g.showOTCNotificationSentToast=a}),226);
__d("MWEncrypedBackupsSendOTCNotifications",["FBLogger","I64","LSAuthorityLevel","LSEncryptedBackupsOpStatus","LSFactory","LSSendOTCNotificationsStoredProcedure","LSVec","MWEncryptedBackupsOTCShowNotificationSentToast","ReQL","ReQLSuspense","err","react","react-compiler-runtime","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;(i||d("react")).useCallback;async function k(a){var b=a.db,e=a.deviceIds;a=new Promise(function(a,e){var f=d("ReQL").fromTableAscending(b.tables.encrypted_backups_otc_notification_sending_status),g=f.subscribe(function(b,f){if(f.operation==="delete")return;b=f.value;if(b==null)return;f=(j||(j=d("I64"))).to_int32(b.authorityLevel);if(f!==c("LSAuthorityLevel").AUTHORITATIVE)return;g();switch((j||(j=d("I64"))).to_int32(b.notificationSendingStatus)){case c("LSEncryptedBackupsOpStatus").SUCCESS:d("MWEncryptedBackupsOTCShowNotificationSentToast").showOTCNotificationSentToast();return a();case c("LSEncryptedBackupsOpStatus").FAILURE:return e(c("err")("[sendOTCNotifications] Failure"));default:c("FBLogger")("labyrinth_web").mustfix("OTC: Unexpected UNKNOWN status type for notification sending result.");return e(c("err")("[sendOTCNotifications] Unknown"))}})});await b.runInTransaction(function(a){return c("LSSendOTCNotificationsStoredProcedure")(c("LSFactory")(a),{deviceIds:c("LSVec").ofArray(e!=null?e:[])})},"readwrite",void 0,void 0,f.id+":81");return a}function a(){var a,b=d("react-compiler-runtime").c(5),e=(h||(h=c("useReStore")))();a=(a=d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableAscending(e.tables.encrypted_backups_otc_notification_sending_status)},[e.tables.encrypted_backups_otc_notification_sending_status],f.id+":98"))==null?void 0:a.authorityLevel;a=a!=null&&(j||(j=d("I64"))).to_int32(a)===c("LSAuthorityLevel").OPTIMISTIC;var g;b[0]!==e?(g=function(a){return k({db:e,deviceIds:a})},b[0]=e,b[1]=g):g=b[1];g=g;var i;b[2]!==a||b[3]!==g?(i=[g,a],b[2]=a,b[3]=g,b[4]=i):i=b[4];return i}g.sendOTCNotifications=k;g.useSendOTCNotifications=a}),98);
__d("usePakeInitiatorManager",["FBLogger","PakeCpaceWasm","promiseDone","react","react-compiler-runtime","requireDeferred","useAsyncReStore"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");b.useCallback;var i=b.useEffect,j=b.useRef,k=c("requireDeferred")("establishPakeHandshakeAsInitiator").__setRef("usePakeInitiatorManager"),l=3e4;function a(a){var b=d("react-compiler-runtime").c(15),e=a.onGeneralFailure,f=a.onMaxAttemptsReached,g=a.onNoSessionExists,h=a.onSessionExpired,r=a.onSuccessfulSecretDecryption,s=a.onWrongOtc,t=a.timeout,u=a.clientType,v=t===void 0?l:t,w=c("useAsyncReStore")(),x=j(null),y=j(q),z=j(p),A=j(null),B=j(!1);b[0]===Symbol.for("react.memo_cache_sentinel")?(a=function(){var a;z.current();z.current=o;(a=x.current)==null||a.delete();x.current=null;y.current();y.current=n},b[0]=a):a=b[0];var C=a;b[1]===Symbol.for("react.memo_cache_sentinel")?(t=function(){B.current===!1&&(B.current=!0,c("promiseDone")(d("PakeCpaceWasm").PakeCPaceWasm().then(function(a){A.current=a}),void 0,m));return C},a=[C],b[1]=t,b[2]=a):(t=b[1],a=b[2]);i(t,a);b[3]!==u||b[4]!==w||b[5]!==e||b[6]!==f||b[7]!==g||b[8]!==h||b[9]!==r||b[10]!==s||b[11]!==v?(t=function(a){return Promise.all([w,k.load()]).then(async function(b){var c=b[0];b=b[1];b=await b({clientType:u,onGeneralFailure:e,onMaxAttemptsReached:f,onNoSessionExists:g,onSessionExpired:h,onSuccessfulSecretDecryption:function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];var d=b;C();r.apply(void 0,d)},onWrongOtc:s,otc:a,pakeCpaceModule:A.current,storage:c,timeout:v});c=b.pakeClient;var d=b.stopTimeout;b=b.unsubFromMessagesTable;x.current=c;y.current=d;z.current=b})},b[3]=u,b[4]=w,b[5]=e,b[6]=f,b[7]=g,b[8]=h,b[9]=r,b[10]=s,b[11]=v,b[12]=t):t=b[12];a=t;b[13]!==a?(t={establishPakeHandshakeAsInitiator:a},b[13]=a,b[14]=t):t=b[14];return t}function m(){c("FBLogger")("labyrinth_web").mustfix("PAKE: Error loading WASM module")}function n(){}function o(){}function p(){}function q(){}g.default=a}),98);
__d("MWEncryptedBackupsInsertOTCStep.react",["fbt","EBSMGatingUI","FBLogger","FocusRegion.react","JSResourceForInteraction","MWChatEncryptedBackupsDismissalDialogContext","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsNumericCodeErrorWrapper.react","MWChatEncryptedBackupsNumericCodeInput.react","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsSetIsDialogPersistedContext","MWEBEOTRDialog.entrypoint","MWEBLazyLoadResetPinPage","MWEBOTCErrorMessages","MWEBOTCGating","MWEBQPOneTimeCode.react","MWEBVirtualDevicesContext.react","MWEncrypedBackupsSendOTCNotifications","MWEncryptedBackupsLocalStorageEntryEnum","MWXColumn.react","MWXColumnItem.react","MWXDeferredPopoverTrigger.react","MWXDialogPageLegacy.react","MWXLink.react","MWXMultiStepDialogHeader.react","MWXRow.react","MWXRowItem.react","MWXSpinner.react","MWXText.react","PAKEClientTypeEnum","QPLUserFlow","focusScopeQueries","gkx","justknobx","promiseDone","react","requireDeferred","useAsyncReStore","useFetchOTCEligibleEBDevices","useMWChatEncryptedBackupsNumericCode","useMWEBFlowSourceContext","usePakeInitiatorManager","usePushFDSMultiStepDialogEntryPointPage","useVisibilityObserver"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;var k=b.useCallback,l=b.useContext,m=b.useEffect,n=b.useMemo,o=b.useRef,p=b.useState,q=c("requireDeferred")("MWEBUseLocalStorage").__setRef("MWEncryptedBackupsInsertOTCStep.react"),r=c("requireDeferred")("MWEncryptedBackupsFetchBackupIds").__setRef("MWEncryptedBackupsInsertOTCStep.react"),s=c("requireDeferred")("MWEncryptedBackupsOTCEligibleDevicesPopover.react").__setRef("MWEncryptedBackupsInsertOTCStep.react"),t=c("requireDeferred")("MWEncryptedBackupsSharedState").__setRef("MWEncryptedBackupsInsertOTCStep.react"),u=c("requireDeferred")("deserializeSecretsAndAddDevice").__setRef("MWEncryptedBackupsInsertOTCStep.react"),v=c("JSResourceForInteraction")("MWEBPushResetPinPage").__setRef("MWEncryptedBackupsInsertOTCStep.react"),w="chat-encrypted-backups-dialog-layout-second-step",x=6,y="https://www.facebook.com/help/messenger-app/431055522328649?ref=learn_more",z=c("gkx")("23219"),aa=c("gkx")("20861");function a(a){var b=a.isSecondStep,e=b===void 0?!1:b,f=a.onClose,g=a.onComplete,i=a.onSkip,A=a.onViewAllDevices,B=a.pushPage;b=p(!1);a=b[0];var C=b[1],D=o(!1),E=o(!1),F=o(function(){});b=p(null);var G=b[0],H=b[1],I=c("useAsyncReStore")();b=c("useFetchOTCEligibleEBDevices")(e?"store-or-network":"network-only");var J=b.triggerFetchOtcEligibleDevices,ba=c("useMWEBFlowSourceContext")(),K=l(c("MWChatEncryptedBackupsSetIsDialogPersistedContext")).setIsDialogPersisted;m(function(){return function(){F.current()}},[]);b=d("MWEncrypedBackupsSendOTCNotifications").useSendOTCNotifications();var L=b[0],M=b[1],N=k(function(){L()["catch"](function(){c("FBLogger")("labyrinth_web").mustfix("OTC: Send otc notifications sproc failed."),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_SEND_NOTIFICATION_FAILURE"),H(d("MWEBOTCErrorMessages").getNotificationFailedToSendErrorMessage())})},[L]);m(function(){D.current===!1&&(D.current=!0,c("promiseDone")(v.load()),e||N())},[e,N]);b=l(c("MWChatEncryptedBackupsDismissalDialogContext"));var O=b.setIsDismissedDisabled;b=d("MWEBVirtualDevicesContext.react").useMWEBVirtualDevices();var P=b.virtualDeviceInfo,Q=k(function(){P.vestaClientID!=null?(O(!0),c("MWEBLazyLoadResetPinPage")(g,B)):g()},[g,B,O,P.vestaClientID]);b=c("usePakeInitiatorManager")({clientType:c("PAKEClientTypeEnum").ENCRYPTED_BACKUPS,onGeneralFailure:k(function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_API_FAILURE"),H(d("MWEBOTCErrorMessages").getGeneralErrorMessage()),E.current=!0,C(!1),K==null||K(!1)},[K]),onMaxAttemptsReached:k(function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_MAX_ATTEMPTS_REACHED"),H(d("MWEBOTCErrorMessages").getMaxAttemptsReachedErrorMessage()),E.current=!0,C(!1)},[]),onNoSessionExists:k(function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_NO_SESSION"),H(d("MWEBOTCErrorMessages").getNoSessionOngoingErrorMessage()),E.current=!0,C(!1)},[]),onSessionExpired:k(function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_SESSION_EXPIRED"),H(d("MWEBOTCErrorMessages").getSessionExpiredErrorMessage()),E.current=!0,C(!1)},[]),onSuccessfulSecretDecryption:k(function(a){var b=a.decryptedSecret,e=a.initiatorId;K==null||K(!0);c("promiseDone")(u.load(),function(a){c("promiseDone")(I.then(function(f){return a({db:f,initiatorId:e,onAddDeviceFailure:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_ADD_DEVICE_FAILURE"),H(d("MWEBOTCErrorMessages").getGeneralErrorMessage()),E.current=!0,C(!1),K==null||K(!1)},onAddDeviceFinish:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_ADD_DEVICE_FINISHED"),d("MWChatEncryptedBackupsLogging").endSuccess({annotations:{bool:{is_backend_setup:d("EBSMGatingUI").isBackendSetupSuccessfulForEBSM()}},event:d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent}),t.onReady(function(a){a=a.upsertEBSharedStateEntry;c("promiseDone")(a({db:f,stateKey:c("MWEncryptedBackupsLocalStorageEntryEnum").ENCRYPTED_BACKUPS_RESTORED_SUCCESSFULLY}))}),q.onReady(function(a){var b=a.mwEBCreateLocalStorageEntry;a=a.mwEBDeleteLocalStorageEntry;b(c("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_RESTORED_IN_CURRENT_SESSION);b(c("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_RESTORED_IN_CURRENT_SESSION_2);a(c("MWEncryptedBackupsLocalStorageEntryEnum").EBSM_CORRUPTION_WIPE)}),Q(),C(!1),r.onReady(function(a){a=a.encryptedBackupsFetchBackupIds;a(f)["catch"](function(a){return c("FBLogger")("labyrinth_web").mustfix("OTC Restore: Error when fetching backup ids, %s",a)})})},secrets:b})}),function(a){F.current=a})})},[I,Q,K]),onWrongOtc:k(function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_INCORRECT_CODE"),H(d("MWEBOTCErrorMessages").getOtcIsWrongErrorMessage()),E.current=!0,C(!1)},[])});var ca=b.establishPakeHandshakeAsInitiator;b=d("useMWChatEncryptedBackupsNumericCode").useMWChatEncryptedBackupsNumericCode({focusRegionId:w,inputSize:x,onChange:function(){H()},onComplete:function(a){var b=ba();c("QPLUserFlow").addAnnotations(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,{string:{restore_type:"one_time_code",source:b}});C(!0);c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_SUBMIT");c("promiseDone")(ca(a))},type:"otc"});var da=b[0];b=b[1];var R=b.clearNumericInput,S=b.focusOnInput,T=b.isLoading,U=k(function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_RESEND_CLICK"),N(),S()},[S,N]);b=c("usePushFDSMultiStepDialogEntryPointPage")(c("MWEBEOTRDialog.entrypoint"),{});b[0];var V=b[1],W=k(function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_HELP_CLICK"),V({onClose:f,onSkip:i})},[f,i,V]);m(function(){E.current&&(R(),E.current=!1)},[R]);b=c("useVisibilityObserver")({onVisible:function(){c("QPLUserFlow").addAnnotations(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,{bool:{otc_check_first:e,otc_devices_popover:d("MWEBOTCGating").showDevicesPopover()}}),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_SCREEN"),S()}});var ea=d("MWEBOTCGating").showNewTitle()&&!e?h._(/*BTDS*/"Check Messenger or Facebook on your mobile device for a one-time code"):h._(/*BTDS*/"Enter your one-time code"),X=n(function(){return d("MWEBOTCGating").showResendButton()?{disabled:T||M,label:h._(/*BTDS*/"Resend code"),onPress:U,testid:"mw-eb-otc-insert-resend-code-button",type:"secondary"}:{disabled:T,label:h._(/*BTDS*/"View your devices"),onPress:function(){R(),H(),A({onFetchOtcEligibleDevicesError:function(){H(d("MWEBOTCErrorMessages").getFailedToFetchOtcDevicesErrorMessage()),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_FETCH_OTC_ELIGIBLE_DEVICES_FAILURE"),J()},onResendCodeFailure:function(){H(d("MWEBOTCErrorMessages").getNotificationFailedToSendErrorMessage()),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESEND_NOTIFICATION_FAILURE")}}),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_VIEW_ALL_DEVICES_CLICK")}}},[R,T,M,U,A,J]),Y=c("justknobx")._("4787"),Z=n(function(){return d("MWEBOTCGating").showResendButton&&!e?{label:h._(/*BTDS*/"Need help?"),linkProps:Y?{rel:"noreferrer",target:"_blank",url:y}:void 0,onPress:Y?void 0:W,testid:"mw-eb-otc-insert-help-button"}:void 0},[e,W,Y]),$=Z!=null;return j.jsxs(j.Fragment,{children:[j.jsx(c("MWXMultiStepDialogHeader.react"),{withCloseButton:!1,withoutBackButton:!0,withoutHeaderBottomBorder:!0}),j.jsx(c("MWXDialogPageLegacy.react"),{callToActionGroupLayout:"expanded",includeFDSContentPadding_REMOVE_THIS_AFTER_CONTENT_PADDING_MIGRATION:!1,primaryCallToAction:$&&!a?X:void 0,ref:b,secondaryCallToAction:$&&!a?Z:void 0,children:j.jsx("div",babelHelpers["extends"]({className:"x2lwn1j"},{children:j.jsxs(c("MWXColumn.react"),{align:"center",paddingHorizontal:16,paddingTop:16,paddingVertical:$&&!a?void 0:16,spacing:8,children:[j.jsx(c("MWXColumnItem.react"),{align:"center",paddingTop:16,children:j.jsx("div",babelHelpers["extends"]({className:"xg87l8a"},{children:j.jsx(c("MWEBQPOneTimeCode.react"),{})}))}),j.jsx(c("MWXColumnItem.react"),{align:"center",paddingVertical:16,children:j.jsx(c("MWXText.react"),{align:"center",isSemanticHeading:!0,type:"headlineEmphasized2",children:ea})}),!e&&j.jsx(c("MWXColumnItem.react"),{align:"center",children:j.jsx("div",babelHelpers["extends"]({className:"x1l90r2v x2b8uid"},{children:d("MWEBOTCGating").showDevicesPopover()?j.jsx(c("MWXDeferredPopoverTrigger.react"),{align:"middle",popoverProps:{},popoverResource:s,position:"above",children:function(a,b){return j.jsx(c("MWXText.react"),{color:"secondary",type:"body3",children:h._(/*BTDS*/"After confirming on {device} that you requested a code, you can enter it here.",[h._param("device",j.jsx(c("MWXText.react"),{color:"blueLink",ref:a,type:"bodyLink3",children:j.jsx(c("MWXLink.react"),{onClick:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_DEVICES_POPOVER_CLICK"),b()},testid:void 0,children:h._(/*BTDS*/"your mobile device")})}))])})}}):j.jsx(c("MWXText.react"),{color:"secondary",type:"body3",children:h._(/*BTDS*/"Check Messenger or Facebook on your mobile device for a one-time code. After confirming that you requested a code, you can enter it here.")})}))}),j.jsxs(c("MWXColumnItem.react"),{align:"center",children:[j.jsx(c("MWChatEncryptedBackupsNumericCodeErrorWrapper.react"),{error:G,children:j.jsx(d("FocusRegion.react").FocusRegion,{autoFocusQuery:d("focusScopeQueries").tabbableScopeQuery,id:w,children:j.jsx(c("MWChatEncryptedBackupsNumericCodeInput.react"),babelHelpers["extends"]({},da,{disabled:T||a,testid:void 0}))})}),aa&&G===d("MWEBOTCErrorMessages").getGeneralErrorMessage()?j.jsx("div",babelHelpers["extends"]({className:"xwib8y2"},{children:j.jsx(c("MWXText.react"),{align:"center",color:"negative",type:"body4",children:h._(/*BTDS*/"[meta-only] please rageshake from both devices (mobile and web) when reporting an OTC bug")})})):null]}),a&&j.jsx(c("MWXColumnItem.react"),{align:"center",paddingTop:$?16:0,paddingVertical:$?8:0,children:j.jsxs(c("MWXRow.react"),{align:"center",paddingTop:8,spacing:8,children:[j.jsx(c("MWXRowItem.react"),{verticalAlign:"center",children:j.jsx(c("MWXSpinner.react"),{color:z?"disabled_DEPRECATED":"blue",size:12})}),j.jsx(c("MWXRowItem.react"),{verticalAlign:"center",children:j.jsx(c("MWXText.react"),{color:"secondary",testid:void 0,type:"body3",children:h._(/*BTDS*/"Verifying your code")})})]})}),!$&&!a&&j.jsx(c("MWXColumnItem.react"),{align:"center",paddingTop:8,children:j.jsx(c("MWXText.react"),{color:X.disabled?"disabled":"highlight",type:"button2",children:j.jsx(c("MWXLink.react"),{disabled:X.disabled,onClick:X.onPress,rel:"noreferrer",children:X.label})})})]})}))})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("useMWEBAutoRestoreNoticeStep",["MWChatEncryptedBackupsDismissalDialogContext","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWEBUseLocalStorage","MWEncryptedBackupsLocalStorageEntryEnum","QPLUserFlow","ReQL","ReQLSuspense","deferredLoadComponent","react","react-compiler-runtime","requireDeferred","useLabyrinthLogging","useMWEBFlowSourceContext","useMWEBSetHasSeenNotice","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;b=j||d("react");var k=h||(h=c("react"));b.useCallback;var l=b.useContext,m=c("deferredLoadComponent")(c("requireDeferred")("MWEBAutoRestoreNoticeDialogStep.react").__setRef("useMWEBAutoRestoreNoticeStep"));function a(){var a=d("react-compiler-runtime").c(10),b=d("useLabyrinthLogging").useLabyrinthLoggingFlow(),e=b.startFlow;b=l(c("MWChatEncryptedBackupsDismissalDialogContext"));var g=b.setIsDismissedDisabled,h=c("useMWEBFlowSourceContext")(),j=(i||(i=c("useReStore")))();a[0]!==j.tables.auto_restore_opt_out?(b=function(){return d("ReQL").fromTableAscending(j.tables.auto_restore_opt_out)},a[0]=j.tables.auto_restore_opt_out,a[1]=b):b=a[1];var o;a[2]!==j?(o=[j],a[2]=j,a[3]=o):o=a[3];var p=d("ReQLSuspense").useArray(b,o,f.id+":55"),q=c("useMWEBSetHasSeenNotice")();a[4]!==p||a[5]!==h||a[6]!==q||a[7]!==g||a[8]!==e?(b=function(a){var b=a.hasSeenNotice,f=a.onNextStep,i=a.pushPage;a=p.filter(n).length>0;var j=function(){d("MWChatEncryptedBackupsLogging").endSuccess({event:d("MWChatEncryptedBackupsQPLEvents").restoreWithAutoRestoreConsentQplEvent}),f()};e({event:d("MWChatEncryptedBackupsQPLEvents").restoreWithAutoRestoreConsentQplEvent,source:h()});if(a){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreWithAutoRestoreConsentQplEvent,"AUTO_RESTORE_NOTICE_SCREEN_OPTED_OUT");j();return}c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreWithAutoRestoreConsentQplEvent,"AUTO_RESTORE_NOTICE_SCREEN_OPTED_IN");d("MWEBUseLocalStorage").mwEBCreateLocalStorageEntry(c("MWEncryptedBackupsLocalStorageEntryEnum").ENCRYPTED_BACKUPS_REMEMBER_BROWSER_CONSENT);if(b){j();return}g(!0);q();i(function(){return k.jsx(m,{onComplete:j,pushPage:i})},{withoutBackButton:!0,withoutCloseButton:!0})},a[4]=p,a[5]=h,a[6]=q,a[7]=g,a[8]=e,a[9]=b):b=a[9];return b}function n(a){return a.optOutKey===c("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_OPTED_OUT_OF_AUTO_RESTORE}g["default"]=a}),98);
__d("useMWResetAttachmentsRangesOnEBOnboard",["LSThreadMediaGalleryGroup","MAWFetchAndPersistMedia","MAWMediaRestoreEBRange","MWEBEntrypointsKillswitch.enum","promiseDone","react","react-compiler-runtime","useMWEBBackupState"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useEffect;function a(a){var b=d("react-compiler-runtime").c(8),e=a.thread;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(a={entrypoint:c("MWEBEntrypointsKillswitch.enum").MEDIA_GALLERY_RESTORE},b[0]=a):a=b[0];var f=c("useMWEBBackupState")(a);b[1]===Symbol["for"]("react.memo_cache_sentinel")?(a=d("MAWMediaRestoreEBRange").getMediaRestoreEBRange(),b[1]=a):a=b[1];var g=a,h;b[2]!==f||b[3]!==e.threadKey?(a=function(){f===3&&(g.resetRange(e.threadKey),c("promiseDone")(d("MAWFetchAndPersistMedia").updateLocalAttachmentsRange(e.threadKey,c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS,{hasMoreBefore:!0})))},h=[f,g,e.threadKey],b[2]=f,b[3]=e.threadKey,b[4]=a,b[5]=h):(a=b[4],h=b[5]);i(a,h);b[6]!==f?(a={backupState:f},b[6]=f,b[7]=a):a=b[7];return a}g["default"]=a}),98);/*FB_PKG_DELIM*/
__d("E2EEBackupSecretRestoreModule",["E2EEBackupCommon","QuickPerformanceLogger","VestaClient","VestaClientError","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("qpl")._(235874858,"168");async function a(a,b,e){(h||(h=c("QuickPerformanceLogger"))).markerStart(i);h.markerAnnotate(i,{string:{product_use_case:b.productUseCase}});try{var f=await a.initLogin({clientId:b.clientId,productUseCase:b.productUseCase},e),g=f.islandRsaPub,j=f.islandRsaPubSig,k=f.islandEd25519Pub,l=f.islandEd25519PubSig;f=f.isRegistered;(h||(h=c("QuickPerformanceLogger"))).markerPoint(i,"init_login_network_call");if(!f){(h||(h=c("QuickPerformanceLogger"))).markerAnnotate(i,{string:{failure_reason:"NOT_REGISTERED"}});h.markerEnd(i,3);throw new(d("E2EEBackupCommon").BackupError)(d("E2EEBackupCommon").BackupErrorType.NOT_REGISTERED)}f=await Promise.all([d("VestaClient").validateHsmKey(g,j),d("VestaClient").validateHsmKey(k,l)]);g=f[0];j=f[1];if(!g){(h||(h=c("QuickPerformanceLogger"))).markerAnnotate(i,{string:{failure_reason:"ISLAND_PUB_RSA_KEY_INVALID"}});h.markerEnd(i,3);throw new(d("E2EEBackupCommon").BackupError)(d("E2EEBackupCommon").BackupErrorType.ISLAND_PUB_RSA_KEY_INVALID)}if(!j){(h||(h=c("QuickPerformanceLogger"))).markerAnnotate(i,{string:{failure_reason:"ISLAND_PUB_ED25519_KEY_INVALID"}});h.markerEnd(i,3);throw new(d("E2EEBackupCommon").BackupError)(d("E2EEBackupCommon").BackupErrorType.ISLAND_PUB_ED25519_KEY_INVALID)}h.markerPoint(i,"verify_island_rsa_key");h.markerPoint(i,"verify_island_ed25519_key");l=b.vestaAccountPin;if(l==null)throw new(d("E2EEBackupCommon").BackupError)(d("E2EEBackupCommon").BackupErrorType.MISSING_PIN_INPUT);else{f=new TextEncoder();g=await d("VestaClient").beginLogin(f.encode(l));j=g.clientState;f=g.l1Message;(h||(h=c("QuickPerformanceLogger"))).markerPoint(i,"begin_login_vesta_client");l=await a.beginLogin({clientId:b.clientId,productUseCase:b.productUseCase,opaqueL1:f},e);g=l.opaqueL2;f=l.opaqueL2Sig;h.markerPoint(i,"begin_login_network_call");l=await d("VestaClient").finishLogin(g,f,k,j);g=l.exportKey;f=l.l3Message;k=l.sessionKey;h.markerPoint(i,"finish_login_vesta_client");j=await a.finishLogin({clientId:b.clientId,productUseCase:b.productUseCase,opaqueL3:f},e);l=j.loginSuccess;a=j.loginPayload;h.markerPoint(i,"finish_login_network_call");if(!l){(h||(h=c("QuickPerformanceLogger"))).markerAnnotate(i,{string:{failure_reason:"VESTA_SERVER_ERROR"}});h.markerEnd(i,3);throw new(d("E2EEBackupCommon").BackupError)(d("E2EEBackupCommon").BackupErrorType.VESTA_SERVER_ERROR)}if(a!=null){b=await d("VestaClient").unpackLoginPayload(a,k,g);f=b.userSecret;(h||(h=c("QuickPerformanceLogger"))).markerPoint(i,"unpack_login_payload");h.markerEnd(i,2);return f}h.markerAnnotate(i,{string:{failure_reason:"VESTA_SERVER_ERROR"}});h.markerEnd(i,3);throw new(d("E2EEBackupCommon").BackupError)(d("E2EEBackupCommon").BackupErrorType.VESTA_SERVER_ERROR)}}catch(a){if(a instanceof d("E2EEBackupCommon").BackupError)throw a;else if(a instanceof c("VestaClientError")){(h||(h=c("QuickPerformanceLogger"))).markerAnnotate(i,{string:{failure_reason:"VestaClientException: "+a.name}});h.markerEnd(i,3);if(a.name==="InvalidUserPassword")throw new(d("E2EEBackupCommon").BackupError)(d("E2EEBackupCommon").BackupErrorType.INVALID_PASSWORD,a);throw new(d("E2EEBackupCommon").BackupError)(d("E2EEBackupCommon").BackupErrorType.VESTA_CLIENT_ERROR,a)}else{(h||(h=c("QuickPerformanceLogger"))).markerAnnotate(i,{string:{failure_reason:a.message}});h.markerEnd(i,3);throw new(d("E2EEBackupCommon").BackupError)(d("E2EEBackupCommon").BackupErrorType.NETWORK_PROVIDER_ERROR,a)}}}g.restoreBackupSecret=a}),98);
__d("EOTRTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["OTC_ELIGIBLE_MOBILE","NO_MOBILE","UNTRUSTED_MOBILE"]);f.EOTRFlow=a}),66);
__d("MWChatEBPinCodeVerifyIndicator.react",["fbt","MWXRow.react","MWXRowItem.react","MWXSpinner.react","MWXText.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(a){var b=d("react-compiler-runtime").c(5);a=a.isMessenger;a=a?"disabled_DEPRECATED":"blue";var e;b[0]!==a?(e=j.jsx(c("MWXRowItem.react"),{verticalAlign:"center",children:j.jsx(c("MWXSpinner.react"),{color:a,size:12})}),b[0]=a,b[1]=e):e=b[1];b[2]===Symbol["for"]("react.memo_cache_sentinel")?(a=j.jsx(c("MWXRowItem.react"),{verticalAlign:"center",children:j.jsx(c("MWXText.react"),{color:"secondary",testid:void 0,type:"meta3",children:h._(/*BTDS*/"Verifying your PIN")})}),b[2]=a):a=b[2];b[3]!==e?(a=j.jsxs(c("MWXRow.react"),{align:"center",paddingTop:8,spacing:8,children:[e,a]}),b[3]=e,b[4]=a):a=b[4];return a}g["default"]=a}),226);
__d("MWChatEncryptedBackupsForgotPINDialogQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="29657246047255053"}),null);
__d("MWChatEncryptedBackupsForgotPINDialogQuery$Parameters",["MWChatEncryptedBackupsForgotPINDialogQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a={kind:"PreloadableConcreteRequest",params:{id:b("MWChatEncryptedBackupsForgotPINDialogQuery_facebookRelayOperation"),metadata:{},name:"MWChatEncryptedBackupsForgotPINDialogQuery",operationKind:"query",text:null}};e.exports=a}),null);
__d("MWChatEncryptedBackupsForgotPINDialog.entrypoint",["JSResourceForInteraction","MWChatEncryptedBackupsForgotPINDialogQuery$Parameters"],(function(a,b,c,d,e,f,g){"use strict";a={getPreloadProps:function(){return{queries:{queryReference:{parameters:c("MWChatEncryptedBackupsForgotPINDialogQuery$Parameters"),variables:{}}}}},root:c("JSResourceForInteraction")("MWChatEncryptedBackupsForgotPINDialog.react").__setRef("MWChatEncryptedBackupsForgotPINDialog.entrypoint")};g["default"]=a}),98);
__d("MWChatEncryptedBackupsForgotPinStepDialogPage.entrypoint",["JSResourceForInteraction"],(function(a,b,c,d,e,f,g){"use strict";a={getPreloadProps:function(){return{queries:{}}},root:c("JSResourceForInteraction")("MWChatEncryptedBackupsForgotPinStepDialogPage.react").__setRef("MWChatEncryptedBackupsForgotPinStepDialogPage.entrypoint")};g["default"]=a}),98);
__d("useEOTRPhaseTwoAndThree",["EOTRTypes","cr:10459","cr:10460"],(function(a,b,c,d,e,f,g){"use strict";function a(){return d("EOTRTypes").EOTRFlow.OTC_ELIGIBLE_MOBILE}f=(e=(c=b("cr:10459"))!=null?c:b("cr:10460"))!=null?e:a;g["default"]=f}),98);
__d("MWEncryptedBackupsForgotPinStep",["fbt","EOTRTypes","MAWEncryptedBackupsRestoreDialog.entrypoint","MWChatEncryptedBackupsForgotPINDialog.entrypoint","MWChatEncryptedBackupsForgotPinStepDialogPage.entrypoint","MWChatEncryptedBackupsQPLSource.enum","MWEBNoMobileEOTRInformationalDialog.entrypoint","MWEBUntrustedMobileEOTRInformationalDialog.entrypoint","MWEBVirtualDevicesContext.react","MWJewelPopoverDialogContext.react","QE2Logger","emptyFunction","qex","react","react-compiler-runtime","useEOTRPhaseTwoAndThree","useMWXEntryPointDialog","usePushPage"],(function(a,b,c,d,e,f,g,h){"use strict";var i=["onHighIntent"],j=["onHighIntent"],k=["onHighIntent"],l;l||(l=d("react"));var m=l.useContext,n=h._(/*BTDS*/"Forgot PIN?"),o=h._(/*BTDS*/"Need help?"),p="https://www.facebook.com/help/messenger-app/431055522328649?ref=learn_more";h=(f=(e=c("qex")._("3693"))!=null?e:c("qex")._("4656"))!=null?f:!1;var q=function(){d("QE2Logger").logExposureForUser("messenger_web_eotr")},r={children:h?n:o,href:p,onClick:q,rel:"noreferrer",target:"_blank"};function a(a){var b=d("react-compiler-runtime").c(40),e=a.offlineDevicesCount,f=a.onClose,g=a.onComplete,h=a.pushPage;a=c("useEOTRPhaseTwoAndThree")();var l;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(l={},b[0]=l):l=b[0];l=c("usePushPage")(c("MWEBNoMobileEOTRInformationalDialog.entrypoint"),l);var m=l[0];l=l[1];if(b[1]!==l){l.onHighIntent;var r=babelHelpers.objectWithoutPropertiesLoose(l,i);r=r;b[1]=l;b[2]=r}else r=b[2];b[3]===Symbol["for"]("react.memo_cache_sentinel")?(l={},b[3]=l):l=b[3];l=c("usePushPage")(c("MWEBUntrustedMobileEOTRInformationalDialog.entrypoint"),l);var s=l[0];l=l[1];if(b[4]!==l){l.onHighIntent;var t=babelHelpers.objectWithoutPropertiesLoose(l,j);t=t;b[4]=l;b[5]=t}else t=b[5];b[6]===Symbol["for"]("react.memo_cache_sentinel")?(l={},b[6]=l):l=b[6];l=c("usePushPage")(c("MWChatEncryptedBackupsForgotPinStepDialogPage.entrypoint"),l);var u=l[0];l=l[1];if(b[7]!==l){l.onHighIntent;var v=babelHelpers.objectWithoutPropertiesLoose(l,k);v=v;b[7]=l;b[8]=v}else v=b[8];if(a===d("EOTRTypes").EOTRFlow.NO_MOBILE){b[9]!==f||b[10]!==g||b[11]!==m?(l=function(){q(),m({onClose:f,onComplete:g})},b[9]=f,b[10]=g,b[11]=m,b[12]=l):l=b[12];var w;b[13]!==r.onHoverIn||b[14]!==r.onHoverOut||b[15]!==r.onPressIn||b[16]!==l?(w={children:n,onClick:l,onHoverEnd:r.onHoverOut,onHoverStart:r.onHoverIn,onPressStart:r.onPressIn},b[13]=r.onHoverIn,b[14]=r.onHoverOut,b[15]=r.onPressIn,b[16]=l,b[17]=w):w=b[17];return w}else if(a===d("EOTRTypes").EOTRFlow.UNTRUSTED_MOBILE){b[18]!==f||b[19]!==g||b[20]!==h||b[21]!==s?(r=function(){q(),s({onClose:f,onComplete:g,pushPage:h})},b[18]=f,b[19]=g,b[20]=h,b[21]=s,b[22]=r):r=b[22];b[23]!==r||b[24]!==t.onHoverIn||b[25]!==t.onHoverOut||b[26]!==t.onPressIn?(l={children:n,onClick:r,onHoverEnd:t.onHoverOut,onHoverStart:t.onHoverIn,onPressStart:t.onPressIn},b[23]=r,b[24]=t.onHoverIn,b[25]=t.onHoverOut,b[26]=t.onPressIn,b[27]=l):l=b[27];return l}var x=e>0;if(x){b[28]!==x||b[29]!==f||b[30]!==g||b[31]!==u||b[32]!==h?(w=function(){q(),u({isRCDeviceEnabled:x,onClose:f,onComplete:g,pushPage:h},{})},b[28]=x,b[29]=f,b[30]=g,b[31]=u,b[32]=h,b[33]=w):w=b[33];b[34]!==v.onHoverIn||b[35]!==v.onHoverOut||b[36]!==v.onPressIn||b[37]!==w?(a={children:o,onClick:w,onHoverEnd:v.onHoverOut,onHoverStart:v.onHoverIn,onPressStart:v.onPressIn},b[34]=v.onHoverIn,b[35]=v.onHoverOut,b[36]=v.onPressIn,b[37]=w,b[38]=a):a=b[38];return a}else{b[39]===Symbol["for"]("react.memo_cache_sentinel")?(r={children:o,href:p,onClick:q,rel:"noreferrer",target:"_blank"},b[39]=r):r=b[39];return r}}function b(a){var b=d("react-compiler-runtime").c(18);a=a.onDismiss;var e=a===void 0?c("emptyFunction"):a;a=c("useEOTRPhaseTwoAndThree")();var f;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(f={},b[0]=f):f=b[0];f=c("useMWXEntryPointDialog")(c("MAWEncryptedBackupsRestoreDialog.entrypoint"),f);var g=f[0];f=d("MWEBVirtualDevicesContext.react").useMWEBVirtualDevices();f=f.virtualDeviceInfo;f=f.offlineDevicesCount;var h=m(c("MWJewelPopoverDialogContext.react")),i=h.setIsOpenForDialog;b[1]===Symbol["for"]("react.memo_cache_sentinel")?(h={},b[1]=h):h=b[1];h=c("useMWXEntryPointDialog")(c("MWChatEncryptedBackupsForgotPINDialog.entrypoint"),h);var j,k;b[2]!==h?(k=h[0],j=h.slice(1),b[2]=h,b[3]=j,b[4]=k):(j=b[3],k=b[4]);if(a===d("EOTRTypes").EOTRFlow.NO_MOBILE){b[5]!==g?(h={children:n,onClick:function(){q(),g({onDismissUpsell:c("emptyFunction"),skipToForgotPINStep:!0,source:c("MWChatEncryptedBackupsQPLSource.enum").JEWEL_THREADLIST_QP})}},b[5]=g,b[6]=h):h=b[6];return h}else if(a===d("EOTRTypes").EOTRFlow.UNTRUSTED_MOBILE){b[7]!==g?(h={children:n,onClick:function(){q(),g({onDismissUpsell:c("emptyFunction"),skipToForgotPINStep:!0,source:c("MWChatEncryptedBackupsQPLSource.enum").JEWEL_THREADLIST_QP})}},b[7]=g,b[8]=h):h=b[8];return h}a=f>0;if(a){h=j;f=h[0];a=h[1];j=h[2];b[9]!==e||b[10]!==i||b[11]!==k?(h=function(){q(),i(!0),k({onDismiss:e})},b[9]=e,b[10]=i,b[11]=k,b[12]=h):h=b[12];var l;b[13]!==a||b[14]!==f||b[15]!==j||b[16]!==h?(l={children:o,onClick:h,onHoverEnd:a,onHoverStart:f,onPressStart:j},b[13]=a,b[14]=f,b[15]=j,b[16]=h,b[17]=l):l=b[17];return l}else return r}g.STATIC_HELP_CENTER_PROPS=r;g.useForgotPinLinkPushPageProps=a;g.useForgotPinLinkShowDialogProps=b}),226);
__d("MWChatEncryptedBackupsRestoreJewelForgotPinButtonSuspender.react",["MWEncryptedBackupsForgotPinStep","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h=["children","href","onClick","onHoverEnd","onHoverStart","onPressStart","rel","target"],i;i||d("react");function a(a){var b=d("react-compiler-runtime").c(24),c=a.children;a=a.dismissSoftblock;var e;b[0]!==a?(e={onDismiss:a},b[0]=a,b[1]=e):e=b[1];a=d("MWEncryptedBackupsForgotPinStep").useForgotPinLinkShowDialogProps(e);var f,g,i,j,k,l,m,n;b[2]!==a?(e=a.children,g=a.href,i=a.onClick,j=a.onHoverEnd,k=a.onHoverStart,l=a.onPressStart,m=a.rel,n=a.target,f=babelHelpers.objectWithoutPropertiesLoose(a,h),b[2]=a,b[3]=f,b[4]=g,b[5]=e,b[6]=i,b[7]=j,b[8]=k,b[9]=l,b[10]=m,b[11]=n):(f=b[3],g=b[4],e=b[5],i=b[6],j=b[7],k=b[8],l=b[9],m=b[10],n=b[11]);if(b[12]!==c||b[13]!==f||b[14]!==a||b[15]!==g||b[16]!==e||b[17]!==i||b[18]!==j||b[19]!==k||b[20]!==l||b[21]!==m||b[22]!==n){var o=babelHelpers["extends"]({},f,{label:e,linkProps:g!=null?{rel:m,target:n,url:g}:void 0,onHoverIn:k,onHoverOut:j,onPress:i,onPressIn:l});o=c({buttonProps:o,linkProps:a});b[12]=c;b[13]=f;b[14]=a;b[15]=g;b[16]=e;b[17]=i;b[18]=j;b[19]=k;b[20]=l;b[21]=m;b[22]=n;b[23]=o}else o=b[23];return o}g["default"]=a}),98);
__d("MWChatEncryptedBackupsSetIsDialogPersistedContext",["react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h||d("react");b=a.createContext({setIsDialogPersisted:function(){}});g["default"]=b}),98);
__d("MWChatEncryptedBackupsSettingsDialogQuery.graphql",["MWChatEncryptedBackupsSettingsDialogQuery_facebookRelayOperation","relay-runtime"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:!1,kind:"LocalArgument",name:"labyrinthOnePointOneSecurityUX"}],c={alias:null,args:null,kind:"ScalarField",name:"has_seen_eb_auto_restore_notice",storageKey:null},d={alias:null,args:[{kind:"Literal",name:"family_device_id",value:""}],kind:"ScalarField",name:"has_otc_eligible_devices",storageKey:'has_otc_eligible_devices(family_device_id:"")'},e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"MWChatEncryptedBackupsSettingsDialogQuery",selections:[{kind:"RequiredField",field:{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerDefaultEncryptedBackup",kind:"LinkedField",name:"messenger_default_encrypted_backup",plural:!1,selections:[{alias:null,args:null,concreteType:"VestaGetUserInfoResponse",kind:"LinkedField",name:"vesta_user_info",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"useMWChatEncryptedBackupsVestaUserInfo_vestaGetUserInfoResponse"}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"encrypted_backup",plural:!1,selections:[c],storageKey:null}],storageKey:null},action:"THROW",path:"viewer"},{args:[{kind:"Variable",name:"labyrinthOnePointOneSecurityUX",variableName:"labyrinthOnePointOneSecurityUX"}],kind:"FragmentSpread",name:"MWChatEncryptedBackupsSettingsDialogStep_query"},{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"xfb_backup",plural:!1,selections:[d,{args:null,kind:"FragmentSpread",name:"useMWEncryptedBackupsGetVirtualDevicesPreloaded_xfbEncryptedBackup"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"MWChatEncryptedBackupsSettingsDialogQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerDefaultEncryptedBackup",kind:"LinkedField",name:"messenger_default_encrypted_backup",plural:!1,selections:[{alias:null,args:null,concreteType:"VestaGetUserInfoResponse",kind:"LinkedField",name:"vesta_user_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"attempts_remaining",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_registered",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"login_timeout_remaining_secs",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"encrypted_backup",plural:!1,selections:[c,e],storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"backup_state",storageKey:null}]},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"actor",plural:!1,selections:[f,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"encrypted_backup_encryption_management_delegator_id",storageKey:null}],type:"User",abstractKey:null},e],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"xfb_backup",plural:!1,selections:[f,e,{alias:null,args:null,kind:"ScalarField",name:"last_sync_time",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"backup_creation_time",storageKey:null},{condition:"labyrinthOnePointOneSecurityUX",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"allow_sender_backup",storageKey:null}]},d,{alias:null,args:null,concreteType:"XFBEBVirtualDevice",kind:"LinkedField",name:"virtual_devices",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"client_generated_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"device_type",storageKey:null},e],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"logout_whitelist",storageKey:null}]},params:{id:b("MWChatEncryptedBackupsSettingsDialogQuery_facebookRelayOperation"),metadata:{},name:"MWChatEncryptedBackupsSettingsDialogQuery",operationKind:"query",text:null}}}();b("relay-runtime").PreloadableQueryRegistry.set(a.params.id,a);e.exports=a}),null);
__d("MWEBOTCDialog.entrypoint",["JSResourceForInteraction"],(function(a,b,c,d,e,f,g){"use strict";a={getPreloadProps:function(){return{queries:{}}},root:c("JSResourceForInteraction")("MWEBOTCDialog.react").__setRef("MWEBOTCDialog.entrypoint")};g["default"]=a}),98);
__d("MWEBQPWithPinState.enum",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({INITIAL:0,RESTORE_IN_PROGRESS:1});c=a;f["default"]=c}),66);
__d("MWEBRestoreQPWithPin_viewer.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MWEBRestoreQPWithPin_viewer",selections:[{alias:null,args:null,concreteType:"MessengerDefaultEncryptedBackup",kind:"LinkedField",name:"messenger_default_encrypted_backup",plural:!1,selections:[{alias:null,args:null,concreteType:"VestaGetUserInfoResponse",kind:"LinkedField",name:"vesta_user_info",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"useMWChatEncryptedBackupsVestaUserInfo_vestaGetUserInfoResponse"}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"encrypted_backup",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"has_seen_eb_auto_restore_notice",storageKey:null}],storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"qp_with_pin_state",storageKey:null}]}],type:"Viewer",abstractKey:null};e.exports=a}),null);
__d("useMWChatEncryptedBackupsAddDevice",["EBMainThreadEBDBApiDeferred","LSDataTraceCheckPoint","LSIntEnum","MAWTraceUtils","Promise","promiseDone","react","react-compiler-runtime","requireDeferred","useAsyncReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;e=j||d("react");e.useCallback;var k=e.useRef,l=e.useState,m=c("requireDeferred")("MAWEncryptedBackupsClearRecoveryCode").__setRef("useMWChatEncryptedBackupsAddDevice"),n=c("requireDeferred")("MWEncryptedBackupsFetchBackupIds").__setRef("useMWChatEncryptedBackupsAddDevice"),o=c("requireDeferred")("mwEBAddDevice").__setRef("useMWChatEncryptedBackupsAddDevice");function a(a){var e=d("react-compiler-runtime").c(12),f=a.environment,g=a.hsmFleetMigrationResetPIN,j=a.onComplete,s=a.onFailure,t=a.onInvalidRecoveryCode,u=a.onStart;a=l(!1);var v=a[0],w=a[1];e[0]===Symbol["for"]("react.memo_cache_sentinel")?(a=function(){w(!1)},e[0]=a):a=e[0];var x=a,y=c("useAsyncReStore")(),z=k("");e[1]!==y||e[2]!==f||e[3]!==g||e[4]!==j||e[5]!==s||e[6]!==t||e[7]!==u?(a=function(a,e,k){z.current=k||"",c("promiseDone")((h||(h=b("Promise"))).all([y,m.load(),o.load().then(r),n.load()]),function(h){var k=h[0],b=h[1],l=h[2];h=h[3];b=b.encryptedBackupsClearRecoveryCode;var m=h.encryptedBackupsFetchBackupIds;return c("promiseDone")(b(k),function(){var b={onFailure:function(a){x(),s(a),e!=null&&d("MAWTraceUtils").recordFailureAndFlushForTraceId(e,(i||(i=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_PIN_RESTORE_FAILURE),[],"Add Device Failure")},onInvalidRecoveryCode:function(){x(),t()},onStart:function(){w(!0),e!=null&&d("MAWTraceUtils").recordSuccessAndFlushForTraceId(e,(i||(i=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_PLUGIN_CALLING_INITIALIZE_RESTORE),[]),u==null||u()},onSuccess:function(){c("promiseDone")(m(k)),x(),j(),g&&z.current!==""&&g(z.current)},recoveryCode:a,storage:k};return l(babelHelpers["extends"]({},b,{environment:f,traceId:d("MAWTraceUtils").stringToTraceId(e),trackAddingDevice:q,trackOverprompting:p}))})})},e[1]=y,e[2]=f,e[3]=g,e[4]=j,e[5]=s,e[6]=t,e[7]=u,e[8]=a):a=e[8];a=a;var A;e[9]!==v||e[10]!==a?(A=[a,v],e[9]=v,e[10]=a,e[11]=A):A=e[11];return A}function p(a){return d("EBMainThreadEBDBApiDeferred").trackOverprompting(a)}function q(){return d("EBMainThreadEBDBApiDeferred").addNewDevice()}function r(a){return a.EBAddDevice}g["default"]=a}),98);
__d("useMWChatEncryptedBackupsPinCodeRestore",["CometRelay","EBSMGatingUI","JSResourceForInteraction","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsSetIsDialogPersistedContext","MWEBODSEntityName.enum","MWEBPinCodeSize","MWEBUpsellDismissedEnum.facebook","MWEncryptedBackupsLocalStorageEntryEnum","QPLUserFlow","promiseDone","react","react-compiler-runtime","requireDeferred","useLabyrinthLogging","useMWChatEncryptedBackupsAddDevice","useMWChatEncryptedBackupsNumericCode","useMWEBFlowSourceContext","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i;b=i||d("react");b.useCallback;var j=b.useContext,k=b.useEffect,l=b.useRef,m=b.useState,n=c("requireDeferred")("MWEBUseLocalStorage").__setRef("useMWChatEncryptedBackupsPinCodeRestore"),o=c("requireDeferred")("MWEncryptedBackupsSharedState").__setRef("useMWChatEncryptedBackupsPinCodeRestore"),p=c("requireDeferred")("mwEBGetPINSecretFromVesta").__setRef("useMWChatEncryptedBackupsPinCodeRestore"),q=c("requireDeferred")("updateUpsellsStateInRelayStore").__setRef("useMWChatEncryptedBackupsPinCodeRestore"),r=c("JSResourceForInteraction")("MWEncryptedBackupsHsmFleetMigrationGated").__setRef("useMWChatEncryptedBackupsPinCodeRestore");function a(a){var b=d("react-compiler-runtime").c(47),e=a.clientID,f=a.focusRegionId,g=a.onSubmitPin,i=a.onSubmitPinFailure,t=a.onVestaComplete,u=d("CometRelay").useRelayEnvironment();a=m(!1);var v=a[0],w=a[1];a=m(!1);var x=a[0],y=a[1];a=m(!1);var z=a[0],A=a[1],B=l(!1);a=d("useLabyrinthLogging").useLabyrinthLoggingFlow();var C=a.startFlow,D=(h||(h=c("useReStore")))(),E=c("useMWEBFlowSourceContext")();a=m(!1);var F=a[0],G=a[1],H=j(c("MWChatEncryptedBackupsSetIsDialogPersistedContext")).setIsDialogPersisted;b[0]!==D||b[1]!==u||b[2]!==C?(a=function(a){c("promiseDone")(r.load().then(function(b){b({db:D,environment:u,pinCode:a,startFlow:C})}))},b[0]=D,b[1]=u,b[2]=C,b[3]=a):a=b[3];a=a;var I;b[4]!==D||b[5]!==u||b[6]!==t?(I=function(){var a;c("QPLUserFlow").addPoint((a=d("MWChatEncryptedBackupsQPLEvents")).restoreDeviceAuthQplEvent,"add_device_success");c("QPLUserFlow").addPoint(a.restoreQplEvent,"restore_auth_finished_and_dismissed");o.onReady(function(a){a=a.upsertEBSharedStateEntry;c("promiseDone")(a({db:D,stateKey:c("MWEncryptedBackupsLocalStorageEntryEnum").ENCRYPTED_BACKUPS_RESTORED_SUCCESSFULLY}))});n.onReady(s);d("MWChatEncryptedBackupsLogging").endSuccess({annotations:{bool:{is_backend_setup:d("EBSMGatingUI").isBackendSetupSuccessfulForEBSM()}},event:a.restoreQplEvent});d("MWChatEncryptedBackupsLogging").endSuccess({event:a.restoreDeviceAuthQplEvent,odsEntityName:c("MWEBODSEntityName.enum").MW_EB_PIN_RESTORE_AUTH});t();G(!1);c("promiseDone")(q.load(),function(a){a({environment:u,updateValue:d("MWEBUpsellDismissedEnum.facebook").MWEBUpsellDismissedStateEnum.UPSELLS_DISMISSED})})},b[4]=D,b[5]=u,b[6]=t,b[7]=I):I=b[7];I=I;var J;b[8]!==u||b[9]!==i||b[10]!==H?(J=function(a){i==null||i(),B.current=!0,y(!0),G(!1),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,a),d("MWChatEncryptedBackupsLogging").endFailure({errorName:a,event:d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityName:c("MWEBODSEntityName.enum").MW_EB_PIN_RESTORE_AUTH}),c("promiseDone")(q.load(),function(a){a({environment:u,updateValue:d("MWEBUpsellDismissedEnum.facebook").MWEBUpsellDismissedStateEnum.NOT_DISMISSED})}),H==null||H(!1)},b[8]=u,b[9]=i,b[10]=H,b[11]=J):J=b[11];J=J;var K;b[12]!==u||b[13]!==i||b[14]!==H?(K=function(){i==null||i(),B.current=!0,y(!0),G(!1),d("MWChatEncryptedBackupsLogging").endFailure({errorName:"pin_code_restore_wrong_recovery_code",event:d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityName:c("MWEBODSEntityName.enum").MW_EB_PIN_RESTORE_AUTH}),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"pin_code_restore_wrong_recovery_code"),c("promiseDone")(q.load(),function(a){a({environment:u,updateValue:d("MWEBUpsellDismissedEnum.facebook").MWEBUpsellDismissedStateEnum.NOT_DISMISSED})}),H==null||H(!1)},b[12]=u,b[13]=i,b[14]=H,b[15]=K):K=b[15];K=K;var L;b[16]!==u||b[17]!==a||b[18]!==I||b[19]!==J||b[20]!==K?(L={environment:u,hsmFleetMigrationResetPIN:a,onComplete:I,onFailure:J,onInvalidRecoveryCode:K},b[16]=u,b[17]=a,b[18]=I,b[19]=J,b[20]=K,b[21]=L):L=b[21];a=c("useMWChatEncryptedBackupsAddDevice")(L);var M=a[0];b[22]===Symbol.for("react.memo_cache_sentinel")?(I=function(){y(!1),A(!1),w(!1)},b[22]=I):I=b[22];b[23]!==M||b[24]!==e||b[25]!==u||b[26]!==E||b[27]!==g||b[28]!==i||b[29]!==H||b[30]!==C?(J=async function(a){var b=await p.load();await b({addDevice:M,clientID:e,environment:u,getSourceFromContext:E,onSubmitPin:g,onSubmitPinFailure:i,onVestaSecretFetch:function(){H==null||H(!0)},pinCode:a,productUseCase:"MSGR_ENC_BACKUP",setIsInProgress:G,setIsPinCodeIncorrect:w,setIsVestaError:A,startFlow:C})},b[23]=M,b[24]=e,b[25]=u,b[26]=E,b[27]=g,b[28]=i,b[29]=H,b[30]=C,b[31]=J):J=b[31];b[32]!==f||b[33]!==J?(K={enableMasking:!0,focusRegionId:f,inputSize:d("MWEBPinCodeSize").EB_PIN_CODE_SIZE,onChange:I,onComplete:J,type:"pin"},b[32]=f,b[33]=J,b[34]=K):K=b[34];L=d("useMWChatEncryptedBackupsNumericCode").useMWChatEncryptedBackupsNumericCode(K);a=L[0];I=L[1];var N=I.clearNumericInput;f=I.disabled;J=I.focusOnInput;K=I.invalidKeyPressedError;b[35]!==N?(L=function(){B.current&&(N(),B.current=!1)},I=[N],b[35]=N,b[36]=L,b[37]=I):(L=b[36],I=b[37]);k(L,I);L=f!=null?f:!1;b[38]!==J||b[39]!==a||b[40]!==K||b[41]!==F||b[42]!==x||b[43]!==v||b[44]!==z||b[45]!==L?(I={focusOnInput:J,inputProps:a,invalidKeyPressedError:K,isDisabled:L,isInProgress:F,isLabyrinthError:x,isPinCodeIncorrect:v,isVestaError:z},b[38]=J,b[39]=a,b[40]=K,b[41]=F,b[42]=x,b[43]=v,b[44]=z,b[45]=L,b[46]=I):I=b[46];return I}function s(a){var b=a.mwEBCreateLocalStorageEntry;a=a.mwEBDeleteLocalStorageEntry;b(c("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_RESTORED_IN_CURRENT_SESSION);b(c("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_RESTORED_IN_CURRENT_SESSION_2);a(c("MWEncryptedBackupsLocalStorageEntryEnum").EBSM_CORRUPTION_WIPE)}g.useMWChatEncryptedBackupsPinCodeRestore=a}),98);
__d("MWEBRestoreQPWithPin.react",["fbt","CometPlaceholder.react","CometRelay","CometVisualCompletionAttributes","EncryptedBackupsSupportedPlatformUtils","FBLogger","FocusRegion.react","JSResourceForInteraction","MWChatEBPinCodeVerifyIndicator.react","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsNumericCodeErrorWrapper.react","MWChatEncryptedBackupsNumericCodeInput.react","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsQPLSource.enum","MWChatEncryptedBackupsRestoreJewelForgotPinButtonSuspender.react","MWEBFlowSourceContextProvider.react","MWEBOTCDialog.entrypoint","MWEBQPWithPinState.enum","MWEBRestoreQPWithPin_viewer.graphql","MWEncryptedBackupsForgotPinStep","MWEncryptedBackupsRetrieveQplLoggingAnnotations","MWJewelPopoverDialogContext.react","MWLogInboxFiltersInteraction","MWLogInteraction","MWXCircleButton.react","MWXColumn.react","MWXColumnItem.react","MWXIconCross","MWXImage.react","MWXLink.react","MWXRow.react","MWXRowItem.react","MWXText.react","QPLUserFlow","cr:6334","cr:6335","focusScopeQueries","getMWEBRestoreQPCautionCircleProperties","gkx","promiseDone","react","react-compiler-runtime","useAsyncReStore","useLabyrinthLogging","useMWChatEncryptedBackupsPinCodeRestore","useMWChatEncryptedBackupsVestaUserInfo","useMWEBFlowSourceContext","useMWXEntryPointDialog","useMWXLazyDialog","useVisibilityObserver"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||(j=d("react"));e=j;var l=e.useCallback,m=e.useContext,n=e.useEffect,o=e.useMemo,p=e.useRef,q=e.useState,r=c("JSResourceForInteraction")("MWChatEncryptedBackupsPinCodeBlockedDialog.react").__setRef("MWEBRestoreQPWithPin.react"),s="chat-encrypted-backups-jewel-qp-with-pin-input",t={icon:{paddingTop:"x889kno",$$css:!0}};function u(a){var e,f,g=a.clientID,j=a.doesUserHaveOtcEligibleDevices,u=a.fragmentKey,v=a.isInbox,w=a.setClosed,x=a.setDismissed,y=d("CometRelay").useFragment(i!==void 0?i:i=b("MWEBRestoreQPWithPin_viewer.graphql"),u),z=d("CometRelay").useRelayEnvironment(),A=l(function(a){return d("CometRelay").commitLocalUpdate(z,function(b){b=b.getRoot().getLinkedRecord("viewer");if(b==null){c("FBLogger")("labyrinth_web").mustfix("[labyrinth][jewel_softblock_state] A viewer record does not exist when propagating EB restore qp with pin state");return}b.setValue(a,"qp_with_pin_state")})},[z]);a=y==null||(e=y.messenger_default_encrypted_backup)==null?void 0:e.vesta_user_info;var B=c("useMWChatEncryptedBackupsVestaUserInfo")({vestaGetUserInfoResponse$key:a}),C=B.attemptsRemaining===0||B.loginTimeoutRemainingSecs!=null;u=q(!1);var D=u[0],E=u[1],F=p(!1);a=c("useMWXLazyDialog")(r);var G=a[0];n(function(){C&&D===!0&&F.current!==!0&&(F.current=!0,G({attemptsRemaining:B.attemptsRemaining,loginTimeoutRemainingSecs:B.loginTimeoutRemainingSecs,onDismiss:function(){}}))},[C,G,D,B.attemptsRemaining,B.loginTimeoutRemainingSecs]);u=d("useLabyrinthLogging").useLabyrinthLoggingFlow();var H=u.startFlow,I=c("useAsyncReStore")(),J=c("useMWEBFlowSourceContext")(),K=o(function(){return J()},[J]),L=l(function(a){c("promiseDone")(I.then(function(b){d("MWEncryptedBackupsRetrieveQplLoggingAnnotations").encryptedBackupsRetrieveQplLoggingAnnotations({db:b,onFetch:function(b){var e=b.ebsmWiped,f=b.firstUpsellTime,g=b.hasEbKeysLocally,h=b.hasEBSM,i=b.hasPDB,k=b.hasUserRestoredBefore;b=b.hasUserRestoredBeforeTemp;H({additionalAnnotations:{eb_session_identifier:f,ebsm_wiped:e,has_eb_keys_locally:g,has_ebsm:h,has_pdb:i,has_user_restored_before:k,has_user_restored_before_temp:b,is_otc_eligible:j.toString(),is_pin_set:"true",restore_upsell_first_impression_time:f},event:d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,source:K});c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,a)}})}))},[I,H,j,K]);a=l(function(){var a=v?"RESTORE_QP_WITH_PIN_INBOX_DISMISSED":"RESTORE_QP_WITH_PIN_JEWEL_DISMISSED";L(a);d("MWChatEncryptedBackupsLogging").cancelFlow({cancelEndPoint:"thread_list_qp_with_pin",event:d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent});w();x()},[v,w,x,L]);u=m(c("MWJewelPopoverDialogContext.react"));var M=u.setIsOpenForDialog,N=b("cr:6334")==null?void 0:b("cr:6334")(),O=b("cr:6335")==null?void 0:b("cr:6335")();u=l(function(){w();if(N!=null)N(K);else if(O!=null){var a,b;O({hasSeenNotice:(a=y==null||(b=y.encrypted_backup)==null?void 0:b.has_seen_eb_auto_restore_notice)!=null?a:!1,source:K})}M(!0);A(c("MWEBQPWithPinState.enum").INITIAL)},[w,N,O,A,K,M,y==null||(f=y.encrypted_backup)==null?void 0:f.has_seen_eb_auto_restore_notice]);g=d("useMWChatEncryptedBackupsPinCodeRestore").useMWChatEncryptedBackupsPinCodeRestore({clientID:g,focusRegionId:s,onSubmitPin:function(){E(!0),d("MWLogInteraction").logPopoverOpenCancel("initiate_restore"),d("MWLogInboxFiltersInteraction").logInboxFiltersNavigationCancel("initiate_restore"),A(c("MWEBQPWithPinState.enum").RESTORE_IN_PROGRESS)},onSubmitPinFailure:function(){A(c("MWEBQPWithPinState.enum").INITIAL)},onVestaComplete:u});u=g.inputProps;var P=g.invalidKeyPressedError,Q=g.isInProgress,R=g.isLabyrinthError,S=g.isPinCodeIncorrect;g=g.isVestaError;Q=(y==null?void 0:y.qp_with_pin_state)===c("MWEBQPWithPinState.enum").RESTORE_IN_PROGRESS||Q;var T=c("useVisibilityObserver")({onVisible:function(){d("FocusRegion.react").focusRegionById(s,d("focusScopeQueries").tabbableScopeQuery);var a=v?"RESTORE_QP_WITH_PIN_INBOX_IMPRESSION":"RESTORE_QP_WITH_PIN_JEWEL_IMPRESSION";L(a)}}),U=c("useMWXEntryPointDialog")(c("MWEBOTCDialog.entrypoint"),{}),V=U[0],W=l(function(){V({source:v?c("MWChatEncryptedBackupsQPLSource.enum").INBOX_THREADLIST_QP:c("MWChatEncryptedBackupsQPLSource.enum").JEWEL_THREADLIST_QP},function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_CLOSE_DIALOG_CLICK")})},[v,V]);U=P!=null?P:S?h._(/*BTDS*/"Incorrect PIN. Try again."):R||g?h._(/*BTDS*/"There was an error while using the PIN Code, please try again"):void 0;if(C===!0){w();return null}P=c("gkx")("23219");return k.jsx("div",babelHelpers["extends"]({},{0:{className:"xlhe6ec x1obq294 x5a5i1n xde0f50 x15x8krk xe4pinz x14vqqas x1ys307a xod5an3 xyqm7xq xz9dl7a xpdmqnj xsag5q8 x1g0dm76"},1:{className:"x1obq294 x5a5i1n xde0f50 x15x8krk xe4pinz x14vqqas x1ys307a xod5an3 xyqm7xq xz9dl7a xpdmqnj xsag5q8 x1g0dm76 x1jx94hy"}}[!!P<<0],{children:k.jsxs(c("MWXColumn.react"),{ref:T,testid:void 0,children:[k.jsx(c("MWXColumnItem.react"),{children:k.jsxs(c("MWXRow.react"),{paddingHorizontal:0,paddingVertical:0,spacing:12,children:[k.jsx(c("MWXRowItem.react"),{xstyle:t.icon,children:k.jsx(c("MWXImage.react"),{src:c("getMWEBRestoreQPCautionCircleProperties")()})}),k.jsx(c("MWXRowItem.react"),{expanding:!0,children:k.jsxs(c("MWXColumn.react"),{paddingTop:8,spacing:12,children:[k.jsx(c("MWXColumnItem.react"),{children:k.jsx(c("MWXText.react"),{align:"start",numberOfLines:2,type:"headlineEmphasized4",children:h._(/*BTDS*/"Chat history is missing")})}),k.jsx(c("MWXColumnItem.react"),{children:k.jsx(c("MWXText.react"),{align:"start",color:P?"secondary":"primary",numberOfLines:2,type:"body4",children:h._(/*BTDS*/"Enter your PIN to restore chat history.")})})]})}),k.jsx(c("MWXRowItem.react"),{children:k.jsx(c("MWXCircleButton.react"),{color:"primary",icon:c("MWXIconCross"),label:h._(/*BTDS*/"Close"),onPress:a,size:P?24:32,testid:void 0})})]})}),k.jsx(c("MWXColumnItem.react"),{paddingTop:16,children:k.jsx(c("MWChatEncryptedBackupsNumericCodeErrorWrapper.react"),{error:U,inputSize:"small",children:k.jsx(d("FocusRegion.react").FocusRegion,{autoFocusQuery:d("focusScopeQueries").tabbableScopeQuery,id:s,children:k.jsx(c("MWChatEncryptedBackupsNumericCodeInput.react"),babelHelpers["extends"]({},u,{color:P?"primary":"secondary",disabled:Q,inputSize:"small",testid:void 0}))})})}),Q&&k.jsx(c("MWXColumnItem.react"),{align:"center",children:k.jsx("div",babelHelpers["extends"]({className:"xfitlp5 x9otpla"},{children:k.jsx(c("MWChatEBPinCodeVerifyIndicator.react"),{isMessenger:P})}))}),!Q&&k.jsx(c("MWXColumnItem.react"),{align:"center",children:k.jsx("div",babelHelpers["extends"]({},{0:{},2:{className:"xod5an3"},1:{className:"x12nagc x1iorvi4"},3:{className:"x12nagc x1iorvi4"}}[!!(U==null)<<1|!!(U!=null)<<0],{children:k.jsx(c("MWXText.react"),{color:"blueLink",type:"bodyLink4",children:j===!0?k.jsx(c("MWXLink.react"),{onClick:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_USE_ONE_TIME_CODE_CLICK"),M(!0),W()},children:h._(/*BTDS*/"Use a one-time code instead")}):k.jsx("div",babelHelpers["extends"]({},c("CometVisualCompletionAttributes").IGNORE,{children:k.jsx(c("CometPlaceholder.react"),{fallback:k.jsx(c("MWXLink.react"),babelHelpers["extends"]({},d("MWEncryptedBackupsForgotPinStep").STATIC_HELP_CENTER_PROPS,{onClick:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_FORGOT_PIN_CLICK"),c("FBLogger")("labyrinth_web").tags(["jewel_restore_qp"]).warn("User clicked on the placeholder Forgot PIN button")}})),children:k.jsx(c("MWChatEncryptedBackupsRestoreJewelForgotPinButtonSuspender.react"),{children:function(a){var b=a.linkProps;return k.jsx(c("MWXLink.react"),babelHelpers["extends"]({},b,{onClick:function(a){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"RESTORE_FORGOT_PIN_CLICK"),b.onClick==null||b.onClick(a)}}))}})})}))})}))})]})}))}u.displayName=u.name+" [from "+f.id+"]";function a(a){var b=d("react-compiler-runtime").c(10),e=a.clientID,f=a.currentSupportedPlatform,g=a.doesUserHaveOtcEligibleDevices,h=a.fragmentKey,i=a.setClosed;a=a.setDismissed;f=f!==d("EncryptedBackupsSupportedPlatformUtils").EncryptedBackupsSupportedPlatform.FACEBOOK_DOT_COM;var j=f?c("MWChatEncryptedBackupsQPLSource.enum").INBOX_THREADLIST_QP_WITH_PIN:c("MWChatEncryptedBackupsQPLSource.enum").JEWEL_THREADLIST_QP_WITH_PIN,l;b[0]!==e||b[1]!==g||b[2]!==h||b[3]!==f||b[4]!==i||b[5]!==a?(l=k.jsx(u,{clientID:e,doesUserHaveOtcEligibleDevices:g,fragmentKey:h,isInbox:f,setClosed:i,setDismissed:a}),b[0]=e,b[1]=g,b[2]=h,b[3]=f,b[4]=i,b[5]=a,b[6]=l):l=b[6];b[7]!==j||b[8]!==l?(e=k.jsx(c("MWEBFlowSourceContextProvider.react"),{source:j,children:l}),b[7]=j,b[8]=l,b[9]=e):e=b[9];return e}g["default"]=a}),226);
__d("MWEncryptedBackupsFetchBackupIds",["LSEncryptedBackupsBackupTenancy","LSFactory","LSFetchBackupIdsStoredProcedure","LSIntEnum"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){return a.runInTransaction(function(a){return c("LSFetchBackupIdsStoredProcedure")(c("LSFactory")(a),{backupTenancy:(h||(h=d("LSIntEnum"))).ofNumber(c("LSEncryptedBackupsBackupTenancy").PRODUCTION),isUiBlocking:!1})},"readwrite",void 0,void 0,f.id+":19")}g.encryptedBackupsFetchBackupIds=a}),98);
__d("MWEncryptedBackupsThreadListPersistentBanner.react",["fbt","EncryptedBackupsSupportedPlatformUtils","MAWEncryptedBackupsRestoreDialog.entrypoint","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsQPLSource.enum","MWEncryptedBackupsRetrieveQplLoggingAnnotations","MWJewelPopoverDialogContext.react","MWXLink.react","MWXText.react","QPLUserFlow","promiseDone","react","react-compiler-runtime","requireDeferred","useLabyrinthLogging","useMWXEntryPointDialog","useReStore","useVisibilityObserver"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||(j=d("react"));b=j;var l=b.useContext,m=b.useRef,n=c("requireDeferred")("mwEBCheckIfEBKeysExistInDisk").__setRef("MWEncryptedBackupsThreadListPersistentBanner.react");function a(a){var b=d("react-compiler-runtime").c(23),e=a.onDismissUpsell;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(a={},b[0]=a):a=b[0];a=c("useMWXEntryPointDialog")(c("MAWEncryptedBackupsRestoreDialog.entrypoint"),a);var f=a[0];a=d("EncryptedBackupsSupportedPlatformUtils").useMWEncryptedBackupsGetCurrentSupportedPlatform();var g=a!==d("EncryptedBackupsSupportedPlatformUtils").EncryptedBackupsSupportedPlatform.FACEBOOK_DOT_COM;a=l(c("MWJewelPopoverDialogContext.react"));var j=a.setIsOpenForDialog,o=(i||(i=c("useReStore")))();a=d("useLabyrinthLogging").useLabyrinthLoggingFlow();var p=a.startFlow,q=m(!1),r=g?c("MWChatEncryptedBackupsQPLSource.enum").INBOX_THREADLIST_PERSISTENT_BANNER:c("MWChatEncryptedBackupsQPLSource.enum").JEWEL_THREADLIST_PERSISTENT_BANNER;b[1]!==o||b[2]!==r||b[3]!==p?(a=function(a){d("MWEncryptedBackupsRetrieveQplLoggingAnnotations").encryptedBackupsRetrieveQplLoggingAnnotations({db:o,onFetch:function(b){var e=b.ebsmWiped,f=b.firstUpsellTime,g=b.hasEbKeysLocally,h=b.hasEBSM,i=b.hasPDB,j=b.hasUserRestoredBefore;b=b.hasUserRestoredBeforeTemp;p({additionalAnnotations:{eb_session_identifier:f,ebsm_wiped:e,has_eb_keys_locally:g,has_ebsm:h,has_pdb:i,has_user_restored_before:j,has_user_restored_before_temp:b,restore_upsell_first_impression_time:f},event:d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,source:r});c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,a);q.current===!1&&(q.current=!0,c("promiseDone")(n.load(),function(a){return a(g)}))}})},b[1]=o,b[2]=r,b[3]=p,b[4]=a):a=b[4];var s=a;b[5]!==g||b[6]!==s?(a={onVisible:function(){s(g?"RESTORE_THREAD_LIST_PERSISTENT_BANNER_IMPRESSION_INBOX":"RESTORE_THREAD_LIST_PERSISTENT_BANNER_IMPRESSION")}},b[5]=g,b[6]=s,b[7]=a):a=b[7];a=c("useVisibilityObserver")(a);var t;b[8]===Symbol["for"]("react.memo_cache_sentinel")?(t={className:"xlhe6ec x1obq294 x5a5i1n xde0f50 x15x8krk x1xmf6yo x1e56ztr xyqm7xq x1ys307a x6ikm8r x10wlt62 xyamay9 x1l90r2v xf7dkkf xv54qhq"},b[8]=t):t=b[8];var u;b[9]===Symbol["for"]("react.memo_cache_sentinel")?(u=h._(/*BTDS*/"Missing chat history."),b[9]=u):u=b[9];var v;b[10]!==g||b[11]!==e||b[12]!==j||b[13]!==f||b[14]!==r||b[15]!==s?(v=function(){j(!0),s(g?"RESTORE_THREAD_LIST_PERSISTENT_BANNER_CTA_CLICKED_INBOX":"RESTORE_THREAD_LIST_PERSISTENT_BANNER_CTA_CLICKED"),f({onDismissUpsell:e,source:r})},b[10]=g,b[11]=e,b[12]=j,b[13]=f,b[14]=r,b[15]=s,b[16]=v):v=b[16];var w;b[17]===Symbol["for"]("react.memo_cache_sentinel")?(w=h._(/*BTDS*/"Restore now"),b[17]=w):w=b[17];b[18]!==v?(u=k.jsx(c("MWXText.react"),{color:"primary",type:"body4",children:k.jsxs(k.Fragment,{children:[u," ",k.jsx(c("MWXText.react"),{color:"blueLink",type:"bodyLink4",children:k.jsx(c("MWXLink.react"),{onClick:v,target:"_blank",testid:void 0,children:w})})]})}),b[18]=v,b[19]=u):u=b[19];b[20]!==a||b[21]!==u?(w=k.jsx("div",babelHelpers["extends"]({},t,{ref:a,children:u})),b[20]=a,b[21]=u,b[22]=w):w=b[22];return w}g["default"]=a}),226);
__d("MWEncryptedBackupsThreadListRestoreQPWrapper_query.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MWEncryptedBackupsThreadListRestoreQPWrapper_query",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"MWEncryptedBackupsThreadListRestoreQPWrapper_viewer"}],storageKey:null}],type:"Query",abstractKey:null};e.exports=a}),null);
__d("MWEncryptedBackupsThreadListRestoreQPWrapper_viewer.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MWEncryptedBackupsThreadListRestoreQPWrapper_viewer",selections:[{args:null,kind:"FragmentSpread",name:"MWEBRestoreQPWithPin_viewer"}],type:"Viewer",abstractKey:null};e.exports=a}),null);
__d("MWEncryptedBackupsVerifyDeviceNux.react",["fbt","EncryptedBackupsSupportedPlatformUtils","MAWEncryptedBackupsRestoreDialog.entrypoint","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsQPLSource.enum","MWEBVestaUserInfoContext.react","MWEBVirtualDevicesContext.react","MWEncryptedBackupsRetrieveQplLoggingAnnotations","MWJewelPopoverDialogContext.react","MWXQPCard.react","QPLUserFlow","getMWEBRestoreQPCautionCircleProperties","promiseDone","react","react-compiler-runtime","requireDeferred","useLabyrinthLogging","useMWXEntryPointDialog","useReStore","useVisibilityObserver"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||(j=d("react"));b=j;var l=b.useContext,m=b.useRef,n=c("requireDeferred")("mwEBCheckIfEBKeysExistInDisk").__setRef("MWEncryptedBackupsVerifyDeviceNux.react");function a(a){var b=d("react-compiler-runtime").c(46),e=a.children,f=a.currentSupportedPlatform,g=a.setClosed,j=a.setDismissed;a=d("MWEBVestaUserInfoContext.react").useMWEBIsCooldownOrLockOutState();var o;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(o={},b[0]=o):o=b[0];o=c("useMWXEntryPointDialog")(c("MAWEncryptedBackupsRestoreDialog.entrypoint"),o);var p=o[0],q=(i||(i=c("useReStore")))(),r=f!==d("EncryptedBackupsSupportedPlatformUtils").EncryptedBackupsSupportedPlatform.FACEBOOK_DOT_COM,s=r?c("MWChatEncryptedBackupsQPLSource.enum").INBOX_THREADLIST_QP:c("MWChatEncryptedBackupsQPLSource.enum").JEWEL_THREADLIST_QP;o=d("useLabyrinthLogging").useLabyrinthLoggingFlow();var t=o.startFlow,u=m(!1);f=l(c("MWJewelPopoverDialogContext.react"));var v=f.setIsOpenForDialog;o=d("MWEBVirtualDevicesContext.react").useMWEBVirtualDevices();f=o.virtualDeviceInfo;var w=f.vestaClientID!=null;o=f.offlineDevicesCount>0;var x=f.doesUserHaveOtcEligibleDevices;f=!w&&x;var y;b[1]!==q||b[2]!==x||b[3]!==w||b[4]!==s||b[5]!==t?(y=function(a){d("MWEncryptedBackupsRetrieveQplLoggingAnnotations").encryptedBackupsRetrieveQplLoggingAnnotations({db:q,onFetch:function(b){var e=b.ebsmWiped,f=b.firstUpsellTime,g=b.hasEbKeysLocally,h=b.hasEBSM,i=b.hasPDB,j=b.hasUserRestoredBefore;b=b.hasUserRestoredBeforeTemp;t({additionalAnnotations:{eb_session_identifier:f,ebsm_wiped:e,has_eb_keys_locally:g,has_ebsm:h,has_pdb:i,has_user_restored_before:j,has_user_restored_before_temp:b,is_otc_eligible:x.toString(),is_pin_set:w.toString(),restore_upsell_first_impression_time:f},event:d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,source:s});c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,a);u.current===!1&&(u.current=!0,c("promiseDone")(n.load(),function(a){return a(g)}))}})},b[1]=q,b[2]=x,b[3]=w,b[4]=s,b[5]=t,b[6]=y):y=b[6];var z=y;b[7]!==r||b[8]!==z?(y={onVisible:function(){var a=r?"VERIFY_DEVICE_INBOX_QP_THREAD_LIST_IMPRESSION":"VERIFY_DEVICE_QP_THREAD_LIST_IMPRESSION";z(a)}},b[7]=r,b[8]=z,b[9]=y):y=b[9];y=c("useVisibilityObserver")(y);var A;b[10]!==r||b[11]!==g||b[12]!==v||b[13]!==z?(A=function(){var a=r?"USER_CLICKED_INBOX_THREAD_LIST_VERIFY_DEVICE":"USER_CLICKED_FB_THREAD_LIST_VERIFY_DEVICE";z(a);v(!0);g()},b[10]=r,b[11]=g,b[12]=v,b[13]=z,b[14]=A):A=b[14];var B=A,C;b[15]!==r||b[16]!==g||b[17]!==j||b[18]!==z?(A=function(){var a=r?"USER_CLOSED_INBOX_THREAD_LIST_VERIFY_DEVICE_NUX":"USER_CLOSED_FB_THREAD_LIST_VERIFY_DEVICE_NUX";z(a);d("MWChatEncryptedBackupsLogging").cancelFlow({cancelEndPoint:"thread_list_nux",event:d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent});C()},C=function(){j(),g()},b[15]=r,b[16]=g,b[17]=j,b[18]=z,b[19]=A,b[20]=C):(A=b[19],C=b[20]);if(!w&&!o&&!x)return e;b[21]===Symbol["for"]("react.memo_cache_sentinel")?(o=h._(/*BTDS*/"Chat history is missing"),b[21]=o):o=b[21];e=o;b[22]!==x||b[23]!==a||b[24]!==w||b[25]!==f?(o=a&&x?h._(/*BTDS*/"Restore now"):w?h._(/*BTDS*/"Enter PIN"):f?h._(/*BTDS*/"Restore now"):h._(/*BTDS*/"Enter 40-character code"),b[22]=x,b[23]=a,b[24]=w,b[25]=f,b[26]=o):o=b[26];var D;b[27]!==C||b[28]!==B||b[29]!==s||b[30]!==p?(D=function(){B(),p({onDismissUpsell:C,source:s})},b[27]=C,b[28]=B,b[29]=s,b[30]=p,b[31]=D):D=b[31];var E;b[32]!==o||b[33]!==D?(E={label:o,onPress:D,testid:"mw-encrypted-backups-in-thread-verify-device-nux-verify-now-button"},b[32]=o,b[33]=D,b[34]=E):E=b[34];b[35]!==x||b[36]!==a||b[37]!==w||b[38]!==f?(o=a&&x?h._(/*BTDS*/"Send a one-time code to restore your chat history"):w?h._(/*BTDS*/"Enter your PIN to see messages that aren't loaded on this device."):f?h._(/*BTDS*/"Send a one-time code to restore your chat history"):h._(/*BTDS*/"Enter your 40-character code to see messages that aren't loaded on this device."),b[35]=x,b[36]=a,b[37]=w,b[38]=f,b[39]=o):o=b[39];b[40]===Symbol["for"]("react.memo_cache_sentinel")?(D={props:{src:c("getMWEBRestoreQPCautionCircleProperties")()},type:"image"},b[40]=D):D=b[40];b[41]!==A||b[42]!==y||b[43]!==E||b[44]!==o?(a=k.jsx(c("MWXQPCard.react"),{addOnPrimary:E,body:o,headline:e,icon:D,onClose:A,ref:y}),b[41]=A,b[42]=y,b[43]=E,b[44]=o,b[45]=a):a=b[45];return a}g["default"]=a}),226);
__d("MWEncryptedBackupsThreadListRestoreQPWrapper.react",["CometRelay","EncryptedBackupsSupportedPlatformUtils","MWEBEntrypointsKillswitch.enum","MWEBRestoreQPWithPin.react","MWEBVestaUserInfoContext.react","MWEBVirtualDevicesContext.react","MWEncryptedBackupsDeferLocalStorageUpsell","MWEncryptedBackupsThreadListPersistentBanner.react","MWEncryptedBackupsThreadListQPWrapper.react","MWEncryptedBackupsThreadListRestoreQPWrapper_query.graphql","MWEncryptedBackupsThreadListRestoreQPWrapper_viewer.graphql","MWEncryptedBackupsVerifyDeviceNux.react","react","react-compiler-runtime","useHasRestoreInterstitialSoftblockBeenDismissed","useMWEBBackupState","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=k||d("react");function m(a){var e=d("react-compiler-runtime").c(32),f=a.backupState,g=a.children,i=a.currentSupportedPlatform,k=a.fragmentKey,m=a.setHasDismissedQp,n=a.setHasDismissedQpWithPin;a=d("CometRelay").useFragment(h!==void 0?h:h=b("MWEncryptedBackupsThreadListRestoreQPWrapper_viewer.graphql"),k);var o=(j||(j=c("useReStore")))();k=d("MWEBVirtualDevicesContext.react").useMWEBVirtualDevices();k=k.virtualDeviceInfo;var p=i===d("EncryptedBackupsSupportedPlatformUtils").EncryptedBackupsSupportedPlatform.FACEBOOK_DOT_COM,q=k.doesUserHaveOtcEligibleDevices,r=d("MWEBVestaUserInfoContext.react").useMWEBIsCooldownOrLockOutState(),s;e[0]!==f||e[1]!==r?(s={backupState:f,isCooldownOrLockOutState:r},e[0]=f,e[1]=r,e[2]=s):s=e[2];f=c("useHasRestoreInterstitialSoftblockBeenDismissed")(s);if(!q&&r&&f)return null;else if(r&&f){e[3]!==m?(s=function(){m(!0)},e[3]=m,e[4]=s):s=e[4];e[5]!==o?(q=function(){return d("MWEncryptedBackupsDeferLocalStorageUpsell").updateUpsellEntry({db:o,upsellType:d("MWEncryptedBackupsDeferLocalStorageUpsell").MWEncryptedBackupsDeferableUpsellType.QP_JEWEL})},e[5]=o,e[6]=q):q=e[6];e[7]!==g||e[8]!==i||e[9]!==s||e[10]!==q?(r=l.jsx(c("MWEncryptedBackupsVerifyDeviceNux.react"),{children:g,currentSupportedPlatform:i,setClosed:s,setDismissed:q}),e[7]=g,e[8]=i,e[9]=s,e[10]=q,e[11]=r):r=e[11];return r}else if(p&&k.vestaClientID!=null&&c("MWEBRestoreQPWithPin.react")){e[12]!==n?(f=function(){n(!0)},e[12]=n,e[13]=f):f=e[13];e[14]!==o?(s=function(){return d("MWEncryptedBackupsDeferLocalStorageUpsell").updateUpsellEntry({db:o,upsellType:d("MWEncryptedBackupsDeferLocalStorageUpsell").MWEncryptedBackupsDeferableUpsellType.QP_WITH_PIN_JEWEL})},e[14]=o,e[15]=s):s=e[15];e[16]!==i||e[17]!==a||e[18]!==f||e[19]!==s||e[20]!==k.doesUserHaveOtcEligibleDevices||e[21]!==k.vestaClientID?(q=l.jsx(c("MWEBRestoreQPWithPin.react"),{clientID:k.vestaClientID,currentSupportedPlatform:i,doesUserHaveOtcEligibleDevices:k.doesUserHaveOtcEligibleDevices,fragmentKey:a,setClosed:f,setDismissed:s}),e[16]=i,e[17]=a,e[18]=f,e[19]=s,e[20]=k.doesUserHaveOtcEligibleDevices,e[21]=k.vestaClientID,e[22]=q):q=e[22];return q}else{e[23]!==m?(r=function(){m(!0)},e[23]=m,e[24]=r):r=e[24];e[25]!==o?(p=function(){return d("MWEncryptedBackupsDeferLocalStorageUpsell").updateUpsellEntry({db:o,upsellType:d("MWEncryptedBackupsDeferLocalStorageUpsell").MWEncryptedBackupsDeferableUpsellType.QP_JEWEL})},e[25]=o,e[26]=p):p=e[26];e[27]!==g||e[28]!==i||e[29]!==r||e[30]!==p?(a=l.jsx(c("MWEncryptedBackupsVerifyDeviceNux.react"),{children:g,currentSupportedPlatform:i,setClosed:r,setDismissed:p}),e[27]=g,e[28]=i,e[29]=r,e[30]=p,e[31]=a):a=e[31];return a}}function a(a){var e=d("react-compiler-runtime").c(12),f=a.children,g=a.currentSupportedPlatform,h=a.fragmentKey,k=a.hasDismissedQps,n=a.setHasDismissedBanner,o=a.setHasDismissedQp,p=a.setHasDismissedQpWithPin;a=a.trigger;h=d("CometRelay").useFragment(i!==void 0?i:i=b("MWEncryptedBackupsThreadListRestoreQPWrapper_query.graphql"),h);var q=(j||(j=c("useReStore")))(),r;e[0]===Symbol["for"]("react.memo_cache_sentinel")?(r={entrypoint:c("MWEBEntrypointsKillswitch.enum").INBOX_THREADLIST},e[0]=r):r=e[0];r=c("useMWEBBackupState")(r);var s;e[1]!==r||e[2]!==f||e[3]!==g||e[4]!==(h==null?void 0:h.viewer)||e[5]!==q||e[6]!==k||e[7]!==n||e[8]!==o||e[9]!==p||e[10]!==a?(s=k?l.jsx(d("MWEncryptedBackupsThreadListQPWrapper.react").MWEncryptedBackupsThreadListQPWrapper,{trigger:a,children:l.jsx(c("MWEncryptedBackupsThreadListPersistentBanner.react"),{onDismissUpsell:function(){n(!0),d("MWEncryptedBackupsDeferLocalStorageUpsell").updateUpsellEntry({db:q,upsellType:d("MWEncryptedBackupsDeferLocalStorageUpsell").MWEncryptedBackupsDeferableUpsellType.PERSISTENT_BANNER_JEWEL})}})}):l.jsx(d("MWEncryptedBackupsThreadListQPWrapper.react").MWEncryptedBackupsThreadListQPWrapper,{trigger:a,children:l.jsx(m,{backupState:r,children:f,currentSupportedPlatform:g,fragmentKey:h==null?void 0:h.viewer,setHasDismissedQp:o,setHasDismissedQpWithPin:p})}),e[1]=r,e[2]=f,e[3]=g,e[4]=h==null?void 0:h.viewer,e[5]=q,e[6]=k,e[7]=n,e[8]=o,e[9]=p,e[10]=a,e[11]=s):s=e[11];return s}g["default"]=a}),98);
__d("MWXIconMobile",["MWXSvgIcon","SVGIcon","cr:22406","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=d("MWXSvgIcon").mwxSvgIcon(d("SVGIcon").svgIcon(b("cr:22406")),c("gkx")("23219"));g["default"]=a}),98);
__d("VestaServerGraphQLLoginProviderBeginLoginMutation_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="9747954008656745"}),null);
__d("VestaServerGraphQLLoginProviderBeginLoginMutation.graphql",["VestaServerGraphQLLoginProviderBeginLoginMutation_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{alias:null,args:[{kind:"Variable",name:"begin_login_request",variableName:"input"}],concreteType:"VestaBeginLoginResponse",kind:"LinkedField",name:"fbid_based_auth_layer_vesta_begin_login",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_opaque_l2",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_opaque_l2_sig",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"VestaServerGraphQLLoginProviderBeginLoginMutation",selections:c,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"VestaServerGraphQLLoginProviderBeginLoginMutation",selections:c},params:{id:b("VestaServerGraphQLLoginProviderBeginLoginMutation_facebookRelayOperation"),metadata:{},name:"VestaServerGraphQLLoginProviderBeginLoginMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("VestaServerGraphQLLoginProviderFinishLoginMutation_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="9611648865601020"}),null);
__d("VestaServerGraphQLLoginProviderFinishLoginMutation.graphql",["VestaServerGraphQLLoginProviderFinishLoginMutation_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{alias:null,args:[{kind:"Variable",name:"finish_login_request",variableName:"input"}],concreteType:"VestaFinishLoginResponse",kind:"LinkedField",name:"fbid_based_auth_layer_vesta_finish_login",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_login_payload",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"login_success",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"attempts_remaining",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"VestaServerGraphQLLoginProviderFinishLoginMutation",selections:c,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"VestaServerGraphQLLoginProviderFinishLoginMutation",selections:c},params:{id:b("VestaServerGraphQLLoginProviderFinishLoginMutation_facebookRelayOperation"),metadata:{},name:"VestaServerGraphQLLoginProviderFinishLoginMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("VestaServerGraphQLLoginProviderInitQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="9285801411531503"}),null);
__d("VestaServerGraphQLLoginProviderInitQuery.graphql",["VestaServerGraphQLLoginProviderInitQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"request"}],c=[{alias:null,args:[{kind:"Variable",name:"vesta_init_request",variableName:"request"}],concreteType:"VestaInitIqResponse",kind:"LinkedField",name:"fbid_based_auth_layer_vesta_login_init",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_island_rsa_pub",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_island_rsa_pub_signature",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_opaque_pub",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_opaque_pub_signature",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_island_ed25519_pub",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_island_ed25519_pub_signature",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_registered",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"attempts_remaining",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"VestaServerGraphQLLoginProviderInitQuery",selections:c,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"VestaServerGraphQLLoginProviderInitQuery",selections:c},params:{id:b("VestaServerGraphQLLoginProviderInitQuery_facebookRelayOperation"),metadata:{},name:"VestaServerGraphQLLoginProviderInitQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("VestaServerGraphQLLoginProvider",["E2EEBackupUtil","RelayHooks","RelayModern","VestaServerGraphQLLoginProviderBeginLoginMutation.graphql","VestaServerGraphQLLoginProviderFinishLoginMutation.graphql","VestaServerGraphQLLoginProviderInitQuery.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;async function a(a,c){c=c.environment;c=await d("RelayHooks").fetchQuery(c,h!==void 0?h:h=b("VestaServerGraphQLLoginProviderInitQuery.graphql"),{request:{fbid:a.clientId,product_use_case:a.productUseCase,vesta_client_api_version:6}}).toPromise();a=c==null?void 0:c.fbid_based_auth_layer_vesta_login_init;c=a==null?void 0:a.base64url_encoded_island_rsa_pub;var e=a==null?void 0:a.base64url_encoded_island_rsa_pub_signature,f=a==null?void 0:a.base64url_encoded_opaque_pub,g=a==null?void 0:a.base64url_encoded_opaque_pub_signature,i=a==null?void 0:a.base64url_encoded_island_ed25519_pub,j=a==null?void 0:a.base64url_encoded_island_ed25519_pub_signature,k=a==null?void 0:a.is_registered;a=a==null?void 0:a.attempts_remaining;if(c!=null&&e!=null&&f!=null&&g!=null&&i!=null&&j!=null&&k!=null){var l;return{islandRsaPub:(l=d("E2EEBackupUtil")).decodeBase64Url(c),islandRsaPubSig:l.decodeBase64Url(e),opaquePub:l.decodeBase64Url(f),opaquePubSig:l.decodeBase64Url(g),islandEd25519Pub:l.decodeBase64Url(i),islandEd25519PubSig:l.decodeBase64Url(j),isRegistered:k,loginAttemptsRemaining:a}}throw new Error("GraphQL Response is Null")}function c(a,c){var e=c.environment,f=i!==void 0?i:i=b("VestaServerGraphQLLoginProviderBeginLoginMutation.graphql"),g={input:{fbid:a.clientId,product_use_case:a.productUseCase,base64url_encoded_opaque_l1:d("E2EEBackupUtil").encodeBase64Url(a.opaqueL1)}};return new Promise(function(a,b){d("RelayModern").commitMutation(e,{mutation:f,variables:g,onCompleted:function(c){c=c.fbid_based_auth_layer_vesta_begin_login;var e=c==null?void 0:c.base64url_encoded_opaque_l2;c=c==null?void 0:c.base64url_encoded_opaque_l2_sig;if(e!=null&&c!=null){a({opaqueL2:d("E2EEBackupUtil").decodeBase64Url(e),opaqueL2Sig:d("E2EEBackupUtil").decodeBase64Url(c)});return}b(new Error("GraphQL Response is Null"))},onError:function(a){b(a)}})})}function e(a,c){var e=c.environment,f=c.updater;return new Promise(function(c,g){d("RelayModern").commitMutation(e,{mutation:j!==void 0?j:j=b("VestaServerGraphQLLoginProviderFinishLoginMutation.graphql"),variables:{input:{fbid:a.clientId,product_use_case:a.productUseCase,base64url_encoded_opaque_l3:d("E2EEBackupUtil").encodeBase64Url(a.opaqueL3)}},onCompleted:function(a){a=a.fbid_based_auth_layer_vesta_finish_login;var b=a==null?void 0:a.base64url_encoded_login_payload,e=a==null?void 0:a.login_success;a=a==null?void 0:a.attempts_remaining;if(e!=null){c({loginSuccess:e,loginPayload:b==null?b:d("E2EEBackupUtil").decodeBase64Url(b),attemptsRemaining:a});return}g(new Error("GraphQL Response is Null"))},onError:function(a){g(a)},updater:f})})}g.initLogin=a;g.beginLogin=c;g.finishLogin=e}),98);
__d("mwEBAddDevice",["EBSMAPI","MAWCurrentUser","cr:21222"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var e=a.environment,f=a.onFailure,g=a.onInvalidRecoveryCode,h=a.onStart,i=a.onSuccess,j=a.recoveryCode,k=a.storage,l=a.traceId,m=a.trackAddingDevice;a=a.trackOverprompting;return c("EBSMAPI").addDeviceWithRecoveryCode({environment:e,isInWorker:!1,onFailure:f,onInvalidRecoveryCode:g,onStart:h,onSuccess:i,recoveryCode:j,storage:k,traceId:l,trackAddingDevice:m,trackOverprompting:a,userId:d("MAWCurrentUser").getID()}).then(function(){b("cr:21222")==null||b("cr:21222").fireAndForget("backend","addDeviceWithPinInWorker",{recoveryCode:j,userId:d("MAWCurrentUser").getID()})})}g.EBAddDevice=a}),98);
__d("vestaBackupSecretRestore",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("E2EEBackupSecretRestoreModule").__setRef("vestaBackupSecretRestore"),i=c("requireDeferred")("VestaServerGraphQLLoginProvider").__setRef("vestaBackupSecretRestore");async function a(a){var b=a.input;a=a.environment;var c=await Promise.all([i.load(),h.load()]),d=c[0],e=d.beginLogin,f=d.finishLogin;d=d.initLogin;c=c[1].restoreBackupSecret;return c({beginLogin:e,finishLogin:f,initLogin:d},b,{environment:a})}g.default=a}),98);
__d("mwEBGetPINSecretFromVesta",["CometRelay","E2EEBackupCommon","FBLogger","LSDataTraceCheckPoint","LSDataTraceType","LSIntEnum","MAWTraceUtils","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsSettingsDialogQuery.graphql","MWEBODSEntityKey.enum","MWEBODSEntityName.enum","QPLUserFlow","promiseDone","vestaBackupSecretRestore"],(function(a,b,c,d,e,f,g){"use strict";var h;async function a(a){var b=a.addDevice,e=a.clientID,f=a.environment,g=a.getSourceFromContext,i=a.onSubmitPin,j=a.onSubmitPinFailure,k=a.onVestaSecretFetch,l=a.pinCode,m=a.productUseCase,n=a.setIsInProgress,o=a.setIsPinCodeIncorrect,p=a.setIsVestaError;a=a.startFlow;var q=d("MAWTraceUtils").startNewTrace((h||(h=d("LSIntEnum"))).ofNumber(c("LSDataTraceType").SAP_VESTA_LOGIN),d("MAWTraceUtils").CONTEXT_VESTA_LOGIN);n(!0);i==null||i();i=g();c("QPLUserFlow").addAnnotations(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,{string:{restore_type:"pin_code",source:i}});g=new TextDecoder();var r;a({additionalAnnotations:{device_type:"HSM"},event:d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityName:c("MWEBODSEntityName.enum").MW_EB_PIN_RESTORE_AUTH,source:i});try{c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,"vesta_login_begin"),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"PIN_CODE_RESTORE_SUBMIT"),d("MAWTraceUtils").recordCheckpointForTrace(q,(h||(h=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").SAP_VESTA_CALLING_VESTA_LOGIN),[],!1),r=g.decode(await c("vestaBackupSecretRestore")({environment:f,input:{clientId:e,productUseCase:m,vestaAccountPin:l}})),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,"vesta_login_success"),d("MAWTraceUtils").recordCheckpointForTrace(q,h.ofNumber(c("LSDataTraceCheckPoint").SAP_VESTA_LOGIN_COMPLETION),[],!1)}catch(b){j==null||j();c("promiseDone")(d("CometRelay").fetchQuery(f,c("MWChatEncryptedBackupsSettingsDialogQuery.graphql"),{}).toPromise());if(b.errorType===d("E2EEBackupCommon").BackupErrorType.INVALID_PASSWORD)n(!1),o(!0),d("MWChatEncryptedBackupsLogging").endFailure({errorName:"incorrect_pin_code",event:d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityKey:c("MWEBODSEntityKey.enum").INCORRECT_PIN_CODE,odsEntityName:c("MWEBODSEntityName.enum").MW_EB_PIN_RESTORE_AUTH}),c("QPLUserFlow").markError(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"incorrect_pin_code"),d("MAWTraceUtils").recordFailureAndFlushForTraceId(q,(h||(h=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_PIN_RESTORE_FAILURE),[],"Incorrect pin code");else{d("MWChatEncryptedBackupsLogging").endFailure({annotations:{string:{errorMessage:b.message,errorType:b.errorType}},errorName:"vesta_login_failure",event:d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityName:c("MWEBODSEntityName.enum").MW_EB_PIN_RESTORE_AUTH});c("QPLUserFlow").markError(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"pin_code_error");n(!1);p(!0);a="Error when restoring using PIN: "+b;c("FBLogger")("labyrinth_web").mustfix(a);d("MAWTraceUtils").recordFailureAndFlushForTraceId(q,(h||(h=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_PIN_RESTORE_FAILURE),[],b.toString())}throw b}r!=null&&(d("MAWTraceUtils").recordCheckpointForTrace(q,(h||(h=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_PLUGIN_CALLING_ADD_DEVICE),[],!1),k==null||k(),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,"add_device_begin"),b(r,q,l))}g.default=a}),98);
__d("updateUpsellsStateInRelayStore",["CometRelay","FBLogger"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.environment,e=a.updateValue;d("CometRelay").commitLocalUpdate(b,function(a){a=a.getRoot().getLinkedRecord("viewer");if(a==null){c("FBLogger")("labyrinth_web").mustfix("[labyrinth][upsells] A viewer record does not exist when updating upsell state.");return}a.setValue(e,"is_eb_restore_upsells_dismissed")})}g["default"]=a}),98);
__d("useMWEBSetHasSeenNoticeMutation_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="9618790408209960"}),null);
__d("useMWEBSetHasSeenNoticeMutation.graphql",["useMWEBSetHasSeenNoticeMutation_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{alias:null,args:null,concreteType:"SetHasSeenEbAutoRestoreNoticeResponsePayload",kind:"LinkedField",name:"set_has_seen_eb_auto_restore_notice",plural:!1,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useMWEBSetHasSeenNoticeMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"useMWEBSetHasSeenNoticeMutation",selections:a},params:{id:b("useMWEBSetHasSeenNoticeMutation_facebookRelayOperation"),metadata:{},name:"useMWEBSetHasSeenNoticeMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("useMWEBSetHasSeenNotice",["CometRelay","react","react-compiler-runtime","useMWEBSetHasSeenNoticeMutation.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h,i;(i||d("react")).useCallback;function a(){var a=d("react-compiler-runtime").c(3),c;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(c=h!==void 0?h:h=b("useMWEBSetHasSeenNoticeMutation.graphql"),a[0]=c):c=a[0];c=d("CometRelay").useMutation(c);var e=c[0];a[1]!==e?(c=function(){e({variables:{}})},a[1]=e,a[2]=c):c=a[2];return c}g["default"]=a}),98);
__d("useMWEBAutoRestoreNoticeDialog",["JSResourceForInteraction","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWEBUseLocalStorage","MWEncryptedBackupsLocalStorageEntryEnum","QPLUserFlow","ReQL","ReQLSuspense","react","react-compiler-runtime","useLabyrinthLogging","useMWEBSetHasSeenNotice","useMWXLazyDialog","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i;(i||d("react")).useCallback;var j=c("JSResourceForInteraction")("MWEBAutoRestoreNoticeDialog.react").__setRef("useMWEBAutoRestoreNoticeDialog");function a(){var a=d("react-compiler-runtime").c(9),b=d("useLabyrinthLogging").useLabyrinthLoggingFlow(),e=b.startFlow;b=c("useMWXLazyDialog")(j);var g=b[0],i=(h||(h=c("useReStore")))();a[0]!==i.tables.auto_restore_opt_out?(b=function(){return d("ReQL").fromTableAscending(i.tables.auto_restore_opt_out)},a[0]=i.tables.auto_restore_opt_out,a[1]=b):b=a[1];var l;a[2]!==i?(l=[i],a[2]=i,a[3]=l):l=a[3];var m=d("ReQLSuspense").useArray(b,l,f.id+":45"),n=c("useMWEBSetHasSeenNotice")();a[4]!==m||a[5]!==n||a[6]!==g||a[7]!==e?(b=function(a){var b=a.hasSeenNotice;a=a.source;var f=m.filter(k).length>0;e({event:d("MWChatEncryptedBackupsQPLEvents").restoreWithAutoRestoreConsentQplEvent,source:a});if(f){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreWithAutoRestoreConsentQplEvent,"AUTO_RESTORE_NOTICE_SCREEN_OPTED_OUT");d("MWChatEncryptedBackupsLogging").endSuccess({event:d("MWChatEncryptedBackupsQPLEvents").restoreWithAutoRestoreConsentQplEvent});return}c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreWithAutoRestoreConsentQplEvent,"AUTO_RESTORE_NOTICE_SCREEN_OPTED_IN");d("MWEBUseLocalStorage").mwEBCreateLocalStorageEntry(c("MWEncryptedBackupsLocalStorageEntryEnum").ENCRYPTED_BACKUPS_REMEMBER_BROWSER_CONSENT);if(b){d("MWChatEncryptedBackupsLogging").endSuccess({event:d("MWChatEncryptedBackupsQPLEvents").restoreWithAutoRestoreConsentQplEvent});return}n();g({})},a[4]=m,a[5]=n,a[6]=g,a[7]=e,a[8]=b):b=a[8];return b}function k(a){return a.optOutKey===c("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_OPTED_OUT_OF_AUTO_RESTORE}g["default"]=a}),98);/*FB_PKG_DELIM*/
__d("BaseTypeaheadInMemoryListDataCache",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=[]}var b=a.prototype;b.clear=function(){this.$1=[]};b.get=function(a){var b=this.$1.find(function(b){return b.key===a});return b?b.value:null};b.has=function(a){return this.$1.some(function(b){return b.key===a})};b.set=function(a,b){var c=this.$1.findIndex(function(b){return b.key===a});if(c===-1){this.$1.push({key:a,value:b});return}this.$1[c]={key:a,value:b}};b.remove=function(a){var b=this.$1.findIndex(function(b){return b.key===a});this.$1.splice(b,1)};b.values=function(){return this.$1.map(function(a){return a.value})};return a}();f["default"]=a}),66);
__d("CometAddTypeaheadRecentSearchMutation_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="9990530167705749"}),null);
__d("CometAddTypeaheadRecentSearchMutation.graphql",["CometAddTypeaheadRecentSearchMutation_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"SearchTypeaheadAddRecentSearchResponsePayload",kind:"LinkedField",name:"search_typeahead_add_recent_search",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"client_mutation_id",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"CometAddTypeaheadRecentSearchMutation",selections:c,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"CometAddTypeaheadRecentSearchMutation",selections:c},params:{id:b("CometAddTypeaheadRecentSearchMutation_facebookRelayOperation"),metadata:{},name:"CometAddTypeaheadRecentSearchMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("RelayModernOrCometRelay",["cr:1012418"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:1012418")}),98);
__d("CometAddTypeaheadRecentSearchMutation",["CometAddTypeaheadRecentSearchMutation.graphql","RelayModernOrCometRelay"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h!==void 0?h:h=b("CometAddTypeaheadRecentSearchMutation.graphql");function a(a){var b=a.onBeforeCommitMutation,d=a.onError,e=a.onSuccess,f=a.relayEnvironment,g=a.searchScopeEntityID,h=a.selectedID,j=a.selectedText,k=a.selectedType,l=a.source,m=a.stsDirectNavType,n=a.stsDisambiguationType,o=a.stsHighConfidenceSource,p=a.userID;a=a.userInput;b&&b();c("RelayModernOrCometRelay").commitMutation(f,{mutation:i,onCompleted:function(a,b){b&&b.length?d&&d(new Error("Payload errors while executing `addTypeaheadRecentSearchMutation`.")):e&&e(a)},onError:d,variables:{input:babelHelpers["extends"]({},p!=null?{actor_id:p}:null,{search_scope_entity_id:g,selected_id:h,selected_text:j,selected_type:k,source:l,sts_direct_nav_type_for_graphql:m,sts_disambiguation_type_for_graphql:n,sts_high_confidence_source_for_graphql:o,user_input:a})}})}g.commit=a}),98);
__d("CometDeleteRecentSearchMutation_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="9360833174026215"}),null);
__d("CometDeleteRecentSearchMutation.graphql",["CometDeleteRecentSearchMutation_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"SearchTypeaheadDeleteRecentResponsePayload",kind:"LinkedField",name:"search_typeahead_delete_recent",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"client_mutation_id",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"CometDeleteRecentSearchMutation",selections:c,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"CometDeleteRecentSearchMutation",selections:c},params:{id:b("CometDeleteRecentSearchMutation_facebookRelayOperation"),metadata:{},name:"CometDeleteRecentSearchMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("CometDeleteRecentSearchMutation",["CometDeleteRecentSearchMutation.graphql","RelayModernOrCometRelay"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h!==void 0?h:h=b("CometDeleteRecentSearchMutation.graphql");function a(a){var b=a.onBeforeCommitMutation,d=a.onError,e=a.onSuccess,f=a.relayEnvironment,g=a.searchEntityType,h=a.searchText;a=a.userID;b&&b();c("RelayModernOrCometRelay").commitMutation(f,{mutation:i,onCompleted:function(a,b){b&&b.length?d&&d(new Error("Payloads error while executing `deleteSearchMutation`.")):e&&e(a)},onError:d,variables:{input:babelHelpers["extends"]({},a!=null?{actor_id:a}:null,{search_entity_type:g,search_text:h})}})}g.commit=a}),98);
__d("CometSearchBootstrapKeywordsDataSourceQuery.graphql",["relay-runtime"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"first"}],b=[{kind:"Variable",name:"first",variableName:"first"}],c={alias:null,args:null,kind:"ScalarField",name:"keyword_text",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"item_logging_id",storageKey:null},e={alias:null,args:null,kind:"ScalarField",name:"item_logging_info",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"link_url",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"snippet",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null};g=[{alias:null,args:null,concreteType:"STSDirectNavResult",kind:"LinkedField",name:"direct_nav_result",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ent_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"img_url",storageKey:null},f,{alias:null,args:null,kind:"ScalarField",name:"entity_type",storageKey:null},g,h,i],storageKey:null},{alias:null,args:null,concreteType:"STSHighConfidenceResult",kind:"LinkedField",name:"high_confidence_result",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"hcm_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"picture_url",storageKey:null},g,{alias:null,args:null,kind:"ScalarField",name:"source_as_enum",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"STSDisambiguationResult",kind:"LinkedField",name:"disambiguation_result",plural:!1,selections:[h,{alias:null,args:null,concreteType:"STSDisambiguationInfo",kind:"LinkedField",name:"disambiguation_info_list",plural:!0,selections:[{alias:"snippet",args:null,kind:"ScalarField",name:"text",storageKey:null},f,i],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"TypeaheadBadgeInfo",kind:"LinkedField",name:"badge_info",plural:!1,selections:[{alias:"badge_text",args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}];h={alias:null,args:null,concreteType:"SearchTypeaheadSuggestionKeys",kind:"LinkedField",name:"suggestion_keys",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"tier",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"keys",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"default_key",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"CometSearchBootstrapKeywordsDataSourceQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:b,concreteType:"BootstrapKeywordsConnection",kind:"LinkedField",name:"bootstrap_keywords",plural:!1,selections:[{alias:null,args:null,concreteType:"BootstrapKeywordsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"BootstrapResult",kind:"LinkedField",name:"node",plural:!1,selections:[c,d,e,{alias:null,args:null,concreteType:"StructuredTypeaheadInfo",kind:"LinkedField",name:"sts_info",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"getSearchCometKeywordDataSourceStructuredInfoForEntry_structuredTypeaheadInfo",selections:g,args:null,argumentDefinitions:[]}],storageKey:null},h],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"CometSearchBootstrapKeywordsDataSourceQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:b,concreteType:"BootstrapKeywordsConnection",kind:"LinkedField",name:"bootstrap_keywords",plural:!1,selections:[{alias:null,args:null,concreteType:"BootstrapKeywordsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"BootstrapResult",kind:"LinkedField",name:"node",plural:!1,selections:[c,d,e,{alias:null,args:null,concreteType:"StructuredTypeaheadInfo",kind:"LinkedField",name:"sts_info",plural:!1,selections:g,storageKey:null},h],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:"29156638353980166",metadata:{},name:"CometSearchBootstrapKeywordsDataSourceQuery",operationKind:"query",text:null}}}();b("relay-runtime").PreloadableQueryRegistry.set(a.params.id,a);e.exports=a}),null);
__d("getSearchCometKeywordDataSourceStructuredInfoForEntry_structuredTypeaheadInfo.graphql",[],(function(a,b,c,d,e,f){"use strict";a={kind:"InlineDataFragment",name:"getSearchCometKeywordDataSourceStructuredInfoForEntry_structuredTypeaheadInfo"};e.exports=a}),null);
__d("getSearchCometKeywordDataSourceStructuredSuggestionKey",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b;if(((b=a.direct_nav_result)==null?void 0:b.ent_id)!=null){return"dir_nav_sts:"+((b=a.direct_nav_result)==null?void 0:b.ent_id)}if(((b=a.high_confidence_result)==null?void 0:b.hcm_id)!=null){return"hc_sts:"+((b=a.high_confidence_result)==null?void 0:b.hcm_id)}return((b=a.disambiguation_result)==null?void 0:b.title)!=null&&((b=a.disambiguation_result)==null||(b=b.disambiguation_info_list[0])==null?void 0:b.type)!=null?a.disambiguation_result.disambiguation_info_list[0].type+":"+a.disambiguation_result.title:null}f["default"]=a}),66);
__d("getSearchCometKeywordDataSourceStructuredInfoForEntry",["CometRelay","getSearchCometKeywordDataSourceStructuredInfoForEntry_structuredTypeaheadInfo.graphql","getSearchCometKeywordDataSourceStructuredSuggestionKey"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){a=a.structuredTypeaheadInfo;if(a==null)return{entryKey:null,extraLoggingInfo:null,label:null,markers:[],structuredInfo:null};a=d("CometRelay").readInlineData(h!==void 0?h:h=b("getSearchCometKeywordDataSourceStructuredInfoForEntry_structuredTypeaheadInfo.graphql"),a);var e=a.badge_info,f=a.direct_nav_result,g=a.disambiguation_result;a=a.high_confidence_result;var i=[],j,k,l;if(f!=null){i=["direct_nav"];var m=f.ent_id,n=f.entity_type,o=f.img_url,p=f.link_url,q=f.snippet,r=f.title;f=f.type;l=r;j={direct_nav_result:{ent_id:m,entity_type:n,img_url:o,link_url:p,snippet:q,title:r,type:f}};k={stsDirectNavEntityID:m,stsDirectNavEntityType:n,stsDirectNavType:f}}if(a!=null){i=["high_confidence"];o=a.hcm_id;p=a.picture_url;q=a.snippet;r=a.source_as_enum;m=a.text;l=m;j={high_confidence_result:{hcm_id:o,picture_url:p,snippet:q,source_as_enum:r,text:m}};k={stsHighConfidenceID:o,stsHighConfidenceSource:r}}if(g!=null){i=["disambiguation"];n=g.disambiguation_info_list;f=g.title;l=f;j={disambiguation_result:{disambiguation_info_list:n,title:f}};k={stsDisambiguationType:n[0].type}}return{badgeSnippet:(a=e==null?void 0:e.badge_text)!=null?a:void 0,entryKey:j!=null?c("getSearchCometKeywordDataSourceStructuredSuggestionKey")(j):null,extraLoggingInfo:k,label:l,markers:i,structuredInfo:j}}g["default"]=a}),98);
__d("CometSearchBootstrapKeywordsDataSource.query",["CometSearchBootstrapKeywordsDataSourceQuery.graphql","filterNulls","getSearchCometKeywordDataSourceStructuredInfoForEntry","recoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h;d=h!==void 0?h:h=b("CometSearchBootstrapKeywordsDataSourceQuery.graphql");function a(a){var b;if(!a)return[];a=a.viewer;a=((a=a==null||(b=a.bootstrap_keywords)==null?void 0:b.edges)!=null?a:[]).map(function(a){return a.node}).filter(Boolean);return c("filterNulls")(a.map(function(a){var b=a.item_logging_id,d=a.item_logging_info,e=a.keyword_text,f=a.sts_info;a=a.suggestion_keys;if(e==null){c("recoverableViolation")("Cannot have TA bootstrap entry without keyword_text","search");return null}f=c("getSearchCometKeywordDataSourceStructuredInfoForEntry")({structuredTypeaheadInfo:f});var g=f.badgeSnippet,h=f.entryKey,i=f.extraLoggingInfo,j=f.label,k=f.markers;f=f.structuredInfo;var l=a!=null?a:{},m=l.default_key,n=l.keys;l=l.tier;return{key:(h=h!=null?h:f&&(a==null?void 0:a.default_key))!=null?h:e,label:j!=null?j:e,metaData:{logging:babelHelpers["extends"]({},i,{loggingID:b!=null?b:"",loggingInfo:d}),markers:new Set(["bootstrap","keyword"].concat(k))},rawData:{badgeSnippet:g,structuredInfo:f,suggestion_keys:l!=null?{default_key:m,keys:n,tier:l}:null},subtype:"bootstrap",type:"entry"}}))}g.query=d;g.normalize=a}),98);
__d("CometSearchBootstrapKeywordsDataSource",["BaseTypeaheadDataCacheProvider","BaseTypeaheadDataProvider","BaseTypeaheadDataProviderQueryVariablesBuilder","BaseTypeaheadInMemoryMapDataCache","BaseTypeaheadPayloadDecoratorAddLimit","CometSearchBootstrapKeywordsDataSource.query","baseTypeaheadStartsWithMatchBuilder","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){var b=a.limit,e=a.queryVariables;a=a.relayEnvironment;this.$2=new(c("BaseTypeaheadDataCacheProvider"))({cache:new(c("BaseTypeaheadInMemoryMapDataCache"))(),matchBuilder:c("baseTypeaheadStartsWithMatchBuilder")});this.$3=b;b=new(c("BaseTypeaheadDataProviderQueryVariablesBuilder"))(function(){return function(){return e}});this.$1=new(c("BaseTypeaheadDataProvider"))({query:d("CometSearchBootstrapKeywordsDataSource.query").query,queryVariablesBuilder:b,relayEnvironment:a})}var b=a.prototype;b.bootstrap=function(){var a=this;c("promiseDone")(this.$1.fetch({query:""}).then(function(a){a=a.response;return d("CometSearchBootstrapKeywordsDataSource.query").normalize(a)}).then(function(b){a.$2.clear(),a.$2.add(b,null)}))};b.fetchCache=function(a){var b=a.query;b=this.$2.match(b);var d=c("BaseTypeaheadPayloadDecoratorAddLimit")(this.$3);return d({entries:b,params:a})};b.clear=function(){this.$2.clear()};b.removeEntriesByEntID=function(a){var b=this.$2.values();for(b of b){var c;a===((c=b.rawData.structuredInfo)==null||(c=c.direct_nav_result)==null?void 0:c.ent_id)&&this.$2.remove(b)}};return a}();g["default"]=a}),98);
__d("CometSearchKeywordDataSourceQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="29621779027437472"}),null);
__d("CometSearchKeywordDataSourceQuery.graphql",["CometSearchKeywordDataSourceQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"query"}],c=[{kind:"Variable",name:"query",variableName:"query"}],d={alias:"name",args:null,kind:"ScalarField",name:"text",storageKey:null},e={alias:null,args:null,kind:"ScalarField",name:"logging_id",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"logging_info",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"link_url",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"snippet",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null};h=[{alias:null,args:null,concreteType:"STSDirectNavResult",kind:"LinkedField",name:"direct_nav_result",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ent_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"img_url",storageKey:null},g,{alias:null,args:null,kind:"ScalarField",name:"entity_type",storageKey:null},h,i,j],storageKey:null},{alias:null,args:null,concreteType:"STSHighConfidenceResult",kind:"LinkedField",name:"high_confidence_result",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"hcm_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"picture_url",storageKey:null},h,{alias:null,args:null,kind:"ScalarField",name:"source_as_enum",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"STSDisambiguationResult",kind:"LinkedField",name:"disambiguation_result",plural:!1,selections:[i,{alias:null,args:null,concreteType:"STSDisambiguationInfo",kind:"LinkedField",name:"disambiguation_info_list",plural:!0,selections:[{alias:"snippet",args:null,kind:"ScalarField",name:"text",storageKey:null},g,j],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"TypeaheadBadgeInfo",kind:"LinkedField",name:"badge_info",plural:!1,selections:[{alias:"badge_text",args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}];i={alias:null,args:null,concreteType:"SearchTypeaheadSuggestionKeys",kind:"LinkedField",name:"suggestion_keys",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"tier",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"keys",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"default_key",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"CometSearchKeywordDataSourceQuery",selections:[{alias:null,args:c,concreteType:"KeywordsSearchSuggestionSet",kind:"LinkedField",name:"search_keywords_suggestion",plural:!1,selections:[{alias:null,args:null,concreteType:"KeywordsSearchSuggestionsConnection",kind:"LinkedField",name:"suggestions",plural:!1,selections:[{alias:null,args:null,concreteType:"KeywordsSearchSuggestionsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"KeywordSuggestionUnit",kind:"LinkedField",name:"node",plural:!1,selections:[d,e,f,{alias:null,args:null,concreteType:"StructuredTypeaheadInfo",kind:"LinkedField",name:"structured_info",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"getSearchCometKeywordDataSourceStructuredInfoForEntry_structuredTypeaheadInfo",selections:h,args:null,argumentDefinitions:[]}],storageKey:null},i],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"CometSearchKeywordDataSourceQuery",selections:[{alias:null,args:c,concreteType:"KeywordsSearchSuggestionSet",kind:"LinkedField",name:"search_keywords_suggestion",plural:!1,selections:[{alias:null,args:null,concreteType:"KeywordsSearchSuggestionsConnection",kind:"LinkedField",name:"suggestions",plural:!1,selections:[{alias:null,args:null,concreteType:"KeywordsSearchSuggestionsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"KeywordSuggestionUnit",kind:"LinkedField",name:"node",plural:!1,selections:[d,e,f,{alias:null,args:null,concreteType:"StructuredTypeaheadInfo",kind:"LinkedField",name:"structured_info",plural:!1,selections:h,storageKey:null},i],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:b("CometSearchKeywordDataSourceQuery_facebookRelayOperation"),metadata:{},name:"CometSearchKeywordDataSourceQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("CometSearchKeywordDataSource.query",["CometSearchKeywordDataSourceQuery.graphql","cometUniqueID","getSearchCometKeywordDataSourceStructuredInfoForEntry"],(function(a,b,c,d,e,f,g){"use strict";var h;d=h!==void 0?h:h=b("CometSearchKeywordDataSourceQuery.graphql");function a(a,b){var d;if(!a)return[];a=a.search_keywords_suggestion;var e=b.query.request_id;a=((a=a==null||(d=a.suggestions)==null?void 0:d.edges)!=null?a:[]).map(function(a){return a.node}).filter(Boolean);var f;try{b=JSON.parse(b.query.query_text);f=b!=null?b[0]:null}catch(a){}return a.map(function(a){var b=a.logging_id,d=a.logging_info,g=a.name,h=a.structured_info;a=a.suggestion_keys;h=c("getSearchCometKeywordDataSourceStructuredInfoForEntry")({structuredTypeaheadInfo:h});var i=h.badgeSnippet,j=h.entryKey,k=h.extraLoggingInfo,l=h.label,m=h.markers;h=h.structuredInfo;var n=a!=null?a:{},o=n.default_key,p=n.keys;n=n.tier;return{key:(a=(j=j!=null?j:h&&(a==null?void 0:a.default_key))!=null?j:g)!=null?a:c("cometUniqueID")(),label:(j=l!=null?l:g)!=null?j:"",metaData:{logging:babelHelpers["extends"]({},k,{loggingID:b,loggingInfo:d,query:f,sequenceID:e}),markers:new Set(["keyword"].concat(m))},rawData:{badgeSnippet:i,structuredInfo:h,suggestion_keys:n!=null?{default_key:o,keys:p,tier:n}:null},subtype:"keyword",type:"entry"}})}g.query=d;g.normalize=a}),98);
__d("cometSearchKeywordDataSourceQueryVariablesBuilder",[],(function(a,b,c,d,e,f){"use strict";var g=10,h="blended";function a(a){return function(b){var c=b.loggingEventTrace;b=b.query;var d=a!=null?a:{},e=d.fetch_count,f=d.fetch_mode;d=d.group_id;d=JSON.stringify(d!=null?[{text:"",type:"group",uid:d},b]:[b]);return{query:{fetch_count:e!=null?e:g,fetch_mode:f!=null?f:h,query_text:d,request_id:c==null?void 0:c.sequenceID,session_id:(b=c==null?void 0:c.sessionID)!=null?b:""}}}}f["default"]=a}),66);
__d("CometSearchKeywordDataSource",["BaseCacheEntryKeyBuilder","BaseTypeaheadDataProvider","BaseTypeaheadDataProviderQueryVariablesBuilder","BaseTypeaheadNetworkCacheDataSource","BaseTypeaheadQueryDataCacheProvider","CometSearchKeywordDataSource.query","baseTypeaheadDedupEntriesBuilder","baseTypeaheadLabelSuffixBuilder","cometSearchKeywordDataSourceQueryVariablesBuilder"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){var b=a.dedupe,e=a.onError,f=a.queryVariables;a=a.relayEnvironment;f=new(c("BaseTypeaheadDataProviderQueryVariablesBuilder"))(c("cometSearchKeywordDataSourceQueryVariablesBuilder")).setDefaultVariables(f);e=new(c("BaseTypeaheadDataProvider"))({onError:e,query:d("CometSearchKeywordDataSource.query").query,queryVariablesBuilder:f,relayEnvironment:a});this.$1=new(c("BaseTypeaheadQueryDataCacheProvider"))({dedupe:b!=null?b:c("baseTypeaheadDedupEntriesBuilder")(c("BaseCacheEntryKeyBuilder")),suffixBuilder:function(){return c("baseTypeaheadLabelSuffixBuilder").apply(void 0,arguments)}});this.$2=new(c("BaseTypeaheadNetworkCacheDataSource"))(e,this.$1,{normalizeFunc:d("CometSearchKeywordDataSource.query").normalize})}var b=a.prototype;b.fetchCache=function(a){return this.$2.fetchCache(a)};b.fetchNetwork=function(a){return this.$2.fetchNetwork(a)};b.clearQueryCache=function(){this.$1.clear()};return a}();g["default"]=a}),98);
__d("searchCometTypeaheadSubtractSections",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){var c=new Set(a.entries.map(function(a){return a.key}));b.entries=b.entries.filter(function(a){return!c.has(a.key)})}f["default"]=a}),66);
__d("searchCometTypeaheadMergeSections",["searchCometTypeaheadSubtractSections"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){c("searchCometTypeaheadSubtractSections")(a,b),b.entries=a.entries.concat(b.entries)}g["default"]=a}),98);
__d("CometSearchRecentDataCacheProvider",["BaseDataEntryLabelKeyBuilder","searchCometTypeaheadMergeSections","searchCometTypeaheadSubtractSections"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){var b=a.cache,d=a.matchBuilder;a=a.keyBuilder;a=a===void 0?c("BaseDataEntryLabelKeyBuilder"):a;this.$1=b;this.$2=d;this.$3=a}var b=a.prototype;b.add=function(a,b,d){var e=this;if(d==="network"){this.$1.clear();[].concat(a).reverse().forEach(function(a){var b=e.$3(a);e.$1.set(b,a)});return}a.forEach(function(a){var b=e.$3(a),d=e.$1.get(b);if(d)if(d.type==="section"&&a.type==="section"){c("searchCometTypeaheadMergeSections")(a,d);return}else e.$1.remove(b);e.$1.set(b,a)})};b.clear=function(){this.$1.clear()};b.remove=function(a){var b=this.$3(a),d=this.$1.get(b);d&&d.type==="section"&&a.type==="section"&&d.entries.length!==0?c("searchCometTypeaheadSubtractSections")(a,d):this.$1.remove(b)};b.match=function(a){var b=this.$2({query:a});return this.$1.values().map(function(a){return babelHelpers["extends"]({},a)}).reverse().filter(function(a){if(a.type==="section"){a.entries=a.entries.filter(b);return!0}else return b(a)})};b.values=function(){return this.$1.values()};return a}();g["default"]=a}),98);
__d("cometSearchNullStateMatchBuilder",[],(function(a,b,c,d,e,f){"use strict";function a(){return function(a){a=a.metaData.markers;return a.has("recent")||a.has("nullstate_explore")||a.has("keyword")}}f["default"]=a}),66);
__d("CometSearchRecentDataSource",["fbt","BaseDataEntryKeyBuilder","BaseTypeaheadDataProvider","BaseTypeaheadDataProviderQueryVariablesBuilder","BaseTypeaheadInMemoryListDataCache","BaseTypeaheadNetworkDataSource","CometAddTypeaheadRecentSearchMutation","CometDeleteRecentSearchMutation","CometSearchRecentDataCacheProvider","Promise","cometSearchNullStateMatchBuilder","filterNulls","qex"],(function(a,b,c,d,e,f,g,h){"use strict";var i;a=function(){function a(a){var b=a.activityLogURL,d=a.gqlQuery,e=a.limit,f=a.normalize,g=a.options,h=a.queryVariablesBuilderFunction;a=a.relayEnvironment;this.$4=a;this.$5=e;this.$6=h({query:""}).filter;this.$7=b;a=function(){return h};e=new(c("BaseTypeaheadDataProviderQueryVariablesBuilder"))(a);b=new(c("BaseTypeaheadDataProvider"))({options:g,query:d,queryVariablesBuilder:e,relayEnvironment:this.$4});this.$2=new(c("CometSearchRecentDataCacheProvider"))({cache:new(c("BaseTypeaheadInMemoryListDataCache"))(),keyBuilder:c("BaseDataEntryKeyBuilder"),matchBuilder:c("cometSearchNullStateMatchBuilder")});this.$1=new(c("BaseTypeaheadNetworkDataSource"))(b,f)}var e=a.prototype;e.$8=function(){var a=c("filterNulls")(this.$2.values().map(function(a){return a.type==="section"&&a.subtype==="recent_searches"?a:null}));return a.length!==0?a[0]:null};e.add=function(a,b,c){c=c===void 0?{}:c;var e=c.onBeforeCommitMutation,f=c.onError;c=c.onSuccess;var g=a.metaData,h=this.$8();h!=null?this.$2.add([babelHelpers["extends"]({},h,{entries:[a]})],""):this.$2.add([a],"");g=(h=g==null?void 0:g.logging)!=null?h:{};h=g.entityID;var i=g.entityType,j=g.searchScopeEntityID,k=g.stsDirectNavEntityID,l=g.stsDirectNavType,m=g.stsDisambiguationType,n=g.stsHighConfidenceID;g=g.stsHighConfidenceSource;d("CometAddTypeaheadRecentSearchMutation").commit({onBeforeCommitMutation:e,onError:f,onSuccess:c,relayEnvironment:this.$4,searchScopeEntityID:j,selectedID:(e=h!=null?h:k)!=null?e:n,selectedText:a.label.toLowerCase(),selectedType:i!=null?i:"keyword",source:b,stsDirectNavType:l,stsDisambiguationType:m,stsHighConfidenceSource:g,userInput:a.label.toLowerCase()})};e.bootstrap=function(){var a;a=(a=c("qex")._("1300"))!=null?a:!1;if(a&&this.$6==="all")return;this.fetchNetwork({query:""})};e.fetchCache=function(a){var b=a.query;b=this.$2.match(b);return{entries:b,params:a}};e.fetchNetwork=function(a){var c=this;return this.$3!=null&&this.$3<this.$5?(i||(i=b("Promise"))).resolve({entries:this.$2.match(a.query),params:a}):this.$1.fetchNetwork(a).then(function(b){var d=b.entries;b=b.params.query;d!=null&&(d.forEach(function(a){var b=c.$7;["all","group_scoped_search"].includes(c.$6)&&b!=null&&a.type==="section"&&a.subtype==="recent_searches"&&(a.action={label:h._(/*BTDS*/"Edit"),type:"link",url:b})}),c.$3=d.length,c.$2.add(d,b,"network"));return{entries:c.$2.match(b),params:a}})};e.remove=function(a,b){b=b===void 0?{}:b;var c=b.onBeforeCommitMutation,e=b.onError;b=b.onSuccess;var f=this.$8();f!=null?this.$2.remove(babelHelpers["extends"]({},f,{entries:[a]})):this.$2.remove(a);d("CometDeleteRecentSearchMutation").commit({onBeforeCommitMutation:c,onError:e,onSuccess:b,relayEnvironment:this.$4,searchText:a.label})};e.clear=function(){this.$3=null;var a=this.$8();if(a==null){this.$2.clear();return}a.entries.length!==0&&this.$2.remove(a)};e.refresh=function(){this.clear(),this.fetchNetwork({query:""})};return a}();g["default"]=a}),226);
__d("CometSearchRecentDataSourceQuery.graphql",["relay-runtime"],(function(a,b,c,d,e,f){"use strict";a=function(){var a={defaultValue:null,kind:"LocalArgument",name:"fetch_nullstate"},b={defaultValue:null,kind:"LocalArgument",name:"fetch_recent_searches"},c={defaultValue:null,kind:"LocalArgument",name:"fetch_search_badge"},d={defaultValue:null,kind:"LocalArgument",name:"filter"},e={defaultValue:null,kind:"LocalArgument",name:"first"},f={defaultValue:null,kind:"LocalArgument",name:"scale"},g={defaultValue:null,kind:"LocalArgument",name:"search_null_state_argument"},h={defaultValue:null,kind:"LocalArgument",name:"search_scope_entity_id"},i=[{kind:"Variable",name:"filter",variableName:"filter"},{kind:"Variable",name:"first",variableName:"first"},{kind:"Variable",name:"search_scope_entity_id",variableName:"search_scope_entity_id"}],j={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"scale",variableName:"scale"},{kind:"Literal",name:"width",value:36}],concreteType:"Image",kind:"LinkedField",name:"profile_picture",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null}],storageKey:null}],type:"Profile",abstractKey:"__isProfile"},m=[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],n={kind:"InlineFragment",selections:m,type:"Application",abstractKey:null},o={kind:"InlineFragment",selections:m,type:"Event",abstractKey:null},p={kind:"InlineFragment",selections:m,type:"Group",abstractKey:null},q={kind:"InlineFragment",selections:m,type:"Page",abstractKey:null};m={kind:"InlineFragment",selections:m,type:"User",abstractKey:null};var r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"link_url",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"snippet",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},v={alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null};u=[{alias:null,args:null,concreteType:"STSDirectNavResult",kind:"LinkedField",name:"direct_nav_result",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ent_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"img_url",storageKey:null},s,{alias:null,args:null,kind:"ScalarField",name:"entity_type",storageKey:null},t,u,v],storageKey:null},{alias:null,args:null,concreteType:"STSHighConfidenceResult",kind:"LinkedField",name:"high_confidence_result",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"hcm_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"picture_url",storageKey:null},t,{alias:null,args:null,kind:"ScalarField",name:"source_as_enum",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"STSDisambiguationResult",kind:"LinkedField",name:"disambiguation_result",plural:!1,selections:[u,{alias:null,args:null,concreteType:"STSDisambiguationInfo",kind:"LinkedField",name:"disambiguation_info_list",plural:!0,selections:[{alias:"snippet",args:null,kind:"ScalarField",name:"text",storageKey:null},s,v],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"TypeaheadBadgeInfo",kind:"LinkedField",name:"badge_info",plural:!1,selections:[{alias:"badge_text",args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}];s={alias:null,args:null,concreteType:"StructuredTypeaheadInfo",kind:"LinkedField",name:"sts_info",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"getSearchCometKeywordDataSourceStructuredInfoForEntry_structuredTypeaheadInfo",selections:u,args:null,argumentDefinitions:[]}],storageKey:null};v={alias:null,args:null,kind:"ScalarField",name:"item_logging_info",storageKey:null};t={condition:"fetch_search_badge",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"XFBSearchEntityBadge",kind:"LinkedField",name:"search_badge",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"enabled",storageKey:null},t],storageKey:null}]};var w=[{kind:"Variable",name:"input",variableName:"search_null_state_argument"}],x={alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},y=[x,{alias:null,args:null,concreteType:"XFBSearchNullStateSectionResult",kind:"LinkedField",name:"result",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"header_text",storageKey:null}],storageKey:null}],z={kind:"InlineFragment",selections:y,type:"XFBSearchNullStateSearchHistoryHeaderRenderingStrategy",abstractKey:null};y={kind:"InlineFragment",selections:y,type:"XFBSearchNullStateGeneralHeaderRenderingStrategy",abstractKey:null};var A={alias:null,args:null,kind:"ScalarField",name:"display_text",storageKey:null},B={alias:"suggestion_logging_info",args:null,concreteType:"XFBSearchSuggestionLoggingSuggestion",kind:"LinkedField",name:"logging_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"fetch_source",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"logging_info",storageKey:null}],storageKey:null};u={alias:null,args:null,concreteType:"StructuredTypeaheadInfo",kind:"LinkedField",name:"sts_info",plural:!1,selections:u,storageKey:null};return{fragment:{argumentDefinitions:[a,b,c,d,e,f,g,h],kind:"Fragment",metadata:null,name:"CometSearchRecentDataSourceQuery",selections:[{condition:"fetch_recent_searches",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:i,concreteType:"RecentSearchConnection",kind:"LinkedField",name:"recent_searches",plural:!1,selections:[{alias:null,args:null,concreteType:"RecentSearchEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[j,k],type:"Node",abstractKey:"__isNode"},l,n,o,p,q,m,r,{kind:"InlineFragment",selections:[s,v],type:"GraphSearchQuery",abstractKey:null}],storageKey:null},t],storageKey:null}],storageKey:null}],storageKey:null}]},{condition:"fetch_nullstate",kind:"Condition",passingValue:!0,selections:[{alias:null,args:w,concreteType:"SearchNullStatePage",kind:"LinkedField",name:"search_null_state",plural:!1,selections:[{alias:null,args:null,concreteType:"SearchNullStatePageResultsConnection",kind:"LinkedField",name:"results",plural:!1,selections:[{alias:null,args:null,concreteType:"SearchNullStatePageResultsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rendering_strategy",plural:!1,selections:[j,z,y,{kind:"InlineFragment",selections:[x,{alias:null,args:null,concreteType:"XFBSearchNullStateSectionResult",kind:"LinkedField",name:"result",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"suggestions",plural:!0,selections:[j,{kind:"InlineFragment",selections:[x,A,s,B],type:"XFBSearchNullStateQuerySuggestion",abstractKey:null}],storageKey:null}],storageKey:null}],type:"XFBSearchNullStateListRenderingStrategy",abstractKey:null}],storageKey:null}],type:"XFBSearchNullStateRenderingStrategyResult",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[d,e,f,h,c,g,a,b],kind:"Operation",name:"CometSearchRecentDataSourceQuery",selections:[{condition:"fetch_recent_searches",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:i,concreteType:"RecentSearchConnection",kind:"LinkedField",name:"recent_searches",plural:!1,selections:[{alias:null,args:null,concreteType:"RecentSearchEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[j,r,{kind:"InlineFragment",selections:[k],type:"Node",abstractKey:"__isNode"},l,n,o,p,q,m,{kind:"InlineFragment",selections:[u,v],type:"GraphSearchQuery",abstractKey:null}],storageKey:null},t],storageKey:null}],storageKey:null}],storageKey:null}]},{condition:"fetch_nullstate",kind:"Condition",passingValue:!0,selections:[{alias:null,args:w,concreteType:"SearchNullStatePage",kind:"LinkedField",name:"search_null_state",plural:!1,selections:[{alias:null,args:null,concreteType:"SearchNullStatePageResultsConnection",kind:"LinkedField",name:"results",plural:!1,selections:[{alias:null,args:null,concreteType:"SearchNullStatePageResultsEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[j,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rendering_strategy",plural:!1,selections:[j,z,y,{kind:"InlineFragment",selections:[x,{alias:null,args:null,concreteType:"XFBSearchNullStateSectionResult",kind:"LinkedField",name:"result",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"suggestions",plural:!0,selections:[j,{kind:"InlineFragment",selections:[x,A,u,B],type:"XFBSearchNullStateQuerySuggestion",abstractKey:null}],storageKey:null}],storageKey:null}],type:"XFBSearchNullStateListRenderingStrategy",abstractKey:null}],storageKey:null}],type:"XFBSearchNullStateRenderingStrategyResult",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]}]},params:{id:"9481428298650330",metadata:{},name:"CometSearchRecentDataSourceQuery",operationKind:"query",text:null}}}();b("relay-runtime").PreloadableQueryRegistry.set(a.params.id,a);e.exports=a}),null);
__d("searchCometIsValidRecentSearchEntityType",[],(function(a,b,c,d,e,f){"use strict";var g=["app","application","event","group","page","user"];function a(a){return g.includes(a==null?void 0:a.toLowerCase())}f["default"]=a}),66);
__d("CometSearchRecentDataSource.query",["fbt","CometSearchRecentDataSourceQuery.graphql","FBLogger","filterNulls","getSearchCometKeywordDataSourceStructuredInfoForEntry","searchCometIsValidRecentSearchEntityType"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j={__typename:"XFBSearchNullStateSearchHistoryHeaderRenderingStrategy",key:"recent-searches",result:{header_text:String(h._(/*BTDS*/"Recent searches"))}};d=i!==void 0?i:i=b("CometSearchRecentDataSourceQuery.graphql");function a(a){var b;if(!a)return[];b=c("filterNulls")(((b=(b=a.search_null_state)==null||(b=b.results)==null?void 0:b.edges)!=null?b:[{node:{rendering_strategy:j}}]).map(function(a){return(a=a.node)==null?void 0:a.rendering_strategy}));var d=[],e=null;for(b of b){if(b.__typename==="%other")continue;var f=b.key,g=b.result;if(g==null||f==null)continue;g=g.header_text;if(b.__typename==="XFBSearchNullStateSearchHistoryHeaderRenderingStrategy"&&g!=null){var h;d.push({entries:k((h=(h=a.viewer)==null||(h=h.recent_searches)==null?void 0:h.edges)!=null?h:[]),key:f,label:g,subtype:"recent_searches",type:"section"})}else if(b.__typename==="XFBSearchNullStateGeneralHeaderRenderingStrategy"&&g!=null)e={header_text:g,key:f};else if(b.__typename==="XFBSearchNullStateListRenderingStrategy"&&e!=null){h=e;g=h.header_text;f=h.key;d.push({entries:l(b),key:f,label:g,subtype:"other",type:"section"});e=null}}return d}function k(a){return c("filterNulls")(a.map(function(a){var b=a.node;a=a.search_badge;if(b==null)return null;var d=b.__typename,e=b.id,f=b.item_logging_info,g=b.name,h=b.profile_picture,i=b.sts_info;b=b.url;var j=c("searchCometIsValidRecentSearchEntityType")(d);i=c("getSearchCometKeywordDataSourceStructuredInfoForEntry")({structuredTypeaheadInfo:i});var k=i.extraLoggingInfo,l=i.label,m=i.markers;i=i.structuredInfo;if(g==null){c("FBLogger")("search").mustfix("Missing name for recent search data with __typename: %s",d);return null}var n=g.toLocaleLowerCase();return{hasSecondaryAction:!0,key:n,label:l!=null?l:g,metaData:{logging:babelHelpers["extends"]({},k,{entityID:j?e:null,entityType:j&&d!=null?d.toLowerCase():null,loggingInfo:f}),markers:new Set(c("filterNulls")(["recent",j?"entity":null].concat(m)))},rawData:{badgeSnippet:(a==null?void 0:a.enabled)===!0?a.snippet:null,profile:j&&e!=null&&(h==null?void 0:h.uri)!=null&&b!=null?{id:e,profilePictureURL:h.uri,url:b}:void 0,structuredInfo:i},subtype:"recent",type:"entry"}}))}function l(a){if(a.__typename!=="XFBSearchNullStateListRenderingStrategy")return[];a=(a=a.result)!=null?a:{};a=a.suggestions;return c("filterNulls")((a!=null?a:[]).map(function(a){if(a.__typename!=="XFBSearchNullStateQuerySuggestion")return null;var b=a.display_text,d=a.key,e=a.sts_info,f=a.suggestion_logging_info;if(b==null){c("FBLogger")("search").mustfix("Missing name for nullstate suggestion search data with __typename: %s",a.__typename);return null}if(d==null){c("FBLogger")("search").mustfix("Missing key for nullstate suggestion search data with __typename: %s",a.__typename);return null}a=c("getSearchCometKeywordDataSourceStructuredInfoForEntry")({structuredTypeaheadInfo:e});e=a.extraLoggingInfo;var g=a.markers;a=a.structuredInfo;f=f!=null?f:{};var h=f.fetch_source;f=f.logging_info;return{key:d,label:b,metaData:{logging:babelHelpers["extends"]({fetchSource:h,loggingInfo:(f!=null?f:[])[0]},e),markers:new Set(new Set(["keyword","nullstate_explore"].concat(g)))},rawData:{structuredInfo:a},subtype:"keyword",type:"entry"}}))}g.query=d;g.normalize=a}),226);
__d("CometSearchRecentDataSourceDispatcherContext",["react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h||d("react");b=a.createContext();g["default"]=b}),98);
__d("FBNucleusCrossFilled20Icon.react",["react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){return i.jsxs("svg",babelHelpers["extends"]({viewBox:"0 0 20 20",width:"1em",height:"1em",fill:"currentColor"},a,{children:[a.title!=null&&i.jsx("title",{children:a.title}),a.children!=null&&i.jsx("defs",{children:a.children}),i.jsx("path",{d:"M15.543 3.043a1 1 0 1 1 1.414 1.414L11.414 10l5.543 5.542a1 1 0 0 1-1.414 1.415L10 11.414l-5.543 5.543a1 1 0 0 1-1.414-1.415L8.586 10 3.043 4.457a1 1 0 1 1 1.414-1.414L10 8.586l5.543-5.543z"})]}))}a.displayName=a.name+" [from "+f.id+"]";a._size=20;a._isSVG=!0;b=a;g["default"]=b}),98);
__d("CometSearchTypeaheadBaseSurfaceRecentViewItemRemoveButton.react",["fbt","CometPressable.react","CometSearchRecentDataSourceDispatcherContext","FBNucleusCrossFilled20Icon.react","FDSIcon.react","XPlatReactEnvironment","react","react-compiler-runtime","useCometInternalTypeaheadState"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;b.useCallback;var k=b.useContext,l=b.useState,m={buttonContainer:{alignItems:"x6s0dn4",borderStartStartRadius:"x1c9tyrk",borderStartEndRadius:"xeusxvb",borderEndEndRadius:"x1pahc9y",borderEndStartRadius:"x1ertn4p",display:"x78zum5",height:"x1fgtraw",justifyContent:"xl56j7k",width:"xgd8bvy",$$css:!0},buttonContainerActive:{boxShadow:"xpud6h4",outline:"x1a2a7pz xvetz19",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(15),e=a.entry;a=a.testid;var f=k(c("CometSearchRecentDataSourceDispatcherContext")),g=l(!1),i=g[0],n=g[1];g=c("useCometInternalTypeaheadState")();var o=g.highlightedEntry;g=g.secondaryActionHighlighted;var p;b[0]!==e||b[1]!==f?(p=function(a){a&&a.type!=="press"&&a.stopPropagation(),n(!0),f==null||f.dispatchRemoveRecentEntry(e)},b[0]=e,b[1]=f,b[2]=p):p=b[2];p=p;var q;b[3]!==e.label?(q=h._(/*BTDS*/"{search_term}, Delete",[h._param("search_term",e.label)]),b[3]=e.label,b[4]=q):q=b[4];q=q;o=o===e&&g===!0&&m.buttonContainerActive;b[5]!==o?(g=[m.buttonContainer,o],b[5]=o,b[6]=g):g=b[6];b[7]!==q||b[8]!==i?(o=j.jsx(c("FDSIcon.react"),{"aria-label":q,color:"secondary",disabled:i,focusable:!1,icon:c("FBNucleusCrossFilled20Icon.react"),size:d("XPlatReactEnvironment").isWeb()?12:20}),b[7]=q,b[8]=i,b[9]=o):o=b[9];b[10]!==p||b[11]!==g||b[12]!==o||b[13]!==a?(q=j.jsx(c("CometPressable.react"),{dynamicHoverTiltAngle:15,dynamicHoverTranslationPercent:.15,onPress:p,overlayRadius:999,showDynamicHover:!0,testid:void 0,xstyle:g,children:o}),b[10]=p,b[11]=g,b[12]=o,b[13]=a,b[14]=q):q=b[14];return q}g["default"]=a}),226);
__d("CometSearchTypeaheadBaseSurfaceRecentViewItem.react",["CometSearchTypeaheadBaseSurfaceRecentViewItemRemoveButton.react","CometTypeaheadFocusLockRegion.react","CometTypeaheadRecentViewItem.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h=["entry"],i,j=i||d("react");function a(a){var b=d("react-compiler-runtime").c(9),e,f;b[0]!==a?(e=a.entry,f=babelHelpers.objectWithoutPropertiesLoose(a,h),b[0]=a,b[1]=e,b[2]=f):(e=b[1],f=b[2]);b[3]!==e?(a=j.jsx(c("CometTypeaheadFocusLockRegion.react"),{children:j.jsx(c("CometSearchTypeaheadBaseSurfaceRecentViewItemRemoveButton.react"),{entry:e,testid:void 0})}),b[3]=e,b[4]=a):a=b[4];var g;b[5]!==e||b[6]!==f||b[7]!==a?(g=j.jsx(c("CometTypeaheadRecentViewItem.react"),babelHelpers["extends"]({},f,{entry:e,itemEndContent:a,itemEndContentKeyboardFocusable:!0,testid:void 0})),b[5]=e,b[6]=f,b[7]=a,b[8]=g):g=b[8];return g}g["default"]=a}),98);
__d("getCometSearchTypeaheadStructuredInfoKey",["getSearchCometKeywordDataSourceStructuredSuggestionKey"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=a.rawData.structuredInfo;return a==null?null:c("getSearchCometKeywordDataSourceStructuredSuggestionKey")(a)}g["default"]=a}),98);
__d("CometSearchTypeaheadDefaultEntryComparator",["BaseDataEntryLabelKeyBuilder","getCometSearchTypeaheadStructuredInfoKey","recoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){var d=c("getCometSearchTypeaheadStructuredInfoKey")(a),e=c("getCometSearchTypeaheadStructuredInfoKey")(b);return d!=null&&e!=null?d===e:c("BaseDataEntryLabelKeyBuilder")(a)===c("BaseDataEntryLabelKeyBuilder")(b)}function a(a,b){if(!h(a,b)){c("recoverableViolation")("The suggestions are not dupes: "+a.key+" compared to "+b.key,"search");return a}var d=c("getCometSearchTypeaheadStructuredInfoKey")(a),e=c("getCometSearchTypeaheadStructuredInfoKey")(b);return d!=null&&e!=null?b:e!=null?b:a}g.areEntriesDupes=h;g.pickEntryToKeep=a}),98);
__d("CometSearchTypeaheadServerDrivenEntryComparator",["FBLogger","getCometSearchTypeaheadStructuredInfoKey"],(function(a,b,c,d,e,f,g){"use strict";function h(a){a=(a=a.rawData)!=null?a:{};a=a.suggestion_keys;if(a==null)throw c("FBLogger")("search").mustfixThrow("Unexpected missing keys");return a}function a(a,b){var d=h(a),e=d.default_key;d=d.keys;var f=h(b),g=f.default_key,i=f.keys;if(d.some(function(a){return i.includes(a)}))return!0;f=c("getCometSearchTypeaheadStructuredInfoKey")(a);var k=c("getCometSearchTypeaheadStructuredInfoKey")(b);f!=null&&f===k&&j("STS dupe: same STS UI key but no keys overlap",a,b);if(d.length>0&&i.length>0)return!1;if(e==null||g==null)return!1;e===g&&a.label.toLowerCase()!==b.label.toLowerCase()&&j("STS dupe: same default key but different label",a,b);return e.toLowerCase()===g.toLowerCase()}function b(a,b){var c=h(a);c=c.tier;var d=h(b);d=d.tier;return c<=d?b:a}function i(a){var b=h(a),c=b.default_key;b=b.keys;return"ui key: "+a.key+", keys: "+(b.join(",")||"empty")+", default key: "+(c!=null?c:"null")+", label: "+a.label}function j(a,b,d){c("FBLogger")("search").warn(a+": ("+i(b)+") vs ("+i(d)+")")}g.areEntriesDupes=a;g.pickEntryToKeep=b}),98);
__d("CometTypeaheadEchoViewItem.react",["CometTypeaheadViewItem.react","CometTypeaheadViewItemIcon.react","FDSText.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h=["entry","isActive","queryString"],i,j=i||d("react");function a(a){var b=d("react-compiler-runtime").c(18),e,f,g,i;b[0]!==a?(e=a.entry,f=a.isActive,i=a.queryString,g=babelHelpers.objectWithoutPropertiesLoose(a,h),b[0]=a,b[1]=e,b[2]=f,b[3]=g,b[4]=i):(e=b[1],f=b[2],g=b[3],i=b[4]);b[5]!==e.label||b[6]!==f?(a=j.jsx(d("CometTypeaheadViewItemIcon.react").CometTypeaheadViewTypedIcon,{isActive:f,label:e.label}),b[5]=e.label,b[6]=f,b[7]=a):a=b[7];i=String(i);var k;b[8]!==i?(k=i.toLowerCase(),b[8]=i,b[9]=k):k=b[9];b[10]!==k?(i=j.jsx(c("FDSText.react"),{numberOfLines:1,type:"body3",children:k}),b[10]=k,b[11]=i):i=b[11];b[12]!==e||b[13]!==f||b[14]!==g||b[15]!==a||b[16]!==i?(k=j.jsx(c("CometTypeaheadViewItem.react"),babelHelpers["extends"]({},g,{entry:e,isActive:f,itemStartContent:a,children:i})),b[12]=e,b[13]=f,b[14]=g,b[15]=a,b[16]=i,b[17]=k):k=b[17];return k}g["default"]=a}),98);
__d("CometTypeaheadSeeAllViewItem.react",["fbt","CometTypeaheadViewItem.react","FDSIcon.react","FDSMagnifyingGlassFilled16Icon","FDSText.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i=["entry","extraViewItemProps","queryString"],j,k=j||(j=d("react"));j.useMemo;function a(a){var b=d("react-compiler-runtime").c(15),e,f,g,h;b[0]!==a?(e=a.entry,f=a.extraViewItemProps,h=a.queryString,g=babelHelpers.objectWithoutPropertiesLoose(a,i),b[0]=a,b[1]=e,b[2]=f,b[3]=g,b[4]=h):(e=b[1],f=b[2],g=b[3],h=b[4]);(a=f)==null||a.placeholderBuilder;a=(f=(a=f)==null?void 0:a.placeholderBuilder)!=null?f:l;f=a;b[5]===Symbol["for"]("react.memo_cache_sentinel")?(a=k.jsx("div",babelHelpers["extends"]({className:"x6s0dn4 xwnonoy x1fmog5m xu25z0z x140muxe xo1y3bh x78zum5 xc9qbxq xl56j7k x14qfxbe"},{children:k.jsx(c("FDSIcon.react"),{color:"white",icon:c("FDSMagnifyingGlassFilled16Icon"),size:16})})),b[5]=a):a=b[5];var j;b[6]!==f||b[7]!==h?(j=f(h),b[6]=f,b[7]=h,b[8]=j):j=b[8];b[9]!==j?(f=k.jsx(c("FDSText.react"),{color:"blueLink",numberOfLines:1,type:"body3",children:j}),b[9]=j,b[10]=f):f=b[10];b[11]!==e||b[12]!==g||b[13]!==f?(h=k.jsx(c("CometTypeaheadViewItem.react"),babelHelpers["extends"]({},g,{entry:e,itemStartContent:a,children:f})),b[11]=e,b[12]=g,b[13]=f,b[14]=h):h=b[14];return h}function l(a){return h._(/*BTDS*/"Search for {=m1}",[h._implicitParam("=m1",k.jsx("strong",{children:h._(/*BTDS*/"{query}",[h._param("query",a.toLowerCase())])}))])}l.displayName=l.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("cometSearchTypeaheadEchoViewItem.resolver",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=a.metaData.markers;return b.has("echo")?a:null}f["default"]=a}),66);
__d("cometSearchTypeaheadKeywordViewItem.resolver",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=a.metaData.markers;return b.has("keyword")?a:null}f["default"]=a}),66);
__d("cometSearchTypeaheadRecentViewItem.resolver",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a.subtype==="recent"?a:null}f["default"]=a}),66);
__d("cometSearchTypeaheadSeeAllViewItem.resolver",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=a.metaData.markers;return b.has("see_all")?a:null}f["default"]=a}),66);
__d("SearchCometTypeaheadViewItemResolver.react",["CometSearchTypeaheadBaseSurfaceRecentViewItem.react","CometTypeaheadEchoViewItem.react","CometTypeaheadKeywordViewItem.react","CometTypeaheadSeeAllViewItem.react","cometSearchTypeaheadEchoViewItem.resolver","cometSearchTypeaheadKeywordViewItem.resolver","cometSearchTypeaheadRecentViewItem.resolver","cometSearchTypeaheadSeeAllViewItem.resolver","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useMemo;function a(a){var b=a.additionalEntryMappings,d=a.seeAllLabelBuilder,e=a.children,f=a.entry;a=a.fallbackViewItem;a=a===void 0?c("CometTypeaheadKeywordViewItem.react"):a;var g=i(function(){return[].concat(b!=null?b:[],j({seeAllLabelBuilder:d}))},[b,d]);g=g.find(function(a){a=a.resolver;return a(f)});if(g){var h=g.viewItem;g=g.viewItemProps;return e(h,g)}return e(a)}function j(a){a=a.seeAllLabelBuilder;return[{resolver:c("cometSearchTypeaheadEchoViewItem.resolver"),viewItem:c("CometTypeaheadEchoViewItem.react")},{resolver:c("cometSearchTypeaheadSeeAllViewItem.resolver"),viewItem:c("CometTypeaheadSeeAllViewItem.react"),viewItemProps:{placeholderBuilder:a}},{resolver:c("cometSearchTypeaheadRecentViewItem.resolver"),viewItem:c("CometSearchTypeaheadBaseSurfaceRecentViewItem.react")},{resolver:c("cometSearchTypeaheadKeywordViewItem.resolver"),viewItem:c("CometTypeaheadKeywordViewItem.react")}].filter(Boolean)}g["default"]=a}),98);
__d("XCometGamingVideoControllerRouteBuilder",["jsRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsRouteBuilder")("/gaming/video/",Object.freeze({}),void 0);b=a;g["default"]=b}),98);
__d("cometTypeaheadMemoizeEntryKey",["cometUniqueID","memoizeStringOnly"],(function(a,b,c,d,e,f,g){"use strict";var h=c("memoizeStringOnly")(function(a){return c("cometUniqueID")()});function a(a){return h(a)}g["default"]=a}),98);
__d("cometSearchTypeaheadPayloadDecoratorAddEcho",["BaseDataEntryKeyBuilder","cometTypeaheadMemoizeEntryKey"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.keyBuilder,d=b===void 0?c("BaseDataEntryKeyBuilder"):b,e=a.limit;return function(a){var b=a.entries,f=a.params.query;b=b!=null?b:[];var g=b.find(function(a){return d(a).trim().toLowerCase()===f.trim().toLowerCase()})!=null,h=[];if(!g&&b.length<e){g=c("cometTypeaheadMemoizeEntryKey")(f+"-echo");g={key:g,label:f,metaData:{markers:new Set(["echo"])},rawData:{type:"echo"}};h.push(g)}return babelHelpers["extends"]({},a,{entries:[].concat(b,h)})}}g["default"]=a}),98);
__d("cometSearchTypeaheadPayloadDecoratorAddSeeAll",["cometTypeaheadMemoizeEntryKey"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.position;return function(a){var d=a.entries,e=a.params.query;d=d!=null?d:[];var f=c("cometTypeaheadMemoizeEntryKey")(e+"-see_all");f={key:f,label:e,metaData:{markers:new Set(["see_all"])},rawData:{type:"see_all"}};e=[];switch(b){case"bottom":e=[].concat(d,[f]);break;case"top":e=[f].concat(d);break}return babelHelpers["extends"]({},a,{entries:e})}}g["default"]=a}),98);
__d("cometSearchTypeaheadDecorateMixedPayload",["BaseTypeaheadPayloadDecoratorAddLimit","baseTypeaheadFetchPayloadDecorate","cometSearchTypeaheadPayloadDecoratorAddEcho","cometSearchTypeaheadPayloadDecoratorAddSeeAll"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var d=b.excludeSeeAllAndEcho;d=d===void 0?!1:d;var e=b.keyBuilder,f=b.limit;b=b.seeAllPosition;b=b===void 0?"bottom":b;return c("baseTypeaheadFetchPayloadDecorate")(a,[c("BaseTypeaheadPayloadDecoratorAddLimit")(f),d?null:c("cometSearchTypeaheadPayloadDecoratorAddEcho")({keyBuilder:e,limit:f}),d?null:c("cometSearchTypeaheadPayloadDecoratorAddSeeAll")({position:b})].filter(Boolean))}g["default"]=a}),98);
__d("cometSearchTypeaheadPayloadDecoratorApplySectionLimits",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){return function(c){for(var d of c.entries){var e=b(d);e=e!=null?a.get(e):null;e!=null&&d.type==="section"&&(d.entries=d.entries.slice(0,e))}return c}}f["default"]=a}),66);
__d("cometSearchTypeaheadDecorateRecentPayload",["BaseTypeaheadPayloadDecoratorAddLimit","baseTypeaheadFetchPayloadDecorate","cometSearchTypeaheadPayloadDecoratorApplySectionLimits"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var d=b.getSectionLimitKey,e=b.limit;b=b.sectionLimits;var f=a.entries.every(function(a){return a.type==="section"});return c("baseTypeaheadFetchPayloadDecorate")(a,[f&&b!=null?c("cometSearchTypeaheadPayloadDecoratorApplySectionLimits")(b,d):c("BaseTypeaheadPayloadDecoratorAddLimit")(e)])}g["default"]=a}),98);
__d("cometSearchTypeaheadDedupeAndLog",["FBLogger","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("ODS").__setRef("cometSearchTypeaheadDedupeAndLog");function a(a,b,c){var d=new Map(),e=[];for(b of b){var f=d.get(b.key);f!=null?i({caller:c,dupeEntry:b,existingEntry:f,strategy:a}):(d.set(b.key,b),e.push(b))}return e}function i(a){var b=a.caller,d=a.dupeEntry,e=a.existingEntry;a=a.strategy;var f=e.metaData.markers,g=d.metaData.markers;c("FBLogger")("search").warn("STS Dupe encountered: "+e.key+" ("+Array.from(f).join("_")+", label: "+e.label+") compared to "+d.key+"\n    ("+Array.from(g).join("_")+", label: "+d.label+")");var i="comet_ta_sts_dupe_v4."+a,j=["react_key_"+(Array.from(f).join("_")||"plain_keyword"),b,"existing_kind_"+Array.from(f).join("_"),"dupe_kind_"+Array.from(g).join("_")].join(".");h.onReady(function(a){a.bumpEntityKey(354,i,j,1)})}g["default"]=a}),98);
__d("cometSearchTypeaheadSTSDedupeEntries",["CometSearchTypeaheadDefaultEntryComparator","CometSearchTypeaheadServerDrivenEntryComparator","cometSearchTypeaheadDedupeAndLog","filterNulls"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,c){c===void 0&&(c="bootstrap_and_backend_merge");var e=a.concat(b).every(function(a){return a.rawData.suggestion_keys!=null});return h.apply(void 0,[a,b,c].concat(e?[d("CometSearchTypeaheadServerDrivenEntryComparator").areEntriesDupes,d("CometSearchTypeaheadServerDrivenEntryComparator").pickEntryToKeep]:[d("CometSearchTypeaheadDefaultEntryComparator").areEntriesDupes,d("CometSearchTypeaheadDefaultEntryComparator").pickEntryToKeep]))}function h(a,b,e,f,g){var h=d("CometSearchTypeaheadServerDrivenEntryComparator").areEntriesDupes,i=[],j=new Set(b);for(a of a)i.push(a);for(a of b){b=[];for(var k=0;k<i.length;k++){var l=i[k];l!=null&&f(l,a)&&b.push(k)}l=b[0];k=l!=null?i[l]:null;if(k!=null&&!j.has(k)){k=g(k,a);i[l]=k;for(l of b){b=i[l];b!=null&&b!==k&&b!==g(b,a)&&(i[l]=null)}}else i.push(a)}return c("cometSearchTypeaheadDedupeAndLog")(h?"with_keys":"without_keys",c("filterNulls")(i),e)}g["default"]=a}),98);
__d("cometSearchTypeaheadSTSDedupeCachedEntries",["cometSearchTypeaheadSTSDedupeEntries","filterNulls"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var d=c("cometSearchTypeaheadSTSDedupeEntries")(a.map(function(a){return a.entry}),b.map(function(a){return a.entry}),"query_cache"),e=[].concat(a,b);return c("filterNulls")(d.map(function(a){return e.find(function(b){return b.entry===a})}))}g["default"]=a}),98);
__d("searchCometTypeaheadGetHighConfidenceResult",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=a.metaData,c=a.rawData;b=b.markers;if((a.subtype==="keyword"||a.subtype==="recent")&&b.has("high_confidence")){c=(b=(a=c.structuredInfo)==null?void 0:a.high_confidence_result)!=null?b:{};a=c.hcm_id;b=c.source_as_enum;if(a!=null&&b!=null)return{id:a,source:b}}}f["default"]=a}),66);
__d("searchCometTypeaheadGetStsDisambiguation",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=a.metaData,c=a.rawData;b=b.markers;if(a.subtype==="keyword"&&b.has("disambiguation")){c=(b=(a=c.structuredInfo)==null||(a=a.disambiguation_result)==null?void 0:a.disambiguation_info_list[0])!=null?b:{};a=c.type;if(a!=null)return{primary:{type:a}}}}f["default"]=a}),66);
__d("searchCometTypeaheadPushErrorToast",["fbt","cometPushToast"],(function(a,b,c,d,e,f,g,h){"use strict";function a(){d("cometPushToast").cometPushErrorToast({message:h._(/*BTDS*/"Sorry, something went wrong. Please try again at a later time.")})}g["default"]=a}),226);
__d("useSearchCometEventEmitterContext",["FBLogger","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useContext;function a(a){a=i(a);a==null&&c("FBLogger")("search").mustfix("Missing event emitter context");return a}g["default"]=a}),98);
__d("searchCometTypeaheadWithRecentDataSourceContext",["CometSearchRecentDataSourceDispatcherContext","SearchCometTypeaheadEventEmitterContext","react","react-compiler-runtime","useCometInternalTypeaheadFetch","useCometInternalTypeaheadStateDispatcher","useSearchCometEventEmitterContext"],(function(a,b,c,d,e,f,g){"use strict";var h=["inputRef","onChange","onPressEntry","onSelectFreeformQuery"],i,j=i||(i=d("react"));b=i;b.useCallback;var k=b.useEffect;b.useMemo;function a(a,b){var e=b.dataSource,f=b.shouldSubscribeToRecentSearches;function g(b){var g=d("react-compiler-runtime").c(28),l,m,n,o,p;g[0]!==b?(l=b.inputRef,m=b.onChange,n=b.onPressEntry,o=b.onSelectFreeformQuery,p=babelHelpers.objectWithoutPropertiesLoose(b,h),g[0]=b,g[1]=l,g[2]=m,g[3]=n,g[4]=o,g[5]=p):(l=g[1],m=g[2],n=g[3],o=g[4],p=g[5]);b=c("useCometInternalTypeaheadFetch")();var q=b.refetch;b=c("useCometInternalTypeaheadStateDispatcher")();var r=b.dispatchHighlightedEntry;b=(b=c("useSearchCometEventEmitterContext")(c("SearchCometTypeaheadEventEmitterContext")))!=null?b:{};var s=b.subscribeToRecentSearchEntryAdded,t;g[6]!==s?(b=function(){if(f)return s==null?void 0:s(i)},t=[s],g[6]=s,g[7]=b,g[8]=t):(b=g[7],t=g[8]);k(b,t);g[9]!==o?(b=function(a){var b={hasSecondaryAction:!0,key:a,label:a,metaData:{markers:new Set(["recent"])},rawData:{},subtype:"recent",type:"entry"};e.addRecentEntry(b);o&&o(a)},g[9]=o,g[10]=b):b=g[10];t=b;g[11]!==q?(b=function(a){e.removeRecentEntry(a,{onBeforeCommitMutation:function(){q({source:"cache"})}})},g[11]=q,g[12]=b):b=g[12];var u=b;g[13]!==r||g[14]!==n||g[15]!==u?(b=function(a,b){var c,d=a.label,f=a.metaData;c=(c=f==null?void 0:f.markers)!=null?c:new Set();if(b===!0&&a.subtype==="recent"){u(a);r({entry:null,secondaryActionHighlighted:null,source:null});return}if(c.has("nullstate_explore")){n&&n(a);return}var g=new Set(["recent"]);c.has("entity")&&g.add("entity");c.has("direct_nav")&&g.add("direct_nav");c.has("high_confidence")&&g.add("high_confidence");a.subtype==="recent"||a.subtype==="bootstrap"||a.subtype==="keyword"?c=babelHelpers["extends"]({},a.rawData,{badgeSnippet:null}):c={};f=(f=f==null?void 0:f.logging)!=null?f:{};var h=f.entityID,i=f.entityType,j=f.loggingInfo,k=f.stsDirectNavEntityID,l=f.stsDirectNavType,m=f.stsDisambiguationType,o=f.stsHighConfidenceID;f=f.stsHighConfidenceSource;e.addRecentEntry({hasSecondaryAction:!0,key:d.toLocaleLowerCase(),label:d,metaData:{logging:{entityID:h,entityType:i,loggingInfo:j,stsDirectNavEntityID:k,stsDirectNavType:l,stsDisambiguationType:m,stsHighConfidenceID:o,stsHighConfidenceSource:f},markers:g},rawData:c,subtype:"recent",type:"entry"});n==null||n(a,b)},g[13]=r,g[14]=n,g[15]=u,g[16]=b):b=g[16];b=b;var v;g[17]!==u?(v={dispatchRemoveRecentEntry:u},g[17]=u,g[18]=v):v=g[18];v=v;v=v;var w;g[19]!==l||g[20]!==t||g[21]!==b||g[22]!==m||g[23]!==p?(w=j.jsx(a,babelHelpers["extends"]({},p,{inputRef:l,onChange:m,onPressEntry:b,onSelectFreeformQuery:t})),g[19]=l,g[20]=t,g[21]=b,g[22]=m,g[23]=p,g[24]=w):w=g[24];g[25]!==v||g[26]!==w?(l=j.jsx(c("CometSearchRecentDataSourceDispatcherContext").Provider,{value:v,children:w}),g[25]=v,g[26]=w,g[27]=l):l=g[27];return l}function i(a){e.addRecentEntry(a)}return g}g["default"]=a}),98);
__d("useCometSearchRoutingQueryString",["CometRouteParams","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a=d("react-compiler-runtime").c(2),b=d("CometRouteParams").useRouteParams(),c;a[0]!==b.q?(c=typeof b.q==="string"?b.q.trim():"",a[0]=b.q,a[1]=c):c=a[1];return c}g["default"]=a}),98);
__d("useCometSearchScopedTypeaheadPressEntryHandler",["react","react-compiler-runtime","searchCometTypeaheadGetHighConfidenceResult","searchCometTypeaheadGetStsDisambiguation","useCometTypeaheadNavigate"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(a){var b=d("react-compiler-runtime").c(5),e=a.callback,f=a.loggingProvider,g=a.urlBuilder,h=c("useCometTypeaheadNavigate")();b[0]!==e||b[1]!==f||b[2]!==h||b[3]!==g?(a=function(a){var b=a.rawData;a=a.subtype==="your_group_activity"?b.url:g({entryPointAction:"SEARCH_BOX",highConfidenceResult:c("searchCometTypeaheadGetHighConfidenceResult")(a),query:a.label,stsDisambiguation:(b=c("searchCometTypeaheadGetStsDisambiguation")(a))!=null?b:void 0,typeaheadSessionID:f.getSessionID()});h(a);e&&e()},b[0]=e,b[1]=f,b[2]=h,b[3]=g,b[4]=a):a=b[4];return a}g["default"]=a}),98);
__d("useCometSearchScopedTypeaheadSelectFreeformQueryHandler",["react","react-compiler-runtime","useCometTypeaheadNavigate"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(a){var b=d("react-compiler-runtime").c(5),e=a.callback,f=a.loggingProvider,g=a.urlBuilder,h=c("useCometTypeaheadNavigate")();b[0]!==e||b[1]!==f||b[2]!==h||b[3]!==g?(a=function(a){a=g({entryPointAction:"SEARCH_BOX",query:a,typeaheadSessionID:f.getSessionID()});h(a);e&&e()},b[0]=e,b[1]=f,b[2]=h,b[3]=g,b[4]=a):a=b[4];return a}g["default"]=a}),98);
__d("useCometTypeaheadStateQueryString",["react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");var i=b.useEffect,j=b.useState;function a(a){var b=d("react-compiler-runtime").c(5),c=j(a),e=c[0],f=c[1],g;b[0]!==a?(c=function(){return f(a)},g=[a],b[0]=a,b[1]=c,b[2]=g):(c=b[1],g=b[2]);i(c,g);b[3]!==e?(c=[e,f],b[3]=e,b[4]=c):c=b[4];return c}g["default"]=a}),98);
__d("useHostedRouteEntityKey",["getCometEntityKey","react","react-compiler-runtime","useHostedRoute"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useMemo;function a(){var a=d("react-compiler-runtime").c(2),b=c("useHostedRoute")(),e;a[0]!==b?(e=b?c("getCometEntityKey")(b):null,a[0]=b,a[1]=e):e=a[1];b=e;a=b;return a}g["default"]=a}),98);
__d("useSearchCometRecentSearchDataSource",["Actor","CometRelay","CometSearchRecentDataSource","CometSearchRecentDataSource.query","WebPixelRatio","XCometActivityLogControllerRouteBuilder","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useMemo,j=16;function a(a){var b=a.fetchSearchBadge,e=b===void 0?!1:b,f=a.filter,g=a.nullStateSurface,h=a.searchScopeEntityID,k=d("CometRelay").useRelayEnvironment();b=d("Actor").useActor();a=b[0];var l=c("XCometActivityLogControllerRouteBuilder").buildURL({category_key:"SEARCH",entry_point:"edit_search_history",log_filter:"search",vanity:a});return i(function(){return new(c("CometSearchRecentDataSource"))({activityLogURL:l,gqlQuery:d("CometSearchRecentDataSource.query").query,limit:j,normalize:d("CometSearchRecentDataSource.query").normalize,queryVariablesBuilderFunction:function(){return{fetch_nullstate:g!=null,fetch_recent_searches:f!=null,fetch_search_badge:e,filter:f,first:j,scale:d("WebPixelRatio").get(),search_null_state_argument:g!=null?{surface:{name:g}}:{surface:{name:"GLOBAL"}},search_scope_entity_id:h}},relayEnvironment:k})},[l,e,f,g,k,h])}g["default"]=a}),98);
__d("useSearchCometTypeaheadCompositeDataSource",["BaseDataEntryLabelKeyBuilder","CometRelay","CometSearchBootstrapKeywordsDataSource","CometSearchKeywordDataSource","Promise","cometSearchTypeaheadDecorateMixedPayload","cometSearchTypeaheadDecorateRecentPayload","cometSearchTypeaheadSTSDedupeCachedEntries","cometSearchTypeaheadSTSDedupeEntries","justknobx","react","react-compiler-runtime","searchCometTypeaheadPushErrorToast"],(function(a,b,c,d,e,f,g){"use strict";var h,i;e=i||d("react");e.useCallback;e.useMemo;function a(a){var e=d("react-compiler-runtime").c(51),f=a.config,g=a.recentDataSource,i=a.searchScopeEntityID;a=f.dataSources;var n=f.logging;f=f.view;var o=a.bootstrapKeywordsDataSourceParams;a=a.keywordDataSourceParams;var p=n.sessionContext,q=f.renderLimit,r=f.sectionLimits;n=d("CometRelay").useRelayEnvironment();e[0]!==o||e[1]!==q||e[2]!==n?(f=o!=null?new(c("CometSearchBootstrapKeywordsDataSource"))(babelHelpers["extends"]({},o,{limit:q,relayEnvironment:n})):null,e[0]=o,e[1]=q,e[2]=n,e[3]=f):f=e[3];o=f;var s=o;e[4]!==a||e[5]!==q||e[6]!==n?(f=new(c("CometSearchKeywordDataSource"))(babelHelpers["extends"]({},a,{dedupe:c("cometSearchTypeaheadSTSDedupeCachedEntries"),limit:q,onError:m,relayEnvironment:n})),e[4]=a,e[5]=q,e[6]=n,e[7]=f):f=e[7];o=f;var t=o;e[8]!==q?(a=function(a){var b=a.entries;a=a.params;return c("cometSearchTypeaheadDecorateMixedPayload")({entries:b,params:a},{excludeSeeAllAndEcho:(b=c("justknobx")._("1509"))!=null?b:!1,keyBuilder:c("BaseDataEntryLabelKeyBuilder"),limit:q})},e[8]=q,e[9]=a):a=e[9];var u=a,v=l;e[10]!==s||e[11]!==g?(n=function(){s==null||s.bootstrap(),g==null||g.bootstrap()},e[10]=s,e[11]=g,e[12]=n):n=e[12];f=n;e[13]!==p||e[14]!==g||e[15]!==i?(o=function(a,b){if(g==null)return;if(i==null){g.add(a,p,b);return}var c=a.key,d=a.label,e=a.metaData;a=a.rawData;e={logging:{searchScopeEntityID:i},markers:e.markers};c={hasSecondaryAction:!0,key:c,label:d,metaData:e,rawData:a,subtype:"recent",type:"entry"};g.add(c,p,b)},e[13]=p,e[14]=g,e[15]=i,e[16]=o):o=e[16];a=o;e[17]!==s||e[18]!==u||e[19]!==t||e[20]!==q||e[21]!==g||e[22]!==r?(n=function(a){var b=a.query;if(b===""&&g!=null){var d=g.fetchCache(a),e=d.entries;d=d.params;return c("cometSearchTypeaheadDecorateRecentPayload")({entries:e,params:d},{getSectionLimitKey:k,limit:q,sectionLimits:r})}if(b==="")return{entries:[],params:a};if(s==null){e=t.fetchCache(a);return u(babelHelpers["extends"]({},e))}d=s.fetchCache(a);b=d.entries;e=d.params;if(b.length>=q)return u({entries:b,params:e});d=t.fetchCache(a);e=d.entries;a=d.params;d=v(b,e);return u({entries:d,params:a})},e[17]=s,e[18]=u,e[19]=t,e[20]=q,e[21]=g,e[22]=r,e[23]=n):n=e[23];o=n;e[24]!==s||e[25]!==u||e[26]!==t||e[27]!==q||e[28]!==g||e[29]!==r?(n=function(a){var d=a.query;if(d===""&&g!=null)return g.fetchNetwork(a).then(function(a){return c("cometSearchTypeaheadDecorateRecentPayload")({entries:a.entries,params:a.params},{getSectionLimitKey:j,limit:q,sectionLimits:r})});if(d==="")return(h||(h=b("Promise"))).resolve({entries:[],params:a});return s==null?t.fetchNetwork(a).then(function(a){return u(babelHelpers["extends"]({},a))}):t.fetchNetwork(a).then(function(b){var c=s.fetchCache(a);c=c.entries;var d=b.entries;b=b.params;c=v(c,d);return u({entries:c,params:b})})},e[24]=s,e[25]=u,e[26]=t,e[27]=q,e[28]=g,e[29]=r,e[30]=n):n=e[30];n=n;var w;e[31]!==g?(w=function(a,b){g!=null&&g.remove(a,b)},e[31]=g,e[32]=w):w=e[32];w=w;var x;e[33]!==t?(x=function(){return t.clearQueryCache()},e[33]=t,e[34]=x):x=e[34];var y;e[35]!==g?(y=function(){return g==null?void 0:g.clear()},e[35]=g,e[36]=y):y=e[36];var z;e[37]!==s?(z=function(){return s},e[37]=s,e[38]=z):z=e[38];var A;e[39]!==g?(A=function(){return g==null?void 0:g.refresh()},e[39]=g,e[40]=A):A=e[40];var B;e[41]!==a||e[42]!==f||e[43]!==o||e[44]!==n||e[45]!==w||e[46]!==x||e[47]!==y||e[48]!==z||e[49]!==A?(B={addRecentEntry:a,bootstrap:f,clearQueryCache:x,clearRecentSearches:y,fetchCache:o,fetchNetwork:n,getBootstrapKeywordsDataSource:z,refreshRecentSearches:A,removeRecentEntry:w},e[41]=a,e[42]=f,e[43]=o,e[44]=n,e[45]=w,e[46]=x,e[47]=y,e[48]=z,e[49]=A,e[50]=B):B=e[50];a=B;return a}function j(a){return a.type==="section"?a.subtype:null}function k(a){return a.type==="section"?a.subtype:null}function l(a,b){return c("cometSearchTypeaheadSTSDedupeEntries")(a,b,"bootstrap_and_backend_merge")}function m(){return c("searchCometTypeaheadPushErrorToast")()}g["default"]=a}),98);
__d("useSearchCometTypeaheadRecentDataSourceContextDecorator",["react","searchCometTypeaheadWithRecentDataSourceContext"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useMemo;function a(a,b){b===void 0&&(b=!0);return i(function(){return{decorate:function(){return c("searchCometTypeaheadWithRecentDataSourceContext").apply(void 0,arguments)},params:{dataSource:a,shouldSubscribeToRecentSearches:b}}},[a,b])}g["default"]=a}),98);
__d("useSearchCometTypeaheadViewItem",["SearchCometTypeaheadViewItemResolver.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h=["entry","queryString"],i,j=i||(i=d("react"));i.useCallback;function a(a){var b=d("react-compiler-runtime").c(4),e=a.additionalEntryMappings,f=a.getLinkProps,g=a.seeAllLabelBuilder;b[0]!==e||b[1]!==f||b[2]!==g?(a=function(a){var b=a.entry,d=a.queryString,i=babelHelpers.objectWithoutPropertiesLoose(a,h);return j.jsx(c("SearchCometTypeaheadViewItemResolver.react"),{additionalEntryMappings:e,entry:b,seeAllLabelBuilder:g,children:function(a,c){return j.jsx(a,babelHelpers["extends"]({},i,{entry:b,extraViewItemProps:c,linkProps:f==null?void 0:f({entry:b,queryString:d}),queryString:d}))}})},b[0]=e,b[1]=f,b[2]=g,b[3]=a):a=b[3];return a}g["default"]=a}),98);
__d("useSearchCometTypeaheadViewListStrategy",["CometScrollableArea.react","FocusInertRegion.react","focusScopeQueries","react","react-compiler-runtime","react-strict-dom","useCometTypeaheadSectionedViewListStrategy","useSearchCometTypeaheadViewItem"],(function(a,b,c,d,e,f,g){"use strict";var h=["ariaProps","entries","highlightedEntry","isLoading","queryString"],i,j=i||(i=d("react"));i.useCallback;function a(a){var b=d("react-compiler-runtime").c(15),e=a.additionalEntryMappings,f=a.afterNullstateContent,g=a.emptyStateContent,i=a.getLinkProps,k=a.isScrollable,l=a.nullstateContent,m=a.onHeaderActionPress,n=a.scrollableXStyle,o=a.seeAllLabelBuilder,p=a.xstyle;b[0]!==e||b[1]!==i||b[2]!==o?(a={additionalEntryMappings:e,getLinkProps:i,seeAllLabelBuilder:o},b[0]=e,b[1]=i,b[2]=o,b[3]=a):a=b[3];e=c("useSearchCometTypeaheadViewItem")(a);b[4]!==g||b[5]!==l||b[6]!==m||b[7]!==e?(i={emptyStateContent:g,nullstateContent:l,onHeaderActionPress:m,viewItemStrategyRenderer:e},b[4]=g,b[5]=l,b[6]=m,b[7]=e,b[8]=i):i=b[8];var q=c("useCometTypeaheadSectionedViewListStrategy")(i);b[9]!==q||b[10]!==f||b[11]!==k||b[12]!==n||b[13]!==p?(o=function(a){var b=a.ariaProps,e=a.entries,g=a.highlightedEntry,i=a.isLoading,l=a.queryString;a=babelHelpers.objectWithoutPropertiesLoose(a,h);b=j.jsxs(j.Fragment,{children:[j.jsx(q,babelHelpers["extends"]({ariaProps:b,entries:e,highlightedEntry:g,isLoading:i,queryString:l},a)),f!=null&&l.length===0&&e.length>0?f:null]});g=l==="";return j.jsx(c("FocusInertRegion.react"),{focusQuery:d("focusScopeQueries").tabbableScopeQuery,children:j.jsx(d("react-strict-dom").html.div,{style:p,"data-testid":void 0,children:k?j.jsx(c("CometScrollableArea.react"),{horizontal:!1,xstyle:n,children:b}):b})})},b[9]=q,b[10]=f,b[11]=k,b[12]=n,b[13]=p,b[14]=o):o=b[14];return o}g["default"]=a}),98);/*FB_PKG_DELIM*/
__d("CometTahoeCustomVideoAreaContext",["emptyFunction","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useMemo;var j=b.useState,k=i.createContext({customVideoAreaHidden:!0,setCustomVideoAreaHidden:c("emptyFunction")});function a(a){var b=d("react-compiler-runtime").c(5);a=a.children;var c=j(!0),e=c[0];c=c[1];b[0]!==e?(c={customVideoAreaHidden:e,setCustomVideoAreaHidden:c},b[0]=e,b[1]=c):c=b[1];e=c;c=e;b[2]!==a||b[3]!==c?(e=i.jsx(k.Provider,{value:c,children:a}),b[2]=a,b[3]=c,b[4]=e):e=b[4];return e}g.CometTahoeCustomVideoAreaContext=k;g.CometTahoeCustomVideoAreaContextProvider=a}),98);
__d("CometTahoeSidePaneContext",["react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h||d("react");b={rightRailExpanded:!1,rightRailHidden:!1,setRightRailExpanded:function(){},setRightRailHidden:function(){}};c=a.createContext(b);g["default"]=c}),98);
__d("VideoControlsContainerFocusedContext",["react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h||d("react");b=a.createContext(!1);g["default"]=b}),98);
__d("VideoPlayerControlsContainerOverlay.react",["CometErrorBoundary.react","FocusWithinHandler.react","VideoControlsContainerFocusedContext","VideoPlayerControlsBottomRowAddOnContext","VideoPlayerControlsHiddenContext","VideoPlayerHooks","react","react-compiler-runtime","stylex","useResizeObserver"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=i||(i=d("react"));b=i;var l=b.useEffect,m=b.useState,n=44,o={backgroundGradient:{backgroundImage:"x11v4dcs",bottom:"x1ey2m1c",position:"x10l6tqk",transitionDuration:"x1d8287x",transitionProperty:"x6o7n8i",transitionTimingFunction:"xl405pv",width:"xh8yej3",zIndex:"x8knxv4",$$css:!0},hidden:{opacity:"xg01cxk",pointerEvents:"x47corl",visibility:"xlshs6z",$$css:!0},visible:{opacity:"x1hc1fzr",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(18),e=a.children,f=a.height,g=a.initialBottomRowAddOn,i=a.isBackgroundVisible,p=a.isVisible,q=a.xstyle;a=g===void 0?null:g;g=m(0);var r=g[0],s=g[1];b[0]===Symbol["for"]("react.memo_cache_sentinel")?(g=function(a){s(a.height)},b[0]=g):g=b[0];var t=c("useResizeObserver")(g),u=d("VideoPlayerControlsBottomRowAddOnContext").useVideoPlayerControlsBottomRowAddOn(a);g=(j||(j=d("VideoPlayerHooks"))).useVideoPlayerCaptionsReservationActions();var v=g.release,w=g.reserve,x=f!=null?f:n;b[1]!==x||b[2]!==i||b[3]!==p||b[4]!==v||b[5]!==w?(a=function(){if(Boolean(p)||Boolean(i)){var a=w({location:"bottom",size:x});return function(){v(a)}}},g=[p,i,w,v,x],b[1]=x,b[2]=i,b[3]=p,b[4]=v,b[5]=w,b[6]=a,b[7]=g):(a=b[6],g=b[7]);l(a,g);var y=i===!1||p===!1,z=i===!0||p===!0;b[8]!==u||b[9]!==r||b[10]!==t||b[11]!==e||b[12]!==x||b[13]!==y||b[14]!==z||b[15]!==p||b[16]!==q?(f=k.jsx(c("FocusWithinHandler.react"),{children:function(a,b){return k.jsx(c("VideoControlsContainerFocusedContext").Provider,{value:b,children:k.jsxs("div",babelHelpers["extends"]({},{0:{className:"x1ey2m1c x1q0g3np x10l6tqk x1d8287x x6o7n8i xl405pv xh8yej3 x11uqc5h"},4:{className:"x1ey2m1c x10l6tqk x1d8287x x6o7n8i xl405pv xh8yej3 x11uqc5h x6s0dn4 xzt5al7 x78zum5 x1q0g3np"},2:{className:"x1ey2m1c x1q0g3np x10l6tqk x1d8287x x6o7n8i xl405pv xh8yej3 x11uqc5h xg01cxk x47corl xlshs6z"},6:{className:"x1ey2m1c x10l6tqk x1d8287x x6o7n8i xl405pv xh8yej3 x11uqc5h x6s0dn4 xzt5al7 x78zum5 x1q0g3np xg01cxk x47corl xlshs6z"},1:{className:"x1ey2m1c x1q0g3np x10l6tqk x1d8287x x6o7n8i xl405pv xh8yej3 x11uqc5h x1hc1fzr"},5:{className:"x1ey2m1c x10l6tqk x1d8287x x6o7n8i xl405pv xh8yej3 x11uqc5h x6s0dn4 xzt5al7 x78zum5 x1q0g3np x1hc1fzr"},3:{className:"x1ey2m1c x1q0g3np x10l6tqk x1d8287x x6o7n8i xl405pv xh8yej3 x11uqc5h x47corl xlshs6z x1hc1fzr"},7:{className:"x1ey2m1c x10l6tqk x1d8287x x6o7n8i xl405pv xh8yej3 x11uqc5h x6s0dn4 xzt5al7 x78zum5 x1q0g3np x47corl xlshs6z x1hc1fzr"}}[!!(u==null)<<2|!!(p===!1)<<1|!!(p===!0)<<0],{"data-testid":void 0,children:[k.jsx("div",{className:(h||(h=c("stylex")))(o.backgroundGradient,y&&o.hidden,z&&o.visible,q),style:{height:x+r}}),k.jsx(c("VideoPlayerControlsHiddenContext").Provider,{value:y,children:u==null?e:k.jsxs(k.Fragment,{children:[k.jsx("div",babelHelpers["extends"]({className:"x6s0dn4 xzt5al7 x78zum5 x1q0g3np"},{children:e})),k.jsx(c("CometErrorBoundary.react"),{children:k.jsx("div",{ref:t,children:u})})]})})]}))})}}),b[8]=u,b[9]=r,b[10]=t,b[11]=e,b[12]=x,b[13]=y,b[14]=z,b[15]=p,b[16]=q,b[17]=f):f=b[17];return f}g["default"]=a}),98);
__d("VideoPlayerControlsGroups.react",["VideoControlsContainerFocusedContext","VideoPlayerControlsHiddenContext","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useContext;function a(a){var b=d("react-compiler-runtime").c(10),e=a.children,f=a.isVisible,g=a.noPaddingEnd;a=a.noPaddingStart;f=f===void 0?!0:f;g=g===void 0?!1:g;a=a===void 0?!1:a;var h=j(c("VideoControlsContainerFocusedContext"));f=f||h;h=j(c("VideoPlayerControlsHiddenContext"));var k;b[0]!==f||b[1]!==g||b[2]!==a?(k={0:{className:"x6s0dn4 x78zum5 x1q0g3np x2lah0s xozqiw3 xexx8yu x1gabggj x18d9i69 xaso8d8 x1fmh03i x47corl"},4:{className:"x6s0dn4 x78zum5 x1q0g3np x2lah0s xozqiw3 xexx8yu x18d9i69 xaso8d8 xyri2b x1fmh03i x47corl"},2:{className:"x6s0dn4 x78zum5 x1q0g3np x2lah0s xozqiw3 xexx8yu x1gabggj x18d9i69 x1c1uobl x1fmh03i x47corl"},6:{className:"x6s0dn4 x78zum5 x1q0g3np x2lah0s xozqiw3 xexx8yu x18d9i69 xyri2b x1c1uobl x1fmh03i x47corl"},1:{className:"x6s0dn4 x78zum5 x1q0g3np x2lah0s xozqiw3 xexx8yu x1gabggj x18d9i69 xaso8d8 x1hc1fzr"},5:{className:"x6s0dn4 x78zum5 x1q0g3np x2lah0s xozqiw3 xexx8yu x18d9i69 xaso8d8 xyri2b x1hc1fzr"},3:{className:"x6s0dn4 x78zum5 x1q0g3np x2lah0s xozqiw3 xexx8yu x1gabggj x18d9i69 x1c1uobl x1hc1fzr"},7:{className:"x6s0dn4 x78zum5 x1q0g3np x2lah0s xozqiw3 xexx8yu x18d9i69 xyri2b x1c1uobl x1hc1fzr"}}[!!g<<2|!!a<<1|!!f<<0],b[0]=f,b[1]=g,b[2]=a,b[3]=k):k=b[3];g=h||!f;b[4]!==e||b[5]!==g?(a=i.jsx(c("VideoPlayerControlsHiddenContext").Provider,{value:g,children:e}),b[4]=e,b[5]=g,b[6]=a):a=b[6];b[7]!==k||b[8]!==a?(h=i.jsx("div",babelHelpers["extends"]({},k,{children:a})),b[7]=k,b[8]=a,b[9]=h):h=b[9];return h}function b(a){var b=d("react-compiler-runtime").c(8),e=a.children;a=a.isVisible;a=a===void 0?!0:a;var f=j(c("VideoControlsContainerFocusedContext"));a=a||f;f=j(c("VideoPlayerControlsHiddenContext"));var g;b[0]!==a?(g={0:{className:"x6s0dn4 x78zum5 x1q0g3np x2lah0s xozqiw3 x1iyjqo2 x1fmh03i x47corl"},1:{className:"x6s0dn4 x78zum5 x1q0g3np x2lah0s xozqiw3 x1iyjqo2 x1hc1fzr"}}[!!a<<0],b[0]=a,b[1]=g):g=b[1];f=f||!a;b[2]!==e||b[3]!==f?(a=i.jsx(c("VideoPlayerControlsHiddenContext").Provider,{value:f,children:e}),b[2]=e,b[3]=f,b[4]=a):a=b[4];b[5]!==g||b[6]!==a?(e=i.jsx("div",babelHelpers["extends"]({},g,{children:a})),b[5]=g,b[6]=a,b[7]=e):e=b[7];return e}g.Contracted=a;g.Expanded=b}),98);
__d("VideoPlayerLiveRewindControlContext",["react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h||d("react");b=a.createContext({cachedLiveRewindTimestamp:null,onLiveRewindControlEvent:function(){}});g["default"]=b}),98);
__d("VideoPlayerPlaybackControlBase.react",["fbt","ix","VideoPlayerControlIcon.react","fbicon","react","react-compiler-runtime","unrecoverableViolation"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k=j||d("react");function a(a){var b=d("react-compiler-runtime").c(14),e=a.onPress,f=a.playbackIcon,g=a.showTooltip;a=a.useOutlineIcons;g=g===void 0?!0:g;var j,l;bb0:switch(f){case"pause":var m;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(m=h._(/*BTDS*/"Pause"),b[0]=m):m=b[0];j=m;b[1]!==a?(m=a===!0?d("fbicon")._(i("497677"),20):d("fbicon")._(i("497675"),20),b[1]=a,b[2]=m):m=b[2];l=m;break bb0;case"replay":b[3]===Symbol["for"]("react.memo_cache_sentinel")?(m=h._(/*BTDS*/"Replay"),b[3]=m):m=b[3];j=m;b[4]!==a?(m=a===!0?d("fbicon")._(i("534222"),20):d("fbicon")._(i("534219"),20),b[4]=a,b[5]=m):m=b[5];l=m;break bb0;case"play":b[6]===Symbol["for"]("react.memo_cache_sentinel")?(m=h._(/*BTDS*/"Play"),b[6]=m):m=b[6];j=m;b[7]!==a?(m=a===!0?d("fbicon")._(i("484866"),20):d("fbicon")._(i("484863"),20),b[7]=a,b[8]=m):m=b[8];l=m;break bb0;default:throw c("unrecoverableViolation")("The playback icon is unsupported "+f,"comet_video_player")}a=g?j:null;b[9]!==l||b[10]!==j||b[11]!==e||b[12]!==a?(m=k.jsx(c("VideoPlayerControlIcon.react"),{icon:l,label:j,onPress:e,tooltip:a}),b[9]=l,b[10]=j,b[11]=e,b[12]=a,b[13]=m):m=b[13];return m}g["default"]=a}),226);
__d("VideoPlayerPlaybackControl.react",["CometTrackingNodeProvider.react","VideoHomeTypedLiteLogger","VideoPlayerHooks","VideoPlayerPlaybackControlBase.react","react","react-compiler-runtime","useFeedClickEventHandler","useMinifiedProductAttribution","useVideoPlayerControllerSubscription"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||(h=d("react")),k=h.useEffect;function a(a){var b=d("react-compiler-runtime").c(14),e=a.isNPC,f=a.showTooltip,g=a.unmuteOnPlay;a=a.useOutlineIcons;var h=e===void 0?!1:e;e=f===void 0?!0:f;var m=g===void 0?!1:g;b[0]!==h?(f=function(){h&&c("VideoHomeTypedLiteLogger").log({event:"npc_control_playback_button_impression"})},g=[h],b[0]=h,b[1]=f,b[2]=g):(f=b[1],g=b[2]);k(f,g);f=c("useVideoPlayerControllerSubscription")(l);var n=f.showPauseButton;g=f.showReplayButton;var o=(i||(i=d("VideoPlayerHooks"))).useController(),p=c("useMinifiedProductAttribution")();b[3]!==o||b[4]!==h||b[5]!==p||b[6]!==n||b[7]!==m?(f=function(){h&&c("VideoHomeTypedLiteLogger").log({attribution_id_v2:p,click_point:"npc_control_playback_button",event:"click",event_target:"video"}),n?o.pause("user_initiated"):(m&&o.setMuted(!1,"user_initiated"),o.play("user_initiated"))},b[3]=o,b[4]=h,b[5]=p,b[6]=n,b[7]=m,b[8]=f):f=b[8];f=c("useFeedClickEventHandler")(f);g=n?"pause":g?"replay":"play";var q;b[9]!==f||b[10]!==g||b[11]!==e||b[12]!==a?(q=j.jsx(c("CometTrackingNodeProvider.react"),{trackingNode:592,children:j.jsx(c("VideoPlayerPlaybackControlBase.react"),{onPress:f,playbackIcon:g,showTooltip:e,useOutlineIcons:a})}),b[9]=f,b[10]=g,b[11]=e,b[12]=a,b[13]=q):q=b[13];return q}function l(a,b){var c=a.getCurrentState(),d=c.ended,e=c.paused,f=c.playing,g=c.stalling;a=a.getPlayheadPosition();c=c.duration;e=!e&&(f||g);g=!f&&d&&a>=c;return b!=null&&b.showPauseButton===e&&b.showReplayButton===g?b:{showPauseButton:e,showReplayButton:g}}g["default"]=a}),98);
__d("getFormattedTimestamp",["DateConsts"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b="";a=a;isNaN(a)?a=0:a<0&&(a*=-1,b="-");var c=Math.floor(a/d("DateConsts").SEC_PER_HOUR),e=Math.floor((a-c*d("DateConsts").SEC_PER_HOUR)/d("DateConsts").SEC_PER_MIN);a=Math.round(a-c*d("DateConsts").SEC_PER_HOUR-e*d("DateConsts").SEC_PER_MIN);a===d("DateConsts").SEC_PER_MIN&&(a=0,e++);e===d("DateConsts").MIN_PER_HOUR&&(e=0,c++);a=("0"+a).slice(-2);if(c===0)return""+b+e+":"+a;else{e=("0"+e).slice(-2);return""+b+c+":"+e+":"+a}}g["default"]=a}),98);
__d("VideoPlayerPlaybackTimerBase.react",["getFormattedTimestamp","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(11),e=a.currentTime;a=a.duration;var f,g;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(f={className:"x14ctfv x1rg5ohu x1pg5gke xss6m8b x7h9g57 xf6vk7d xpcyujq x9hgts1 x2b8uid x27saw0 x3ajldb"},g={className:"x1s688f x15hfatp"},b[0]=f,b[1]=g):(f=b[0],g=b[1]);var h;b[2]!==e?(h=c("getFormattedTimestamp")(e),b[2]=e,b[3]=h):h=b[3];b[4]!==h?(e=i.jsx("span",babelHelpers["extends"]({},g,{children:h})),b[4]=h,b[5]=e):e=b[5];b[6]!==a?(g=a!=null&&i.jsxs(i.Fragment,{children:[i.jsx("span",{children:" / "}),i.jsx("span",{children:c("getFormattedTimestamp")(a)})]}),b[6]=a,b[7]=g):g=b[7];b[8]!==e||b[9]!==g?(h=i.jsxs("div",babelHelpers["extends"]({},f,{children:[e,g]})),b[8]=e,b[9]=g,b[10]=h):h=b[10];return h}g["default"]=a}),98);
__d("useLiveRewindUtils",["VideoPlayerHooks","VideoPlayerLiveRewindControlContext","react","react-compiler-runtime","useVideoPlayerControllerSubscription"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||d("react");j.useCallback;var k=j.useContext,l=10,m=10;function a(){var a=d("react-compiler-runtime").c(3),b=(i||(i=d("VideoPlayerHooks"))).useController(),e=k(c("VideoPlayerLiveRewindControlContext")),f;a[0]!==e||a[1]!==b?(f=function(){var a=b.getCurrentState().seekableRanges;a=a!=null?(a=a.end(a.length()-1))!=null?a:0:0;var c=Math.min(b.getPlayheadPosition()+l,a);c===a?(b.setIsLiveRewindActive(!1),b.seek(a)):b.seek(c);e.onLiveRewindControlEvent()},a[0]=e,a[1]=b,a[2]=f):f=a[2];return f}function b(){var a=d("react-compiler-runtime").c(3),b=(i||(i=d("VideoPlayerHooks"))).useController(),e=k(c("VideoPlayerLiveRewindControlContext")),f;a[0]!==e||a[1]!==b?(f=function(){var a=b.getCurrentState().seekableRanges;a=(a=a==null?void 0:a.start(0))!=null?a:0;a=Math.max(b.getPlayheadPosition()-m,a);b.seek(a);b.setIsLiveRewindActive(!0);e.onLiveRewindControlEvent()},a[0]=e,a[1]=b,a[2]=f):f=a[2];return f}function e(){var a=d("react-compiler-runtime").c(3),b=(i||(i=d("VideoPlayerHooks"))).useController(),e=k(c("VideoPlayerLiveRewindControlContext")),f;a[0]!==e||a[1]!==b?(f=function(){var a=b.getCurrentState().seekableRanges;a=a!=null?(a=a.end(a.length()-1))!=null?a:0:0;b.seek(a);b.play("user_initiated");b.setIsLiveRewindActive(!1);e.onLiveRewindControlEvent()},a[0]=e,a[1]=b,a[2]=f):f=a[2];return f}function f(){var a=d("react-compiler-runtime").c(3),b=(i||(i=d("VideoPlayerHooks"))).useController(),e=k(c("VideoPlayerLiveRewindControlContext")),f;a[0]!==e||a[1]!==b?(f=function(){var a=b.getCurrentState().seekableRanges;a=(a=a==null?void 0:a.start(0))!=null?a:0;b.seek(a);b.setIsLiveRewindActive(!0);e.onLiveRewindControlEvent()},a[0]=e,a[1]=b,a[2]=f):f=a[2];return f}function n(){var a=d("react-compiler-runtime").c(3),b=(i||(i=d("VideoPlayerHooks"))).useController(),e=k(c("VideoPlayerLiveRewindControlContext")),f;a[0]!==e||a[1]!==b?(f=function(){b.play("user_initiated"),e.onLiveRewindControlEvent()},a[0]=e,a[1]=b,a[2]=f):f=a[2];return f}function o(){var a=d("react-compiler-runtime").c(3),b=(i||(i=d("VideoPlayerHooks"))).useController(),e=k(c("VideoPlayerLiveRewindControlContext")),f;a[0]!==e||a[1]!==b?(f=function(){b.pause("user_initiated"),b.setIsLiveRewindActive(!0),e.onLiveRewindControlEvent()},a[0]=e,a[1]=b,a[2]=f):f=a[2];return f}function p(){var a=d("react-compiler-runtime").c(3),b=(i||(i=d("VideoPlayerHooks"))).useController(),e=k(c("VideoPlayerLiveRewindControlContext")),f;a[0]!==e||a[1]!==b?(f=function(){var a=b.getCurrentState().seekableRanges;a=(a=a==null?void 0:a.start(0))!=null?a:0;b.seek(a);b.setIsLiveRewindActive(!0);b.play("user_initiated");e.onLiveRewindControlEvent()},a[0]=e,a[1]=b,a[2]=f):f=a[2];return f}function q(){var a=d("react-compiler-runtime").c(3),b=(i||(i=d("VideoPlayerHooks"))).useController(),e=k(c("VideoPlayerLiveRewindControlContext")),f;a[0]!==e||a[1]!==b?(f=function(a){var c,d=b.getCurrentState().seekableRanges;c=(c=d==null?void 0:d.start(0))!=null?c:0;d=d!=null?(d=d.end(d.length()-1))!=null?d:0:0;c=Math.min(c+a,d);b.scrubEnd(c);c===d?b.setIsLiveRewindActive(!1):b.setIsLiveRewindActive(!0);e.onLiveRewindControlEvent()},a[0]=e,a[1]=b,a[2]=f):f=a[2];return f}function r(){return c("useVideoPlayerControllerSubscription")(s)}function s(a){return(a=(a=a.getCurrentState().seekableRanges)==null?void 0:a.start(0))!=null?a:0}g.useLiveRewindForward=a;g.useLiveRewindBack=b;g.useLiveRewindLive=e;g.useLiveRewindStart=f;g.useLiveRewindPlay=n;g.useLiveRewindPause=o;g.useLiveRewindReplay=p;g.useLiveRewindScrub=q;g.useLiveRewindSeekableStartTime=r}),98);
__d("VideoPlayerPlaybackTimer.react",["VideoPlayerHooks","VideoPlayerPlaybackTimerBase.react","react","react-compiler-runtime","useLiveRewindUtils"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||d("react");b=a;var k=function(a,b){return a-b.duration};function l(){var a=d("react-compiler-runtime").c(2),b=d("useLiveRewindUtils").useLiveRewindSeekableStartTime(),e=(i||(i=d("VideoPlayerHooks"))).useCurrentTimeThrottled(200),f=i.useCurrentTimeThrottled(1e3,k),g=i.useIsLiveRewindActive();g=g?f:e-b;a[0]!==g?(f=j.jsx(c("VideoPlayerPlaybackTimerBase.react"),{currentTime:g,duration:null}),a[0]=g,a[1]=f):f=a[1];return f}function m(){var a=d("react-compiler-runtime").c(3),b=(i||(i=d("VideoPlayerHooks"))).useDuration(),e=i.useCurrentTimeThrottled(200),f;a[0]!==e||a[1]!==b?(f=j.jsx(c("VideoPlayerPlaybackTimerBase.react"),{currentTime:e,duration:b}),a[0]=e,a[1]=b,a[2]=f):f=a[2];return f}function a(){var a=d("react-compiler-runtime").c(2),b=(i||(i=d("VideoPlayerHooks"))).useIsLive();if(b){a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b=j.jsx(l,{}),a[0]=b):b=a[0];return b}else{a[1]===Symbol["for"]("react.memo_cache_sentinel")?(b=j.jsx(m,{}),a[1]=b):b=a[1];return b}}e=b;g["default"]=e}),98);
__d("VideoPlayerPointerDrag",["react","react-compiler-runtime","useResizeObserver","useStable"],(function(a,b,c,d,e,f,g){"use strict";var h;f=h||d("react");var i=f.useEffect,j=f.useRef,k=f.useState;function a(){var a=d("react-compiler-runtime").c(5),b=j(null),e=j(null),f;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(f=function(a,c){b.current=c.getBoundingClientRect(),e.current=c},a[0]=f):f=a[0];f=c("useResizeObserver")(f);var g;a[1]===Symbol["for"]("react.memo_cache_sentinel")?(g=function(){return function(){var a=e.current;a?b.current=a.getBoundingClientRect():b.current=null}},a[1]=g):g=a[1];g=c("useStable")(g);var h;a[2]!==g||a[3]!==f?(h={invalidateRootRect:g,rootRectRef:b,rootSizeRefCallback:f},a[2]=g,a[3]=f,a[4]=h):h=a[4];return h}function b(a,b){if(b==null)return null;var c=Math.max(0,Math.min(b.width,a.clientX-b.left));a=Math.max(0,Math.min(b.height,a.clientY-b.top));return{ratioX:b.width>0?c/b.width:0,ratioY:b.height>0?a/b.height:0}}function l(a,b){a=a.changedTouches;if(b==null||!a)return null;for(var c=0;c<a.length;++c){var d=a[c];if(d.identifier===b)return{clientX:d.clientX,clientY:d.clientY}}return null}function m(a,b){var c=a;switch(b.type){case"start":c=babelHelpers["extends"]({},a,{clientX:b.clientX,clientY:b.clientY,dragState:"dragging",lastEffect:a.dragState==="idle"?"start":a.lastEffect});break;case"move":if(a.dragState!=="dragging")break;c={clientX:b.clientX,clientY:b.clientY,dragState:"dragging",lastEffect:a.dragState==="idle"?"start":"move"};break;case"end":if(a.dragState!=="dragging")break;c={clientX:b.clientX,clientY:b.clientY,dragState:"idle",lastEffect:a.dragState==="idle"?a.lastEffect:"end"};break;case"cancel":if(a.dragState!=="dragging")break;c={clientX:a.clientX,clientY:a.clientY,dragState:"idle",lastEffect:a.dragState==="idle"?a.lastEffect:"cancel"};break;default:break}return c.dragState!==a.dragState||c.lastEffect!==a.lastEffect||c.clientX!==a.clientX||c.clientY!==a.clientY?c:a}var n={clientX:0,clientY:0,dragState:"idle",lastEffect:null},o=function(){return window.navigator.userAgent.indexOf("MSIE")>=0};function p(a,b,c){var d=n,e=null,f=null,g=function(b){d=m(d,b),a(d)},h=function(a){g({clientX:a.clientX,clientY:a.clientY,type:"move"});a=b.current.onDragMoveSync;a==null||a(d)},i=function(a){e&&e();g({clientX:a.clientX,clientY:a.clientY,type:"end"});a=b.current.onDragEndSync;a==null||a(d)},j=function(){e&&e();g({type:"cancel"});var a=b.current.onDragCancelSync;a==null||a(d)},k=function(a){a=l(a,c.current);if(a==null)return;g({clientX:a.clientX,clientY:a.clientY,type:"move"});a=b.current.onDragMoveSync;a==null||a(d)},p=function(a){a=l(a,c.current);if(a==null)return;f&&f();g({clientX:a.clientX,clientY:a.clientY,type:"end"});a=b.current.onDragEndSync;a==null||a(d)},q=p;return{destroy:function(){e&&e(),f&&f()},onMouseDown:function(a){o()||a.preventDefault();g({clientX:a.clientX,clientY:a.clientY,type:"start"});a=b.current.onDragStartSync;a==null||a(d);e||(window.addEventListener("mousemove",h),window.addEventListener("mouseup",i),window.addEventListener("blur",j),window.addEventListener("mouseleave",j),e=function(){e=null,window.removeEventListener("mousemove",h),window.removeEventListener("mouseup",i),window.removeEventListener("blur",j),window.removeEventListener("mouseleave",j)})},onTouchStart:function(a){a.preventDefault();var e=a.changedTouches[0];e!=null&&(c.current=e.identifier);e=l(a,c.current);if(e==null)return;g({clientX:e.clientX,clientY:e.clientY,type:"start"});a=b.current.onDragStartSync;a==null||a(d);f||(window.addEventListener("touchmove",k),window.addEventListener("touchend",p),window.addEventListener("touchcancel",q),window.addEventListener("blur",j),f=function(){f=null,window.removeEventListener("touchmove",k),window.removeEventListener("touchend",p),window.removeEventListener("touchcancel",q),window.removeEventListener("blur",j)})}}}function q(a,b){var c=d("react-compiler-runtime").c(6),e;c[0]!==b.current||c[1]!==a?(e=function(){var c=b.current,d=c.onDragCancel,e=c.onDragEnd,f=c.onDragMove;c=c.onDragStart;switch(a.lastEffect){case"start":c(a);return;case"move":f(a);return;case"end":e(a);return;case"cancel":d(a);return}},c[0]=b.current,c[1]=a,c[2]=e):e=c[2];var f;c[3]!==b||c[4]!==a?(f=[a,b],c[3]=b,c[4]=a,c[5]=f):f=c[5];i(e,f)}function r(a,b,e){var f=d("react-compiler-runtime").c(13),g=k(n),h=g[0],j=g[1];f[0]!==a||f[1]!==b?(g=function(){return p(j,a,b)},f[0]=a,f[1]=b,f[2]=g):g=f[2];g=c("useStable")(g);var l=g.destroy,m=g.onMouseDown;g=g.onTouchStart;var o,q;f[3]!==l?(o=function(){return l},q=[l],f[3]=l,f[4]=o,f[5]=q):(o=f[4],q=f[5]);i(o,q);f[6]!==m||f[7]!==g||f[8]!==(e==null?void 0:e.hasTouchEvents)?(o={onClick:function(a){a.stopPropagation(),a.preventDefault()},onMouseDown:m,onTouchStart:(e==null?void 0:e.hasTouchEvents)===!0?g:void 0},f[6]=m,f[7]=g,f[8]=e==null?void 0:e.hasTouchEvents,f[9]=o):o=f[9];f[10]!==h||f[11]!==o?(q={dragState:h,rootProps:o},f[10]=h,f[11]=o,f[12]=q):q=f[12];return q}function e(a,b){var c=d("react-compiler-runtime").c(7),e=j(a),f=j(null),g,h;c[0]!==a?(g=function(){e.current=a},h=[a],c[0]=a,c[1]=g,c[2]=h):(g=c[1],h=c[2]);i(g,h);g=r(e,f,b);h=g.dragState;f=g.rootProps;q(h,e);b=h.dragState==="dragging";c[3]!==h||c[4]!==f||c[5]!==b?(g={dragState:h,isDragging:b,rootProps:f},c[3]=h,c[4]=f,c[5]=b,c[6]=g):g=c[6];return g}g.usePointerDragResizeObserver=a;g.computePointerOffsetRatio=b;g.usePointerDrag=e}),98);
__d("VideoPlayerSliderNub.react",["react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(4);a=a.isVisible;var c;b[0]!==a?(c={0:{className:"x14hiurz x1g7gg9k x16h6fyj x1eoefnw x10eyzkn x1c9tyrk xeusxvb x1pahc9y x1ertn4p x13fuv20 x18b5jzi x1q0q8m5 x1t7ytsu xamhcws x1alpsbp xlxy82 xyumdvf x1nqv1ya x1s85apg xdk7pt x1x862rh x1rdy4ex x10l6tqk x3m8u43 x1xc55vz x1vjfegm"},1:{className:"x14hiurz x1g7gg9k x16h6fyj x1eoefnw x10eyzkn x1c9tyrk xeusxvb x1pahc9y x1ertn4p x13fuv20 x18b5jzi x1q0q8m5 x1t7ytsu xamhcws x1alpsbp xlxy82 xyumdvf x1nqv1ya xdk7pt x1x862rh x1rdy4ex x10l6tqk x3m8u43 x1xc55vz x1vjfegm x1lliihq"}}[!!a<<0],b[0]=a,b[1]=c):c=b[1];b[2]!==c?(a=i.jsx("div",babelHelpers["extends"]({},c,{"data-testid":void 0})),b[2]=c,b[3]=a):a=b[3];return a}g["default"]=a}),98);
__d("VideoPlayerScrubberBaseContentDefault.react",["CometVisualCompletionAttributes","VideoPlayerSliderNub.react","react","react-compiler-runtime","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||d("react"),k={liveRewindTimePlayed:{backgroundColor:"xh1tjdi",$$css:!0},liveTimePlayed:{backgroundColor:"x1ciooss",$$css:!0},timelineBackground:{backgroundColor:"x1rwy58d",borderStartStartRadius:"xr9e8f9",borderStartEndRadius:"x1e4oeot",borderEndEndRadius:"x1ui04y5",borderEndStartRadius:"x6en5u8",boxShadow:"xpdb0fs",height:"xuoj239",textShadow:"xd9u3wd",userSelect:"x87ps6o",$$css:!0},timelineBuffered:{height:"xuoj239",position:"x10l6tqk",$$css:!0},timelineBufferedBackground:{backgroundColor:"x17j41np",$$css:!0},timelinePlayed:{backgroundColor:"x1evw4sf",borderStartStartRadius:"xr9e8f9",borderStartEndRadius:"x1e4oeot",borderEndEndRadius:"x1ui04y5",borderEndStartRadius:"x6en5u8",height:"xuoj239",position:"x10l6tqk",userSelect:"x87ps6o",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(26),e=a.bufferedRatio,f=a.isLive,g=a.isLiveRewindActive,i=a.isNubVisible,l=a.playedRatio,m=a.timelineBackgroundXStyle,n=a.timelineBufferedXStyle;a=a.timelinePlayedXStyle;var o;b[0]!==m?(o=(h||(h=c("stylex"))).props(k.timelineBackground,m),b[0]=m,b[1]=o):o=b[1];m=!f&&k.timelineBufferedBackground;var p;b[2]!==m||b[3]!==n?(p=(h||(h=c("stylex")))(k.timelineBuffered,m,n),b[2]=m,b[3]=n,b[4]=p):p=b[4];m=(100*e).toFixed(5)+"%";b[5]!==m?(n={width:m},b[5]=m,b[6]=n):n=b[6];b[7]!==p||b[8]!==n?(e=j.jsx("div",babelHelpers["extends"]({className:p},c("CometVisualCompletionAttributes").IGNORE,{style:n})),b[7]=p,b[8]=n,b[9]=e):e=b[9];m=f&&!g&&k.liveTimePlayed;p=f&&g&&k.liveRewindTimePlayed;b[10]!==m||b[11]!==p||b[12]!==a?(n=(h||(h=c("stylex")))(k.timelinePlayed,m,p,a),b[10]=m,b[11]=p,b[12]=a,b[13]=n):n=b[13];f=(100*l).toFixed(5)+"%";b[14]!==f?(g={width:f},b[14]=f,b[15]=g):g=b[15];b[16]!==i?(m=j.jsx(c("VideoPlayerSliderNub.react"),{isVisible:i}),b[16]=i,b[17]=m):m=b[17];b[18]!==g||b[19]!==m||b[20]!==n?(p=j.jsx("div",babelHelpers["extends"]({className:n},c("CometVisualCompletionAttributes").IGNORE,{style:g,children:m})),b[18]=g,b[19]=m,b[20]=n,b[21]=p):p=b[21];b[22]!==o||b[23]!==p||b[24]!==e?(a=j.jsxs("div",babelHelpers["extends"]({},o,{children:[e,p]})),b[22]=o,b[23]=p,b[24]=e,b[25]=a):a=b[25];return a}g["default"]=a}),98);
__d("useVideoPlayerScrubberState",["VideoPlayerPointerDrag","react","react-compiler-runtime","usePrevious"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");var i=b.useEffect,j=b.useState;function k(a,b){return Math.min(a>0?b/a:0,1)}function a(a){var b=d("react-compiler-runtime").c(41),e=a.bufferEnd,f=a.currentTime,g=a.duration,h=a.onScrubCancel,l=a.onScrubEnd,m=a.onScrubStart;a=a.supportsTouch;var n=d("VideoPlayerPointerDrag").usePointerDragResizeObserver(),o=n.invalidateRootRect,p=n.rootRectRef;n=n.rootSizeRefCallback;var q=j(0),r=q[0],s=q[1];q=j(!1);var t=q[0],u=q[1],v=c("usePrevious")(f),w;b[0]!==f||b[1]!==v?(q=function(){f!==v&&u(!1)},w=[f,v],b[0]=f,b[1]=v,b[2]=q,b[3]=w):(q=b[2],w=b[3]);i(q,w);b[4]!==h?(q=function(a){h()},b[4]=h,b[5]=q):q=b[5];b[6]!==g||b[7]!==h||b[8]!==l||b[9]!==p?(w=function(a){a=d("VideoPlayerPointerDrag").computePointerOffsetRatio(a,p.current);if(!a){h();return}s(a.ratioX);a=a.ratioX*g;l(a)},b[6]=g,b[7]=h,b[8]=l,b[9]=p,b[10]=w):w=b[10];var x;b[11]===Symbol["for"]("react.memo_cache_sentinel")?(x=function(){u(!0)},b[11]=x):x=b[11];var y;b[12]!==p?(y=function(a){a=d("VideoPlayerPointerDrag").computePointerOffsetRatio(a,p.current);if(!a)return;s(a.ratioX)},b[12]=p,b[13]=y):y=b[13];var z;b[14]!==o||b[15]!==m||b[16]!==p?(z=function(a){o();a=d("VideoPlayerPointerDrag").computePointerOffsetRatio(a,p.current);if(!a)return;s(a.ratioX);m()},b[14]=o,b[15]=m,b[16]=p,b[17]=z):z=b[17];b[18]!==q||b[19]!==w||b[20]!==y||b[21]!==z?(x={onDragCancel:q,onDragEnd:w,onDragEndSync:x,onDragMove:y,onDragStart:z},b[18]=q,b[19]=w,b[20]=y,b[21]=z,b[22]=x):x=b[22];q=a===!0;b[23]!==q?(w={hasTouchEvents:q},b[23]=q,b[24]=w):w=b[24];y=d("VideoPlayerPointerDrag").usePointerDrag(x,w);z=y.isDragging;a=y.rootProps;b[25]!==e||b[26]!==g?(q=k(g,e),b[25]=e,b[26]=g,b[27]=q):q=b[27];x=q;b[28]!==f||b[29]!==g?(w=k(g,f),b[28]=f,b[29]=g,b[30]=w):w=b[30];y=w;b[31]!==x||b[32]!==y||b[33]!==o||b[34]!==z||b[35]!==t||b[36]!==r||b[37]!==a||b[38]!==p||b[39]!==n?(e={bufferedRatio:x,currentPlayedRatio:y,invalidateRootRect:o,isDragging:z,isWaitingForSeek:t,pointerOffsetRatio:r,rootProps:a,rootRectRef:p,rootSizeRefCallback:n},b[31]=x,b[32]=y,b[33]=o,b[34]=z,b[35]=t,b[36]=r,b[37]=a,b[38]=p,b[39]=n,b[40]=e):e=b[40];return e}g["default"]=a}),98);
__d("VideoPlayerScrubberBase.react",["fbt","CometComponentWithKeyCommands.react","CometKeys","VideoPlayerScrubberBaseContentDefault.react","VideoPlayerUserInteractionCounter","react","useVideoPlayerScrubberState"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;var k=b.useCallback,l=b.useMemo,m=b.useState;function a(a){var b=a.bufferEnd,e=a.currentTime,f=a.disableKeyCommands,g=a.duration,i=a.hideNub;i=i===void 0?!1:i;var n=a.isLive,o=a.isLiveRewindActive,p=a.keyLeftDescription,q=a.keyRightDescription,r=a.onScrubCancel,s=a.onScrubEnd,t=a.onScrubStart,u=a.onUserInteraction,v=a.playFromBeginningImpl,w=a.renderScrubber,x=a.renderTooltip,y=a.skipBackwardImpl,z=a.skipForwardImpl,A=a.skipToEndImpl,B=a.supportsTouch,C=a.timelineBackgroundXStyle,D=a.timelineBufferedXStyle,E=a.timelinePlayedXStyle;a=a.withoutVerticalPadding;a=a===void 0?!1:a;var F=m(!1),G=F[0],H=F[1];F=m(0);var I=F[0],J=F[1];F=m(null);var K=F[0],L=F[1];F=c("useVideoPlayerScrubberState")({bufferEnd:b,currentTime:e,duration:g,onScrubCancel:r,onScrubEnd:s,onScrubStart:t,supportsTouch:B});b=F.bufferedRatio;r=F.currentPlayedRatio;var M=F.invalidateRootRect;s=F.isDragging;t=F.isWaitingForSeek;B=F.pointerOffsetRatio;var N=F.rootProps,O=F.rootRectRef;F=F.rootSizeRefCallback;var P=k(function(){H(!0)},[]),Q=k(function(){H(!1)},[]),R=k(function(a){M();if(O.current!=null){var b=O.current.left,c=O.current.width,d=Math.max(0,Math.min(c,a.clientX-b));d=c>0?d/c:0;c=Number.isFinite(g)&&g>0?g*d:null;J(a.clientX-b);L(c)}},[g,M,O]),S=G||s;d("VideoPlayerUserInteractionCounter").useVideoPlayerUserInteraction("video_scrubber",S,u);S=G||s||t;u=s||t?B:n&&!o?1:r;s=l(function(){return f===!0?[]:[{command:{key:c("CometKeys").RIGHT},description:q,handler:z},{command:{key:c("CometKeys").LEFT},description:p,handler:y},{command:{key:c("CometKeys").HOME},description:h._(/*BTDS*/"Play from beginning"),handler:v},{command:{key:c("CometKeys").END},description:h._(/*BTDS*/"Skip to end"),handler:A}]},[f,q,z,p,y,v,A]);t={bufferedRatio:b,duration:g,hoveringPositionSec:K,isHovering:G,isLive:n,isLiveRewindActive:o,isNubVisible:!i&&S,playedRatio:u,timelineBackgroundXStyle:C,timelineBufferedXStyle:D,timelinePlayedXStyle:E};return j.jsx(c("CometComponentWithKeyCommands.react"),{commandConfigs:s,children:j.jsxs("div",babelHelpers["extends"]({},N,{"aria-label":h._(/*BTDS*/"Change Position"),"aria-orientation":"horizontal","aria-valuemax":g,"aria-valuemin":"0","aria-valuenow":e,className:{0:"x1ypdohk x1y1aw1k xyri2b xwib8y2 x1c1uobl x1n2onr6 x87ps6o xh8yej3",1:"x1ypdohk xyri2b x1c1uobl x1n2onr6 x87ps6o xh8yej3 x18d9i69 xexx8yu"}[!!a<<0],"data-testid":void 0,onMouseEnter:P,onMouseLeave:Q,onMouseMove:R,ref:F,role:"slider",tabIndex:0,children:[w!=null?w(t):j.jsx(c("VideoPlayerScrubberBaseContentDefault.react"),babelHelpers["extends"]({},t)),x!=null&&K!=null&&G&&j.jsx("div",{className:"xfqi8uc x10l6tqk",style:{left:I},children:x(K)})]}))})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("VideoPlayerScrubber.react",["fbt","VideoPlayerHooks","VideoPlayerScrubberBase.react","react","react-compiler-runtime","useLiveRewindUtils"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=i||(i=d("react"));i.useCallback;function l(){return(j||(j=d("VideoPlayerHooks"))).useCurrentTimeThrottled(200)}function a(a){var b=d("react-compiler-runtime").c(48),e=a.onUserInteraction,f=a.renderScrubber;a=a.renderTooltip;var g=l(),i=(j||(j=d("VideoPlayerHooks"))).useDuration(),m=j.useController(),n=j.useBufferEnd(),o=j.useIsLive(),p=j.useIsLiveRewindActive(),q=d("useLiveRewindUtils").useLiveRewindScrub(),r=d("useLiveRewindUtils").useLiveRewindForward(),s=d("useLiveRewindUtils").useLiveRewindBack(),t=d("useLiveRewindUtils").useLiveRewindStart(),u=d("useLiveRewindUtils").useLiveRewindLive(),v=d("useLiveRewindUtils").useLiveRewindSeekableStartTime();o&&(i=i-v,i,g=g-v);b[0]!==m||b[1]!==i||b[2]!==o||b[3]!==r?(v=function(){if(o)r();else{var a=m.getPlayheadPosition()+5;a>=i?m.seek(i-.01):m.seek(a)}},b[0]=m,b[1]=i,b[2]=o,b[3]=r,b[4]=v):v=b[4];i;v=v;var w;b[5]!==o?(w=o?h._(/*BTDS*/"Fast forward 10 seconds"):h._(/*BTDS*/"Fast forward 5 seconds"),b[5]=o,b[6]=w):w=b[6];w=w;var x;b[7]!==m||b[8]!==o||b[9]!==s?(x=function(){if(o)s();else{var a=m.getPlayheadPosition()-5;a<0?m.seek(0):m.seek(a)}},b[7]=m,b[8]=o,b[9]=s,b[10]=x):x=b[10];x=x;var y;b[11]!==o?(y=o?h._(/*BTDS*/"Rewind 10 seconds"):h._(/*BTDS*/"Rewind 5 seconds"),b[11]=o,b[12]=y):y=b[12];y=y;var z;b[13]!==m||b[14]!==o||b[15]!==t?(z=function(){o?t():m.seek(0)},b[13]=m,b[14]=o,b[15]=t,b[16]=z):z=b[16];z=z;var A;b[17]!==m||b[18]!==i||b[19]!==o||b[20]!==u?(A=function(){o?u():m.seek(i-.01)},b[17]=m,b[18]=i,b[19]=o,b[20]=u,b[21]=A):A=b[21];i;A=A;var B;b[22]!==m?(B=function(){m.scrubEnd(null)},b[22]=m,b[23]=B):B=b[23];B=B;var C;b[24]!==m?(C=function(){m.scrubBegin()},b[24]=m,b[25]=C):C=b[25];C=C;var D;b[26]!==m||b[27]!==o||b[28]!==q?(D=function(a){!o?m.scrubEnd(a):q(a)},b[26]=m,b[27]=o,b[28]=q,b[29]=D):D=b[29];D=D;var E;b[30]!==n||b[31]!==g||b[32]!==i||b[33]!==o||b[34]!==p||b[35]!==A||b[36]!==y||b[37]!==w||b[38]!==e||b[39]!==z||b[40]!==f||b[41]!==a||b[42]!==B||b[43]!==D||b[44]!==C||b[45]!==x||b[46]!==v?(E=k.jsx(c("VideoPlayerScrubberBase.react"),{bufferEnd:n,currentTime:g,duration:i,isLive:o,isLiveRewindActive:p,keyLeftDescription:y,keyRightDescription:w,onScrubCancel:B,onScrubEnd:D,onScrubStart:C,onUserInteraction:e,playFromBeginningImpl:z,renderScrubber:f,renderTooltip:a,skipBackwardImpl:x,skipForwardImpl:v,skipToEndImpl:A}),b[30]=n,b[31]=g,b[32]=i,b[33]=o,b[34]=p,b[35]=A,b[36]=y,b[37]=w,b[38]=e,b[39]=z,b[40]=f,b[41]=a,b[42]=B,b[43]=D,b[44]=C,b[45]=x,b[46]=v,b[47]=E):E=b[47];return E}g["default"]=a}),226);
__d("VideoPlayerScrubberPreview_video.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VideoPlayerScrubberPreview_video",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"video_player_scrubber_preview_renderer",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,documentName:"VideoPlayerScrubberPreview_video",fragmentName:"VideoPlayerScrubberChapterPreview_video",fragmentPropName:"video",kind:"ModuleImport"}],type:"XFBVideoPlayerScrubberChapterPreviewRenderer",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"VideoPlayerScrubberPreview_video",fragmentName:"VideoPlayerScrubberDefaultPreview_video",fragmentPropName:"video",kind:"ModuleImport"}],type:"XFBVideoPlayerScrubberDefaultPreviewRenderer",abstractKey:null}],storageKey:null}],type:"Video",abstractKey:null};e.exports=a}),null);
__d("VideoPlayerScrubberPreview.react",["CometRelay","VideoPlayerScrubberPreview_video.graphql","VideoPlayerTimeIndicator.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||d("react");function a(a){var e=d("react-compiler-runtime").c(8),f=a.timestampSec;a=a.video;a=d("CometRelay").useFragment(h!==void 0?h:h=b("VideoPlayerScrubberPreview_video.graphql"),a);if(a==null){var g;e[0]!==f?(g=j.jsx(c("VideoPlayerTimeIndicator.react"),{shouldCenterSelf:!0,timestampSec:f}),e[0]=f,e[1]=g):g=e[1];return g}g=a==null?void 0:a.video_player_scrubber_preview_renderer;var i;e[2]!==f||e[3]!==a?(i={timestampSec:f,video:a},e[2]=f,e[3]=a,e[4]=i):i=e[4];e[5]!==g||e[6]!==i?(f=j.jsx(d("CometRelay").MatchContainer,{match:g,props:i}),e[5]=g,e[6]=i,e[7]=f):f=e[7];return f}g["default"]=a}),98);
__d("VideoPlayerVolumeControlBase.react",["fbt","ix","FocusWithinHandler.react","VideoPlayerControlIcon.react","fbicon","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k=j||(j=d("react")),l=j.useState,m=.33,n=.66;function a(a){var b=d("react-compiler-runtime").c(18),e=a.audioAvailabilityUI,f=a.isMuted,g=a.onMouseEnter,j=a.onMouseLeave,o=a.onSetMuted,p=a.onUserInteraction,q=a.renderVolumeSlider,r=a.useOutlineIcons;a=a.volume;r=r===void 0?!1:r;var s=!f&&a>0,t;b[0]!==e||b[1]!==s||b[2]!==r||b[3]!==a?(e!=null&&e.shouldShowNullIcon?t=r?d("fbicon")._(i("944795"),20):d("fbicon")._(i("944792"),20):s?a<=m?t=r?d("fbicon")._(i("1146252"),20):d("fbicon")._(i("1104387"),20):a<=n?t=r?d("fbicon")._(i("1104392"),20):d("fbicon")._(i("1104390"),20):t=r?d("fbicon")._(i("564393"),20):d("fbicon")._(i("564390"),20):t=r?d("fbicon")._(i("564399"),20):d("fbicon")._(i("564396"),20),b[0]=e,b[1]=s,b[2]=r,b[3]=a,b[4]=t):t=b[4];s=l(!1);var u=s[0],v=s[1];b[5]!==f?(r=f?h._(/*BTDS*/"Unmute"):h._(/*BTDS*/"Mute"),b[5]=f,b[6]=r):r=b[6];var w=r;b[7]!==e||b[8]!==t||b[9]!==f||b[10]!==u||b[11]!==w||b[12]!==g||b[13]!==j||b[14]!==o||b[15]!==p||b[16]!==q?(a=k.jsx(c("FocusWithinHandler.react"),{children:function(a,b){return k.jsxs("div",babelHelpers["extends"]({className:"x1ypdohk x1rg5ohu xhsvlbd xyamay9 x1icxu4v x10b6aqq x25sj25 x1n2onr6"},{onMouseEnter:g,onMouseLeave:j,children:[e!=null&&e.shouldDisableVolumeControl?null:k.jsx("div",babelHelpers["extends"]({className:"xk7dvq3 x9f619 x1o0tod x1yrsyyn x1icxu4v x10b6aqq x25sj25 x10l6tqk xh8yej3"},{children:q({focusVisible:b,onVisibilityChange:v})})),k.jsx(c("VideoPlayerControlIcon.react"),{icon:t,label:w,onPress:function(){e&&e.onVolumeControlPress(),e!=null&&e.shouldDisableVolumeControl||o(!f,"user_initiated"),p&&p({name:"video_mute_button",type:"happened"})},tooltip:e!=null?e.tooltipContent:null,tooltipAlign:"end",tooltipImpl:e!=null?e.tooltipImpl:null,tooltipOffsetY:u?-80:0})]}))}}),b[7]=e,b[8]=t,b[9]=f,b[10]=u,b[11]=w,b[12]=g,b[13]=j,b[14]=o,b[15]=p,b[16]=q,b[17]=a):a=b[17];return a}g["default"]=a}),226);
__d("VideoPlayerVolumeSliderBase.react",["fbt","CometComponentWithKeyCommands.react","CometKeys","VideoPlayerPointerDrag","VideoPlayerSliderNub.react","VideoPlayerUserInteractionCounter","react","react-compiler-runtime","stylex"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||(j=d("react"));b=j;var l=b.useEffect;b.useMemo;var m=b.useRef,n=b.useState,o={root:{cursor:"x1ypdohk",height:"xng8ra",opacity:"xg01cxk",pointerEvents:"x47corl",position:"x1n2onr6",transitionDuration:"x1d8287x",transitionProperty:"x19991ni",transitionTimingFunction:"xl405pv",width:"x1td3qas",zIndex:"x1ja2u2z",$$css:!0},rootVisible:{opacity:"x1hc1fzr",pointerEvents:"x67bb7w",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(59),e=a.isHovering,f=a.isMuted,g=a.onChangeVolumeDown,j=a.onChangeVolumeUp,p=a.onSetMuted,q=a.onSetVolume,r=a.onUserInteraction,s=a.onVisibilityChange,t=a.volume;a=d("VideoPlayerPointerDrag").usePointerDragResizeObserver();var u=a.invalidateRootRect,v=a.rootRectRef;a=a.rootSizeRefCallback;var w=m(t),x=m(f),y=f?0:t,z=n(y),A=z[0],B=z[1];b[0]!==f||b[1]!==p||b[2]!==q||b[3]!==v?(z=function(a){a=d("VideoPlayerPointerDrag").computePointerOffsetRatio(a,v.current);if(!a)return;a=Math.max(0,Math.min(1,1-a.ratioY));B(a);q(a);f&&p(!1,"user_initiated")},b[0]=f,b[1]=p,b[2]=q,b[3]=v,b[4]=z):z=b[4];var C=z;b[5]!==p||b[6]!==q?(z=function(a){B(w.current),q(w.current),p(x.current,"user_initiated")},b[5]=p,b[6]=q,b[7]=z):z=b[7];var D,E;b[8]!==C?(D=function(a){C(a)},E=function(a){C(a)},b[8]=C,b[9]=D,b[10]=E):(D=b[9],E=b[10]);var F;b[11]!==u||b[12]!==f||b[13]!==C||b[14]!==t||b[15]!==y?(F=function(a){u(),w.current=t,x.current=f,B(y),C(a)},b[11]=u,b[12]=f,b[13]=C,b[14]=t,b[15]=y,b[16]=F):F=b[16];var G;b[17]!==z||b[18]!==D||b[19]!==E||b[20]!==F?(G={onDragCancel:z,onDragEnd:D,onDragMove:E,onDragStart:F},b[17]=z,b[18]=D,b[19]=E,b[20]=F,b[21]=G):G=b[21];z=d("VideoPlayerPointerDrag").usePointerDrag(G);D=z.isDragging;E=z.rootProps;F=D?A:y;var H=e||D,I=m(H);b[22]!==H||b[23]!==s?(G=function(){I.current!==H&&(s&&s(H)),I.current=H},z=[s,H],b[22]=H,b[23]=s,b[24]=G,b[25]=z):(G=b[24],z=b[25]);l(G,z);A=H;d("VideoPlayerUserInteractionCounter").useVideoPlayerUserInteraction("video_volume_slider",A,r);b[26]===Symbol["for"]("react.memo_cache_sentinel")?(e={key:c("CometKeys").UP},D=h._(/*BTDS*/"Increase volume"),b[26]=e,b[27]=D):(e=b[26],D=b[27]);b[28]!==j?(G={command:e,description:D,handler:function(){j()}},b[28]=j,b[29]=G):G=b[29];b[30]===Symbol["for"]("react.memo_cache_sentinel")?(z={key:c("CometKeys").DOWN},A=h._(/*BTDS*/"Decrease volume"),b[30]=z,b[31]=A):(z=b[30],A=b[31]);b[32]!==g?(r={command:z,description:A,handler:function(){g()}},b[32]=g,b[33]=r):r=b[33];b[34]!==G||b[35]!==r?(e=[G,r],b[34]=G,b[35]=r,b[36]=e):e=b[36];D=e;z=D;b[37]===Symbol["for"]("react.memo_cache_sentinel")?(A=h._(/*BTDS*/"Change volume"),b[37]=A):A=b[37];G=H&&o.rootVisible;b[38]!==G?(r=(i||(i=c("stylex")))(o.root,G),b[38]=G,b[39]=r):r=b[39];b[40]===Symbol["for"]("react.memo_cache_sentinel")?(e={className:"x18fn2jl xjwep3j x1t39747 x1wcsgtt x1pczhz8 x1ey2m1c xng8ra xi5uv41 x10l6tqk x1xc55vz"},D="x1spa7qu xjwep3j x1t39747 x1wcsgtt x1pczhz8 x1ey2m1c x10l6tqk xh8yej3",b[40]=e,b[41]=D):(e=b[40],D=b[41]);G=F*100+"%";b[42]!==G?(F={height:G},b[42]=G,b[43]=F):F=b[43];b[44]===Symbol["for"]("react.memo_cache_sentinel")?(G={className:"x1c7jfne x1f4buv5 x1n2onr6"},b[44]=G):G=b[44];b[45]!==H?(G=k.jsx("div",babelHelpers["extends"]({},G,{children:k.jsx(c("VideoPlayerSliderNub.react"),{isVisible:H})})),b[45]=H,b[46]=G):G=b[46];b[47]!==F||b[48]!==G?(e=k.jsx("div",babelHelpers["extends"]({},e,{children:k.jsx("div",{className:D,style:F,children:G})})),b[47]=F,b[48]=G,b[49]=e):e=b[49];b[50]!==E||b[51]!==a||b[52]!==r||b[53]!==e||b[54]!==t?(D=k.jsx("div",babelHelpers["extends"]({},E,{"aria-label":A,"aria-orientation":"vertical","aria-valuemax":1,"aria-valuemin":0,"aria-valuenow":t,className:r,ref:a,role:"slider",tabIndex:0,children:e})),b[50]=E,b[51]=a,b[52]=r,b[53]=e,b[54]=t,b[55]=D):D=b[55];b[56]!==z||b[57]!==D?(F=k.jsx(c("CometComponentWithKeyCommands.react"),{commandConfigs:z,children:D}),b[56]=z,b[57]=D,b[58]=F):F=b[58];return F}g["default"]=a}),226);
__d("VideoPlayerVolumeSlider.react",["VideoPlayerHooks","VideoPlayerVolumeSliderBase.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||(h=d("react"));h.useCallback;function a(a){var b=d("react-compiler-runtime").c(20),e=a.isHovering,f=a.onUserInteraction;a=a.onVisibilityChange;var g=(i||(i=d("VideoPlayerHooks"))).useController(),h=i.useMuted(),k=i.useVolume(),l;b[0]!==g?(l=function(a){g.setVolume(a)},b[0]=g,b[1]=l):l=b[1];l=l;var m;b[2]!==g?(m=function(a,b){g.setMuted(a,b)},b[2]=g,b[3]=m):m=b[3];m=m;var n;b[4]!==g?(n=function(a){var b=g.getCurrentState();a=Math.max(0,Math.min(1,b.volume+a));g.setVolume(a);a===0?g.setMuted(!0,"user_initiated"):b.muted&&g.setMuted(!1,"user_initiated")},b[4]=g,b[5]=n):n=b[5];var o=n;b[6]!==o?(n=function(){o(.05)},b[6]=o,b[7]=n):n=b[7];n=n;var p;b[8]!==o?(p=function(){o(-.05)},b[8]=o,b[9]=p):p=b[9];p=p;var q;b[10]!==p||b[11]!==n||b[12]!==e||b[13]!==h||b[14]!==f||b[15]!==a||b[16]!==m||b[17]!==l||b[18]!==k?(q=j.jsx(c("VideoPlayerVolumeSliderBase.react"),{isHovering:e,isMuted:h,onChangeVolumeDown:p,onChangeVolumeUp:n,onSetMuted:m,onSetVolume:l,onUserInteraction:f,onVisibilityChange:a,volume:k}),b[10]=p,b[11]=n,b[12]=e,b[13]=h,b[14]=f,b[15]=a,b[16]=m,b[17]=l,b[18]=k,b[19]=q):q=b[19];return q}g["default"]=a}),98);
__d("VideoPlayerVolumeControl.react",["VideoPlayerHooks","VideoPlayerVolumeControlBase.react","VideoPlayerVolumeSlider.react","cr:1826284","react","react-compiler-runtime","useEmptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||(h=d("react"));e=h;e.useCallback;var k=e.useState,l=(f=b("cr:1826284"))!=null?f:c("useEmptyFunction");function a(a){var b=d("react-compiler-runtime").c(15),e=a.onUserInteraction;a=a.useOutlineIcons;a=a===void 0?!1:a;var f=k(!1),g=f[0],h=f[1],m=(i||(i=d("VideoPlayerHooks"))).useController();f=i.useMuted();var n=i.useVolume(),o;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(o=function(){h(!0)},b[0]=o):o=b[0];o=o;var p;b[1]===Symbol["for"]("react.memo_cache_sentinel")?(p=function(){h(!1)},b[1]=p):p=b[1];p=p;var q;b[2]!==m?(q=function(a,b){m.setMuted(a,b)},b[2]=m,b[3]=q):q=b[3];q=q;var r=!f&&n>0;r=l({canPlayerProduceSound:r,isHovering:g})||null;var s;b[4]!==g||b[5]!==e?(s=function(a){var b=a.focusVisible;a=a.onVisibilityChange;return j.jsx(c("VideoPlayerVolumeSlider.react"),{isHovering:g||b,onUserInteraction:e,onVisibilityChange:a})},b[4]=g,b[5]=e,b[6]=s):s=b[6];b[7]!==r||b[8]!==f||b[9]!==e||b[10]!==q||b[11]!==s||b[12]!==a||b[13]!==n?(o=j.jsx(c("VideoPlayerVolumeControlBase.react"),{audioAvailabilityUI:r,isMuted:f,onMouseEnter:o,onMouseLeave:p,onSetMuted:q,onUserInteraction:e,renderVolumeSlider:s,useOutlineIcons:a,volume:n}),b[7]=r,b[8]=f,b[9]=e,b[10]=q,b[11]=s,b[12]=a,b[13]=n,b[14]=o):o=b[14];return o}g["default"]=a}),98);
__d("useVideoPlayerVolumeControlAudioAvailabilityUI",["fbt","CometTooltipImpl.react","VideoPlayerControlsHiddenContext","clearTimeout","emptyFunction","react","setTimeout","useAudioAvailabilityAtPlayhead","usePrevious","useStable"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;var k=b.useContext,l=b.useEffect,m=b.useRef,n=b.useState,o=3e3;function a(a){var b=a.canPlayerProduceSound,d=a.isHovering;a=c("useAudioAvailabilityAtPlayhead")();var e=a.isSilentAtPlayhead;a=a.volumeControlState;var g=null;switch(a){case"VOLUME_SILENT":g=h._(/*BTDS*/"Video has no sound");break;case"VOLUME_COPYRIGHT_FULL":g=h._(/*BTDS*/"Muted due to copyright claim");break;case"VOLUME_COPYRIGHT_PARTIAL_SILENCED":g=h._(/*BTDS*/"Partially muted due to copyright claim");break;case"VOLUME_COPYRIGHT_PARTIAL_NOT_SILENCED":break;case"VOLUME_DEFAULT":break;default:a}var i=c("usePrevious")(e),p=n(!1),q=p[0],r=p[1],s=m(c("emptyFunction")),t=m(!1);p=n(!1);var u=p[0],v=p[1],w=c("useStable")(function(){return function(a){t.current=a,v(a),s.current(a),a||r(!1)}}),x=k(c("VideoPlayerControlsHiddenContext"));l(function(){x?w(!1):g==null?w(!1):d||q?w(!0):e!==i&&e&&b&&w(!0)},[g,b,x,d,q,e,i,w]);l(function(){if(u){var a=c("setTimeout")(function(){w(!1)},o);return function(){c("clearTimeout")(a)}}},[u,w]);p=c("useStable")(function(){return function(){r(function(a){return!a})}});var y=c("useStable")(function(){function a(a){var b=n(!1),d=b[0],e=b[1];l(function(){s.current=e;return function(){s.current=c("emptyFunction")}},[e]);l(function(){a.isVisible||w(!1)},[a.isVisible]);return j.jsx(c("CometTooltipImpl.react"),babelHelpers["extends"]({},a,{isVisible:d}))}a.displayName=a.name+" [from "+f.id+"]";return a}),z=a==="VOLUME_COPYRIGHT_FULL"||a==="VOLUME_SILENT",A=b?e:z;return g==null?null:{onVolumeControlPress:p,shouldDisableVolumeControl:z,shouldShowNullIcon:A,tooltipContent:g,tooltipImpl:y,volumeControlState:a}}g["default"]=a}),226);/*FB_PKG_DELIM*/
__d("EBMinosLogger",["WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";a=d("WATagsLogger").TAGS(["minos"]);g.minosLogger=a}),98);
__d("EBGetMinosWasm",["WAWasmModuleCache","bx"],(function(a,b,c,d,e,f,g){"use strict";var h=c("bx").getURL(c("bx")("31853"));a=function(){return d("WAWasmModuleCache").loadWasmModule(h)};g.getMinosWasm=a}),98);
__d("EBMinosWasm.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};c={};e={};f={};var h={},i={},j={},k={},l={},m={},n={},o={},p={},q={},r={},s={},t={},u={},v={},w={},x={},y={},z={},A={},B={},C={},D={},E={},F={},G={},H={},I={},J={},K={},L={},M={},N={},O={},P={},Q={},R={},S={},T={},U={},V={},W={},X={},Y={},Z={};a.name="MinosMessageMetadata";a.internalSpec={mekId:[1,(d=d("WAProtoConst")).FLAGS.REQUIRED|d.TYPES.BYTES],timestamp:[2,d.FLAGS.REQUIRED|d.TYPES.UINT64],messageId:[3,d.FLAGS.REQUIRED|d.TYPES.STRING],threadId:[4,d.FLAGS.REQUIRED|d.TYPES.BYTES]};b.name="MinosEncryptAndSignMessageInput";b.internalSpec={transportSigningSk:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],mek:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES],plaintext:[3,d.FLAGS.REQUIRED|d.TYPES.BYTES],metadata:[4,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,a]};c.name="MinosEncryptAndSignMessageResult";c.internalSpec={ciphertext:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],signature:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES]};e.name="MinosDecryptAndVerifyMessageInput";e.internalSpec={transportSigningPk:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],mek:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES],encryptedMessageCiphertext:[3,d.FLAGS.REQUIRED|d.TYPES.BYTES],encryptedMessageSignature:[4,d.FLAGS.REQUIRED|d.TYPES.BYTES],metadata:[5,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,a]};f.name="MinosDecryptAndVerifyMessageResult";f.internalSpec={plaintext:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};h.name="MekBundle";h.internalSpec={key:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],mekId:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES],rosterHash:[3,d.FLAGS.REQUIRED|d.TYPES.BYTES]};i.name="GenerateMekInput";i.internalSpec={epochHeads:[1,d.FLAGS.REPEATED|d.TYPES.BYTES]};j.name="GenerateMekResult";j.internalSpec={mek:[1,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,h]};k.name="GenerateMekRosterHashInput";k.internalSpec={epochHeads:[1,d.FLAGS.REPEATED|d.TYPES.BYTES]};l.name="GenerateMekRosterHashResult";l.internalSpec={rosterHash:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};m.name="EncryptMekForDistributionInput";m.internalSpec={senderEpochHead:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],toMailboxPk:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES],fromKeypair:[3,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,n],mek:[4,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,h]};n.name="EncryptMekForDistributionInput$MailboxAuthKP";n.internalSpec={sk:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],pk:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES]};o.name="EncryptMekForDistributionResult";o.internalSpec={ciphertext:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};p.name="DecryptMekForDistributionInput";p.internalSpec={toMailboxSk:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],fromPk:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES],mekId:[3,d.FLAGS.REQUIRED|d.TYPES.BYTES],senderEpochHead:[4,d.FLAGS.REQUIRED|d.TYPES.BYTES],rosterHash:[5,d.FLAGS.REQUIRED|d.TYPES.BYTES],ciphertext:[6,d.FLAGS.REQUIRED|d.TYPES.BYTES]};q.name="DecryptMekForDistributionResult";q.internalSpec={mek:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};r.name="EncryptMeksForDistributionFromTransportSenderInput";r.internalSpec={mek:[1,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,h],transportSigningKp:[2,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,s],recipientMailboxEncryptionPks:[3,d.FLAGS.REPEATED|d.TYPES.BYTES],recipientEpochHeads:[4,d.FLAGS.REPEATED|d.TYPES.BYTES]};s.name="EncryptMeksForDistributionFromTransportSenderInput$TransportSigningKP";s.internalSpec={sk:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],pk:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES]};t.name="EncryptMeksForDistributionFromTransportSenderResult";t.internalSpec={encryptedMeks:[1,d.FLAGS.REPEATED|d.TYPES.BYTES],ephemeralEncryptionPk:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES],signingPk:[3,d.FLAGS.REQUIRED|d.TYPES.BYTES],signature:[4,d.FLAGS.REQUIRED|d.TYPES.BYTES]};u.name="DecryptMekForDistributionFromTransportSenderInput";u.internalSpec={mekDistribution:[1,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,v],mekId:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES],rosterHash:[3,d.FLAGS.REQUIRED|d.TYPES.BYTES],recipientEncSk:[4,d.FLAGS.REQUIRED|d.TYPES.BYTES]};v.name="DecryptMekForDistributionFromTransportSenderInput$TransportSenderMEKDistributionSingleRecipient";v.internalSpec={encryptedMek:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],ephemeralEncryptionPk:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES],signingPk:[3,d.FLAGS.REQUIRED|d.TYPES.BYTES],signature:[4,d.FLAGS.REQUIRED|d.TYPES.BYTES]};w.name="DecryptMekForDistributionFromTransportSenderResult";w.internalSpec={mek:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};x.name="WrapTransportSigningPublicKeyInput";x.internalSpec={keyBytes:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};y.name="WrapTransportSigningPublicKeyResult";y.internalSpec={prefixedKey:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};z.name="WrapTransportSigningSecretKeyInput";z.internalSpec={keyBytes:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};A.name="WrapTransportSigningSecretKeyResult";A.internalSpec={prefixedKey:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};B.name="DeriveMailboxSigningKeypairInput";B.internalSpec={exportRootKey:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],epochNumber:[2,d.FLAGS.REQUIRED|d.TYPES.UINT64]};C.name="DeriveMailboxSigningKeypairResult";C.internalSpec={mailboxSigningPublicKey:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],mailboxSigningPrivateKey:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES]};D.name="DeriveMailboxEncryptionKeypairInput";D.internalSpec={exportRootKey:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],epochNumber:[2,d.FLAGS.REQUIRED|d.TYPES.UINT64]};E.name="DeriveMailboxEncryptionKeypairResult";E.internalSpec={mailboxEncryptionPublicKey:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],mailboxEncryptionPrivateKey:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES]};F.name="DeriveMailboxAuthKeypairInput";F.internalSpec={exportRootKey:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],epochNumber:[2,d.FLAGS.REQUIRED|d.TYPES.UINT64]};G.name="DeriveMailboxAuthKeypairResult";G.internalSpec={mailboxAuthPublicKey:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],mailboxAuthPrivateKey:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES]};H.name="DeriveAttachmentAccessTokenSecretInput";H.internalSpec={mediaKey:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};I.name="DeriveAttachmentAccessTokenSecretResult";I.internalSpec={attachmentAccessTokenSecret:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};J.name="DeriveAttachmentPrimaryKeySecretInput";J.internalSpec={mediaKey:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};K.name="DeriveAttachmentPrimaryKeySecretResult";K.internalSpec={attachmentPrimaryKeySecret:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};L.name="EpochPublicData";L.internalSpec={epochNumber:[1,d.FLAGS.REQUIRED|d.TYPES.UINT64],userFbid:[2,d.FLAGS.REQUIRED|d.TYPES.STRING],mailboxSigningPk:[3,d.FLAGS.REQUIRED|d.TYPES.BYTES],mailboxEncryptionPk:[4,d.FLAGS.REQUIRED|d.TYPES.BYTES],mailboxAuthPk:[5,d.FLAGS.REQUIRED|d.TYPES.BYTES],previousEpochHead:[6,d.TYPES.BYTES]};M.name="EpochSignatures";M.internalSpec={selfSignature:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],prevSignature:[2,d.TYPES.BYTES]};N.name="MinosSignedEpoch";N.internalSpec={epochPublicData:[1,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,L],signatures:[2,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,M],epochHead:[3,d.FLAGS.REQUIRED|d.TYPES.BYTES]};O.name="MinosOpenInitialEpochInput";O.internalSpec={userFbid:[1,d.FLAGS.REQUIRED|d.TYPES.STRING],epochNumber:[2,d.FLAGS.REQUIRED|d.TYPES.UINT64],exportRootKey:[3,d.FLAGS.REQUIRED|d.TYPES.BYTES]};P.name="MinosOpenInitialEpochResult";P.internalSpec={minosSignedEpoch:[1,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,N]};Q.name="MinosOpenEpochInput";Q.internalSpec={userFbid:[1,d.FLAGS.REQUIRED|d.TYPES.STRING],epochNumber:[2,d.FLAGS.REQUIRED|d.TYPES.UINT64],exportRootKey:[3,d.FLAGS.REQUIRED|d.TYPES.BYTES],previousExportRootKey:[4,d.FLAGS.REQUIRED|d.TYPES.BYTES],previousEpochNumber:[5,d.FLAGS.REQUIRED|d.TYPES.UINT64],previousEpochHead:[6,d.FLAGS.REQUIRED|d.TYPES.BYTES]};R.name="MinosOpenEpochResult";R.internalSpec={minosSignedEpoch:[1,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,N]};S.name="MinosValidateEpochInput";S.internalSpec={epochPublicData:[1,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,L],previousEpochPublicData:[2,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,L],signatures:[3,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,M]};T.name="MinosValidateEpochResult";T.internalSpec={valid:[1,d.TYPES.BOOL],errorMessage:[2,d.TYPES.STRING],__oneofs__:{result:["valid","errorMessage"]}};U.name="MinosVerifySingleEpochInput";U.internalSpec={epochPublicData:[1,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,L],signature:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES]};V.name="MinosVerifySingleEpochResult";V.internalSpec={valid:[1,d.FLAGS.REQUIRED|d.TYPES.BOOL]};W.name="MinosThreadIdFromOneToOneThreadInput";W.internalSpec={actThreadId:[1,d.FLAGS.REQUIRED|d.TYPES.STRING],selfFbid:[2,d.FLAGS.REQUIRED|d.TYPES.STRING]};X.name="MinosThreadIdFromOneToOneThreadResult";X.internalSpec={threadId:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};Y.name="MinosThreadIdFromActThreadIdInput";Y.internalSpec={actThreadId:[1,d.FLAGS.REQUIRED|d.TYPES.STRING]};Z.name="MinosThreadIdFromActThreadIdResult";Z.internalSpec={threadId:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};g.MinosMessageMetadataSpec=a;g.MinosEncryptAndSignMessageInputSpec=b;g.MinosEncryptAndSignMessageResultSpec=c;g.MinosDecryptAndVerifyMessageInputSpec=e;g.MinosDecryptAndVerifyMessageResultSpec=f;g.MekBundleSpec=h;g.GenerateMekInputSpec=i;g.GenerateMekResultSpec=j;g.GenerateMekRosterHashInputSpec=k;g.GenerateMekRosterHashResultSpec=l;g.EncryptMekForDistributionInputSpec=m;g.EncryptMekForDistributionInput$MailboxAuthKPSpec=n;g.EncryptMekForDistributionResultSpec=o;g.DecryptMekForDistributionInputSpec=p;g.DecryptMekForDistributionResultSpec=q;g.EncryptMeksForDistributionFromTransportSenderInputSpec=r;g.EncryptMeksForDistributionFromTransportSenderInput$TransportSigningKPSpec=s;g.EncryptMeksForDistributionFromTransportSenderResultSpec=t;g.DecryptMekForDistributionFromTransportSenderInputSpec=u;g.DecryptMekForDistributionFromTransportSenderInput$TransportSenderMEKDistributionSingleRecipientSpec=v;g.DecryptMekForDistributionFromTransportSenderResultSpec=w;g.WrapTransportSigningPublicKeyInputSpec=x;g.WrapTransportSigningPublicKeyResultSpec=y;g.WrapTransportSigningSecretKeyInputSpec=z;g.WrapTransportSigningSecretKeyResultSpec=A;g.DeriveMailboxSigningKeypairInputSpec=B;g.DeriveMailboxSigningKeypairResultSpec=C;g.DeriveMailboxEncryptionKeypairInputSpec=D;g.DeriveMailboxEncryptionKeypairResultSpec=E;g.DeriveMailboxAuthKeypairInputSpec=F;g.DeriveMailboxAuthKeypairResultSpec=G;g.DeriveAttachmentAccessTokenSecretInputSpec=H;g.DeriveAttachmentAccessTokenSecretResultSpec=I;g.DeriveAttachmentPrimaryKeySecretInputSpec=J;g.DeriveAttachmentPrimaryKeySecretResultSpec=K;g.EpochPublicDataSpec=L;g.EpochSignaturesSpec=M;g.MinosSignedEpochSpec=N;g.MinosOpenInitialEpochInputSpec=O;g.MinosOpenInitialEpochResultSpec=P;g.MinosOpenEpochInputSpec=Q;g.MinosOpenEpochResultSpec=R;g.MinosValidateEpochInputSpec=S;g.MinosValidateEpochResultSpec=T;g.MinosVerifySingleEpochInputSpec=U;g.MinosVerifySingleEpochResultSpec=V;g.MinosThreadIdFromOneToOneThreadInputSpec=W;g.MinosThreadIdFromOneToOneThreadResultSpec=X;g.MinosThreadIdFromActThreadIdInputSpec=Y;g.MinosThreadIdFromActThreadIdResultSpec=Z}),98);
__d("WASIContext",[],(function(a,b,c,d,e,f){"use strict";a=function(a){var b;this.fs=(b=a==null?void 0:a.fs)!=null?b:{};this.args=(b=a==null?void 0:a.args)!=null?b:[];this.env=(b=a==null?void 0:a.env)!=null?b:{};this.stdin=(b=a==null?void 0:a.stdin)!=null?b:function(){return null};this.stdout=(b=a==null?void 0:a.stdout)!=null?b:function(){};this.stderr=(b=a==null?void 0:a.stderr)!=null?b:function(){};this.debug=a==null?void 0:a.debug;this.isTTY=!!(a!=null&&a.isTTY)};f.WASIContext=a}),66);
__d("WASISnapshotPreview1",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({SUCCESS:0,E2BIG:1,EACCESS:2,EADDRINUSE:3,EADDRNOTAVAIL:4,EAFNOSUPPORT:5,EAGAIN:6,EALREADY:7,EBADF:8,EBADMSG:9,EBUSY:10,ECANCELED:11,ECHILD:12,ECONNABORTED:13,ECONNREFUSED:14,ECONNRESET:15,EDEADLK:16,EDESTADDRREQ:17,EDOM:18,EDQUOT:19,EEXIST:20,EFAULT:21,EFBIG:22,EHOSTUNREACH:23,EIDRM:24,EILSEQ:25,EINPROGRESS:26,EINTR:27,EINVAL:28,EIO:29,EISCONN:30,EISDIR:31,ELOOP:32,EMFILE:33,EMLINK:34,EMSGSIZE:35,EMULTIHOP:36,ENAMETOOLONG:37,ENETDOWN:38,ENETRESET:39,ENETUNREACH:40,ENFILE:41,ENOBUFS:42,ENODEV:43,ENOENT:44,ENOEXEC:45,ENOLCK:46,ENOLINK:47,ENOMEM:48,ENOMSG:49,ENOPROTOOPT:50,ENOSPC:51,ENOSYS:52,ENOTCONN:53,ENOTDIR:54,ENOTEMPTY:55,ENOTRECOVERABLE:56,ENOTSOCK:57,ENOTSUP:58,ENOTTY:59,ENXIO:60,EOVERFLOW:61,EOWNERDEAD:62,EPERM:63,EPIPE:64,EPROTO:65,EPROTONOSUPPORT:66,EPROTOTYPE:67,ERANGE:68,EROFS:69,ESPIPE:70,ESRCH:71,ESTALE:72,ETIMEDOUT:73,ETXTBSY:74,EXDEV:75,ENOTCAPABLE:76});d=(c=b("$InternalEnum"))({REALTIME:0,MONOTONIC:1,PROCESS_CPUTIME_ID:2,THREAD_CPUTIME_ID:3});e=c({SET:0,CUR:1,END:2});b=c({UNKNOWN:0,BLOCK_DEVICE:1,CHARACTER_DEVICE:2,DIRECTORY:3,REGULAR_FILE:4,SOCKET_DGRAM:5,SOCKET_STREAM:6,SYMBOLIC_LINK:7});var g=c({DIR:0});c=c({CLOCK:0,FD_READ:1,FD_WRITE:2});var h={SYMLINK_FOLLOW:1<<0},i={CREAT:1<<0,DIRECTORY:1<<1,EXCL:1<<2,TRUNC:1<<3},j={APPEND:1<<0,DSYNC:1<<1,NONBLOCK:1<<2,RSYNC:1<<3,SYNC:1<<4},k={FD_DATASYNC:BigInt(1)<<BigInt(0),FD_READ:BigInt(1)<<BigInt(1),FD_SEEK:BigInt(1)<<BigInt(2),FD_FDSTAT_SET_FLAGS:BigInt(1)<<BigInt(3),FD_SYNC:BigInt(1)<<BigInt(4),FD_TELL:BigInt(1)<<BigInt(5),FD_WRITE:BigInt(1)<<BigInt(6),FD_ADVISE:BigInt(1)<<BigInt(7),FD_ALLOCATE:BigInt(1)<<BigInt(8),PATH_CREATE_DIRECTORY:BigInt(1)<<BigInt(9),PATH_CREATE_FILE:BigInt(1)<<BigInt(10),PATH_LINK_SOURCE:BigInt(1)<<BigInt(11),PATH_LINK_TARGET:BigInt(1)<<BigInt(12),PATH_OPEN:BigInt(1)<<BigInt(13),FD_READDIR:BigInt(1)<<BigInt(14),PATH_READLINK:BigInt(1)<<BigInt(15),PATH_RENAME_SOURCE:BigInt(1)<<BigInt(16),PATH_RENAME_TARGET:BigInt(1)<<BigInt(17),PATH_FILESTAT_GET:BigInt(1)<<BigInt(18),PATH_FILESTAT_SET_SIZE:BigInt(1)<<BigInt(19),PATH_FILESTAT_SET_TIMES:BigInt(1)<<BigInt(20),FD_FILESTAT_GET:BigInt(1)<<BigInt(21),FD_FILESTAT_SET_SIZE:BigInt(1)<<BigInt(22),FD_FILESTAT_SET_TIMES:BigInt(1)<<BigInt(23),PATH_SYMLINK:BigInt(1)<<BigInt(24),PATH_REMOVE_DIRECTORY:BigInt(1)<<BigInt(25),PATH_UNLINK_FILE:BigInt(1)<<BigInt(26),POLL_FD_READWRITE:BigInt(1)<<BigInt(27),SOCK_SHUTDOWN:BigInt(1)<<BigInt(28),SOCK_ACCEPT:BigInt(1)<<BigInt(29)},l={ATIM:1<<0,ATIM_NOW:1<<1,MTIM:1<<2,MTIM_NOW:1<<3},m={SUBSCRIPTION_CLOCK_ABSTIME:1<<0},n={FD_READWRITE_HANGUP:1<<0},o=64,p=48,q=32;f.RESULT=a;f.Clock=d;f.Whence=e;f.FileType=b;f.PreopenType=g;f.EventType=c;f.LookupFlags=h;f.OpenFlags=i;f.FileDescriptorFlags=j;f.RightsFlags=k;f.FileStatTimestampFlags=l;f.SubscriptionClockFlags=m;f.EventReadWriteFlags=n;f.FILESTAT_SIZE=o;f.SUBSCRIPTION_SIZE=p;f.EVENT_SIZE=q}),66);
__d("WATextEncoding",[],(function(a,b,c,d,e,f){"use strict";e=TextEncoder;var g=TextDecoder,h=e,i=g;function a(){return new h()}function b(){return new i()}function c(a){h=a}function d(a){i=a}f.newTextEncoder=a;f.newTextDecoder=b;f.setTextEncoderClass=c;f.setTextDecoderClass=d}),66);
__d("WASIDrive",["WASISnapshotPreview1","WATextEncoding"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.nextFD=10,this.openMap=new Map(),this.fs=babelHelpers["extends"]({},a),this.openMap.set(3,new j(this.fs,"/"))}var b=a.prototype;b.$1=function(a,b,c){a=new h(a,c);b&&(a.buffer=new Uint8Array(new ArrayBuffer(1024),0,0));c=this.nextFD;this.openMap.set(c,a);this.nextFD++;return[d("WASISnapshotPreview1").RESULT.SUCCESS,c]};b.$2=function(a,b){a=new j(a,b);b=this.nextFD;this.openMap.set(b,a);this.nextFD++;return[d("WASISnapshotPreview1").RESULT.SUCCESS,b]};b.$3=function(a,b){return b==="."?!0:a.containsDirectory(b)};b.open=function(a,b,c,e){var f,g=!!(c&(f=d("WASISnapshotPreview1")).OpenFlags.CREAT),h=!!(c&f.OpenFlags.DIRECTORY),i=!!(c&f.OpenFlags.EXCL);c=!!(c&f.OpenFlags.TRUNC);f=this.openMap.get(a);if(!(f instanceof j))return[d("WASISnapshotPreview1").RESULT.EBADF];if(f.containsFile(b)){if(h)return[d("WASISnapshotPreview1").RESULT.ENOTDIR];if(i)return[d("WASISnapshotPreview1").RESULT.EEXIST];a=f.get(b);return this.$1(a,c,e)}else if(this.$3(f,b)){if(b===".")return this.$2(this.fs,"/");var k="/"+b+"/";h=Object.entries(this.fs).filter(function(a){a=a[0];return a.startsWith(k)});return this.$2(Object.fromEntries(h),k)}else{if(g){i=f.fullPath(b);this.fs[i]={path:i,mode:"binary",content:new Uint8Array(0),timestamps:{access:new Date(),modification:new Date(),change:new Date()}};return this.$1(this.fs[i],c,e)}return[d("WASISnapshotPreview1").RESULT.ENOTCAPABLE]}};b.close=function(a){if(!this.openMap.has(a))return d("WASISnapshotPreview1").RESULT.EBADF;var b=this.openMap.get(a);b instanceof h&&b.sync();this.openMap["delete"](a);return d("WASISnapshotPreview1").RESULT.SUCCESS};b.read=function(a,b){a=this.openMap.get(a);return!a||a instanceof j?[d("WASISnapshotPreview1").RESULT.EBADF]:[d("WASISnapshotPreview1").RESULT.SUCCESS,a.read(b)]};b.pread=function(a,b,c){a=this.openMap.get(a);return!a||a instanceof j?[d("WASISnapshotPreview1").RESULT.EBADF]:[d("WASISnapshotPreview1").RESULT.SUCCESS,a.pread(b,c)]};b.write=function(a,b){a=this.openMap.get(a);if(!a||a instanceof j)return d("WASISnapshotPreview1").RESULT.EBADF;a.write(b);return d("WASISnapshotPreview1").RESULT.SUCCESS};b.pwrite=function(a,b,c){a=this.openMap.get(a);if(!a||a instanceof j)return d("WASISnapshotPreview1").RESULT.EBADF;a.pwrite(b,c);return d("WASISnapshotPreview1").RESULT.SUCCESS};b.sync=function(a){a=this.openMap.get(a);if(!a||a instanceof j)return d("WASISnapshotPreview1").RESULT.EBADF;a.sync();return d("WASISnapshotPreview1").RESULT.SUCCESS};b.seek=function(a,b,c){a=this.openMap.get(a);return!a||a instanceof j?[d("WASISnapshotPreview1").RESULT.EBADF]:[d("WASISnapshotPreview1").RESULT.SUCCESS,a.seek(b,c)]};b.tell=function(a){a=this.openMap.get(a);return!a||a instanceof j?[d("WASISnapshotPreview1").RESULT.EBADF]:[d("WASISnapshotPreview1").RESULT.SUCCESS,a.tell()]};b.renumber=function(a,b){if(!this.exists(a)||!this.exists(b))return d("WASISnapshotPreview1").RESULT.EBADF;if(a===b)return d("WASISnapshotPreview1").RESULT.SUCCESS;this.close(b);a=this.openMap.get(a);this.openMap.set(b,a);return d("WASISnapshotPreview1").RESULT.SUCCESS};b.unlink=function(a,b){a=this.openMap.get(a);if(!(a instanceof j))return d("WASISnapshotPreview1").RESULT.EBADF;if(!a.contains(b))return d("WASISnapshotPreview1").RESULT.ENOENT;for(var c of Object.keys(this.fs))(c===a.fullPath(b)||c.startsWith(a.fullPath(b)+"/"))&&delete this.fs[c];return d("WASISnapshotPreview1").RESULT.SUCCESS};b.rename=function(a,b,c,e){a=this.openMap.get(a);c=this.openMap.get(c);if(!(a instanceof j)||!(c instanceof j))return d("WASISnapshotPreview1").RESULT.EBADF;if(!a.contains(b))return d("WASISnapshotPreview1").RESULT.ENOENT;if(c.contains(e))return d("WASISnapshotPreview1").RESULT.EEXIST;a=a.fullPath(b);b=c.fullPath(e);for(c of Object.keys(this.fs))if(c.startsWith(a)){e=c.replace(a,b);this.fs[e]=this.fs[c];this.fs[e].path=e;delete this.fs[c]}return d("WASISnapshotPreview1").RESULT.SUCCESS};b.list=function(a){a=this.openMap.get(a);return!(a instanceof j)?[d("WASISnapshotPreview1").RESULT.EBADF]:[d("WASISnapshotPreview1").RESULT.SUCCESS,a.list()]};b.stat=function(a){a=this.openMap.get(a);return!(a instanceof h)?[d("WASISnapshotPreview1").RESULT.EBADF]:[d("WASISnapshotPreview1").RESULT.SUCCESS,a.stat()]};b.pathStat=function(a,b){a=this.openMap.get(a);if(!(a instanceof j))return[d("WASISnapshotPreview1").RESULT.EBADF];if(a.containsFile(b)){var c=a.fullPath(b);c=new h(this.fs[c],0).stat();return[d("WASISnapshotPreview1").RESULT.SUCCESS,c]}else if(this.$3(a,b)){if(b===".")return[d("WASISnapshotPreview1").RESULT.SUCCESS,new j(this.fs,"/").stat()];var e="/"+b+"/";c=Object.entries(this.fs).filter(function(a){a=a[0];return a.startsWith(e)});a=new j(Object.fromEntries(c),e).stat();return[d("WASISnapshotPreview1").RESULT.SUCCESS,a]}else return[d("WASISnapshotPreview1").RESULT.ENOTCAPABLE]};b.setFlags=function(a,b){a=this.openMap.get(a);if(a instanceof h){a.setFlags(b);return d("WASISnapshotPreview1").RESULT.SUCCESS}else return d("WASISnapshotPreview1").RESULT.EBADF};b.setSize=function(a,b){a=this.openMap.get(a);if(a instanceof h){a.setSize(Number(b));return d("WASISnapshotPreview1").RESULT.SUCCESS}else return d("WASISnapshotPreview1").RESULT.EBADF};b.setAccessTime=function(a,b){a=this.openMap.get(a);if(a instanceof h){a.setAccessTime(b);return d("WASISnapshotPreview1").RESULT.SUCCESS}else return d("WASISnapshotPreview1").RESULT.EBADF};b.setModificationTime=function(a,b){a=this.openMap.get(a);if(a instanceof h){a.setModificationTime(b);return d("WASISnapshotPreview1").RESULT.SUCCESS}else return d("WASISnapshotPreview1").RESULT.EBADF};b.pathSetAccessTime=function(a,b,c){a=this.openMap.get(a);if(!(a instanceof j))return d("WASISnapshotPreview1").RESULT.EBADF;a=a.get(b);if(a==null)return d("WASISnapshotPreview1").RESULT.ENOTCAPABLE;b=new h(a,0);b.setAccessTime(c);b.sync();return d("WASISnapshotPreview1").RESULT.SUCCESS};b.pathSetModificationTime=function(a,b,c){a=this.openMap.get(a);if(!(a instanceof j))return d("WASISnapshotPreview1").RESULT.EBADF;a=a.get(b);if(a==null)return d("WASISnapshotPreview1").RESULT.ENOTCAPABLE;b=new h(a,0);b.setModificationTime(c);b.sync();return d("WASISnapshotPreview1").RESULT.SUCCESS};b.pathCreateDir=function(a,b){a=this.openMap.get(a);if(!(a instanceof j))return d("WASISnapshotPreview1").RESULT.EBADF;if(a.contains(b))return d("WASISnapshotPreview1").RESULT.ENOTCAPABLE;a=a.fullPath(b)+"/.runno";this.fs[a]={path:a,timestamps:{access:new Date(),modification:new Date(),change:new Date()},mode:"string",content:""};return d("WASISnapshotPreview1").RESULT.SUCCESS};b.exists=function(a){return this.openMap.has(a)};b.fileType=function(a){a=this.openMap.get(a);if(!a)return d("WASISnapshotPreview1").FileType.UNKNOWN;else if(a instanceof h)return d("WASISnapshotPreview1").FileType.REGULAR_FILE;else return d("WASISnapshotPreview1").FileType.DIRECTORY};b.fileFdflags=function(a){a=this.openMap.get(a);if(a instanceof h)return a.fdflags;else return 0};return a}();var h=function(){function a(a,b){this.$1=BigInt(0);this.isDirty=!1;this.file=a;if(this.file.mode==="string"){a=this.file.content;var c=d("WATextEncoding").newTextEncoder();this.buffer=c.encode(a)}else this.buffer=this.file.content;this.fdflags=b;this.flagAppend=!!(b&d("WASISnapshotPreview1").FileDescriptorFlags.APPEND);this.flagDSync=!!(b&d("WASISnapshotPreview1").FileDescriptorFlags.DSYNC);this.flagNonBlock=!!(b&d("WASISnapshotPreview1").FileDescriptorFlags.NONBLOCK);this.flagRSync=!!(b&d("WASISnapshotPreview1").FileDescriptorFlags.RSYNC);this.flagSync=!!(b&d("WASISnapshotPreview1").FileDescriptorFlags.SYNC)}var b=a.prototype;b.getOffset=function(){return Number(this.$1)};b.read=function(a){a=this.buffer.subarray(this.getOffset(),this.getOffset()+a);this.$1+=BigInt(a.length);return a};b.pread=function(a,b){return this.buffer.subarray(b,b+a)};b.write=function(a){this.isDirty=!0;if(this.flagAppend){var b=this.buffer.length;this.$2(b+a.byteLength);this.buffer.set(a,b)}else{b=Math.max(this.getOffset()+a.byteLength,this.buffer.byteLength);this.$2(b);this.buffer.set(a,this.getOffset());this.$1+=BigInt(a.byteLength)}(this.flagDSync||this.flagSync)&&this.sync()};b.pwrite=function(a,b){this.isDirty=!0;if(this.flagAppend){var c=this.buffer.length;this.$2(c+a.byteLength);this.buffer.set(a,c)}else{c=Math.max(b+a.byteLength,this.buffer.byteLength);this.$2(c);this.buffer.set(a,b)}(this.flagDSync||this.flagSync)&&this.sync()};b.sync=function(){if(!this.isDirty)return;this.isDirty=!1;if(this.file.mode==="binary"){this.file.content=new Uint8Array(this.buffer);return}var a=d("WATextEncoding").newTextDecoder();this.file.content=a.decode(this.buffer);return};b.seek=function(a,b){switch(b){case d("WASISnapshotPreview1").Whence.SET:this.$1=a;break;case d("WASISnapshotPreview1").Whence.CUR:this.$1+=a;break;case d("WASISnapshotPreview1").Whence.END:this.$1=BigInt(this.buffer.length)+a;break}return this.$1};b.tell=function(){return this.$1};b.stat=function(){return{path:this.file.path,timestamps:this.file.timestamps,type:d("WASISnapshotPreview1").FileType.REGULAR_FILE,byteLength:this.buffer.length}};b.setFlags=function(a){this.fdflags=a};b.setSize=function(a){this.$2(a)};b.setAccessTime=function(a){this.file.timestamps.access=a};b.setModificationTime=function(a){this.file.timestamps.modification=a};b.$2=function(a){if(a<=this.buffer.buffer.byteLength){this.buffer=new Uint8Array(this.buffer.buffer,0,a);return}var b;this.buffer.buffer.byteLength===0?b=new ArrayBuffer(a<1024?1024:a*2):a>this.buffer.buffer.byteLength*2?b=new ArrayBuffer(a*2):b=new ArrayBuffer(this.buffer.buffer.byteLength*2);b=new Uint8Array(b,0,a);b.set(this.buffer);this.buffer=b};return a}();function i(a,b){b=b.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&");b=new RegExp("^"+b);return a.replace(b,"")}var j=function(){function a(a,b){this.dir=a,this.prefix=b}var b=a.prototype;b.containsFile=function(a){for(var b of Object.keys(this.dir)){var c=i(b,this.prefix);if(c===a)return!0}return!1};b.containsDirectory=function(a){for(var b of Object.keys(this.dir)){var c=i(b,this.prefix);if(c.startsWith(a+"/"))return!0}return!1};b.contains=function(a){for(var b of Object.keys(this.dir)){var c=i(b,this.prefix);if(c===a||c.startsWith(a+"/"))return!0}return!1};b.get=function(a){return this.dir[this.fullPath(a)]};b.fullPath=function(a){return""+this.prefix+a};b.list=function(){var a=[],b=new Set();for(var c of Object.keys(this.dir)){var e=i(c,this.prefix);if(e.includes("/")){var f=e.split("/")[0];if(b.has(f))continue;b.add(f);a.push({name:f,type:d("WASISnapshotPreview1").FileType.DIRECTORY})}else a.push({name:e,type:d("WASISnapshotPreview1").FileType.REGULAR_FILE})}return a};b.stat=function(){return{path:this.prefix,timestamps:{access:new Date(),modification:new Date(),change:new Date()},type:d("WASISnapshotPreview1").FileType.DIRECTORY,byteLength:0}};return a}();g.WASIDrive=a}),98);
__d("WASI",["WACryptoDependencies","WASIContext","WASIDrive","WASISnapshotPreview1","WATextEncoding","err"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b,e=new(d("WASIContext").WASIContext)(a),f=new(d("WASIDrive").WASIDrive)(e.fs);function g(){return Object.entries(e.env).map(function(a){var b=a[0];a=a[1];return b+"="+a})}var o={args_get:function(a,c){a=a;c=c;var f=new DataView(b.buffer);for(var g of e.args){f.setUint32(a,c,!0);a+=4;var h=d("WATextEncoding").newTextEncoder().encode(g+"\0"),i=new Uint8Array(b.buffer,c,h.byteLength);i.set(h);c+=h.byteLength}return d("WASISnapshotPreview1").RESULT.SUCCESS},args_sizes_get:function(a,c){var f=e.args,g=f.reduce(function(a,b){return a+d("WATextEncoding").newTextEncoder().encode(b+"\0").byteLength},0),h=new DataView(b.buffer);h.setUint32(a,f.length,!0);h.setUint32(c,g,!0);return d("WASISnapshotPreview1").RESULT.SUCCESS},clock_res_get:function(){throw c("err")("clock_res_get is not implemented")},clock_time_get:function(a,c,e){c=d("WASISnapshotPreview1").Clock.cast(a);if(c==null)return d("WASISnapshotPreview1").RESULT.EINVAL;switch(c){case d("WASISnapshotPreview1").Clock.REALTIME:case d("WASISnapshotPreview1").Clock.MONOTONIC:case d("WASISnapshotPreview1").Clock.PROCESS_CPUTIME_ID:case d("WASISnapshotPreview1").Clock.THREAD_CPUTIME_ID:a=new DataView(b.buffer);a.setBigUint64(e,n(new Date()),!0);return d("WASISnapshotPreview1").RESULT.SUCCESS}},environ_get:function(a,c){a=a;c=c;var e=new DataView(b.buffer);for(var f of g()){e.setUint32(a,c,!0);a+=4;var h=d("WATextEncoding").newTextEncoder().encode(f+"\0"),i=new Uint8Array(b.buffer,c,h.byteLength);i.set(h);c+=h.byteLength}return d("WASISnapshotPreview1").RESULT.SUCCESS},environ_sizes_get:function(a,c){var e=g().reduce(function(a,b){return a+d("WATextEncoding").newTextEncoder().encode(b+"\0").byteLength},0),f=new DataView(b.buffer);f.setUint32(a,g().length,!0);f.setUint32(c,e,!0);return d("WASISnapshotPreview1").RESULT.SUCCESS},fd_advise:function(){throw c("err")("fd_advise is not implemented")},fd_allocate:function(){throw c("err")("fd_allocate is not implemented")},fd_close:function(a){return f.close(a)},fd_datasync:function(){throw c("err")("fd_datasync is not implemented")},fd_fdstat_get:function(a,c){if(a<3){if(e.isTTY){var g=i^d("WASISnapshotPreview1").RightsFlags.FD_SEEK^d("WASISnapshotPreview1").RightsFlags.FD_TELL;g=l(d("WASISnapshotPreview1").FileType.CHARACTER_DEVICE,0,g)}else g=l(d("WASISnapshotPreview1").FileType.CHARACTER_DEVICE,0);var h=new Uint8Array(b.buffer,c,g.byteLength);h.set(g);return d("WASISnapshotPreview1").RESULT.SUCCESS}if(!f.exists(a))return d("WASISnapshotPreview1").RESULT.EBADF;h=f.fileType(a);g=f.fileFdflags(a);a=l(h,g);h=new Uint8Array(b.buffer,c,a.byteLength);h.set(a);return d("WASISnapshotPreview1").RESULT.SUCCESS},fd_fdstat_set_flags:function(a,b){return f.setFlags(a,b)},fd_fdstat_set_rights:function(){return d("WASISnapshotPreview1").RESULT.SUCCESS},fd_filestat_get:function(a,c){if(a<3){var e;switch(a){case 0:e="/dev/stdin";break;case 1:e="/dev/stdout";break;case 2:e="/dev/stderr";break;default:e="/dev/undefined";break}var g=k({path:e,byteLength:0,timestamps:{access:new Date(),modification:new Date(),change:new Date()},type:d("WASISnapshotPreview1").FileType.CHARACTER_DEVICE}),h=new Uint8Array(b.buffer,c,g.byteLength);h.set(g);return d("WASISnapshotPreview1").RESULT.SUCCESS}h=f.stat(a);if(h.length===1)return h[0];g=h[1];a=k(g);h=new Uint8Array(b.buffer,c,a.byteLength);h.set(a);return d("WASISnapshotPreview1").RESULT.SUCCESS},fd_filestat_set_size:function(){throw c("err")("fd_filestat_set_size is not implemented")},fd_filestat_set_times:function(){throw c("err")("fd_filestat_set_times is not implemented")},fd_pread:function(){throw c("err")("fd_pread is not implemented")},fd_prestat_dir_name:function(a,c,e){if(a!==3)return d("WASISnapshotPreview1").RESULT.EBADF;a=d("WATextEncoding").newTextEncoder().encode("/");c=new Uint8Array(b.buffer,c,e);c.set(a.subarray(0,e));return d("WASISnapshotPreview1").RESULT.SUCCESS},fd_prestat_get:function(a,c){if(a!==3)return d("WASISnapshotPreview1").RESULT.EBADF;a=d("WATextEncoding").newTextEncoder().encode(".");c=new DataView(b.buffer,c);c.setUint8(0,d("WASISnapshotPreview1").PreopenType.DIR);c.setUint32(4,a.byteLength,!0);return d("WASISnapshotPreview1").RESULT.SUCCESS},fd_pwrite:function(){throw c("err")("fd_pwrite is not implemented")},fd_read:function(a,c,g,h){if(a===1||a===2)return d("WASISnapshotPreview1").RESULT.ENOTSUP;var i=new DataView(b.buffer);c=j(i,c,g);g=d("WATextEncoding").newTextEncoder();var k=0,l=d("WASISnapshotPreview1").RESULT.SUCCESS;for(c of c){var m=void 0;if(a===0){var n=e.stdin(c.byteLength);if(n==null)break;m=g.encode(n)}else{n=f.read(a,c.byteLength);if(n.length===1){l=n[0];break}else m=n[1]}n=Math.min(c.byteLength,m.byteLength);c.set(m.subarray(0,n));k+=n}i.setUint32(h,k,!0);return l},fd_readdir:function(){throw c("err")("fd_readdir is not implemented")},fd_renumber:function(){throw c("err")("fd_renumber is not implemented")},fd_seek:function(a,e,g,h){g=d("WASISnapshotPreview1").Whence.cast(g);if(g==null)throw c("err")("fd_seek: invalid whence");a=f.seek(a,e,g);if(a.length===1)return a[0];e=a[0];g=a[1];a=new DataView(b.buffer);a.setBigUint64(h,g,!0);return e},fd_sync:function(){throw c("err")("fd_sync is not implemented")},fd_tell:function(a,c){a=f.tell(a);if(a.length===1)return a[0];var d=a[0];a=a[1];var e=new DataView(b.buffer);e.setBigUint64(c,a,!0);return d},fd_write:function(a,c,g,h){if(a===0)return d("WASISnapshotPreview1").RESULT.ENOTSUP;var i=new DataView(b.buffer);c=j(i,c,g);g=d("WATextEncoding").newTextDecoder();var k=0,l=d("WASISnapshotPreview1").RESULT.SUCCESS;for(c of c){if(c.byteLength===0)continue;if(a===1||a===2){var m=a===1?e.stdout:e.stderr,n=g.decode(c);m(n)}else{l=f.write(a,c);if(l!==d("WASISnapshotPreview1").RESULT.SUCCESS)break}k+=c.byteLength}i.setUint32(h,k,!0);return l},path_create_directory:function(){throw c("err")("path_create_directory is not implemented")},path_filestat_get:function(){throw c("err")("path_filestat_get is not implemented")},path_filestat_set_times:function(){throw c("err")("path_filestat_set_times is not implemented")},path_link:function(){throw c("err")("path_link is not implemented")},path_open:function(a,c,d,e,g,h,i,j,k){c=new DataView(b.buffer);h=m(b,d,e);i=f.open(a,h,g,j);if(i.length===1)return i[0];d=i[0];e=i[1];c.setUint32(k,e,!0);return d},path_readlink:function(){throw c("err")("path_readlink is not implemented")},path_remove_directory:function(){throw c("err")("path_remove_directory is not implemented")},path_rename:function(){throw c("err")("path_rename is not implemented")},path_symlink:function(){throw c("err")("path_symlink is not implemented")},path_unlink_file:function(){throw c("err")("path_unlink_file is not implemented")},poll_oneoff:function(){throw c("err")("poll_oneoff is not implemented")},proc_exit:function(a){throw new h(a)},proc_raise:function(){throw c("err")("proc_raise is not implemented")},random_get:function(a,c){a=new Uint8Array(b.buffer,a,c);d("WACryptoDependencies").getCrypto().getRandomValues(a);return d("WASISnapshotPreview1").RESULT.SUCCESS},sched_yield:function(){throw c("err")("sched_yield is not implemented")},sock_accept:function(){throw c("err")("sock_accept is not implemented")},sock_recv:function(){throw c("err")("sock_recv is not implemented")},sock_send:function(){throw c("err")("sock_send is not implemented")},sock_shutdown:function(){throw c("err")("sock_shutdown is not implemented")}};return{getImportObject:function(){return{wasi_snapshot_preview1:o}},start:function(a){var d=a.exports.memory;if(d instanceof WebAssembly.Memory)b=d;else throw c("err")("Expected memory object");d=a.exports._start;try{d()}catch(a){if(a instanceof h)return{exitCode:a.code,fs:f.fs};else if(a instanceof WebAssembly.RuntimeError)return{exitCode:134,fs:f.fs};else throw a}return{exitCode:0,fs:f.fs}}}}var h=function(b){function a(a){var c;c=b.call(this)||this;c.code=a;return c}babelHelpers.inheritsLoose(a,b);return a}(babelHelpers.wrapNativeSuper(Error)),i=(b=d("WASISnapshotPreview1")).RightsFlags.FD_DATASYNC|b.RightsFlags.FD_READ|b.RightsFlags.FD_SEEK|b.RightsFlags.FD_FDSTAT_SET_FLAGS|b.RightsFlags.FD_SYNC|b.RightsFlags.FD_TELL|b.RightsFlags.FD_WRITE|b.RightsFlags.FD_ADVISE|b.RightsFlags.FD_ALLOCATE|b.RightsFlags.PATH_CREATE_DIRECTORY|b.RightsFlags.PATH_CREATE_FILE|b.RightsFlags.PATH_LINK_SOURCE|b.RightsFlags.PATH_LINK_TARGET|b.RightsFlags.PATH_OPEN|b.RightsFlags.FD_READDIR|b.RightsFlags.PATH_READLINK|b.RightsFlags.PATH_RENAME_SOURCE|b.RightsFlags.PATH_RENAME_TARGET|b.RightsFlags.PATH_FILESTAT_GET|b.RightsFlags.PATH_FILESTAT_SET_SIZE|b.RightsFlags.PATH_FILESTAT_SET_TIMES|b.RightsFlags.FD_FILESTAT_GET|b.RightsFlags.FD_FILESTAT_SET_SIZE|b.RightsFlags.FD_FILESTAT_SET_TIMES|b.RightsFlags.PATH_SYMLINK|b.RightsFlags.PATH_REMOVE_DIRECTORY|b.RightsFlags.PATH_UNLINK_FILE|b.RightsFlags.POLL_FD_READWRITE|b.RightsFlags.SOCK_SHUTDOWN|b.RightsFlags.SOCK_ACCEPT;function j(a,b,c){var d=new Array(c);b=b;for(var e=0;e<c;e++){var f=a.getUint32(b,!0);b+=4;var g=a.getUint32(b,!0);b+=4;d[e]=new Uint8Array(a.buffer,f,g)}return d}function k(a){var b=new Uint8Array(d("WASISnapshotPreview1").FILESTAT_SIZE),c=new DataView(b.buffer);c.setBigUint64(0,BigInt(0),!0);c.setBigUint64(8,BigInt(o(a.path)),!0);c.setUint8(16,a.type);c.setBigUint64(24,BigInt(1),!0);c.setBigUint64(32,BigInt(a.byteLength),!0);c.setBigUint64(40,n(a.timestamps.access),!0);c.setBigUint64(48,n(a.timestamps.modification),!0);c.setBigUint64(56,n(a.timestamps.change),!0);return b}function l(a,b,c){var d=c!=null?c:i;c=c!=null?c:i;var e=new Uint8Array(24),f=new DataView(e.buffer,0,24);f.setUint8(0,a);f.setUint32(2,b,!0);f.setBigUint64(8,d,!0);f.setBigUint64(16,c,!0);return e}function m(a,b,c){return d("WATextEncoding").newTextDecoder().decode(new Uint8Array(a.buffer,b,c))}function n(a){return BigInt(a.getTime())*BigInt(1e6)}function o(a,b){b===void 0&&(b=0);var c=3735928559^b;b=1103547991^b;for(var d=0,e;d<a.length;d++)e=a.charCodeAt(d),c=Math.imul(c^e,2654435761),b=Math.imul(b^e,1597334677);c=Math.imul(c^c>>>16,2246822507)^Math.imul(b^b>>>13,3266489909);b=Math.imul(b^b>>>16,2246822507)^Math.imul(c^c>>>13,3266489909);return 4294967296*(2097151&b)+(c>>>0)}g.createWasi=a}),98);
__d("WACreateWasmFunction",["WAErrorMessage","WAResultOrError","WASI","decodeProtobuf","encodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m="input",n="output",o="/"+m,p="/"+n;function q(a){var b=a.command,c=a.input,d=a.stderr,e=a.stdout;a=a.cli;var f=new Date();return{args:[a,b,"-i="+m,"-o="+n],fs:(a={},a[o]={content:new Uint8Array(c),mode:"binary",path:o,timestamps:{access:f,change:f,modification:f}},a),stderr:d,stdout:e}}function a(a){var b=a.InputSpec,c=a.ResultSpec,e=a.command,f=a.getWasmModule,g=a.logger,m=a.validateResult,n=a.cli,o=g.TAGS(["WasmFunc"]),r=function(a){o.ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["",""])),a)},s=function(a){o.LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["",""])),a)};return async function(a){try{a=d("encodeProtobuf").encodeProtobuf(b,a).readBuffer();a=d("WASI").createWasi(q({cli:n,command:e,input:a,stderr:r,stdout:s}));var g=a.getImportObject;a=a.start;var h=await f();h=await WebAssembly.instantiate(h,g());g=a(h);a=g.exitCode;h=g.fs;h=(g=h[p])==null?void 0:g.content;if(a!==0){o.ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["non-zero-exit-code: ",""])),a);return d("WAResultOrError").makeError("wasm-internal-non-zero-exit-code")}if(!(h instanceof Uint8Array)){o.ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["invalid result type"])));return d("WAResultOrError").makeError("wasm-internal-invalid-result-type")}g=d("decodeProtobuf").decodeProtobuf(c,h);return m(g)}catch(a){o.ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Unexpected runtime error: ",", for cli: ",""])),d("WAErrorMessage").maybeGetMessageFromError(a),n);return a instanceof Error?d("WAResultOrError").DEPRECATED_makeError("wasm-internal-runtime-error",a):d("WAResultOrError").makeError("wasm-internal-runtime-error")}}}g.createWasmFunction=a}),98);
__d("EBMinosWasmVerifySingleEpoch",["EBGetMinosWasm","EBMinosLogger","EBMinosWasm.pb","WACreateWasmFunction","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.getWasmModule;a=a.logger;var c=a.TAGS(["minos-verify-single-epoch"]);function e(a){a=a.valid;return d("WAResultOrError").makeResult({valid:a})}return async function(a){var f=a.epochPublicData;a=a.signature;var g=d("WACreateWasmFunction").createWasmFunction({InputSpec:d("EBMinosWasm.pb").MinosVerifySingleEpochInputSpec,ResultSpec:d("EBMinosWasm.pb").MinosVerifySingleEpochResultSpec,cli:"minos_cli",command:"minos-verify-single-epoch",getWasmModule:b,logger:c,validateResult:e});g=await g({epochPublicData:f,signature:a});return g}}b=a({getWasmModule:d("EBGetMinosWasm").getMinosWasm,logger:d("EBMinosLogger").minosLogger});g.verifySingleEpoch=b}),98);
__d("EBAPIMinosVerifySingleEpoch",["EBMinosLogger","EBMinosWasmVerifySingleEpoch","WAGetSafeQPLError"],(function(a,b,c,d,e,f,g){"use strict";var h,i;async function a(a){d("EBMinosLogger").minosLogger.DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["minosVerifySingleEpoch start"])));var b=a.qplFlow,c=a.minosEpochAnonId,e=a.minosMailboxAuthPublicKey,f=a.minosMailboxEncryptionPublicKey,g=a.minosMailboxSigningPublicKey,j=a.userId,k=a.selfEpochSignature;try{c={epochNumber:c,mailboxAuthPk:e,mailboxEncryptionPk:f,mailboxSigningPk:g,previousEpochHead:a.previousEpochHead==null?void 0:a.previousEpochHead,userFbid:j};b.addPoint("verify_single_epoch_start");e=await d("EBMinosWasmVerifySingleEpoch").verifySingleEpoch({epochPublicData:c,signature:k});b.addPoint("verify_single_epoch_end");if(e.success){b.endSuccess();return e.value.valid}d("EBMinosLogger").minosLogger.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Unable to verify epoch - WASM error ",""])),e.error);b.endFailWithError("invalid-result",e.error);return!1}catch(a){b.endFailWithError("runtime-error",d("WAGetSafeQPLError").getSafeQPLErrorMessage(a));return!1}}g.minosVerifySingleEpoch=a}),98);
__d("IEBAPI",["MAWBridge"],(function(a,b,c,d,e,f,g){"use strict";c=1;function a(a){return function(){for(var b=arguments.length,c=new Array(b),e=0;e<b;e++)c[e]=arguments[e];return d("MAWBridge").getBridge().sendAndReceive("backend","ebapi",{args:c,type:a})}}function b(a){return function(){for(var b=arguments.length,c=new Array(b),e=0;e<b;e++)c[e]=arguments[e];return d("MAWBridge").getBridge().sendAndReceive("backend","minosEBAPI",{args:c,type:a})}}g.version=c;g.makeBridgedApi=a;g.makeMinosBridgedApi=b}),98);
__d("EBMinosBridgedAPI",["IEBAPI"],(function(a,b,c,d,e,f,g){"use strict";a={writeMinosKeyChangeAdminMessage:d("IEBAPI").makeMinosBridgedApi("writeMinosKeyChangeAdminMessage"),writeMinosMailboxKeysForRecipientAPI:d("IEBAPI").makeMinosBridgedApi("writeMinosMailboxKeysForRecipientAPI"),writeMinosSecureStorageAlert:d("IEBAPI").makeMinosBridgedApi("writeMinosSecureStorageAlert")};b=a;g["default"]=b}),98);
__d("EBMinosDBDev",["MAWWormOdsLogger","QPLFlow","WALogger","WAResolvable","Worm","WormEAR","WormIDbDriver"],(function(a,b,c,d,e,f,g){"use strict";var h,i={secure_minos_mailbox_keys:{indexes:{},primaryKey:"contact_id",secure:!0},secure_minos_thread_message_encryption_keys:{indexes:{"[roster_hash+minos_thread_id]":{fields:["roster_hash","minos_thread_id"],unique:!1}},primaryKey:"mek_id_blob",secure:!0}},j=new(d("WAResolvable").Resolvable)(),k=1e4;async function a(a,b,c){var e=d("QPLFlow").startQPLFlow(b,{annotations:{string:{operationType:"initEBMinosDevDbSchema"}},timeoutInMs:k});try{var f="ebMinosDev";c=new(d("WormEAR").WormEAR)(i,f,c);a=new(d("Worm").WormDatabase)(new(d("WormIDbDriver").WormIDbDriver)(a,f,i,c,d("MAWWormOdsLogger").wormOdsWorkerLogger,{}),b);await a.init({eventFlow:e});e.endSuccess();j.resolve(a)}catch(a){j.reject(a);e.endFail("error");d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Error performing makeEBMinosDevDB: ",""])),a);throw a}}function l(){return j.promise}async function b(){var a=Object.keys(i),b=await l();return b.runInTransaction(a,"readonly",async function(b){var c={};await Promise.all(a.map(async function(a){var d=await b.stores[a].readAll();c[a]=d}));return c},"EBMinosDevDb - Dump").catch(function(){return{}})}g.schema=i;g.makeEBMinosDevDB=a;g.getEBMinosDevDb=l;g.getDbDump=b}),98);
__d("EBMinosSaveNewMailboxKey",["EBMinosDBDev"],(function(a,b,c,d,e,f,g){"use strict";a=async function(a,b,c,e,f,g){var h=await d("EBMinosDBDev").getEBMinosDevDb();await h.runInTransaction(["secure_minos_mailbox_keys"],"readwrite",function(d){return d.stores.secure_minos_mailbox_keys.bulkPut([{contact_id:a,encryption_public_key:b,epoch_anon_id:c,epoch_head:e,epoch_head_creation_time:f,public_key_fbid:g}])},"SaveNewMailboxKey")};g.saveNewMailboxKey=a}),98);
__d("EBMinosLoadMailboxKeys",["EBMinosDBDev"],(function(a,b,c,d,e,f,g){"use strict";a=async function(a){var b=await d("EBMinosDBDev").getEBMinosDevDb();b=await b.runInTransaction(["secure_minos_mailbox_keys"],"readonly",function(b){return b.stores.secure_minos_mailbox_keys.get(a)},"LoadMailboxKeys");return b};g.loadMailboxKeys=a}),98);
__d("EBMinosSecureMailboxKeysForContact",["EBMinosLoadMailboxKeys","EBMinosTypes"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return d("EBMinosLoadMailboxKeys").loadMailboxKeys(d("EBMinosTypes").unsafeCastToUserFbId(a))}g.getSecureMailboxKeysForContact=a}),98);
__d("EBMinosWriteMinosPublicKeysForRecipient",["EBMinosBridgedAPI","EBMinosLogger","EBMinosSaveNewMailboxKey","EBMinosSecureMailboxKeysForContact","WAResultOrError","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i;async function a(a){var b=a.contactId,e=a.encryptionPublicKey,f=a.epochAnonId,g=a.epochHead,k=a.epochHeadCreationTime;a=a.publicKeyFbid;var l=await d("EBMinosSecureMailboxKeysForContact").getSecureMailboxKeysForContact(b);if(g==null||k==null){(l==null?void 0:l.epoch_head)!=null&&(l==null?void 0:l.epoch_head_creation_time)!=null&&(d("EBMinosLogger").minosLogger.DEV(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Deleting mailbox keys for contact: ",""])),b),await d("EBMinosSaveNewMailboxKey").saveNewMailboxKey(b,e,f,g,k,a));return d("WAResultOrError").makeResult()}j(l,g,k)&&(d("EBMinosLogger").minosLogger.DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Writing new mailbox keys for contact: ",""])),b),await d("EBMinosSaveNewMailboxKey").saveNewMailboxKey(b,e,f,g,k,a),c("promiseDone")(c("EBMinosBridgedAPI").writeMinosSecureStorageAlert({contactId:b,epochHead:g,epochHeadCreationTime:k})),c("promiseDone")(c("EBMinosBridgedAPI").writeMinosKeyChangeAdminMessage({contactId:b,epochHeadCreationTime:k})));return d("WAResultOrError").makeResult()}function j(a,b,c){if(b==null||c==null)return!1;return(a==null?void 0:a.epoch_head)==null||(a==null?void 0:a.epoch_head_creation_time)==null?!0:a.epoch_head_creation_time!==c&&c>a.epoch_head_creation_time}g.writeMinosMailboxKeysForRecipient=a}),98);
__d("EBAPIWriteMinosPublicKeysForRecipient",["EBMinosWriteMinosPublicKeysForRecipient"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.contactId,c=a.encryptionPublicKey,e=a.epochAnonId,f=a.epochHead,g=a.epochHeadCreationTime;a=a.publicKeyFbid;return d("EBMinosWriteMinosPublicKeysForRecipient").writeMinosMailboxKeysForRecipient({contactId:b,encryptionPublicKey:c,epochAnonId:e,epochHead:f,epochHeadCreationTime:g,publicKeyFbid:a})}g.writeMinosMailboxKeysForRecipientAPI=a}),98);
__d("EncryptedBackupUploadFailureFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("5728");b=d("FalcoLoggerInternal").create("encrypted_backup_upload_failure",a);e=b;g["default"]=e}),98);/*FB_PKG_DELIM*/
__d("E2EEBackupCommon",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["ALREADY_REGISTERED","BACKUP_KEY_PAIR_SERIALIZATION_ERROR","CLIENT_PARAMS_ERROR","NETWORK_PROVIDER_ERROR","NOT_REGISTERED","VESTA_CLIENT_ERROR","VESTA_SERVER_ERROR","ISLAND_PUB_RSA_KEY_INVALID","ISLAND_PUB_ED25519_KEY_INVALID","MISSING_PIN_INPUT","GENERAL_ERROR","INVALID_PASSWORD"]);c=function(a){function b(b,c){var d;d=a.call(this,c==null?void 0:c.message)||this;d.name="BackupError";d.errorType=b;d.detailedError=c;d.message=b+((c==null?void 0:c.message)!=null?": "+(c==null?void 0:c.message):"");return d}babelHelpers.inheritsLoose(b,a);return b}(babelHelpers.wrapNativeSuper(Error));f.BackupErrorType=a;f.BackupError=c}),66);
__d("E2EEBackupUtil",["tweetnacl-util"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return c("tweetnacl-util").encodeBase64(a).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function b(a){var b=a.replace(/-/g,"+").replace(/_/g,"/");a=a.length%4;if(a>0){if(a===1)throw new Error("Invalid length, couldn't decode input string");b=b.padEnd(b.length+(4-a),"=")}return c("tweetnacl-util").decodeBase64(b)}g.encodeBase64Url=a;g.decodeBase64Url=b}),98);
__d("MWChatEncrypedBackupsNumericCodeKeyTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["NUM_PAD_WITHOUT_NUM_LOCK","NON_NUMERIC_CHAR"]);f.InvalidKeyType=a}),66);
__d("MWChatEncrypedBackupsNumericCodeValidation",[],(function(a,b,c,d,e,f){"use strict";var g=function(a){var b=/^[0-9]*$/;return b.test(a)};a=function(a,b){return a.length>b?!1:g(a)};b=function(a,b){return a.length!==b?!1:g(a)};f.numericCodeIsValid=a;f.numericCodeIsCompleted=b}),66);
__d("MWChatEncryptedBackupsNumericCodeErrorWrapper.react",["MWXColumn.react","MWXColumnItem.react","MWXText.react","react","react-compiler-runtime","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||d("react"),k={inputWrapperErrorOnly:{paddingBottom:"x18d9i69",$$css:!0},outterWrapper:{minHeight:"x10sr9ya",$$css:!0},outterWrapperSmall:{minHeight:"x1h7t28c",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(14),e=a.children,f=a.error;a=a.inputSize;a=a===void 0?"large":a;var g=a==="large"?k.outterWrapper:k.outterWrapperSmall;a=a==="large"?20:0;var i;b[0]!==f?(i=(h||(h=c("stylex"))).props(f!=null&&[k.inputWrapperErrorOnly]),b[0]=f,b[1]=i):i=b[1];var l;b[2]!==e||b[3]!==i?(l=j.jsx("div",babelHelpers["extends"]({},i,{children:e})),b[2]=e,b[3]=i,b[4]=l):l=b[4];b[5]!==f?(e=f!=null?j.jsx("div",babelHelpers["extends"]({className:"x10b6aqq x1y1aw1k x2b8uid"},{children:j.jsx(c("MWXText.react"),{color:"negative",testid:void 0,type:"body4",children:f})})):null,b[5]=f,b[6]=e):e=b[6];b[7]!==a||b[8]!==l||b[9]!==e?(i=j.jsxs(c("MWXColumnItem.react"),{align:"center",paddingHorizontal:a,paddingTop:0,children:[l,e]}),b[7]=a,b[8]=l,b[9]=e,b[10]=i):i=b[10];b[11]!==g||b[12]!==i?(f=j.jsx(c("MWXColumn.react"),{xstyle:g,children:i}),b[11]=g,b[12]=i,b[13]=f):f=b[13];return f}g["default"]=a}),98);
__d("useMWChatEncryptedBackupsNumericCodeInputAutoFocus",["FocusRegion.react","HiddenSubtreePassiveContext","focusScopeQueries","gkx","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");var i=b.useContext,j=b.useEffect;function k(a){if(!("elementsFromPoint"in document))return!0;var b=a.getBoundingClientRect();b=document.elementsFromPoint(b.left+b.width/2,b.top+b.height/2);for(b of b){if(b===a)return!1;var c=window.getComputedStyle(b);if(c.visibility!=="hidden"&&c.display!=="none")return!0}return!1}function l(a){var b=d("react-compiler-runtime").c(3),c,e;b[0]!==a?(c=function(){var b=function(b){b.key>="0"&&b.key<="9"&&a(b.key)};window.addEventListener("keydown",b);return function(){window.removeEventListener("keydown",b)}},e=[a],b[0]=a,b[1]=c,b[2]=e):(c=b[1],e=b[2]);j(c,e)}function a(a,b,e){var f=d("react-compiler-runtime").c(5),g=i(c("HiddenSubtreePassiveContext")),h;f[0]!==b||f[1]!==a||f[2]!==g||f[3]!==e?(h=function(){var f=g.getCurrentState(),h=["input","textarea"].some(m);!a&&!h&&!f.hiddenOrBackgrounded&&!(e.current?k(e.current):!0)&&(c("gkx")("15923")&&d("FocusRegion.react").focusRegionById(b,d("focusScopeQueries").tabbableScopeQuery))},f[0]=b,f[1]=a,f[2]=g,f[3]=e,f[4]=h):h=f[4];l(h)}function m(a){var b;return(b=document.activeElement)==null?void 0:b.matches(a)}g["default"]=a}),98);
__d("MWChatEncryptedBackupsNumericCodeInputInner.react",["BaseTextInput.react","FocusRegion.react","MWChatEncrypedBackupsNumericCodeKeyTypes","MWChatEncrypedBackupsNumericCodeValidation","focusScopeQueries","gkx","qex","react","react-compiler-runtime","useMWChatEncryptedBackupsNumericCodeInputAutoFocus"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;b.useCallback;var j=b.useEffect,k=b.useRef,l=b.useState,m=c("gkx")("24058"),n=function(a){return["0","1","2","3","4","5","6","7","8","9"].includes(a.key)},o=new Map([["Numpad0","0"],["Numpad1","1"],["Numpad2","2"],["Numpad3","3"],["Numpad4","4"],["Numpad5","5"],["Numpad6","6"],["Numpad7","7"],["Numpad8","8"],["Numpad9","9"]]),p=function(a){return a.location===3&&!n(a)&&!a.shiftKey&&!a.ctrlKey&&!a.altKey&&!a.metaKey?o.get((a=a.nativeEvent)==null?void 0:a.code):null},q={input:{height:"x5yr21d",insetInlineStart:"x1o0tod",left:null,right:null,opacity:"xg01cxk",position:"x10l6tqk",top:"x13vifvy",width:"xh8yej3",$$css:!0},testOpacity:{opacity:"x1ptxcow",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(44),e=a.extraProps;a=a.props;var f=e.hasFocus,g=e.setFocus;e=a["aria-label"];var h=a.disabled,n=a.focusRegionId,o=a.inputMode,s=a.onChange,t=a.onCompletionChange,u=a.onEnabledNumLock,v=a.onPressedInvalidKey,w=a.size,x=a.testid,y=a.value,z=h===void 0?!1:h;a=l(y.length===w);var A=a[0],B=a[1],C=k(null),D=k(z);c("useMWChatEncryptedBackupsNumericCodeInputAutoFocus")(f,n,C);b[0]!==A||b[1]!==s||b[2]!==t||b[3]!==w?(h=function(a){var b=d("MWChatEncrypedBackupsNumericCodeValidation").numericCodeIsCompleted(a,w);s(a);t!=null&&b!==A&&(B(b),t(b))},b[0]=A,b[1]=s,b[2]=t,b[3]=w,b[4]=h):h=b[4];var E=h;b[5]===Symbol["for"]("react.memo_cache_sentinel")?(a=function(){var a=r,b=C.current;b==null||b.addEventListener("selectstart",a);return function(){b==null||b.removeEventListener("selectstart",a)}},f=[],b[5]=a,b[6]=f):(a=b[5],f=b[6]);j(a,f);b[7]!==z||b[8]!==g?(h=function(){z&&g(!1)},a=[z,g],b[7]=z,b[8]=g,b[9]=h,b[10]=a):(h=b[9],a=b[10]);j(h,a);b[11]===Symbol["for"]("react.memo_cache_sentinel")?(f=function(){var a=C.current;if(a==null)return;var b=function(){var b=a.value.length,c=a.selectionStart===a.selectionEnd&&a.selectionStart===b;c||a.setSelectionRange(b,b)};a.addEventListener("selectionchange",b);return function(){a.removeEventListener("selectionchange",b)}},h=[],b[11]=h,b[12]=f):(h=b[11],f=b[12]);j(f,h);b[13]!==z||b[14]!==n?(a=function(){D.current!==z&&(D.current=z,z||d("FocusRegion.react").focusRegionById(n,d("focusScopeQueries").tabbableScopeQuery))},f=[z,n],b[13]=z,b[14]=n,b[15]=a,b[16]=f):(a=b[15],f=b[16]);j(a,f);b[17]!==u||b[18]!==v||b[19]!==y||b[20]!==E?(h=function(a){var b=p(a);if(b!=null){v==null||v(d("MWChatEncrypedBackupsNumericCodeKeyTypes").InvalidKeyType.NUM_PAD_WITHOUT_NUM_LOCK);if(c("qex")._("4752")===!0){b=y+b;E(b);a.preventDefault();a.stopPropagation()}}else a.key==="NumLock"&&(a.getModifierState==null?void 0:a.getModifierState("NumLock"))===!0&&(u==null||u())},b[17]=u,b[18]=v,b[19]=y,b[20]=E,b[21]=h):h=b[21];var F=h;a=x!=null?x+"-mw-numeric-code-input-prevent-composer-focus-steal":"mw-numeric-code-input-prevent-composer-focus-steal";b[22]!==g?(f=function(){g(!1)},h=function(){g(!0)},b[22]=g,b[23]=f,b[24]=h):(f=b[23],h=b[24]);var G;b[25]!==F?(G=function(a){var b=a.keyCode;(b===35||b===36||b===37||b===38||b===39||b===40)&&(a.preventDefault(),a.stopPropagation());F==null||F(a)},b[25]=F,b[26]=G):G=b[26];var H;b[27]!==v||b[28]!==w||b[29]!==E?(H=function(a){a=a.toString();d("MWChatEncrypedBackupsNumericCodeValidation").numericCodeIsValid(a,w)?E(a):v==null||v(d("MWChatEncrypedBackupsNumericCodeKeyTypes").InvalidKeyType.NON_NUMERIC_CHAR)},b[27]=v,b[28]=w,b[29]=E,b[30]=H):H=b[30];var I;b[31]===Symbol["for"]("react.memo_cache_sentinel")?(I=[q.input,m&&q.testOpacity],b[31]=I):I=b[31];b[32]!==e||b[33]!==z||b[34]!==o||b[35]!==w||b[36]!==a||b[37]!==f||b[38]!==h||b[39]!==G||b[40]!==H||b[41]!==x||b[42]!==y?(I=i.jsx(c("BaseTextInput.react"),{"aria-label":e,autoComplete:"one-time-code",disabled:z,id:a,inputMode:o,maxLength:w,onBlur:f,onFocus:h,onKeyDown:G,onValueChange:H,ref:C,testid:void 0,value:y,xstyle:I}),b[32]=e,b[33]=z,b[34]=o,b[35]=w,b[36]=a,b[37]=f,b[38]=h,b[39]=G,b[40]=H,b[41]=x,b[42]=y,b[43]=I):I=b[43];return I}function r(a){a.preventDefault()}g["default"]=a}),98);
__d("MWChatEncryptedBackupsNumericCodeInputRenderer.react",["MWXRow.react","MWXRowItem.react","MWXText.react","gkx","react","react-compiler-runtime","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||(i=d("react"));b=i;var k=b.useEffect,l=b.useState,m={focusRing:{boxShadow:"x18bame2",outline:"x1a2a7pz xvetz19",$$css:!0},input:{alignItems:"x6s0dn4",borderStartStartRadius:"x1i5p2am",borderStartEndRadius:"x1whfx0g",borderEndEndRadius:"xr2y4jy",borderEndStartRadius:"x1ihp6rs",borderTopStyle:"x1ejq31n",borderInlineEndStyle:"x18oe1m7",borderBottomStyle:"x1sy0etr",borderInlineStartStyle:"xstzfhl",boxSizing:"x9f619",display:"x78zum5",height:"xng8ra",justifyContent:"xl56j7k",position:"x1n2onr6",width:"x1o817pb",$$css:!0},inputBox:{marginTop:"x1k70j0n",marginInlineEnd:"xbelrpt",marginBottom:"xzueoph",marginInlineStart:"xdzw4kq",$$css:!0},inputColorPrimary:{backgroundColor:"xljulmy",$$css:!0},inputColorSecondary:{backgroundColor:"xwcfey6",$$css:!0},inputSmall:{height:"xaymia4",width:"x1bgwkul",$$css:!0},inputTiny:{height:"x1vqgdyp",width:"x10faclu",$$css:!0}},n="-",o="\u25cf";function p(a,b){if(b)return"disabled";return!c("gkx")("7485")?"primary":a===n?"secondary":"primary"}function a(a){var b=d("react-compiler-runtime").c(28),e=a.color,f=a.disabled,g=a.enableMasking,i=a.hasFocus,q=a.inputSize,r=a.size,s=a.testid,t=a.value,u=e===void 0?"primary":e,v=f===void 0?!1:f,w=g===void 0?!1:g,x=q===void 0?"large":q;a=s===void 0?"numeric-renderer":s;b[0]!==i||b[1]!==r||b[2]!==t?(e=function(a){return(t.length===a||t.length>a&&a===r-1)&&i},b[0]=i,b[1]=r,b[2]=t,b[3]=e):e=b[3];var y=e;b[4]!==r?(f=Array(r).fill(c("gkx")("7485")?n:""),b[4]=r,b[5]=f):f=b[5];g=l(f);q=g[0];var z=g[1];b[6]!==w||b[7]!==r||b[8]!==t?(s=function(){z(Array(r).fill().map(function(a,b){return t[b]!=null?w?o:t[b]:c("gkx")("7485")?n:""}))},e=[w,r,t],b[6]=w,b[7]=r,b[8]=t,b[9]=s,b[10]=e):(s=b[9],e=b[10]);k(s,e);if(b[11]!==u||b[12]!==v||b[13]!==w||b[14]!==x||b[15]!==y||b[16]!==a||b[17]!==q){b[19]!==u||b[20]!==v||b[21]!==w||b[22]!==x||b[23]!==y||b[24]!==a?(f=function(a,b){return j.jsx(c("MWXRowItem.react"),{xstyle:m.inputBox,children:j.jsx("div",babelHelpers["extends"]({},(h||(h=c("stylex"))).props(m.input,x==="small"&&m.inputSmall,x==="tiny"&&m.inputTiny,u==="primary"&&m.inputColorPrimary,u==="secondary"&&m.inputColorSecondary,y(b)&&m.focusRing),{"aria-hidden":a===n&&c("gkx")("7485"),"data-testid":void 0,children:w?j.jsx(c("MWXText.react"),{color:p(a,v),type:c("gkx")("7485")&&a===n?"entityHeaderHeadline1":"headlineEmphasized4",children:v?o:a}):j.jsx(c("MWXText.react"),{color:p(a,v),type:c("gkx")("7485")&&a===n?"entityHeaderHeadline1":"headlineEmphasized1",children:a})}))},b)},b[19]=u,b[20]=v,b[21]=w,b[22]=x,b[23]=y,b[24]=a,b[25]=f):f=b[25];g=q.map(f);b[11]=u;b[12]=v;b[13]=w;b[14]=x;b[15]=y;b[16]=a;b[17]=q;b[18]=g}else g=b[18];b[26]!==g?(s=j.jsx(c("MWXRow.react"),{align:"center",paddingHorizontal:0,paddingVertical:0,role:"group",spacing:0,children:g}),b[26]=g,b[27]=s):s=b[27];return s}g.MWChatEncryptedBackupsNumericCodeInputRenderer=a}),98);
__d("MWChatEncryptedBackupsNumericCodeInput.react",["MWChatEncryptedBackupsNumericCodeInputInner.react","MWChatEncryptedBackupsNumericCodeInputRenderer.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useState;function a(a){var b=d("react-compiler-runtime").c(18),e=a.enableMasking,f=a.inputSize,g=a.size,h=a.testid,k=a.value,l=j(!1),m=l[0];l=l[1];var n;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(n={className:"x1n2onr6"},b[0]=n):n=b[0];var o;b[1]!==e||b[2]!==m||b[3]!==a.color||b[4]!==a.disabled||b[5]!==f||b[6]!==g||b[7]!==h||b[8]!==k?(o=i.jsx(d("MWChatEncryptedBackupsNumericCodeInputRenderer.react").MWChatEncryptedBackupsNumericCodeInputRenderer,{color:a.color,disabled:a.disabled,enableMasking:e,hasFocus:m,inputSize:f,size:g,testid:void 0,value:k}),b[1]=e,b[2]=m,b[3]=a.color,b[4]=a.disabled,b[5]=f,b[6]=g,b[7]=h,b[8]=k,b[9]=o):o=b[9];b[10]!==m?(e={hasFocus:m,setFocus:l},b[10]=m,b[11]=e):e=b[11];b[12]!==a||b[13]!==e?(f=i.jsx(c("MWChatEncryptedBackupsNumericCodeInputInner.react"),{extraProps:e,props:a}),b[12]=a,b[13]=e,b[14]=f):f=b[14];b[15]!==o||b[16]!==f?(g=i.jsxs("div",babelHelpers["extends"]({},n,{children:[o,f]})),b[15]=o,b[16]=f,b[17]=g):g=b[17];return g}g["default"]=a}),98);
__d("MWChatEncryptedBackupsUpsellJewelChatTabLayout.react",["CometScrollView.react","MWXColumnItem.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b,e=d("react-compiler-runtime").c(18),f=a.bottomItem,g=a.children,h=a.ref,j=a.size;a=a.topItem;b=(b=a==null?void 0:a.align)!=null?b:"start";j=j==="small"?8:16;var k;e[0]===Symbol["for"]("react.memo_cache_sentinel")?(k={className:"x21xpn4"},e[0]=k):k=e[0];a=a==null?void 0:a.item;e[1]!==a?(k=i.jsx("div",babelHelpers["extends"]({},k,{children:a})),e[1]=a,e[2]=k):k=e[2];e[3]!==b||e[4]!==j||e[5]!==k?(a=i.jsx(c("MWXColumnItem.react"),{align:b,paddingHorizontal:16,paddingTop:j,children:k}),e[3]=b,e[4]=j,e[5]=k,e[6]=a):a=e[6];e[7]===Symbol["for"]("react.memo_cache_sentinel")?(b={className:"x6s0dn4 x78zum5 x1iyjqo2"},e[7]=b):b=e[7];e[8]!==g||e[9]!==h?(j=i.jsx("div",babelHelpers["extends"]({},b,{ref:h,children:g})),e[8]=g,e[9]=h,e[10]=j):j=e[10];e[11]===Symbol["for"]("react.memo_cache_sentinel")?(k={className:"xisnujt"},e[11]=k):k=e[11];e[12]!==f?(b=i.jsx(c("MWXColumnItem.react"),{paddingHorizontal:16,paddingVertical:12,children:i.jsx("div",babelHelpers["extends"]({},k,{children:f}))}),e[12]=f,e[13]=b):b=e[13];e[14]!==b||e[15]!==a||e[16]!==j?(g=i.jsxs(c("CometScrollView.react"),{children:[a,j,b]}),e[14]=b,e[15]=a,e[16]=j,e[17]=g):g=e[17];return g}b=a;e=b;g["default"]=e}),98);
__d("MWEBConnections4AndroidIcon.react",["ix","CometImageFromIXValue.react","gkx","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react"),k=c("gkx")("23433");function a(a){var b=d("react-compiler-runtime").c(7),e=a.alt,f=a.ref,g=a.size;a=a.xstyle;g=g===void 0?"large":g;var i;b[0]!==g?(i=g==="large"?k?h("398892"):h("398891"):h("398080"),b[0]=g,b[1]=i):i=b[1];g=i;b[2]!==e||b[3]!==f||b[4]!==g||b[5]!==a?(i=j.jsx(c("CometImageFromIXValue.react"),{alt:e,ref:f,source:g,xstyle:a}),b[2]=e,b[3]=f,b[4]=g,b[5]=a,b[6]=i):i=b[6];return i}g["default"]=a}),98);
__d("MWEBFlowSourceContext",["react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h||d("react");b=a.createContext({source:null});g["default"]=b}),98);
__d("MWEBFlowSourceContextProvider.react",["MWEBFlowSourceContext","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useMemo;function a(a){var b=d("react-compiler-runtime").c(5),e=a.children;a=a.source;var f;b[0]!==a?(f={source:a},b[0]=a,b[1]=f):f=b[1];a=f;f=a;b[2]!==e||b[3]!==f?(a=i.jsx(c("MWEBFlowSourceContext").Provider,{value:f,children:e}),b[2]=e,b[3]=f,b[4]=a):a=b[4];return a}g["default"]=a}),98);
__d("VestaClientBootstrap",["FBLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i=new Array(32).fill(void 0);i.push(void 0,null,!0,!1);function j(a,b){return a[b]}var k=i.length;function l(a){if(a<36)return;i[a]=k;k=a}function m(a){var b=j(i,a);l(a);return b}function n(a){k===i.length&&i.push(i.length+1);var b=k;k=j(i,b);i[b]=a;return b}function o(a){return a}var p=new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});p.decode();var q=null;function r(){var a=o(h.memory);(q===null||q.buffer!==a.buffer)&&(q=new Uint8Array(a.buffer));return q}function s(a,b){return p.decode(r().subarray(a,a+b))}function t(a,b){try{return a.apply(void 0,b)}catch(b){a=o(h.__wbindgen_exn_store);a(n(b))}}function u(a,b){return r().subarray(a/1,a/1+b)}async function v(a,b){if(typeof WebAssembly.instantiateStreaming==="function")return WebAssembly.instantiateStreaming(a,b);a=await a.arrayBuffer();return WebAssembly.instantiate(a,b)}async function w(b){var d=arguments,e={wbg:{__wbg_buffer_de1150f91b23aa89:function(a){return n(j(i,a).buffer)},__wbg_call_4573f605ca4b5f10:function(){return t(function(a,b){a=j(i,a).call(j(i,b));return n(a)},d)},__wbg_crypto_98fc271021c7d2ad:function(a){return n(j(i,a).crypto)},__wbg_getRandomValues_98117e9a7e993920:function(){return t(function(a,b){j(i,a).getRandomValues(j(i,b))},arguments)},__wbg_global_8c35aeee4ac77f2b:function(){return t(function(){var b=a.global;return n(b)},d)},__wbg_globalThis_56d9c9f814daeeee:function(){return t(function(){return n(window)},d)},__wbg_length_e09c0b925ab8de5d:function(a){return j(i,a).length},__wbg_modulerequire_3440a4bcf44437db:function(){return t(function(a,b){a=f.require(s(a,b));return n(a)},d)},__wbg_msCrypto_a2cdb043d2bfe57f:function(a){return n(j(i,a).msCrypto)},__wbg_new_97cf52648830a70d:function(a){return n(new Uint8Array(j(i,a)))},__wbg_newnoargs_fc5356289219b93b:function(a,b){a=new Function(s(a,b));return n(a)},__wbg_newwithlength_e833b89f9db02732:function(a){return n(new Uint8Array(a>>>0))},__wbg_node_4b517d861cbcb3bc:function(a){return n(j(i,a).node)},__wbg_process_2f24d6544ea7b200:function(a){return n(j(i,a).process)},__wbg_randomFillSync_64cc7d048f228ca8:function(){return t(function(a,b,c){j(i,a).randomFillSync(u(b,c))},d)},__wbg_self_ba1ddafe9ea7a3a2:function(){return t(function(){var a=self.self;return n(a)},d)},__wbg_set_a0172b213e2469e9:function(a,b,c){return j(i,a).set(j(i,b),c>>>0)},__wbg_subarray_9482ae5cd5cd99d3:function(a,b,c){return n(j(i,a).subarray(b>>>0,c>>>0))},__wbg_versions_6164651e75405d4a:function(a){return n(j(i,a).versions)},__wbg_window_be3cc430364fd32c:function(){return t(function(){var a=window.window;return n(a)},d)},__wbindgen_is_object:function(a){return typeof j(i,a)==="object"&&j(i,a)!==null},__wbindgen_is_string:function(a){return typeof j(i,a)==="string"},__wbindgen_is_undefined:function(a){return j(i,a)===void 0},__wbindgen_memory:function(){return n(h.memory)},__wbindgen_object_clone_ref:function(a){return n(j(i,a))},__wbindgen_object_drop_ref:m,__wbindgen_throw:function(a,b){throw c("FBLogger")("wasm_vesta_client").mustfixThrow(s(a,b))}}},g=await window.fetch(b),k=await v(await g,e),l=k.instance;h=l.exports;w.__wbindgen_wasm_module=f;return l}g.default=w}),98);
__d("VestaClient",["$InternalEnum","VestaClientBootstrap","bx","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("mapVestaClientError").__setRef("VestaClient"),i=4096,j,k,l=function(a){return new Promise(function(b){h.onReady(function(c){b(c(a))})})};async function m(){var a=await c("VestaClientBootstrap")(c("bx").getURL(c("bx")("604")));j=a.exports;k=n(j.memory)}function n(a){return a}async function a(a,b){(j===void 0||k===void 0)&&await m();var c=0,d=new Uint8Array(k.buffer,c,a.byteLength);d.set(a);c+=d.byteLength;a=new Uint8Array(k.buffer,c,b.byteLength);a.set(b);c+=a.byteLength;b=new Uint8Array(k.buffer,c,i);var e=n(j.vesta_client_validate_hsm_key);e=e(d.byteOffset,d.byteLength,a.byteOffset,a.byteLength,b.byteOffset,b.byteLength);if(e!==0)throw await l(e);d=new DataView(k.buffer,c,i);a=r(d);return a[0][0]!==0}async function d(a){(j===void 0||k===void 0)&&await m();var b=0,c=new Uint8Array(k.buffer,b,a.byteLength);c.set(a);b+=c.byteLength;a=new Uint8Array(k.buffer,b,i);var d=n(j.vesta_client_begin_register);d=d(c.byteOffset,c.byteLength,a.byteOffset,a.byteLength);if(d!==0)throw await l(d);c=new DataView(k.buffer,b,i);a=r(c);return{clientState:new Uint8Array(a[1]),r1Message:new Uint8Array(a[0])}}var o=b("$InternalEnum").Mirrored(["WaBackupKeyData","Raw"]);async function e(a,b,c,d,e,f,g,h,p,q){p===void 0&&(p=0);q===void 0&&(q=o.WaBackupKeyData);(j===void 0||k===void 0)&&await m();var s=0,t=new Uint8Array(k.buffer,s,a.byteLength);t.set(a);s+=a.byteLength;a=new Uint8Array(k.buffer,s,b.byteLength);a.set(b);s+=b.byteLength;b=new Uint8Array(k.buffer,s,c.byteLength);b.set(c);s+=c.byteLength;c=new Uint8Array(k.buffer,s,d.byteLength);c.set(d);s+=d.byteLength;d=new Uint8Array(k.buffer,s,e.byteLength);d.set(e);s+=e.byteLength;e=new Uint8Array(k.buffer,s,f.byteLength);e.set(f);s+=f.byteLength;f=new Uint8Array(k.buffer,s,g.byteLength);f.set(g);s+=g.byteLength;g=new Uint8Array(k.buffer,s,h.byteLength);g.set(h);s+=h.byteLength;h=new Uint8Array(k.buffer,s,i);if(q===o.Raw){q=n(j.vesta_client_finish_register);q=q(t.byteOffset,t.byteLength,a.byteOffset,a.byteLength,b.byteOffset,b.byteLength,c.byteOffset,c.byteLength,d.byteOffset,d.byteLength,e.byteOffset,e.byteLength,f.byteOffset,f.byteLength,g.byteOffset,g.byteLength,p,h.byteOffset,h.byteLength)}else{var u=n(j.vesta_client_finish_register_proto);q=u(t.byteOffset,t.byteLength,a.byteOffset,a.byteLength,b.byteOffset,b.byteLength,c.byteOffset,c.byteLength,d.byteOffset,d.byteLength,e.byteOffset,e.byteLength,f.byteOffset,f.byteLength,g.byteOffset,g.byteLength,p,h.byteOffset,h.byteLength)}if(q!==0)throw await l(q);u=new DataView(k.buffer,s,i);t=r(u);return{registerIdentifier:new Uint8Array(t[1]),registerPayload:new Uint8Array(t[0])}}async function f(a){(j===void 0||k===void 0)&&await m();var b=0,c=new Uint8Array(k.buffer,b,a.byteLength);c.set(a);b+=c.byteLength;a=new Uint8Array(k.buffer,b,i);var d=n(j.vesta_client_begin_login);d=d(c.byteOffset,c.byteLength,a.byteOffset,a.byteLength);if(d!==0)throw await l(d);c=new DataView(k.buffer,b,i);a=r(c);return{clientState:new Uint8Array(a[1]),l1Message:new Uint8Array(a[0])}}async function p(a,b,c,d){(j===void 0||k===void 0)&&await m();var e=0,f=new Uint8Array(k.buffer,e,a.byteLength);f.set(a);e+=a.byteLength;a=new Uint8Array(k.buffer,e,b.byteLength);a.set(b);e+=b.byteLength;b=new Uint8Array(k.buffer,e,c.byteLength);b.set(c);e+=c.byteLength;c=new Uint8Array(k.buffer,e,d.byteLength);c.set(d);e+=d.byteLength;d=new Uint8Array(k.buffer,e,i);var g=n(j.vesta_client_finish_login);g=g(f.byteOffset,f.byteLength,a.byteOffset,a.byteLength,b.byteOffset,b.byteLength,c.byteOffset,c.byteLength,d.byteOffset,d.byteLength);if(g!==0)throw await l(g);f=new DataView(k.buffer,e,i);a=r(f);return{exportKey:new Uint8Array(a[2]),l3Message:new Uint8Array(a[0]),sessionKey:new Uint8Array(a[1])}}async function q(a,b,c,d){d===void 0&&(d=o.WaBackupKeyData);(j===void 0||k===void 0)&&await m();var e=0,f=new Uint8Array(k.buffer,e,a.byteLength);f.set(a);e+=a.byteLength;a=new Uint8Array(k.buffer,e,b.byteLength);a.set(b);e+=b.byteLength;b=new Uint8Array(k.buffer,e,c.byteLength);b.set(c);e+=c.byteLength;c=new Uint8Array(k.buffer,e,i);if(d===o.Raw){d=n(j.vesta_client_unpack_login_payload);d=d(f.byteOffset,f.byteLength,a.byteOffset,a.byteLength,b.byteOffset,b.byteLength,c.byteOffset,c.byteLength)}else{var g=n(j.vesta_client_unpack_login_payload_proto);d=g(f.byteOffset,f.byteLength,a.byteOffset,a.byteLength,b.byteOffset,b.byteLength,c.byteOffset,c.byteLength)}if(d!==0)throw await l(d);g=new DataView(k.buffer,e,i);f=r(g);return{userSecret:new Uint8Array(f[0])}}function r(a){var b=[],c=0,d=a.getUint8(c++);for(var e=0;e<d;e++){var f=a.getUint32(c);c+=4;b[e]=[];for(var g=0;g<f;g++)b[e].push(a.getUint8(c++))}return b}g.validateHsmKey=a;g.beginRegister=d;g.SerializationMode=o;g.finishRegister=e;g.beginLogin=f;g.finishLogin=p;g.unpackLoginPayload=q}),98);
__d("VestaClientError",[],(function(a,b,c,d,e,f){"use strict";a=function(a){function b(b){var c;c=a.call(this,b)||this;c.message=b;return c}babelHelpers.inheritsLoose(b,a);return b}(babelHelpers.wrapNativeSuper(Error));f["default"]=a}),66);
__d("getMWChatEncryptedBackupsPinCodeInvalidKeyPressedError",["fbt","MWChatEncrypedBackupsNumericCodeKeyTypes"],(function(a,b,c,d,e,f,g,h){"use strict";function a(a,b){if(a===d("MWChatEncrypedBackupsNumericCodeKeyTypes").InvalidKeyType.NON_NUMERIC_CHAR)return b==="pin"?h._(/*BTDS*/"Your PIN can only contain numbers"):null;else if(a===d("MWChatEncrypedBackupsNumericCodeKeyTypes").InvalidKeyType.NUM_PAD_WITHOUT_NUM_LOCK)return h._(/*BTDS*/"Press Num Lock to use the numeric keypad")}g["default"]=a}),226);
__d("mapVestaClientError",["VestaClientError"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a){case 1:return new h();case 2:return new i();case 3:return new j();case 4:return new k();case 5:return new l();case 6:return new m();case 7:return new n();case 8:return new o();case 9:return new p();case 10:return new q();case 11:return new r();case 12:return new s();default:return new t()}}var h=function(b){function a(a){a===void 0&&(a="Buffer supplied to WASM for response is too small");a=b.call(this,a)||this;a.name="InsufficientResultBuffer";return a}babelHelpers.inheritsLoose(a,b);return a}(b=c("VestaClientError")),i=function(b){function a(a){a===void 0&&(a="Incorrect user password supplied during login");a=b.call(this,a)||this;a.name="InvalidUserPassword";return a}babelHelpers.inheritsLoose(a,b);return a}(b),j=function(b){function a(a){a===void 0&&(a="Invalid input from server");a=b.call(this,a)||this;a.name="MalformedServerResponse";return a}babelHelpers.inheritsLoose(a,b);return a}(b),k=function(b){function a(a){a===void 0&&(a="Invalid input from client");a=b.call(this,a)||this;a.name="MalformedClientInput";return a}babelHelpers.inheritsLoose(a,b);return a}(b),l=function(b){function a(a){a===void 0&&(a="Error during encryption operation");a=b.call(this,a)||this;a.name="EncryptionFailure";return a}babelHelpers.inheritsLoose(a,b);return a}(b),m=function(b){function a(a){a===void 0&&(a="Error during decryption operation");a=b.call(this,a)||this;a.name="DecryptionFailure";return a}babelHelpers.inheritsLoose(a,b);return a}(b),n=function(b){function a(a){a===void 0&&(a="Error during serialization operation.");a=b.call(this,a)||this;a.name="SerializationFailure";return a}babelHelpers.inheritsLoose(a,b);return a}(b),o=function(b){function a(a){a===void 0&&(a="Error deserializing inputs, likely due to malformed input");a=b.call(this,a)||this;a.name="DeserializationFailure";return a}babelHelpers.inheritsLoose(a,b);return a}(b),p=function(b){function a(a){a===void 0&&(a="Passed RSA public key is in an invalid format.");a=b.call(this,a)||this;a.name="RsaInvalidKey";return a}babelHelpers.inheritsLoose(a,b);return a}(b),q=function(b){function a(a){a===void 0&&(a="Unable to verify RSA signature");a=b.call(this,a)||this;a.name="RsaVerificationFailure";return a}babelHelpers.inheritsLoose(a,b);return a}(b),r=function(b){function a(a){a===void 0&&(a="Passed Ed25519 public key is in an invalid format.");a=b.call(this,a)||this;a.name="Ed25519InvalidKey";return a}babelHelpers.inheritsLoose(a,b);return a}(b),s=function(b){function a(a){a===void 0&&(a="Unable to verify Ed25519 signature");a=b.call(this,a)||this;a.name="Ed25519VerificationFailure";return a}babelHelpers.inheritsLoose(a,b);return a}(b),t=function(b){function a(a){a===void 0&&(a="Unknown error code received from WASM binary");a=b.call(this,a)||this;a.name="UnknownErrorCode";return a}babelHelpers.inheritsLoose(a,b);return a}(b);g["default"]=a}),98);
__d("useEncryptedBackupsQplImpressionRef",["QPLUserFlow","react-compiler-runtime","useVisibilityObserver"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e,f){var g=d("react-compiler-runtime").c(5),h;g[0]!==f||g[1]!==a||g[2]!==e||g[3]!==b?(h={onVisible:function(){c("QPLUserFlow").addPoint(a,b,{instanceKey:e}),f==null||f()}},g[0]=f,g[1]=a,g[2]=e,g[3]=b,g[4]=h):h=g[4];return c("useVisibilityObserver")(h)}g["default"]=a}),98);
__d("useMWChatEncryptedBackupsNumericCode",["fbt","FocusRegion.react","MWChatEncrypedBackupsNumericCodeKeyTypes","MWChatEncrypedBackupsNumericCodeValidation","MWLogInteraction","focusScopeQueries","getMWChatEncryptedBackupsPinCodeInvalidKeyPressedError","promiseDone","qex","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i;i||(i=d("react"));var j=i.useState,k={confirmPin:h._(/*BTDS*/"Confirm your PIN"),otc:h._(/*BTDS*/"One-time code"),pin:h._(/*BTDS*/"PIN")};function a(a){var b=a.checkPreviouslyInsertedCode,e=a.clearInputOnComplete,f=e===void 0?!1:e;e=a.enableMasking;var g=a.focusRegionId,h=a.inputSize,i=a.onChange,l=a.onComplete;a=a.type;var m=j(!1),n=m[0],o=m[1];m=j(!0);var p=m[0],q=m[1];m=j("");var r=m[0],s=m[1];m=j(null);var t=m[0],u=m[1];m=function(a){u(null),q(!a)};var v=async function(a){if(d("MWChatEncrypedBackupsNumericCodeValidation").numericCodeIsCompleted(a,h)){d("MWLogInteraction").logPopoverOpenCancel("initiate_restore");if(b!=null){var c=b.onCodeMismatch,e=b.previouslyInsertedCode;e=e===a;if(!e){c();return}}q(!0);o(!0);try{await l(a),f&&s("")}catch(a){s("")}finally{o(!1)}}},w=b!=null&&a==="pin"?"confirmPin":a;return[{"aria-label":k[w],disabled:n,enableMasking:e,focusRegionId:g,onChange:function(a){var b=function(){d("MWChatEncrypedBackupsNumericCodeValidation").numericCodeIsValid(a,h)&&(s(a),u(null),i==null||i(a),c("promiseDone")(v(a)))};b()},onCompletionChange:m,onEnabledNumLock:function(){t===d("MWChatEncrypedBackupsNumericCodeKeyTypes").InvalidKeyType.NUM_PAD_WITHOUT_NUM_LOCK&&u(null)},onPressedInvalidKey:function(a){(a===d("MWChatEncrypedBackupsNumericCodeKeyTypes").InvalidKeyType.NON_NUMERIC_CHAR||a===d("MWChatEncrypedBackupsNumericCodeKeyTypes").InvalidKeyType.NUM_PAD_WITHOUT_NUM_LOCK&&c("qex")._("4752")!==!0)&&u(a)},size:h,value:r},{clearNumericInput:function(){return s("")},disabled:p,focusOnInput:function(){d("FocusRegion.react").focusRegionById(g,d("focusScopeQueries").tabbableScopeQuery)},invalidKeyPressedError:c("getMWChatEncryptedBackupsPinCodeInvalidKeyPressedError")(t,a),isLoading:n,onPress:function(){c("promiseDone")(v(r))}}]}g.useMWChatEncryptedBackupsNumericCode=a}),226);
__d("useMWEBFlowSourceContext",["FBLogger","MWChatEncryptedBackupsQPLSource.enum","MWEBFlowSourceContext","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");b.useCallback;var i=b.useContext;function a(){var a=d("react-compiler-runtime").c(2),b=i(c("MWEBFlowSourceContext")),e=b.source;a[0]!==e?(b=function(){if(e==null){c("FBLogger")("labyrinth_web").mustfix("[labyrinth][web] source is null. Did you wrap your flow with MWEBFlowSourceContextProvider?");return c("MWChatEncryptedBackupsQPLSource.enum").UNKNOWN}return e},a[0]=e,a[1]=b):b=a[1];return b}g["default"]=a}),98);/*FB_PKG_DELIM*/
__d("CastingStateHooks",["CastingContext","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useContext;function a(){var a=i(d("CastingContext").CastingStateContext);return(a==null?void 0:a.receiverIsConnected)||!1}function j(){var a=t();return a==null?null:a.currentVideoID}function b(){var a=j();return a!=null}function c(){var a=t();return a==null?0:a.currentPosition||0}function e(){var a=t();return a==null?0:a.currentDuration||0}function f(){var a=t();if(a==null)return!1;a=a.currentPlaybackState;return a==="play"||a==="seeking"}function k(){var a=t();if(a==null)return!1;a=a.currentPlaybackState;return a==="paused"}function l(){var a=t();if(a==null)return!1;a=a.currentPlaybackState;return a==="ended"}function m(){var a=i(d("CastingContext").CastingStateContext);return a==null||!a.receiverIsConnected?!1:a.receiverIsMuted===!0}function n(){var a=i(d("CastingContext").CastingStateContext);return a==null||!a.receiverIsConnected?0:a.receiverVolume||0}function o(){var a=i(d("CastingContext").CastingStateContext);return a==null||!a.receiverIsConnected?null:a.receiverFriendlyName}function p(){var a=u();return a==null?!1:!0}function q(){var a=v();return a==null?!1:a.currentPlaybackState==="paused"}function r(){var a=v();return a==null?!1:a.currentPlaybackState==="play"}function s(){var a=v();return a==null?null:a.currentAssetID}function t(){var a=i(d("CastingContext").CastingStateContext),b=i(d("CastingContext").CastingExperienceStateContext);if(a==null||!a.receiverIsConnected)return null;return(b==null?void 0:b.type)!=="video_channel"?null:b}function u(){var a=i(d("CastingContext").CastingStateContext),b=i(d("CastingContext").CastingExperienceStateContext);if(a==null||!a.receiverIsConnected)return null;return(b==null?void 0:b.type)!=="photo"?null:b}function v(){var a=i(d("CastingContext").CastingStateContext),b=i(d("CastingContext").CastingExperienceStateContext);if(a==null||!a.receiverIsConnected)return null;return(b==null?void 0:b.type)!=="photo_album"?null:b}g.useIsCastingConnected=a;g.useCastingVideoID=j;g.useIsCastingAnyVideo=b;g.useCastingCurrentTime=c;g.useCastingDuration=e;g.useCastingIsPlaying=f;g.useCastingIsPaused=k;g.useCastingIsEnded=l;g.useCastingIsMuted=m;g.useCastingVolume=n;g.useCastingReceiverFriendlyName=o;g.useIsCastingPhotoExperience=p;g.useCastingIsAlbumPaused=q;g.useCastingIsAlbumPlaying=r;g.useCastingAlbumAssetID=s}),98);
__d("CometPoliticalInfosheetDialogV2Query_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="24537202715904473"}),null);
__d("CometPoliticalInfosheetDialogV2Query$Parameters",["CometPoliticalInfosheetDialogV2Query_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a={kind:"PreloadableConcreteRequest",params:{id:b("CometPoliticalInfosheetDialogV2Query_facebookRelayOperation"),metadata:{},name:"CometPoliticalInfosheetDialogV2Query",operationKind:"query",text:null}};e.exports=a}),null);
__d("CometPoliticalInfosheetDialogV2.entrypoint",["CometPoliticalInfosheetDialogV2Query$Parameters","JSResourceForInteraction","WebPixelRatio"],(function(a,b,c,d,e,f,g){"use strict";a={getPreloadProps:function(a){var b=a.ad_id,e=a.entrypoint;a=a.story_id;return{queries:{politicalInfosheetQueryReference:{parameters:c("CometPoliticalInfosheetDialogV2Query$Parameters"),variables:{ad_id:b,entrypoint:e,scale:d("WebPixelRatio").get(),story_id:a}}}}},root:c("JSResourceForInteraction")("CometPoliticalInfosheetDialogV2.react").__setRef("CometPoliticalInfosheetDialogV2.entrypoint")};g["default"]=a}),98);
__d("FDSWatchTvFilled16PNGIcon.react",["ix","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";a=d("fbicon")._(h("607168"),16);b=a;g["default"]=b}),98);
__d("LiveVideoCometNuxForCVCQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="9844696545637976"}),null);
__d("LiveVideoCometNuxForCVCQuery.graphql",["LiveVideoCometNuxForCVCQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"nuxID"},{defaultValue:null,kind:"LocalArgument",name:"videoID"}],c=[{kind:"Variable",name:"nux_id",variableName:"nuxID"}],d={kind:"InlineFragment",selections:[{args:null,documentName:"LiveVideoCometNuxForCVCQuery",fragmentName:"LiveVideoCometNuxForCVCInternal_nux",fragmentPropName:"nux",kind:"ModuleImport"}],type:"DefaultNUX",abstractKey:null},e=[{kind:"Variable",name:"id",variableName:"videoID"}],f={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"LiveVideoCometNuxForCVCQuery",selections:[{alias:null,args:c,concreteType:null,kind:"LinkedField",name:"nux",plural:!1,selections:[d],storageKey:null},{alias:null,args:e,concreteType:"Video",kind:"LinkedField",name:"video",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"LiveVideoCometNuxForCVCInternal_video"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"LiveVideoCometNuxForCVCQuery",selections:[{alias:null,args:c,concreteType:null,kind:"LinkedField",name:"nux",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},d,f],storageKey:null},{alias:null,args:e,concreteType:"Video",kind:"LinkedField",name:"video",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_premiere",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_live_audio_room_v2_broadcast",storageKey:null},f],storageKey:null}]},params:{id:b("LiveVideoCometNuxForCVCQuery_facebookRelayOperation"),metadata:{},name:"LiveVideoCometNuxForCVCQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("LiveVideoCometNuxForCVC.react",["CometPlaceholder.react","CometRelay","LiveVideoCometNuxForCVCQuery.graphql","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||d("react"),k=h!==void 0?h:h=b("LiveVideoCometNuxForCVCQuery.graphql");function a(a){var b=d("react-compiler-runtime").c(5);a=a.videoID;a=d("CometRelay").useLazyLoadQuery(k,{nuxID:8030,videoID:a});var e;b[0]!==a.video?(e={video:a.video},b[0]=a.video,b[1]=e):e=b[1];var f;b[2]!==a.nux||b[3]!==e?(f=j.jsx(c("CometPlaceholder.react"),{fallback:null,children:j.jsx(d("CometRelay").MatchContainer,{match:a.nux,props:e})}),b[2]=a.nux,b[3]=e,b[4]=f):f=b[4];return f}g["default"]=a}),98);
__d("VideoBroadcastStatus",[],(function(a,b,c,d,e,f){a=Object.freeze({PREVIEW:"PREVIEW",LIVE:"LIVE",LIVE_STOPPED:"LIVE_STOPPED",VOD_READY:"VOD_READY",SEAL_STARTED:"SEAL_STARTED",SCHEDULED_PREVIEW:"SCHEDULED_PREVIEW",SCHEDULED_LIVE:"SCHEDULED_LIVE",SCHEDULED_EXPIRED:"SCHEDULED_EXPIRED",SCHEDULED_CANCELED:"SCHEDULED_CANCELED",PRE_LIVE:"PRE_LIVE",SEAL_FAILED:"SEAL_FAILED"});f["default"]=a}),66);
__d("VideoPlayerControlsBottomRowAddOnContext",["react","react-compiler-runtime","useStable"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));f=h;var j=f.useContext,k=f.useEffect,l=f.useState,m=i.createContext(null);function a(a){var b=d("react-compiler-runtime").c(3);a=a.children;var e=c("useStable")(n),f;b[0]!==a||b[1]!==e?(f=i.jsx(m.Provider,{value:e,children:a}),b[0]=a,b[1]=e,b[2]=f):f=b[2];return f}function n(){var a=null,b=null,c=null;return{getBottomRowAddOn:function(){return b},initialize:function(d){c=function(a){b=a,d(a)};if(a==null)return;c(a);a=null},setBottomRowAddOn:function(b){if(c==null){a=b;return}c(b)}}}function b(a){var b=d("react-compiler-runtime").c(3),c=j(m);a=l(a);var e=a[0],f=a[1],g;b[0]!==c?(a=function(){if(c==null)return;c.initialize(f)},g=[c],b[0]=c,b[1]=a,b[2]=g):(a=b[1],g=b[2]);k(a,g);return e}function e(a){var b=d("react-compiler-runtime").c(4),c=j(m),e,f;b[0]!==a||b[1]!==c?(e=function(){if(c==null)return;c.setBottomRowAddOn(a)},f=[a,c],b[0]=a,b[1]=c,b[2]=e,b[3]=f):(e=b[2],f=b[3]);k(e,f)}g.VideoPlayerControlsBottomRowAddOnContext=m;g.VideoPlayerControlsBottomRowAddOnContextProvider=a;g.useVideoPlayerControlsBottomRowAddOn=b;g.useSetVideoPlayerControlsBottomRowAddOn=e}),98);
__d("createVideoStateHook",["VideoPlayerHooks","emptyFunction","gkx","react","react-compiler-runtime","useStable"],(function(a,b,c,d,e,f,g){"use strict";var h,i;b=h||d("react");var j=b.useEffect;b.useMemo;var k=b.useSyncExternalStore,l=new Set();e=function(a){var b=new Map();l.add(b);var e=c("emptyFunction");function f(a,c){var d=b.get(a);d||(d={consumers:new Set(),key:a,lastValue:c},b.set(a,d));return d}function g(a,c){return{getSnapshot:function(){var d=b.get(a);return d==null?c:d.lastValue},setValue:function(b){var d=f(a,c),e;typeof b==="function"?e=b(d.lastValue):e=b;d.lastValue=e;d.consumers.forEach(function(a){a(e)})},subscribe:function(b){var d=f(a,c);d.consumers.add(b);return function(){d.consumers["delete"](b)}}}}function a(a){var b=d("react-compiler-runtime").c(10),e;b[0]!==a?(e=function(){return a},b[0]=a,b[1]=e):e=b[1];var f=c("useStable")(e);e=(i||(i=d("VideoPlayerHooks"))).useInstanceKey();var h;b[2]!==f||b[3]!==e?(h=g(e,f),b[2]=f,b[3]=e,b[4]=h):h=b[4];e=h;h=e;e=h.getSnapshot;var j=h.setValue;h=h.subscribe;var l;b[5]!==f?(l=function(){return f},b[5]=f,b[6]=l):l=b[6];h=k(h,e,l);b[7]!==j||b[8]!==h?(e=[h,j],b[7]=j,b[8]=h,b[9]=e):e=b[9];return e}function h(a){var b=d("react-compiler-runtime").c(5),e;b[0]!==a?(e=function(){return a},b[0]=a,b[1]=e):e=b[1];e=c("useStable")(e);var f=(i||(i=d("VideoPlayerHooks"))).useInstanceKey(),h;b[2]!==e||b[3]!==f?(h=g(f,e),b[2]=e,b[3]=f,b[4]=h):h=b[4];e=h;f=e;b=f.setValue;return b}function j(a){var b=d("react-compiler-runtime").c(7),e;b[0]!==a?(e=function(){return a},b[0]=a,b[1]=e):e=b[1];var f=c("useStable")(e);e=(i||(i=d("VideoPlayerHooks"))).useInstanceKey();var h;b[2]!==f||b[3]!==e?(h=g(e,f),b[2]=f,b[3]=e,b[4]=h):h=b[4];e=h;h=e;e=h.getSnapshot;h=h.subscribe;var j;b[5]!==f?(j=function(){return f},b[5]=f,b[6]=j):j=b[6];return k(h,e,j)}return{setterHook:h,stateHook:a,valueHook:j}};function a(a){var b=d("react-compiler-runtime").c(3),c,e;b[0]!==a?(c=function(){return function(){l.forEach(function(b){b["delete"](a)})}},e=[a],b[0]=a,b[1]=c,b[2]=e):(c=b[1],e=b[2]);j(c,e)}f=e;b=a;g.createVideoStateHookImpl_SafeForConcurrentRendering=e;g.createVideoStateHook=f;g.useCleanupVideoStateHooks_INTERNAL=b}),98);
__d("VideoPlayerInstreamAdsStateHooks",["createVideoStateHook"],(function(a,b,c,d,e,f,g){"use strict";var h=(d=d("createVideoStateHook")).createVideoStateHook(),i=h.stateHook,j=h.valueHook,k=[];function a(){return i(k)}function b(){return j(k)}h=d.createVideoStateHook();var l=h.stateHook,m=h.valueHook,n=null;function c(){return l(n)}function e(){return m(n)}h=d.createVideoStateHook();var o=h.setterHook,p=h.valueHook,q=!0;function f(){return o(q)}function r(){return p(q)}h=d.createVideoStateHook();var s=h.stateHook,t=h.valueHook,u="INIT";function v(){return s(u)}function w(){return t(u)}h=d.createVideoStateHook();var x=h.stateHook,y=h.valueHook,z=!0;function A(){return x(z)}function B(){return y(z)}h=d.createVideoStateHook();var C=h.stateHook,D=h.valueHook,E=null;function F(){return C(E)}function G(){return D(E)}h=d.createVideoStateHook();var H=h.stateHook,I=h.valueHook,J=null;function K(){return H(J)}function L(){return I(J)}h=d.createVideoStateHook();var M=h.stateHook,N=h.valueHook,O=null;function P(){return M(O)}function Q(){return N(O)}h=d.createVideoStateHook();var R=h.stateHook,S=h.valueHook,T=null;function U(){return R(T)}function aa(){return S(T)}h=d.createVideoStateHook();var ba=h.stateHook,ca=h.valueHook,V=null;function da(){return ba(V)}function ea(){return ca(V)}h=d.createVideoStateHook();var fa=h.stateHook,ga=h.valueHook,W=0;function ha(){return fa(W)}function ia(){return ga(W)}h=d.createVideoStateHook();var ja=h.stateHook,ka=h.valueHook,X=!1;function la(){return ja(X)}function ma(){return ka(X)}h=d.createVideoStateHook();var na=h.stateHook,oa=h.valueHook,Y=!1;function pa(){return na(Y)}function qa(){return oa(Y)}h=d.createVideoStateHook();var ra=h.stateHook,sa=h.valueHook,Z=null;function ta(){return ra(Z)}function ua(){return sa(Z)}h=d.createVideoStateHook();var va=h.stateHook,wa=h.valueHook,$=null;function xa(){return va($)}function ya(){return wa($)}function za(){var a=w();return a==="STARTING_INDICATOR"||a==="START"||a==="START_AD"||a==="PLAY_NI_VIDEO"}g.useInstreamAdsMidRollsState=a;g.useInstreamAdsMidRollsValue=b;g.useInstreamAdsPostRollState=c;g.useInstreamAdsPostRollValue=e;g.useInstreamAdsPostRollEndedOrSkippedStateSetter=f;g.useInstreamAdsPostRollEndedOrSkippedStateValue=r;g.useInstreamAdsState=v;g.useInstreamAdsStateValue=w;g.useInstreamAdsIsEmptyState=A;g.useInstreamAdsIsEmptyStateValue=B;g.useInstreamAdsCurrentInsertionState=F;g.useInstreamAdsCurrentInsertionStateValue=G;g.useStartIndicatorBeginningTimeState=K;g.useStartIndicatorBeginningTimeStateValue=L;g.useAdBreaksTimeOffsetBeginningState=P;g.useAdBreaksTimeOffsetBeginningStateValue=Q;g.useInstreamAdsExtraFieldsState=U;g.useInstreamAdsExtraFieldsStateValue=aa;g.useInstreamAdsHideAdBehaviorState=da;g.useInstreamAdsHideAdBehaviorStateValue=ea;g.useUnifiedSchedulerLastFetchTimeState=ha;g.useUnifiedSchedulerLastFetchTimeStateValue=ia;g.useWaitingForAdFetchState=la;g.useWaitingForAdFetchStateValue=ma;g.useInstreamAdsHasCTAState=pa;g.useInstreamAdsHasCTAStateValue=qa;g.useInstreamAdsFeedContextCardState=ta;g.useInstreamAdsFeedContextCardStateValue=ua;g.useInstreamAdsFullScreenContextCardState=xa;g.useInstreamAdsFullScreenContextCardStateValue=ya;g.useInstreamAdsIsStart=za}),98);
__d("VideoPlayerInteractionOverlay.react",["VideoPlayerHooks","react","react-compiler-runtime","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=i||d("react"),l={hiddenCursor:{cursor:"xjfk50j",$$css:!0},pointer:{cursor:"x1ypdohk",$$css:!0},root:{bottom:"x1ey2m1c",boxSizing:"x9f619",insetInlineEnd:"xtijo5x",insetInlineStart:"x1o0tod",position:"x10l6tqk",top:"x13vifvy",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(13),e=a.children,f=a.pressInteraction,g=a.ref,i=a.style;a=a.xstyle;var m=f==null?void 0:f.handler,n=f==null?void 0:f.onPressStart,o=f==null?void 0:f.onMouseEnter;f=f==null?void 0:f.onMouseLeave;var p=(j||(j=d("VideoPlayerHooks"))).useIsFullscreen(),q=j.useIsMouseIdle(),r=!!m&&l.pointer;p=p&&q&&l.hiddenCursor;b[0]!==r||b[1]!==p||b[2]!==a?(q=(h||(h=c("stylex")))(l.root,r,p,a),b[0]=r,b[1]=p,b[2]=a,b[3]=q):q=b[3];b[4]!==e||b[5]!==o||b[6]!==f||b[7]!==m||b[8]!==n||b[9]!==g||b[10]!==i||b[11]!==q?(r=k.jsx("div",{className:q,onClick:m,onMouseEnter:o,onMouseLeave:f,onPointerDown:n,ref:g,role:"presentation",style:i,children:e}),b[4]=e,b[5]=o,b[6]=f,b[7]=m,b[8]=n,b[9]=g,b[10]=i,b[11]=q,b[12]=r):r=b[12];return r}b=a;g.VideoPlayerInteractionOverlay=b}),98);
__d("VideoPlayerWithLiveVideoInterruptedOverlay.react",["fbt","FDSLoadingAnimation.react","FDSTextPairing.react","VideoPlayerHooks","VideoPlayerInteractionOverlay.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=i||d("react");function a(){var a=d("react-compiler-runtime").c(3),b=(j||(j=d("VideoPlayerHooks"))).useStreamInterrupted(),e=j.useIsLiveRewindActive();if(!b||e)return null;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b={className:"x6s0dn4 x18l40ae x1ey2m1c x9f619 x78zum5 xdt5ytf xtijo5x x1o0tod xl56j7k x10l6tqk x13vifvy"},a[0]=b):b=a[0];a[1]===Symbol["for"]("react.memo_cache_sentinel")?(e=h._(/*BTDS*/"The broadcast is waiting for a signal. It should resume shortly."),a[1]=e):e=a[1];a[2]===Symbol["for"]("react.memo_cache_sentinel")?(b=k.jsx(d("VideoPlayerInteractionOverlay.react").VideoPlayerInteractionOverlay,{children:k.jsxs("div",babelHelpers["extends"]({},b,{children:[k.jsx("div",{children:k.jsx(c("FDSTextPairing.react"),{body:e,bodyColor:"white",headline:h._(/*BTDS*/"Waiting for Live Video Signal"),headlineColor:"white",level:2,textAlign:"center"})}),k.jsx("div",babelHelpers["extends"]({className:"xc9qbxq x1sy10c2 x1n2onr6 x14qfxbe"},{children:k.jsx(c("FDSLoadingAnimation.react"),{size:36})}))]}))}),a[2]=b):b=a[2];return b}g["default"]=a}),226);
__d("useCometSize_DO_NOT_USE",["CometThrottle","ExecutionEnvironment","FBLogger","HiddenSubtreePassiveContext","react","useResizeObserver","useStable","useUnsafeRef_DEPRECATED"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;b=j||d("react");var k=b.useContext,l=b.useEffect,m=b.useLayoutEffect,n=b.useRef,o=b.useState;function p(a){var b=a.setBoxStateStable,d=null,e=function(a){var c;if(((c=d)==null?void 0:c.height)===a.height&&((c=d)==null?void 0:c.width)===a.width)return;d=a;b(a)};a=function(a){a=a.getBoundingClientRect();var b=a.height;a=a.width;e({height:b,width:a})};var f=c("CometThrottle")(function(a){var b=a.height;a=a.width;if(b===0&&a===0)return;e({height:b,width:a})},200,{leading:!0,trailing:!0});return{measure:a,onResizeThrottled:f}}function a(a){a===void 0&&(a=!1);if(!(h||(h=c("ExecutionEnvironment"))).canUseDOM&&!a)throw c("FBLogger")("comet_ssr").blameToPreviousFile().mustfixThrow("useCometSize is not compatible with Server Rendering. This will break SSR! See https://fburl.com/wiki/xrzohrqb");var b=n(null);a=o(null);var d=a[0],e=a[1],f=k(c("HiddenSubtreePassiveContext")),g=c("useStable")(function(){return p({setBoxStateStable:e})}),j=c("useResizeObserver")(g.onResizeThrottled),q=n(j);m(function(){q.current=j},[j]);a=(i||(i=c("useUnsafeRef_DEPRECATED")))(function(a){a!==b.current&&(b.current=a,a!=null&&g.measure(a)),q.current(b.current)});l(function(){if(!f.getCurrentState().hidden)return;var a=f.subscribeToChanges(function(c){!c.hidden&&b.current!=null&&(g.measure(b.current),a.remove())});return function(){return a.remove()}},[f,g]);l(function(){return function(){g.onResizeThrottled.cancel()}},[g]);return[a.current,d]}g["default"]=a}),98);
__d("useFeedClickEventHandler",["react","react-compiler-runtime","useStoryClickEventLogger"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(a,b){var e=d("react-compiler-runtime").c(4),f=c("useStoryClickEventLogger")(),g;e[0]!==b||e[1]!==f||e[2]!==a?(g=function(c){a&&a(c);var d=c.type;if(d==="click"||d==="contextmenu"||d==="mousedown"&&typeof c.button==="number"&&(c.button===1||c.button===2)||d==="keydown"&&(c.key==="Enter"||c.key===" ")){d=typeof c.button==="number"?c.button:0;f(c.timeStamp,d,b)}},e[0]=b,e[1]=f,e[2]=a,e[3]=g):g=e[3];return g}g["default"]=a}),98);
__d("usePlayerOriginRouteTracePolicy",["CometNotificationsRootContext","CometRouteRenderType","react","useCometRouteTracePolicy","useCometRouterState","useParentRoute","useRoutePassthroughProps"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useContext;function a(){var a=i(c("CometNotificationsRootContext"));a=a.isNotificationsRoute;var b=c("useCometRouteTracePolicy")(),e=d("CometRouteRenderType").useIsPushView(),f=c("useParentRoute")(),g=c("useCometRouterState")(),h=c("useRoutePassthroughProps")();if((h==null?void 0:h.isARLTW)===!0)return"comet.watch.arltw";h=b==="comet.videos.tahoe";var j=b==="comet.stories.viewer",k=b==="comet.reels.home"||b==="comet.reels.unified.player";if(e){if(h)return"unknown";if(j)return b;if(k&&(f==null?void 0:f.tracePolicy)==null&&g!=null){e=g.main;j=g.pushViewStack;k=j&&j.length>1?j[j.length-2]:e;g=k.route;return(j=g.tracePolicy)!=null?j:b}}return a&&!h?b:(e=f==null?void 0:f.tracePolicy)!=null?e:b}g["default"]=a}),98);
__d("useRelayClientStateWithLocalStorage",["CometRelay","FBLogger","WebStorage","react","useStable"],(function(a,b,c,d,e,f,g){"use strict";var h,i;b=i||d("react");var j=b.useCallback,k=b.useEffect,l=new Set();function a(a,b,e,f){var g=l.has(b),i=d("CometRelay").useRelayEnvironment(),m=c("useStable")((h||(h=c("WebStorage"))).getLocalStorage),n=c("useStable")(function(){if(g||m==null)return f;var a=m.getItem(b);try{return a==null||a===""?f:JSON.parse(a)}catch(a){return f}}),o=j(function(c){d("CometRelay").commitLocalUpdate(i,function(d){d=d.get(a);if(d==null)return;if(d.getValue(e)===c)return;d.setValue(c,e);l.add(b)})},[i,e,a,b]);k(function(){if(m==null)return;if(!g)return;var a=JSON.stringify(f);if(a==null)return;try{m.setItem(b,a)}catch(b){b!=null&&typeof b==="object"&&b.code===22&&m.clear();a=c("FBLogger")("use_local_storage");b instanceof Error&&(a=a.catching(b));a.mustfix("Cannot save to local storage.")}},[b,g,m,f]);return[g?f:n,o]}g.useRelayClientStateWithLocalStorage=a}),98);
__d("useSelectedLatencySetting",["react-compiler-runtime","useRelayClientStateWithLocalStorage"],(function(a,b,c,d,e,f,g){"use strict";var h="_video_LiveVideoLatencyMenuContextProvider_selected_latency_setting";function i(a){if(a==null)return null;switch(a){case"low":case"normal":return a;default:return null}}function a(a,b){var c=d("react-compiler-runtime").c(5);if(c[0]!==b){var e;e=(e=i(b))!=null?e:"normal";c[0]=b;c[1]=e}else e=c[1];b=d("useRelayClientStateWithLocalStorage").useRelayClientStateWithLocalStorage(a,h,"selected_latency_setting",e);a=b[0];e=b[1];c[2]!==a||c[3]!==e?(b=[a,e],c[2]=a,c[3]=e,c[4]=b):b=c[4];return b}g["default"]=a}),98);
__d("useVideoPlayerAvailableCaptionsLocalesFromRelay_video.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useVideoPlayerAvailableCaptionsLocalesFromRelay_video",selections:[{alias:null,args:null,concreteType:"VideoCaptionLocale",kind:"LinkedField",name:"video_available_captions_locales",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"localized_creation_method",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"captions_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"locale",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"localized_language",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"localized_country",storageKey:null}],storageKey:null}],type:"Video",abstractKey:null};e.exports=a}),null);
__d("useVideoPlayerAvailableCaptionsLocalesFromRelay",["CometRelay","react","react-compiler-runtime","useVideoPlayerAvailableCaptionsLocalesFromRelay_video.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h,i;(i||d("react")).useMemo;function a(a){var c=d("react-compiler-runtime").c(2);a=d("CometRelay").useFragment(h!==void 0?h:h=b("useVideoPlayerAvailableCaptionsLocalesFromRelay_video.graphql"),a);a==null||a.video_available_captions_locales;var e;if(c[0]!==(a==null?void 0:a.video_available_captions_locales)){var f;e=a==null||(f=a.video_available_captions_locales)==null?void 0:f.map(j);c[0]=a==null?void 0:a.video_available_captions_locales;c[1]=e}else e=c[1];a=e;c=a;return c}function j(a){return{captionsUrl:a.captions_url,locale:a.locale,localizedCountry:a.localized_country,localizedCreationMethod:a.localized_creation_method,localizedLanguage:a.localized_language}}g["default"]=a}),98);
__d("useVideoPlayerHasStartedPlayingAtLeastOnce",["VideoPlayerHooks","createVideoStateHook","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=(h||d("react")).useEffect;b=d("createVideoStateHook").createVideoStateHook(null);var k=b.stateHook;function a(){var a=d("react-compiler-runtime").c(4),b=k(!1),c=b[0],e=b[1],f=(i||(i=d("VideoPlayerHooks"))).usePlaying(),g;a[0]!==f||a[1]!==e?(b=function(){f&&e(!0)},g=[f,e],a[0]=f,a[1]=e,a[2]=b,a[3]=g):(b=a[2],g=a[3]);j(b,g);return c}g["default"]=a}),98);/*FB_PKG_DELIM*/
__d("CometTahoeEndScreenProgressCircle.react",["ix","FDSIcon.react","fbicon","react","react-compiler-runtime","useInterval"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;var k=b.useEffect,l=b.useRef,m=b.useState;function a(a){var b=d("react-compiler-runtime").c(38),e=a.circleDiameter,f=a.circleStrokeColor,g=a.circleStrokeWidth,h=a.iconSize,i=a.isMakingProgress,o=a.onProgressDone;a=a.timeoutSec;e=e===void 0?52:e;f=f===void 0?"var(--always-white)":f;g=g===void 0?4:g;h=h===void 0?32:h;var p=e/2,q=p*2*Math.PI,r=q/100,s=m(q),t=s[0],u=s[1];s=m(!1);var v=s[0],w=s[1];b[0]!==t||b[1]!==i||b[2]!==r||b[3]!==v?(s=!i||v?null:function(){if(t<=2){u(0);w(!0);return}u(t-r)},b[0]=t,b[1]=i,b[2]=r,b[3]=v,b[4]=s):s=b[4];var x;b[5]!==i||b[6]!==v?(x=[i,v],b[5]=i,b[6]=v,b[7]=x):x=b[7];c("useInterval")(s,a*10,x);var y=l(o);b[8]!==o?(i=function(){y.current=o},s=[o],b[8]=o,b[9]=i,b[10]=s):(i=b[9],s=b[10]);k(i,s);b[11]!==v?(a=function(){if(v){var a=y.current;a()}},x=[v],b[11]=v,b[12]=x,b[13]=a):(x=b[12],a=b[13]);k(a,x);b[14]===Symbol["for"]("react.memo_cache_sentinel")?(i={className:"x6s0dn4 x78zum5 xl56j7k"},s="x1plvlek xryxfnj x9tu13d",b[14]=i,b[15]=s):(i=b[14],s=b[15]);b[16]!==e?(a={height:e,width:e},b[16]=e,b[17]=a):a=b[17];b[18]!==p?(x=j.jsx("circle",{cx:p,cy:p,fill:"var(--fds-black-alpha-40)",r:p}),b[18]=p,b[19]=x):x=b[19];b[20]!==f||b[21]!==g||b[22]!==q||b[23]!==t||b[24]!==p?(e=j.jsx("circle",{cx:p,cy:p,fill:"transparent",r:p,stroke:f,strokeDasharray:q,strokeDashoffset:t,strokeWidth:g}),b[20]=f,b[21]=g,b[22]=q,b[23]=t,b[24]=p,b[25]=e):e=b[25];b[26]!==a||b[27]!==x||b[28]!==e?(f=j.jsxs("svg",{className:s,style:a,children:[x,e]}),b[26]=a,b[27]=x,b[28]=e,b[29]=f):f=b[29];b[30]===Symbol["for"]("react.memo_cache_sentinel")?(g={className:"x1lliihq xr1yuqi x11t971q x4ii5y1 xvc5jky x10l6tqk"},b[30]=g):g=b[30];b[31]!==h?(q=n(h),b[31]=h,b[32]=q):q=b[32];b[33]!==q?(p=j.jsx("div",babelHelpers["extends"]({},g,{children:j.jsx(c("FDSIcon.react"),{color:"white",icon:q})})),b[33]=q,b[34]=p):p=b[34];b[35]!==f||b[36]!==p?(s=j.jsxs("div",babelHelpers["extends"]({},i,{children:[f,p]})),b[35]=f,b[36]=p,b[37]=s):s=b[37];return s}function n(a){switch(a){case 20:return d("fbicon")._(h("484863"),20);case 32:return d("fbicon")._(h("582360"),32)}}g["default"]=a}),98);
__d("FDSEntityHeaderFacepileProfileIcon.react",["BaseImage.react","react","react-compiler-runtime","react-strict-dom"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j={image:{borderTopColor:"xsdn2ir",borderInlineEndColor:"xpkn66y",borderBottomColor:"x13awxeq",borderInlineStartColor:"xuxekev",borderStartStartRadius:"x1c9tyrk",borderStartEndRadius:"xeusxvb",borderEndEndRadius:"x1pahc9y",borderEndStartRadius:"x1ertn4p",borderTopStyle:"x13fuv20",borderInlineEndStyle:"x18b5jzi",borderBottomStyle:"x1q0q8m5",borderInlineStartStyle:"x1t7ytsu",borderTopWidth:"xamhcws",borderInlineEndWidth:"x1alpsbp",borderBottomWidth:"xlxy82",borderInlineStartWidth:"xyumdvf",display:"x1lliihq",$$css:!0},root:{display:"x1rg5ohu",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(5),e=a.alt,f=a.size;a=a.src;f=f===void 0?32:f;var g;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(g=[j.root],b[0]=g):g=b[0];b[1]!==e||b[2]!==f||b[3]!==a?(g=i.jsx(d("react-strict-dom").html.div,{style:g,children:i.jsx(c("BaseImage.react"),{alt:e,height:f,src:a,width:f,xstyle:j.image})}),b[1]=e,b[2]=f,b[3]=a,b[4]=g):g=b[4];return g}g["default"]=a}),98);
__d("FDSEntityHeaderFacepile.react",["fbt","CometLink.react","FDSEntityHeaderFacepileProfileIcon.react","FDSTooltip.react","react","react-compiler-runtime","react-strict-dom"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react"),k=8,l={dynamicStyle:function(a){return[{zIndex:a!=null?"xbgtp72":a,$$css:!0},{"--zIndex":a!=null?a:void 0}]},facepile:{display:"x1rg5ohu",$$css:!0},left:{marginInlineStart:"xw01apr",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(6);a=a.profiles;var c;b[0]!==a?(c=a.length>k?a.slice(0,k):a,b[0]=a,b[1]=c):c=b[1];a=c;b[2]!==a?(c=a.map(m),b[2]=a,b[3]=c):c=b[3];a=c;b[4]!==a?(c=j.jsx(d("react-strict-dom").html.div,{children:a}),b[4]=a,b[5]=c):c=b[5];return c}function m(a,b){var e=a.name,f=a.pictureURI,g=a.profileURL;a=a.size;return j.jsx(d("react-strict-dom").html.div,{style:[l.facepile,b>0&&l.left,l.dynamicStyle(b)],children:j.jsx(c("FDSTooltip.react"),{align:"middle",position:"below",tooltip:h._(/*BTDS*/"{user's name}",[h._param("user's name",e)]),children:j.jsx(c("CometLink.react"),{href:g,children:j.jsx(c("FDSEntityHeaderFacepileProfileIcon.react"),{alt:e,size:a,src:f})},b)})},b)}m.displayName=m.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("LSMarkBumpedThreadsSeen",["LSIssueNewFireAndForgetTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.islc(c.filter(c.db.table(9).fetchDesc([[[a[0]]],"secondaryParentThreadKeyLastActivityTimestampMs"]),function(b){return c.i64.eq(b.secondaryParentThreadKey,a[0])&&[c.i64.cast([0,18]),c.i64.cast([0,23]),c.i64.cast([0,21]),c.i64.cast([0,27])].some(function(a){return c.i64.eq(b.threadType,a)})}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(e,f){var g=e.done;e=e.value;return g?0:(f=e.item,d[0]=f.lastActivityTimestampMs,c.i64.gt(d[0],c.i64.cast([0,0]))?c.db.table(35).fetch([[[a[0]]]]).next().then(function(f,h){var e=f.done;f=f.value;return e?c.sequence([function(b){return c.db.table(35).add({parentThreadKey:a[0],lastSeenRequestTimestampMs:d[0]})},function(e){return d[2]=new c.Map(),d[2].set("parent_thread_key",a[0]),d[2].set("last_seen_time_ms",d[0]),d[3]=c.toJSON(d[2]),c.storedProcedure(b("LSIssueNewFireAndForgetTask"),"fire_forget",c.i64.cast([0,6]),d[3])}]):(h=f.item,c.i64.lt(h.lastSeenRequestTimestampMs,d[0])?c.sequence([function(b){return c.db.table(35).add({parentThreadKey:a[0],lastSeenRequestTimestampMs:d[0]})},function(e){return d[2]=new c.Map(),d[2].set("parent_thread_key",a[0]),d[2].set("last_seen_time_ms",d[0]),d[3]=c.toJSON(d[2]),c.storedProcedure(b("LSIssueNewFireAndForgetTask"),"fire_forget",c.i64.cast([0,6]),d[3])}]):c.resolve())}):c.resolve())})},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxMarkBumpedThreadsSeenStoredProcedure";a.__tables__=["threads","folder_metadata"];e.exports=a}),null);
__d("LSMarkBumpedThreadsSeenStoredProcedure",["LSMarkBumpedThreadsSeen","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSMarkBumpedThreadsSeen"),e.secondaryParentThreadKey);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSMarkFolderSeen",["LSIssueNewFireAndForgetTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[0]=void 0:(b=a.item,d[0]=b.threadType)})},function(e){return c.i64.eq(d[0],c.i64.cast([0,17]))?c.sequence([function(b){return d[2]=c.i64.of_float(Date.now()),c.forEach(c.db.table(9).fetch([[[a[0]]]]),function(a){var b=a.update;a.item;return b({lastReadWatermarkTimestampMs:d[2]})})},function(e){return d[3]=c.i64.of_float(Date.now()),c.i64.gt(d[3],c.i64.cast([0,0]))?c.db.table(35).fetch([[[a[0]]]]).next().then(function(e,f){var g=e.done;e=e.value;return g?c.sequence([function(b){return c.db.table(35).add({parentThreadKey:a[0],lastSeenRequestTimestampMs:d[3]})},function(e){return d[6]=new c.Map(),d[6].set("parent_thread_key",a[0]),d[6].set("last_seen_time_ms",d[3]),d[7]=c.toJSON(d[6]),c.storedProcedure(b("LSIssueNewFireAndForgetTask"),"fire_forget",c.i64.cast([0,6]),d[7])}]):(f=e.item,c.i64.lt(f.lastSeenRequestTimestampMs,d[3])?c.sequence([function(b){return c.forEach(c.db.table(35).fetch([[[a[0]]]]),function(a){var b=a.update;a.item;return b({lastSeenRequestTimestampMs:d[3]})})},function(e){return d[6]=new c.Map(),d[6].set("parent_thread_key",a[0]),d[6].set("last_seen_time_ms",d[3]),d[7]=c.toJSON(d[6]),c.storedProcedure(b("LSIssueNewFireAndForgetTask"),"fire_forget",c.i64.cast([0,6]),d[7])}]):c.resolve())}):c.resolve()},function(b){return d[4]=c.i64.of_float(Date.now()),c.forEach(c.db.table(162).fetch([[[a[0]]]]),function(a){var b=a.update;a.item;return b({readTimestampMs:d[4]})})}]):c.sequence([function(b){return c.islc(c.sortBy(c.filter(c.db.table(276).fetch(),function(b){return c.i64.eq(b.folderType,a[0])}),[["lastActivityAuthoritativeTsMs","DESC"]]),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){var e=a.done;a=a.value;return e?d[2]=c.i64.cast([0,0]):(b=a.item,d[8]=b.lastActivityAuthoritativeTsMs,c.i64.neq(d[8],void 0)?d[7]=d[8]:d[7]=c.i64.cast([0,0]),d[2]=d[7])})},function(b){return c.islc(c.db.table(9).fetchDesc([[[a[0]]],"parentThreadKeyLastActivityTimestampMs"]),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){var e=a.done;a=a.value;return e?d[4]=c.i64.cast([0,0]):(b=a.item,d[8]=b.lastActivityTimestampMs,c.i64.neq(d[8],void 0)?d[7]=d[8]:d[7]=c.i64.cast([0,0]),d[4]=d[7])})},function(e){return d[6]=c.i64.gt(d[2],d[4])?d[2]:d[4],c.i64.gt(d[6],c.i64.cast([0,0]))?c.db.table(35).fetch([[[a[0]]]]).next().then(function(e,f){var g=e.done;e=e.value;return g?c.sequence([function(b){return c.db.table(35).add({parentThreadKey:a[0],lastSeenRequestTimestampMs:d[6]})},function(e){return d[8]=new c.Map(),d[8].set("parent_thread_key",a[0]),d[8].set("last_seen_time_ms",d[6]),d[9]=c.toJSON(d[8]),c.storedProcedure(b("LSIssueNewFireAndForgetTask"),"fire_forget",c.i64.cast([0,6]),d[9])}]):(f=e.item,c.i64.lt(f.lastSeenRequestTimestampMs,d[6])?c.sequence([function(b){return c.forEach(c.db.table(35).fetch([[[a[0]]]]),function(a){var b=a.update;a.item;return b({lastSeenRequestTimestampMs:d[6]})})},function(e){return d[8]=new c.Map(),d[8].set("parent_thread_key",a[0]),d[8].set("last_seen_time_ms",d[6]),d[9]=c.toJSON(d[8]),c.storedProcedure(b("LSIssueNewFireAndForgetTask"),"fire_forget",c.i64.cast([0,6]),d[9])}]):c.resolve())}):c.resolve()}])}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxMarkFolderSeenStoredProcedure";a.__tables__=["threads","folder_metadata","community_folders","client_threads"];e.exports=a}),null);
__d("LSMarkFolderSeenStoredProcedure",["LSMarkFolderSeen","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSMarkFolderSeen"),e.parentThreadKey);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("MWCMMarkBumpedThreadsSeen",["LSFactory","LSMarkBumpedThreadsSeenStoredProcedure"],(function(a,b,c,d,e,f,g){"use strict";async function a(a,b){a!=null&&await c("LSMarkBumpedThreadsSeenStoredProcedure")(c("LSFactory")(b),{secondaryParentThreadKey:a})}g.MWCMMarkBumpedThreadsSeen=a}),98);
__d("MWPMarkSeenDeferred",["LSFactory","LSMarkFolderSeenStoredProcedure"],(function(a,b,c,d,e,f,g){"use strict";async function a(a,b){a!=null&&await c("LSMarkFolderSeenStoredProcedure")(c("LSFactory")(b),{parentThreadKey:a})}g.markSeen=a}),98);
__d("MWXListCellHoverActions.react",["react","react-compiler-runtime","react-strict-dom"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j={action:{marginInlineStart:"x13fj5qh",$$css:!0},menuButtonContainer:{alignItems:"x6s0dn4",bottom:"x1hgdm3",display:"x78zum5",flexDirection:"x1q0g3np",insetInlineEnd:"x9olu1o",left:null,right:null,pointerEvents:"x67bb7w",position:"x10l6tqk",top:"x1jl3hli",$$css:!0},visuallyHidden:{clip:"x1qvwoe0",clipPath:"x1vzd84k",height:"xjm9jq1",overflowX:"x6ikm8r",overflowY:"x10wlt62",width:"x1i1rx1s",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(7),c=a.children;a=a.hidden;a=a&&j.visuallyHidden;var e;b[0]!==a?(e=[j.menuButtonContainer,a],b[0]=a,b[1]=e):e=b[1];b[2]!==c?(a=Array.isArray(c)?c.filter(l).map(k):c,b[2]=c,b[3]=a):a=b[3];b[4]!==e||b[5]!==a?(c=i.jsx(d("react-strict-dom").html.div,{role:"gridcell",style:e,children:a}),b[4]=e,b[5]=a,b[6]=c):c=b[6];return c}function k(a,b){return i.jsx(d("react-strict-dom").html.div,{style:j.action,children:a},b)}k.displayName=k.name+" [from "+f.id+"]";function l(a){return a!=null}g["default"]=a}),98);
__d("MWXListCellHoverButton.react",["fbt","FocusWithinHandler.react","MWXCircleButton.react","MWXEntryPointPopoverTrigger.react","MWXIconDots3Horizontal","MWXLazyPopoverTrigger.react","react","react-compiler-runtime","react-strict-dom"],(function(a,b,c,d,e,f,g,h){"use strict";var i=["popoverProps"],j,k=j||(j=d("react"));j.useCallback;function a(a){var b=d("react-compiler-runtime").c(30),e=a.label,f=a.onFocusChange,g=a.onHoverChange,j=a.onMenuStateChange,l=a.onPress,m=a.size,n=a.testid,o;b[0]!==j?(o=function(a){j!=null&&j(a)},b[0]=j,b[1]=o):o=b[1];o=o;var p;b[2]!==e||b[3]!==f||b[4]!==g||b[5]!==l||b[6]!==m||b[7]!==n?(p=function(a,b,i,j,n){return k.jsx(d("react-strict-dom").html.div,{ref:a,children:k.jsx(c("FocusWithinHandler.react"),{onFocusChange:f,children:function(a){return k.jsx(d("react-strict-dom").html.div,{children:k.jsx(c("MWXCircleButton.react"),{color:"secondary",icon:c("MWXIconDots3Horizontal"),label:e!=null?e:h._(/*BTDS*/"Menu"),onHoverIn:function(a){i&&i(a),g&&g(!0)},onHoverOut:function(a){j&&j(),g&&g(!1)},onPress:function(){l&&l(),b()},onPressIn:n,size:m!=null?m:36,testid:void 0,type:"overlay-raised"})})}})})},b[2]=e,b[3]=f,b[4]=g,b[5]=l,b[6]=m,b[7]=n,b[8]=p):p=b[8];var q=p;b[9]!==o||b[10]!==a.popoverFallback||b[11]!==a.popoverProps?(n={align:"middle",fallback:a.popoverFallback,onVisibilityChange:o,popoverProps:a.popoverProps,position:"below"},b[9]=o,b[10]=a.popoverFallback,b[11]=a.popoverProps,b[12]=n):n=b[12];p=n;if(a.popoverTriggerType==="lazy"){b[13]!==q?(o=function(a,b){return q(a,b)},b[13]=q,b[14]=o):o=b[14];b[15]!==p||b[16]!==a.popoverResource||b[17]!==o?(n=k.jsx(c("MWXLazyPopoverTrigger.react"),babelHelpers["extends"]({},p,{popoverResource:a.popoverResource,children:o})),b[15]=p,b[16]=a.popoverResource,b[17]=o,b[18]=n):n=b[18];return n}else{b[19]!==p?(o=p.popoverProps,n=babelHelpers.objectWithoutPropertiesLoose(p,i),b[19]=p,b[20]=o,b[21]=n):(o=b[20],n=b[21]);b[22]!==q?(p=function(a,b,c,d,e,f){return q(a,b,d,e,f)},b[22]=q,b[23]=p):p=b[23];var r;b[24]!==o||b[25]!==a.entryPointParams||b[26]!==a.popoverEntryPoint||b[27]!==n||b[28]!==p?(r=k.jsx(c("MWXEntryPointPopoverTrigger.react"),babelHelpers["extends"]({},n,{entryPointParams:a.entryPointParams,otherProps:o,popoverEntryPoint:a.popoverEntryPoint,preloadTrigger:"button_aggressive",children:p})),b[24]=o,b[25]=a.entryPointParams,b[26]=a.popoverEntryPoint,b[27]=n,b[28]=p,b[29]=r):r=b[29];return r}}g["default"]=a}),226);
__d("useMWGetThreadTitleForLabel",["mwCMIsAnyCMThread","react-compiler-runtime","useLSGetThreadTitle.react"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=d("react-compiler-runtime").c(3),e=a.threadName,f=a.threadType,g;b[0]!==e||b[1]!==f?(g=c("mwCMIsAnyCMThread")(f)||e!=null,b[0]=e,b[1]=f,b[2]=g):g=b[2];f=c("useLSGetThreadTitle.react")(a,g).threadTitle;return e!=null?e:f}g["default"]=a}),98);
__d("MWThreadListItemMoreActions.react",["fbt","I64","JSResourceForInteraction","MWPIsThreadUnread","MWThreadListFocusableTable.react","MWXListCellHoverActions.react","MWXListCellHoverButton.react","MWXPopoverLoadingState.react","MessageRequestsBulkActionsContext.react","MessengerWebUXLogger","WebUXLoggingSurfaceContextProvider","cr:2580","gkx","react","react-compiler-runtime","useMWGetThreadTitleForLabel"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=i||(i=d("react"));e=i;var l=e.useContext;e.useMemo;var m=c("JSResourceForInteraction")("MWThreadListHoverButtonDropdownMenu.react").__setRef("MWThreadListItemMoreActions.react");function a(a){var e=d("react-compiler-runtime").c(21),f=a.menuButtonVisibilityState,g=a.messagingEntrypoint,i=a.onClose,n=a.selected;a=a.thread;var o=a.threadKey,p=a.threadType,q;e[0]!==o?(q=(j||(j=d("I64"))).to_string(o),e[0]=o,e[1]=q):q=e[1];q=q;q=q;var r=d("MWPIsThreadUnread").useIsThreadUnread(o),s=f[0];f=f[1];var t=f.setMenuBtnFocused,u=f.setMenuBtnHovered,v=f.setMenuOpened,w=c("MessengerWebUXLogger").useInteractionLogger();f=l(c("MessageRequestsBulkActionsContext.react"));f=f.isBulkActionsEditMode;a=c("useMWGetThreadTitleForLabel")(a);var x;e[2]!==a?(x=a!=null?h._(/*BTDS*/"More options for {chat_name}",[h._param("chat_name",a)]):h._(/*BTDS*/"More options for this chat"),e[2]=a,e[3]=x):x=e[3];a=x;e[4]!==q||e[5]!==f||e[6]!==s||e[7]!==r||e[8]!==a||e[9]!==w||e[10]!==g||e[11]!==i||e[12]!==n||e[13]!==t||e[14]!==u||e[15]!==v||e[16]!==o||e[17]!==p?(x=f?null:k.jsx(c("MWXListCellHoverActions.react"),{hidden:!s,children:k.jsx(c("MWXListCellHoverButton.react"),{label:a,onFocusChange:t,onHoverChange:u,onMenuStateChange:function(a){a&&(b("cr:2580")&&b("cr:2580")({threadKey:o,threadType:p},"open_thread_settings_menu",g),w==null||w({eventName:"open_thread_overflow_menu",threadKey:o,threadType:p}));return v(a)},popoverFallback:k.jsx(c("MWXPopoverLoadingState.react"),{withArrow:!0}),popoverProps:{fbid:q,isUnread:r,messagingEntrypoint:g,onCloseJewel:i,selected:n,threadKey:o},popoverResource:m,popoverTriggerType:"lazy",size:c("gkx")("23219")?32:void 0,testid:void 0})}),e[4]=q,e[5]=f,e[6]=s,e[7]=r,e[8]=a,e[9]=w,e[10]=g,e[11]=i,e[12]=n,e[13]=t,e[14]=u,e[15]=v,e[16]=o,e[17]=p,e[18]=x):x=e[18];e[19]!==x?(q=k.jsx(d("MWThreadListFocusableTable.react").MWThreadListFocusableTableCell,{children:k.jsx(d("WebUXLoggingSurfaceContextProvider").WebUXLoggingSurfaceContextProvider,{value:"thread_list_options",children:x})}),e[19]=x,e[20]=q):q=e[20];return q}g["default"]=a}),226);
__d("RTWebCallBlockedSettingSubscription_CallBlockSettingSubscription_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="24429620016626810"}),null);
__d("RTWebCallBlockedSettingSubscription_CallBlockSettingSubscription.graphql",["RTWebCallBlockedSettingSubscription_CallBlockSettingSubscription_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"RtwebCallBlockedSettingSubscribeResponsePayload",kind:"LinkedField",name:"rtweb_call_blocked_setting_subscribe",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"call_blocked_until",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"client_subscription_id",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"RTWebCallBlockedSettingSubscription_CallBlockSettingSubscription",selections:c,type:"Subscription",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"RTWebCallBlockedSettingSubscription_CallBlockSettingSubscription",selections:c},params:{id:b("RTWebCallBlockedSettingSubscription_CallBlockSettingSubscription_facebookRelayOperation"),metadata:{subscriptionName:"rtweb_call_blocked_setting_subscribe"},name:"RTWebCallBlockedSettingSubscription_CallBlockSettingSubscription",operationKind:"subscription",text:null}}}();e.exports=a}),null);
__d("RTWebCallBlockedSettingSubscription",["CometRelay","RTWebCallBlockedSettingSubscription_CallBlockSettingSubscription.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h!==void 0?h:h=b("RTWebCallBlockedSettingSubscription_CallBlockSettingSubscription.graphql");function a(a,b,c){return d("CometRelay").requestSubscription(a,{onNext:c,subscription:i,variables:{input:b}})}g.subscribe=a}),98);
__d("RTWebCometIncomingUnsupportedDialogNameQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="9539431006134669"}),null);
__d("personalGlobalScope",["CurrentUser"],(function(a,b,c,d,e,f,g){"use strict";a={id:c("CurrentUser").getAccountID(),type:"PERSONAL"};g.personalGlobalScope=a}),98);
__d("useDebounced",["debounce","react"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");var i=b.useEffect,j=b.useMemo,k=b.useRef;function a(a,b,d){b===void 0&&(b=100);d===void 0&&(d=!1);var e=k(a),f=k(!0),g=k(null);i(function(){f.current=!0;g.current&&(g.current(),g.current=null);return function(){f.current=!1}},[]);i(function(){e.current=a},[a]);var h=j(function(){return c("debounce")(function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];f.current?e.current.apply(e,b):g.current=function(){e.current.apply(e,b)}},b,null,!1,d)},[b,d]);return h}g["default"]=a}),98);
__d("useGlobalScope",["BizKitScopingContext","personalGlobalScope","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useContext;function a(){var a=i(c("BizKitScopingContext"));a=a.globalScope;return a!=null?a:d("personalGlobalScope").personalGlobalScope}g["default"]=a}),98);/*FB_PKG_DELIM*/
__d("EncryptedBackupsDYIHandleMessageRestore",["EncryptedBackupsDYISingleton","I64"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l;async function a(a,b,c,e,f,g,n){var o=d("EncryptedBackupsDYISingleton").getSingleton(),p=o.getLogger();o=o.getThreadKeyForThreadId(b);if(o==null){p.WARN(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Cannot find thread key for thread id: ",""])),b);return}void p.LOG(i||(i=babelHelpers.taggedTemplateLiteralLoose(["handling message range query for thread with thread key ",", hasMoreBefore: ",""])),b,e);c.length>0&&await g(o,b,c);if(!e||f==null){e&&f==null&&void p.ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["nextTimestampMs was not supplied for thread with thread key ","."])),b);m(o);return}g=(l||(l=d("I64"))).to_string(f);void p.LOG(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Issuing next range query for thread with thread key ",", server generated next reference timestamp: ",""])),b,g);void n(a,g,b)}function m(a){var b=d("EncryptedBackupsDYISingleton").getSingleton();b.deleteThreadKeyFromThreadsRestoreInProgress(a)}g.handleMessageRangeQueryRestore=a}),98);
__d("MAWAsyncEBPendingQueryPromise",["Promise"],(function(a,b,c,d,e,f){"use strict";var g,h=new Map(),i=new Map(),j=new Map(),k=new Map(),l=new Map(),m=new Map();function a(a){var c=new(g||(g=b("Promise")))(function(b,c){i.set(a,b),k.set(a,c)});h.set(a,c);return c}function c(a,b){j.set(a,b)}function d(a){return j.get(a)}function e(a){var c=new(g||(g=b("Promise")))(function(b,c){l.set(a,{data:null,resolve:b}),m.set(a,c)});return c}function n(a,b){var c=i.get(a);c!=null&&(i["delete"](a),c(b));c=l.get(a);c!=null&&l.set(a,{data:b,resolve:c.resolve})}function o(a,b){var c=k.get(a);c!=null&&(i["delete"](a),c(b));c=m.get(a);c!=null&&(m["delete"](a),c(b),l["delete"](a))}function p(a){var b=l.get(a);b!=null&&b.data!=null&&(b.resolve(b.data),l["delete"](a),m["delete"](a))}f.getPendingQueryPromiseFromTrace=a;f.setJidFromThreadId=c;f.getJidFromThreadId=d;f.getWaitForRestorePromiseFromTrace=e;f.resolvePendingQueryIfPresent=n;f.rejectPendingQueryIfPresent=o;f.resolvePendingQueryUponReStore=p}),66);
__d("MAWEncryptedBackupsDYIProcessProtobufMessages",["CurrentUser","EncryptedBackupsDYIMessageProcessingUtils","EncryptedBackupsDYISingleton","MAWGroupPollsDualEncryptionUtils","MAWHandleEchoProtobufsRestoreApi","MAWJids","MAWMsgType","WAHashUtils","WAJids","WALongInt","WAStanzaUtils","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;async function a(a,b,e){var f=d("EncryptedBackupsDYISingleton").getSingleton(),g=f.getLogger();void g.LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Processing "," protobuf messages for thread ",""])),e.length,b);e=e.map(function(b){var c=f.hasMessage(a,d("WAStanzaUtils").toStanzaId(b.otid));if(c){g.DEV(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Encountered a duplicate message otid ",", skipping"])),b.otid);return null}return b}).filter(Boolean);var n=d("MAWJids").toUserJid(c("CurrentUser").getAccountID()),o=!1,p=!1,q;try{for(var r=babelHelpers.asyncIterator(e),e;o=!(e=await r.next()).done;o=!1){e=e.value;try{e=d("MAWHandleEchoProtobufsRestoreApi").decodeDecryptedMessageProtobuf(e,n,void 0,new Set(),new Set(),new Map(),new Map(),new Map(),!0);if(e==null){void g.WARN(j||(j=babelHelpers.taggedTemplateLiteralLoose(["Decoded protobuf is empty"])));return}if(e!=null&&e.metadata!=null&&e.metadata.messageId!=null){var s=d("WAStanzaUtils").toStanzaId(e.metadata.messageId);e=await B(a,b,e);if(e==null){void g.WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["Error converting protobuf to DYI format. Dropping the message"])));continue}f.setMessagesByThreadKey(a,s,e)}else{void g.WARN(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Error converting protobuf to DYI format. Dropping the message"])));continue}}catch(a){void g.ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["Error processing protobuf. Dropping the message: ",""])),a);continue}}}catch(a){p=!0,q=a}finally{try{o&&r.return!=null&&await r.return()}finally{if(p)throw q}}}async function B(a,b,c){var e=d("EncryptedBackupsDYISingleton").getSingleton(),f=e.getLogger(),g=c.metadata,h=c.msgType,i=c.sortOrderMs;if(g==null||h==null){void f.WARN(n||(n=babelHelpers.taggedTemplateLiteralLoose(["Error processing protobuf: metadata or message type is null"])));return}h=g.messageId;var j=g.senderId;g=g.timestampMs;if(g==null||typeof g!=="number"||h==null||j==null){void f.WARN(o||(o=babelHelpers.taggedTemplateLiteralLoose(["Error processing protobuf: ts or messageId or senderId is null"])));return}h=d("WATimeUtils").castMilliSecondsToUnixTime(g);g=d("EncryptedBackupsDYIMessageProcessingUtils").buildBaseDyiMessage(j,i);j=(j=c.decodedPayload)==null?void 0:j.text;if(c.editMsgData.length>0){var k=h;c.editMsgData.forEach(function(a){var b;if(a.ts>k&&((b=a.editMsgContent.message)==null?void 0:b.text)!=null){k=a.ts;j=(b=a.editMsgContent.message)==null?void 0:b.text}})}c.reactionData.length>0&&(g.reactions=c.reactionData.map(function(a){var b=a.reaction;a=a.senderId;return{actor:(a=e.getContactNameForContactId(a))!=null?a:"unknown",reaction:(a=b.text)!=null?a:"unknown"}}));switch(c.msgType){case d("MAWMsgType").MSG_TYPE.TEXT:g.type="text";g.text=j||"";break;case d("MAWMsgType").MSG_TYPE.VIDEO:case d("MAWMsgType").MSG_TYPE.GIF:case d("MAWMsgType").MSG_TYPE.IMAGE:case d("MAWMsgType").MSG_TYPE.STICKER:case d("MAWMsgType").MSG_TYPE.PTT:g.type="media";g.text=j||"";g=D(a,b,c,i,g);break;case d("MAWMsgType").MSG_TYPE.DOCUMENT_FILE:void f.WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["Documents are not supported in DYI"])));return;case d("MAWMsgType").MSG_TYPE.XMA:g.type="link";if(c.xmaData==null){void f.WARN(q||(q=babelHelpers.taggedTemplateLiteralLoose(["[Protobuf] XMA message doesn't have xmaData"])));return}g.text=((h=c.xmaData)==null?void 0:h.ctas.map(function(a){return a.nativeUrl}).filter(Boolean).join("\n"))||"";break;case d("MAWMsgType").MSG_TYPE.REVOKED:g.type="placeholder";g.isUnsent=!0;g.text="User unsent a message";break;case d("MAWMsgType").MSG_TYPE.GROUP_POLL_CREATE:g.type="poll";g.text=await C(c);break;case d("MAWMsgType").MSG_TYPE.BUMP_EXISTING_MESSAGE:void f.WARN(r||(r=babelHelpers.taggedTemplateLiteralLoose(["Bump message is not supported in DYI"])));return;default:void f.LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["Explicitly dropping "," message type"])),c.msgType);return}return g}async function C(a){var b=d("EncryptedBackupsDYISingleton").getSingleton().getLogger(),c=a.groupPollInfo;if(c==null){void b.WARN(t||(t=babelHelpers.taggedTemplateLiteralLoose(["[Protobuf] Group poll creation message is missing group poll info"])));return""}var e=new Map(),f=new Map();await Promise.all(c.options.map(async function(a){var b=await d("MAWGroupPollsDualEncryptionUtils").getHashForOptionName(a);e.set(b,{optionName:a,voterUserJids:[]})}));if(a.groupPollUpdateData!=null){var g=!1,h=!1,i;try{for(var j=babelHelpers.asyncIterator(a.groupPollUpdateData),k;g=!(k=await j.next()).done;g=!1){k=k.value;var l,m;if(((l=k.pollCreationMessageKey)==null?void 0:l.id)==null||((l=k.pollCreationMessageKey)==null?void 0:l.remoteJid)==null){b.ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[Polls] Poll creation message key is incomplete. Skipping"])));continue}l=k.pollCreationMessageKey;var n=l.id;l=l.remoteJid;l=d("WAJids").unsafeCoerceToUserJid(l);m={pollCreationMessageKey:c.encKey,pollCreationSenderJid:d("WAJids").toMsgrUserJid(((m=a.metadata)==null?void 0:m.senderId)||""),pollCreationStanzaId:d("WAStanzaUtils").toStanzaId(n),pollUpdateSenderJid:l,pollUpdateStanzaId:k.externalId};if(k.addOption!=null){n=await d("MAWGroupPollsDualEncryptionUtils").decryptGroupPollAddOption(k.addOption,m);if(n.success){var o=n.value,p=!1,q=!1,r;try{for(var s=babelHelpers.asyncIterator(o.pollOption),o;p=!(o=await s.next()).done;p=!1){o=o.value;if(o.optionName==null)continue;o=o.optionName;var y=await d("MAWGroupPollsDualEncryptionUtils").getHashForOptionName(o);e.has(y)||e.set(y,{optionName:o,voterUserJids:[]})}}catch(a){q=!0,r=a}finally{try{p&&s.return!=null&&await s.return()}finally{if(q)throw r}}}else b.ERROR(v||(v=babelHelpers.taggedTemplateLiteralLoose(["[Polls] Decryption failure when trying to decrypt poll add option update: ",""])),n.error)}if(k.vote!=null){y=await d("MAWGroupPollsDualEncryptionUtils").decryptGroupPollVote(k.vote,m);if(y.success){o=y.value;if(o.senderTimestampMs==null){b.WARN(w||(w=babelHelpers.taggedTemplateLiteralLoose(["[Polls] senderTimestampMs is null. Cannot determine the latest poll vote"])));continue}p=o.selectedOptions;q=o.senderTimestampMs;n=f.get(l);(n==null||n.senderTimestampMs<d("WALongInt").numberOrThrowIfTooLarge(q))&&f.set(l,{senderTimestampMs:d("WALongInt").numberOrThrowIfTooLarge(q),votes:p.map(d("MAWGroupPollsDualEncryptionUtils").getBase64EncodedHash)})}else b.ERROR(x||(x=babelHelpers.taggedTemplateLiteralLoose(["[Polls] Decryption failure when trying to decrypt poll vote update: ",""])),y.error)}}}catch(a){h=!0,i=a}finally{try{g&&j.return!=null&&await j.return()}finally{if(h)throw i}}}for(k of f){m=k[0];o=k[1];for(n of o.votes){l=e.get(n);l==null?e.set(n,{optionName:"Unknown",voterUserJids:[m]}):e.set(n,babelHelpers.extends({},l,{voterUserJids:[].concat(l.voterUserJids,[m])}))}}return"Question: "+c.name+"; Options: "+Array.from(e).map(function(a){a[0];a=a[1];var b=a.optionName;a=a.voterUserJids;return b+" ("+a.length+" votes"+(a.length>0?": "+a.map(function(a){return d("EncryptedBackupsDYIMessageProcessingUtils").getSenderName(d("WAJids").userIdFromJid(d("WAJids").unsafeCoerceToUserJid(a)))}).join(", "):"")+")"}).join("; ")}function D(a,b,c,e,f){var g;a=d("EncryptedBackupsDYISingleton").getSingleton();var h=a.getLogger();if(c.mediaMetadata==null){void h.WARN(y||(y=babelHelpers.taggedTemplateLiteralLoose(["[Protobuf] Media message is missing media data"])));return f}var i=c.mediaMetadata,j=i.mediaEntryData;i=i.plaintextHash;g=(g=(g=c.metadata)==null?void 0:g.senderId)!=null?g:"0";c=d("WAStanzaUtils").toStanzaId(c.externalId);i=d("WAHashUtils").stringToPlaintextHash(i);f.media.add(i);if(!a.isAttachmentDownloadInProgressForPlaintextHash(i)&&!a.isAttachmentDownloadCompleteForPlaintextHash(i)){void h.LOG(z||(z=babelHelpers.taggedTemplateLiteralLoose(["[Protobuf] Starting DYI media download for attachemnt with hash ",""])),d("WAHashUtils").sanitisePlaintextHash(i));a.addPlaintextHashToAttachmentDownloadsInProgress(i);if(j==null){h.ERROR(A||(A=babelHelpers.taggedTemplateLiteralLoose(["[Protobuf] Media message is missing media entry data"])));a.deletePlaintextHashFromAttachmentDownloadsInProgress(i);return f}h={author:d("WAJids").toMsgrUserJid(g),chat:d("WAJids").toMsgrUserJid(b),externalId:c};void d("EncryptedBackupsDYIMessageProcessingUtils").downloadMediaWithMediaManager(i,h,e,j)}return f}g.processEBProtobufMessagesForDYI=a}),98);
__d("MAWEncryptedBackupsDYIHandleMessageRestore",["EncryptedBackupsDYIHandleMessageRestore","EncryptedBackupsDYISingleton","I64","LSDatabaseSingleton","LSIntEnum","LSMEBTaskCreationSource","MAWBridge","MAWEBRestoreTrackingUtils","MAWEncryptedBackupsDYIProcessProtobufMessages","MAWThreadKeyUtils","WAJids","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;a=(i||d("LSIntEnum")).ofNumber(c("LSMEBTaskCreationSource").MSGR_DYI);var l=c("justknobx")._("467"),m=async function(a,b,e){d("MAWEBRestoreTrackingUtils").markEBRestoreDYI(c("LSMEBTaskCreationSource").MSGR_DYI);a=await d("MAWBridge").getBridge().sendAndReceive("backend","dyiMessageBatchQuery",{after:[b,null],chatJid:d("WAJids").createJidUtils({platform:"msgr"}).toUserJid(e),direction:"before",numMessages:l,source:c("LSMEBTaskCreationSource").MSGR_DYI});if(!a.success){d("EncryptedBackupsDYISingleton").getSingleton().getLogger().ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["Message batch query failed for thread ",": ",""])),e,a.error);d("EncryptedBackupsDYISingleton").getSingleton().deleteThreadKeyFromThreadsRestoreInProgress(d("MAWThreadKeyUtils").toStringThreadKey(e));return}b=a.value;a=b.cursorInfo;b=b.messages;var f=(a==null?void 0:a.endCursor)!=null?(j||(j=d("I64"))).of_string(a.endCursor[0]):void 0;await n(e,b,a.hasNext,f)};async function n(a,b,c,e){var f=await (k||(k=d("LSDatabaseSingleton"))).LSDatabaseSingleton;await d("EncryptedBackupsDYIHandleMessageRestore").handleMessageRangeQueryRestore(f,a,b,c,e,d("MAWEncryptedBackupsDYIProcessProtobufMessages").processEBProtobufMessagesForDYI,m)}g.taskCreationSource=a;g.MESSENGER_DYI_BATCH_SIZE=l;g.handleMAWProtobufMessageRangeQueryRestore=n}),98);
__d("MAWRestoreProtobufsFromEncryptedBackupsDeferred",["ExecutionEnvironment","I64","WAJobOrchestratorTypes","cr:10036","cr:21318","cr:21319","gkx","justknobx","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("requireDeferred")("MAWRestoreProtobufsFromEncryptedBackupsNOP").__setRef("MAWRestoreProtobufsFromEncryptedBackupsDeferred");function a(a,e,g,k,l,m,n,o,p,q,r,s,t,u,v){u===void 0&&(u=d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION);return j.load().then(async function(j){var w;(i||(i=c("ExecutionEnvironment"))).isInWorker&&b("cr:10036")!=null?(await b("cr:10036").init(),w=await b("cr:10036").getLSStorage()):w=b("cr:21318")!=null?await b("cr:21318").LSDatabaseSingleton:null;var x=function(b){return j.call(b,a,e,g,k,l!=null?(h||(h=d("I64"))).to_float(l):0,m,n!=null?(h||(h=d("I64"))).to_float(n):(h||(h=d("I64"))).to_float((h||(h=d("I64"))).max_int),o,p,q,r,s,t,u,v)};if(w!=null&&!c("gkx")("15400"))return w.runInTransaction(function(a){return x(a)},"readwrite",void 0,void 0,f.id+":100");return b("cr:21319")!=null&&c("justknobx")._("4404")?b("cr:21319").queueWork(function(){return x(null)}):x(null)})}g.call=a}),98);
__d("LSProtobufRestoreHandler",["CurrentUser","LSIntEnum","LSMEBTaskCreationSource","LSVec","MAWAsyncEBPendingQueryPromise","MAWEBRestoreTrackingUtils","MAWEBUnstoredDbMsgUtils","MAWEncryptedBackupUtils","MAWEncryptedBackupsDYIHandleMessageRestore","MAWJids","MAWJobDefinitions","MAWRestoreProtobufsFromEncryptedBackupsDeferred","WAErrorMessage","WATagsLogger","err","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o,p,q,r=["ERROR"],s,t=d("WATagsLogger").TAGS(["labyrinth_web","protobuf_restore"]);async function a(a,b,e,f,g,v,w,x,y,z,A,B,C){var D=t.TAGS([x!=null?x:"no_request_id"]);D.ERROR;D=babelHelpers.objectWithoutPropertiesLoose(D,r);var E=D;D=null;A!=null&&(D=u(A));E.LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["restoreProtobufs nativeop"])));d("MAWEBRestoreTrackingUtils").markEBRestoreProtobuf(B);b.type==="convertedProtobufs"?A=b.convertedProtobufs:(b.type,A=d("MAWEncryptedBackupUtils").convertLSTypesToJSTypesForRestoreJob(b.decryptedMessagesProtobufs));d("MAWEncryptedBackupUtils").logIfDuplicateMessagesFoundInRestore(A,"protobuf_restore");if(x!=null)try{d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"native_op_start",traceId:x});b=d("MAWJids").toUserJid(c("CurrentUser").getAccountID());b=d("MAWEBUnstoredDbMsgUtils").getUnstoredDbMsgFromProtobuf(A,a,void 0,b);if(e===!0&&b.length===0){d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"hasMoreBefore_decodedMessages_inconsistency",traceId:x});var F=A.length;E.WARN(i||(i=babelHelpers.taggedTemplateLiteralLoose(["restoreProtobufs nativeop - no decoded messages but hasMoreBefore is true, messages count after decryption: ",""])),F);t.ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["restoreProtobufs nativeop - no decoded messages but hasMoreBefore is true, messages count after decryption: ",""])),F)}d("MAWAsyncEBPendingQueryPromise").resolvePendingQueryIfPresent(x,{echoMessages:D,hasMoreAfter:g,hasMoreBefore:e,isPointQuery:w,messages:b,nextMessageTimestampMsBefore:f,protobufMessages:A,referenceTimestamp:y,requestId:x,restoreType:"protobuf",threadId:a})}catch(a){F=d("WAErrorMessage").maybeGetMessageFromError(a);E.WARN(k||(k=babelHelpers.taggedTemplateLiteralLoose(["restoreProtobufs nativeop - Failed to decode protobufs, with error: ",""])),F);t.ERROR(l||(l=babelHelpers.taggedTemplateLiteralLoose(["restoreProtobufs nativeop - Failed to decode protobufs, with error: ",""])),F);d("MAWAsyncEBPendingQueryPromise").rejectPendingQueryIfPresent(x,a instanceof Error?a:c("err")(F))}e===!0&&A.length===0&&(x!=null&&d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"hasMoreBefore_messages_inconsistency",traceId:x}),E.WARN(m||(m=babelHelpers.taggedTemplateLiteralLoose(["restoreProtobufs nativeop - no messages but hasMoreBefore is true"]))),t.ERROR(n||(n=babelHelpers.taggedTemplateLiteralLoose(["restoreProtobufs nativeop - no messages but hasMoreBefore is true"]))));b=B!=null&&(s||(s=d("LSIntEnum"))).unwrapIntEnum(B)===c("LSMEBTaskCreationSource").FTS_INDEX_EB_MESSAGES_WEB;if(b){x!=null&&d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"search_restore_end",traceId:x});d("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(x);return Promise.resolve()}F=B!=null&&(s||(s=d("LSIntEnum"))).unwrapIntEnum(B)===c("LSMEBTaskCreationSource").MSGR_DYI;if(F){E.LOG(o||(o=babelHelpers.taggedTemplateLiteralLoose(["Restoring Messenger DYI batch"])));await d("MAWEncryptedBackupsDYIHandleMessageRestore").handleMAWProtobufMessageRangeQueryRestore(a,A,e,f);x!=null&&d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"dyi_restore_end",traceId:x});d("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(x);return Promise.resolve()}c("promiseDone")(d("MAWRestoreProtobufsFromEncryptedBackupsDeferred").call("AdvancedCrypto",d("MAWJobDefinitions").toThreadJidPrimaryId(a),A,e,f,g,v,w,x,y,z,D,B,void 0,C!=null?C:void 0),function(){x!=null&&d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"native_op_end",traceId:x})},function(a){a=d("WAErrorMessage").maybeGetMessageFromError(a);E.WARN(p||(p=babelHelpers.taggedTemplateLiteralLoose(["restoreProtobufs nativeop - Failed to restore protobufs, with error: ",""])),a);t.ERROR(q||(q=babelHelpers.taggedTemplateLiteralLoose(["restoreProtobufs nativeop - Failed to restore protobufs, with error: ",""])),a);a={string:{error:a}};x!=null&&d("MAWEBRestoreTrackingUtils").markEBRestoreFail(x,!1,"native_op_reject",a)});return Promise.resolve()}function u(a){return c("LSVec").toArray(a).map(function(a){return d("MAWJobDefinitions").toEncodedEchoMessage(a)})}g.handleProtobufRestoreHelper=a;g.convertLSEchoMessageVecToArray=u}),98);
__d("MAWThreadIdToChatJidMapping",["I64","MAWAsyncEBPendingQueryPromise","MAWJidUtils","ReQL","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=new Map();async function a(a,b,c){if(l.has(b))return l.get(b);var e=d("MAWAsyncEBPendingQueryPromise").getJidFromThreadId(b);if(e!=null){l.set(b,e);return e}e=await d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.mi_act_mapping_table.index("jid")).getKeyRange((k||(k=d("I64"))).of_string(b)));if(e==null){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Cannot find MI ACT mapping table entry for threadId ",", called from ",""])),b,c);return null}var f=e.serverThreadKey;e=e.jid;a=await d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(f));if(a==null){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Cannot find thread with serverThreadKey ",", called from ",""])),(k||(k=d("I64"))).to_string(f),c);return null}f=d("MAWJidUtils").LSJidtoChatJid(e,a.threadType);if(f!=null){l.set(b,f);return f}else{d("WALogger").ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Cannot generate ChatJid from threadKey, called from ",""])),c);return null}}g.genChatJidFromThreadId=a}),98);
__d("LSRestoreProtobufs.nop",["LSProtobufRestoreHandler","MAWMpsGating","MAWThreadIdToChatJidMapping","MWEBODSEntityName.enum","MWEBODSUtils","WAJids"],(function(a,b,c,d,e,f,g){"use strict";a=async function(a,b,e,f,g,h,i,j,k,l,m,n,o,p,q){d("MWEBODSUtils").markODSForEB(c("MWEBODSEntityName.enum").MAW_EB_RESTORE_COUNTER,"restore_protobufs");if(d("MAWMpsGating").isFullMpsEnabled())return;b=null;q!=null?b=d("WAJids").validateChatJid(q):d("MWEBODSUtils").markODSForEB(c("MWEBODSEntityName.enum").MAW_EB_RESTORE_COUNTER,"restore_protobufs.no_chat_jid_provided");b==null&&(b=await d("MAWThreadIdToChatJidMapping").genChatJidFromThreadId(a,e,"LSRestoreProtobufs.nop"));b==null&&d("MWEBODSUtils").markODSForEB(c("MWEBODSEntityName.enum").MAW_EB_RESTORE_COUNTER,"restore_protobufs.no_chat_jid");return d("LSProtobufRestoreHandler").handleProtobufRestoreHelper(e,{decryptedMessagesProtobufs:f,type:"decryptedMessagesProtobufs"},g,h,i,j,k,l,m,n,o,p,b)};a.__nop_name__="LSRestoreProtobufs";g.default=a}),98);
__d("isEbEnabledWithIGDEligibilityCheck",["EBIsEbEnabled","Promise","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){return!c("gkx")("23914")?(h||(h=b("Promise"))).resolve(!1):d("EBIsEbEnabled").isEbEnabledLS(a.tables)}g.isEbEnabledWithIGDEligibilityCheck=a}),98);/*FB_PKG_DELIM*/
__d("BaseAdaptiveLayout.react",["react","react-compiler-runtime","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||(i=d("react"));i.useCallback;var k={absoluteTop:{insetInlineEnd:"xtijo5x",insetInlineStart:"x1o0tod",left:null,right:null,position:"x10l6tqk",top:"x13vifvy",$$css:!0},moreSection:{alignItems:"x6s0dn4",display:"x3nfvp2",justifyContent:"x1nhvcw1",$$css:!0},moreWrapper:{display:"x1rg5ohu",overflowX:"x6ikm8r",overflowY:"x10wlt62",position:"x1n2onr6",verticalAlign:"x16dsc37",$$css:!0},root:{overflowX:"x6ikm8r",overflowY:"x10wlt62",position:"x1n2onr6",width:"xh8yej3",zIndex:"x1ja2u2z",$$css:!0},section:{alignItems:"x6s0dn4",display:"x3nfvp2","float":"x1kmio9f",justifyContent:"x1nhvcw1",verticalAlign:"x16dsc37",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(46),e=a.maxVisibleSections,f=a.moreSection,g=a.moreSectionWidthXStyle,i=a.moreSectionXStyle,l=a.rootXStyle,m=a.sectionRole,n=a.sections,o=a.selectedSectionIndex,p=a.height,q=a.heightXStyle;a=e===void 0?Infinity:e;var r=m===void 0?"tab":m;b[0]!==a||b[1]!==n?(e=a<n.length?n.slice(0,a):n,b[0]=a,b[1]=n,b[2]=e):e=b[2];var s=e;m=a>=n.length;e=r==="tab"?"tablist":"group";b[3]!==q||b[4]!==r||b[5]!==o||b[6]!==s?(a=function(a){return s.map(function(b,d){return typeof b==="function"?b([k.section,q],d,a):j.createElement("div",babelHelpers["extends"]({"aria-selected":r==="img"?void 0:o===d},(h||(h=c("stylex"))).props(k.section,q),{key:d+"section",role:r}),b)})},b[3]=q,b[4]=r,b[5]=o,b[6]=s,b[7]=a):a=b[7];n=a;b[8]!==m||b[9]!==q||b[10]!==l?(a=(h||(h=c("stylex"))).props(k.root,q,m&&l),b[8]=m,b[9]=q,b[10]=l,b[11]=a):a=b[11];b[12]===Symbol["for"]("react.memo_cache_sentinel")?(l={className:"x14ju556 x1n2onr6"},b[12]=l):l=b[12];var t;b[13]!==m||b[14]!==n||b[15]!==e?(t=m&&j.jsx("div",babelHelpers["extends"]({"aria-hidden":!0},{className:"x6ikm8r x10wlt62 xlshs6z"},{role:e,children:n(!0)})),b[13]=m,b[14]=n,b[15]=e,b[16]=t):t=b[16];var u;b[17]!==m?(u={0:{},1:{className:"x1ey2m1c x9f619 xtijo5x x1o0tod x10l6tqk x13vifvy"}}[!!m<<0],b[17]=m,b[18]=u):u=b[18];var v;b[19]!==q||b[20]!==g||b[21]!==i?(v=(h||(h=c("stylex")))(k.moreWrapper,q,g,i),b[19]=q,b[20]=g,b[21]=i,b[22]=v):v=b[22];b[23]!==m||b[24]!==p?(g=m?{height:"calc((100% - "+p+"px) * 9999)",maxHeight:p,minHeight:0}:void 0,b[23]=m,b[24]=p,b[25]=g):g=b[25];b[26]!==q||b[27]!==f?(i=typeof f==="function"?f([k.absoluteTop,k.moreSection,q]):j.jsx("div",babelHelpers["extends"]({},(h||(h=c("stylex"))).props(k.absoluteTop,k.moreSection,q),{children:f})),b[26]=q,b[27]=f,b[28]=i):i=b[28];b[29]!==g||b[30]!==i||b[31]!==v?(m=j.jsx("div",{className:v,style:g,children:i}),b[29]=g,b[30]=i,b[31]=v,b[32]=m):m=b[32];b[33]!==n?(p=n(!1),b[33]=n,b[34]=p):p=b[34];b[35]!==e||b[36]!==m||b[37]!==p||b[38]!==u?(f=j.jsxs("div",babelHelpers["extends"]({},u,{"data-testid":void 0,role:e,children:[m,p]})),b[35]=e,b[36]=m,b[37]=p,b[38]=u,b[39]=f):f=b[39];b[40]!==f||b[41]!==t?(g=j.jsxs("div",babelHelpers["extends"]({},l,{children:[t,f]})),b[40]=f,b[41]=t,b[42]=g):g=b[42];b[43]!==g||b[44]!==a?(i=j.jsx("div",babelHelpers["extends"]({},a,{children:g})),b[43]=g,b[44]=a,b[45]=i):i=b[45];return i}g["default"]=a}),98);
__d("CometResponsiveTopNav.react",["BaseHeading.react","BaseRow.react","BaseRowItem.react","CometLink.react","FDSText.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j={row:{paddingInlineStart:"xf7dkkf",paddingInlineEnd:"xv54qhq",paddingLeft:null,paddingRight:null,$$css:!0},tabs:{overflowX:"x6ikm8r",overflowY:"x10wlt62",$$css:!0},title:{paddingInlineEnd:"xv54qhq",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(20),e=a.action,f=a.auxiliary,g=a.isTitlePrimaryHeading,h=a.tabs,k=a.title,l=a.titleURL;a=a.xstyle;g=g===void 0?!0:g;var m;b[0]!==g||b[1]!==k?(m=k!=null?i.jsx(c("BaseRowItem.react"),{xstyle:j.title,children:i.jsx(c("BaseHeading.react"),{isPrimaryHeading:g,children:i.jsx(c("FDSText.react"),{type:"headlineEmphasized1",children:k})})}):null,b[0]=g,b[1]=k,b[2]=m):m=b[2];g=m;if(l!=null&&g!=null){b[3]!==g||b[4]!==l?(k=i.jsx(c("CometLink.react"),{href:l,children:g}),b[3]=g,b[4]=l,b[5]=k):k=b[5];g=k}b[6]!==a?(m=[j.row,a],b[6]=a,b[7]=m):m=b[7];b[8]!==h?(l=i.jsx(c("BaseRowItem.react"),{expanding:!0,xstyle:j.tabs,children:h}),b[8]=h,b[9]=l):l=b[9];b[10]!==e?(k=e&&i.jsx(c("BaseRowItem.react"),{children:e}),b[10]=e,b[11]=k):k=b[11];b[12]!==f?(a=i.jsx(c("BaseRowItem.react"),{children:f}),b[12]=f,b[13]=a):a=b[13];b[14]!==g||b[15]!==m||b[16]!==l||b[17]!==k||b[18]!==a?(h=i.jsxs(c("BaseRow.react"),{verticalAlign:"center",xstyle:m,children:[g,l,k,a]}),b[14]=g,b[15]=m,b[16]=l,b[17]=k,b[18]=a,b[19]=h):h=b[19];return h}g["default"]=a}),98);
__d("FDSPivotLinkTab.react",["FDSPivotLink.react","react","stylex","useIntersectionObserver","useUnsafeRef_DEPRECATED"],(function(a,b,c,d,e,f,g){"use strict";var h=["ref"],i=["FocusItem","containerRef","disabled","hasNewContentBadge","image","imagePlacement","isHiddenOverride","label","labelIsHidden","linkType","onHidden","role","selected","xstyle"],j,k,l,m=l||(l=d("react"));b=l;var n=b.useCallback,o=b.useState,p={tab:{alignItems:"x6s0dn4",boxSizing:"x9f619",display:"x78zum5",flexShrink:"x2lah0s",minHeight:"x1hshjfz",paddingInlineStart:"x135b78x",paddingInlineEnd:"x11lfxj5",position:"x1n2onr6",zIndex:"x1vjfegm",$$css:!0}};function a(a){var b=a.ref;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var d=a.FocusItem,e=a.containerRef,f=a.disabled;f=f===void 0?!1:f;var g=a.hasNewContentBadge;g=g===void 0?!1:g;var l=a.image,q=a.imagePlacement;q=q===void 0?"left":q;var r=a.isHiddenOverride;r=r===void 0?!1:r;var s=a.label,t=a.labelIsHidden;t=t===void 0?!1:t;var u=a.linkType,v=a.onHidden,w=a.role,x=a.selected;x=x===void 0?!1:x;var y=a.xstyle;a=babelHelpers.objectWithoutPropertiesLoose(a,i);var z=o(!0),A=z[0],B=z[1],C=(j||(j=c("useUnsafeRef_DEPRECATED")))(v);C.current=v;z=n(function(a){a=a.intersectionRatio;a=a<.5;B(a);C.current&&C.current(a)},[C]);v=c("useIntersectionObserver")(z,{root:e?function(){return e.current}:null,threshold:.5});z=m.jsx("div",babelHelpers["extends"]({},(k||(k=c("stylex"))).props(p.tab,y),{ref:b,role:"none",children:m.jsx(c("FDSPivotLink.react"),{disabled:f,focusable:!r,hasNewContentBadge:g,image:l,imagePlacement:q,label:s,labelIsHidden:t,linkProps:a.linkProps,onHoverIn:a.onHoverIn,onHoverOut:a.onHoverOut,onPress:a.onPress,onPressIn:a.onPressIn,ref:v,role:w?w:"tab",selected:x,testid:void 0,type:u})}));return d?m.jsx(d,{disabled:r||A,children:z}):z}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("FDSPivotLinkTabs.react",["fbt","ix","BaseAdaptiveLayout.react","CometComponentWithKeyCommands.react","CometKeys","FDSDeferredPopoverTrigger.react","FDSPivotLinkTab.react","FocusGroup.react","fbicon","focusScopeQueries","react","react-compiler-runtime","requireDeferred","stylex"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k,l=k||(k=d("react"));b=k;b.useCallback;b.useMemo;var m=b.useRef,n=b.useState,o=c("requireDeferred")("FDSTabMenuForPivotLinks.react").__setRef("FDSPivotLinkTabs.react");e=d("FocusGroup.react").createFocusGroup(d("focusScopeQueries").tabbableScopeQuery);var p=e[0],q=e[1],r={height:{height:"xc9qbxq",$$css:!0},moreTabWidth:{width:"x1useyqa",$$css:!0},root:{marginInlineStart:"x165d6jo",marginInlineEnd:"x1lxpwgx",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(44),e=a.linkType,f=a.maxTabs,g=a.moreTabConfig,k=a.tabs;a=a.tabsContainerStyle;var x=f===void 0?Infinity:f;b[0]!==x||b[1]!==k.length?(f=function(){return Array.from({length:k.length}).map(t).filter(function(a){return a>=x})},b[0]=x,b[1]=k.length,b[2]=f):f=b[2];f=n(f);var y=f[0],z=f[1],A=m(null);if(b[3]!==y||b[4]!==k){b[6]!==k?(f=function(a){return(a=k[a])==null?void 0:a.selected},b[6]=k,b[7]=f):f=b[7];f=y.some(f);b[3]=y;b[4]=k;b[5]=f}else f=b[5];f=f;var B=f;b[8]!==y.length||b[9]!==B||b[10]!==e||b[11]!==(g==null?void 0:g.image)||b[12]!==(g==null?void 0:g.imagePlacement)||b[13]!==(g==null?void 0:g.label)||b[14]!==(g==null?void 0:g.labelIsHidden)||b[15]!==(g==null?void 0:g.xstyle)?(f=function(a,b){var f=[{command:{key:c("CometKeys").DOWN},description:h._(/*BTDS*/"Open Menu"),handler:b}];return l.jsx(c("CometComponentWithKeyCommands.react"),{commandConfigs:f,children:l.jsx(c("FDSPivotLinkTab.react"),{FocusItem:q,"aria-haspopup":"menu","aria-label":h._(/*BTDS*/"More"),image:(f=g==null?void 0:g.image)!=null?f:{icon:d("fbicon")._(i("484386"),16),type:"icon"},imagePlacement:(f=g==null?void 0:g.imagePlacement)!=null?f:"left",isHiddenOverride:y.length===0,label:(f=g==null?void 0:g.label)!=null?f:h._(/*BTDS*/"More"),labelIsHidden:(f=g==null?void 0:g.labelIsHidden)!=null?f:!0,linkType:e,onPress:b,ref:a,role:"button",selected:B,testid:void 0,xstyle:g==null?void 0:g.xstyle})})},b[8]=y.length,b[9]=B,b[10]=e,b[11]=g==null?void 0:g.image,b[12]=g==null?void 0:g.imagePlacement,b[13]=g==null?void 0:g.label,b[14]=g==null?void 0:g.labelIsHidden,b[15]=g==null?void 0:g.xstyle,b[16]=f):f=b[16];f=f;if(b[17]!==y||b[18]!==k){var C;b[20]!==k?(C=function(a){return k[a]},b[20]=k,b[21]=C):C=b[21];C=y.map(C).filter(Boolean);b[17]=y;b[18]=k;b[19]=C}else C=b[19];var D;b[22]!==C?(D={menuItems:C},b[22]=C,b[23]=D):D=b[23];b[24]!==f||b[25]!==D?(C=l.jsx(c("FDSDeferredPopoverTrigger.react"),{popoverProps:D,popoverResource:o,children:f}),b[24]=f,b[25]=D,b[26]=C):C=b[26];f=C;b[27]!==a?(D=(j||(j=c("stylex"))).props(r.root,a),b[27]=a,b[28]=D):D=b[28];a=(C=g==null?void 0:g.width)!=null?C:r.moreTabWidth;b[29]!==y||b[30]!==e||b[31]!==k?(C=k.map(function(a){return function(b,d,f){return l.createElement("div",babelHelpers["extends"]({"aria-hidden":y.includes(d)?!0:void 0},(j||(j=c("stylex"))).props(b),{key:d+"tab",role:y.includes(d)?void 0:"none"}),l.jsx(c("FDSPivotLinkTab.react"),babelHelpers["extends"]({},a,{FocusItem:q,containerRef:f?void 0:A,linkType:e,onHidden:function(a){z(function(b){return a?u(b,d):v(b,d)})},ref:a.ref,testid:void 0})))}}),b[29]=y,b[30]=e,b[31]=k,b[32]=C):C=b[32];var E;b[33]!==k?(E=k.findIndex(s),b[33]=k,b[34]=E):E=b[34];var F;b[35]!==x||b[36]!==f||b[37]!==a||b[38]!==C||b[39]!==E?(F=l.jsx(c("BaseAdaptiveLayout.react"),{height:36,heightXStyle:r.height,maxVisibleSections:x,moreSection:f,moreSectionWidthXStyle:a,sections:C,selectedSectionIndex:E}),b[35]=x,b[36]=f,b[37]=a,b[38]=C,b[39]=E,b[40]=F):F=b[40];b[41]!==F||b[42]!==D?(f=l.jsx(c("CometComponentWithKeyCommands.react"),{commandConfigs:w,children:l.jsx(p,{orientation:"horizontal",preventScrollOnFocus:!0,tabScopeQuery:d("focusScopeQueries").tabbableScopeQuery,wrap:!0,children:l.jsx("div",babelHelpers["extends"]({},D,{ref:A,children:F}))})}),b[41]=F,b[42]=D,b[43]=f):f=b[43];return f}function s(a){return a.selected}function t(a,b){return b}function u(a,b){return a.includes(b)?a:[].concat(a,[b]).sort(function(a,b){return a-b})}function v(a,b){return a.includes(b)?a.filter(function(a){return a!==b}):a}var w=[{command:{key:c("CometKeys").LEFT},description:h._(/*BTDS*/"Previous item"),handler:function(){}},{command:{key:c("CometKeys").RIGHT},description:h._(/*BTDS*/"Next item"),handler:function(){}}];g["default"]=a}),226);
__d("XFacebookHelpCenterContentControllerRouteBuilder",["jsRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsRouteBuilder")("/help/{cms_id}/{?cms_title}/",Object.freeze({region_hint:[],expand_folders:[]}),void 0);b=a;g["default"]=b}),98);/*FB_PKG_DELIM*/
__d("CometMessagingJewelDropdownOnboardingPostDecisionUpsell.react",["CometMessagingJewelDropdown.entrypoint","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsQPLSource.enum","deferredLoadComponent","react","react-compiler-runtime","requireDeferredForDisplay","usePushPage"],(function(a,b,c,d,e,f,g){"use strict";var h,i;b=i||d("react");var j=h||(h=c("react"));b.useCallback;var k=b.useEffect,l=c("deferredLoadComponent")(c("requireDeferredForDisplay")("MWEBWebOnboardingPostDecisionDialogContent.react").__setRef("CometMessagingJewelDropdownOnboardingPostDecisionUpsell.react"));function a(a){var b=d("react-compiler-runtime").c(11),e=a.onClose,f=a.onSkip;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(a=[],b[0]=a):a=b[0];k(m,a);b[1]===Symbol["for"]("react.memo_cache_sentinel")?(a={},b[1]=a):a=b[1];a=c("usePushPage")(c("CometMessagingJewelDropdown.entrypoint"),a);var g=a[0];b[2]!==e||b[3]!==g?(a=function(){g({onClose:e})},b[2]=e,b[3]=g,b[4]=a):a=b[4];var h=a;b[5]!==h||b[6]!==f?(a=function(){d("MWChatEncryptedBackupsLogging").cancelFlow({cancelEndPoint:"unmount",event:d("MWChatEncryptedBackupsQPLEvents").backupSetupQplEvent}),f(),h()},b[5]=h,b[6]=f,b[7]=a):a=b[7];a=a;var i;b[8]!==h||b[9]!==a?(i=j.jsx(l,{onClose:h,onSkip:a,source:c("MWChatEncryptedBackupsQPLSource.enum").JEWEL_ONBOARDING_SOFTBLOCK,withCloseButton:!1}),b[8]=h,b[9]=a,b[10]=i):i=b[10];return i}function m(){c("CometMessagingJewelDropdown.entrypoint").root.preload()}g["default"]=a}),98);
__d("FBIconCloudArrowUpFilled12.svg.react",["XPlatReactSVG","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){return i.jsxs(d("XPlatReactSVG").Svg,babelHelpers["extends"]({viewBox:"0 0 12 13",width:"1em",height:"1em",fill:"currentColor",title:a.title},a,{children:[a.children!=null&&i.jsx(d("XPlatReactSVG").Defs,{children:a.children}),i.jsx(d("XPlatReactSVG").G,{fillRule:"evenodd",transform:"translate(-450 -1073)",children:i.jsx(d("XPlatReactSVG").Path,{d:"M459.968 1078.513c-.23-1.715-1.67-3.003-3.468-3.013-1.366 0-2.358.53-2.835 1.502-1.263.05-2.358 1.155-2.438 2.444-.834.297-1.227 1.324-1.227 2.054 0 .83.534 2 1.722 2h3.528v-3.44l-.97.97a.75.75 0 1 1-1.06-1.06l2.25-2.25a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 1 1-1.06 1.06l-.97-.97v3.44h3.04c1.302 0 2.21-1.317 2.21-2.5 0-1.11-.855-2.346-2.032-2.487"})})]}))}a.displayName=a.name+" [from "+f.id+"]";a._isSVG=!0;b=a;g["default"]=b}),98);
__d("MWEBJewelDialogPage.react",["fbt","BaseMultiPageViewContext","CometTopNavListDropdownCard.react","FDSDialogLoadingStateImpl.react","Locale","MWXCircleButton.react","MWXColumn.react","MWXColumnItem.react","MWXIconArrowLeft","MWXIconArrowRight","MWXLink.react","MWXRow.react","MWXRowItem.react","MWXText.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;var k=b.use;b.useMemo;var l=d("Locale").isRTL();function a(a){var b=d("react-compiler-runtime").c(20),e=a.children,f=a.footer,g=a.onBack,i=a.onClose,m=a.withBackButton;a=a.withCloseButton;m=m===void 0?!0:m;a=a===void 0?!0:a;var n=k(c("BaseMultiPageViewContext")),o;b[0]!==n?(o=n!=null?babelHelpers["extends"]({},n,{fallback:j.jsx(c("CometTopNavListDropdownCard.react"),{useFullHeight:!0,useMaxHeight:!0,children:j.jsx(c("FDSDialogLoadingStateImpl.react"),{})})}):null,b[0]=n,b[1]=o):o=b[1];n=o;o=n;b[2]!==g||b[3]!==i||b[4]!==m||b[5]!==a?(n=(g!=null||i!=null)&&j.jsxs(c("MWXRow.react"),{paddingHorizontal:8,paddingVertical:8,children:[g!=null&&m&&j.jsx(c("MWXRowItem.react"),{children:j.jsx("div",babelHelpers["extends"]({className:"x1y1aw1k xf159sx xwib8y2 xmzvs34"},{children:j.jsx(c("MWXCircleButton.react"),{color:"primary",icon:l?c("MWXIconArrowRight"):c("MWXIconArrowLeft"),label:h._(/*BTDS*/"Back"),onPress:g,size:32})}))}),j.jsx(c("MWXRowItem.react"),{children:null,expanding:!0}),i!=null&&a&&j.jsx(c("MWXRowItem.react"),{children:j.jsx("div",babelHelpers["extends"]({className:"xyamay9 xv54qhq x1l90r2v xf7dkkf"},{children:j.jsx(c("MWXText.react"),{color:"blueLink",type:"bodyLink3",children:j.jsx(c("MWXLink.react"),{onClick:i,children:h._(/*BTDS*/"Skip")})})}))})]}),b[2]=g,b[3]=i,b[4]=m,b[5]=a,b[6]=n):n=b[6];b[7]!==e?(g=j.jsx(c("MWXColumnItem.react"),{paddingHorizontal:16,children:e}),b[7]=e,b[8]=g):g=b[8];b[9]!==f?(i=j.jsx(c("MWXColumnItem.react"),{children:f}),b[9]=f,b[10]=i):i=b[10];b[11]!==g||b[12]!==i?(m=j.jsxs(c("MWXColumn.react"),{expanding:!0,verticalAlign:"center",children:[g,i]}),b[11]=g,b[12]=i,b[13]=m):m=b[13];b[14]!==n||b[15]!==m?(a=j.jsx(c("CometTopNavListDropdownCard.react"),{useFullHeight:!0,useMaxHeight:!0,children:j.jsxs(c("MWXColumn.react"),{expanding:!0,children:[n,m]})}),b[14]=n,b[15]=m,b[16]=a):a=b[16];b[17]!==o||b[18]!==a?(e=j.jsx(c("BaseMultiPageViewContext").Provider,{value:o,children:a}),b[17]=o,b[18]=a,b[19]=e):e=b[19];return e}g["default"]=a}),226);
__d("MWEBDialogPage.react",["MWEBJewelDialogPage.react","MWIsJewelContext","MWXDialogHeader.react","MWXDialogPage.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.use;function a(a){var b=d("react-compiler-runtime").c(16),e=a.children,f=a.footer,g=a.onBack,h=a.onClose,k=a.withBackButton;a=a.withCloseButton;k=k===void 0?!0:k;a=a===void 0?!0:a;var l=j(c("MWIsJewelContext"));if(l){b[0]!==e||b[1]!==f||b[2]!==g||b[3]!==h||b[4]!==k||b[5]!==a?(l=i.jsx(c("MWEBJewelDialogPage.react"),{children:e,footer:f,onBack:g,onClose:h,withBackButton:k,withCloseButton:a}),b[0]=e,b[1]=f,b[2]=g,b[3]=h,b[4]=k,b[5]=a,b[6]=l):l=b[6];return l}else{l=f!=null?f:null;f=g!=null?g:void 0;var m=h!=null?h:void 0;k=k&&g!=null;g=a&&h!=null;b[7]!==f||b[8]!==m||b[9]!==k||b[10]!==g?(a=i.jsx(c("MWXDialogHeader.react"),{mdsTitleLayout:"block",onBack:f,onClose:m,withBackButton:k,withCloseButton:g,withoutDivider:!0}),b[7]=f,b[8]=m,b[9]=k,b[10]=g,b[11]=a):a=b[11];b[12]!==e||b[13]!==l||b[14]!==a?(h=i.jsx(c("MWXDialogPage.react"),{footer:l,header:a,children:e}),b[12]=e,b[13]=l,b[14]=a,b[15]=h):h=b[15];return h}}g["default"]=a}),98);
__d("MWEBPinCodeSetupDialog.entrypoint",["JSResourceForInteraction"],(function(a,b,c,d,e,f,g){"use strict";a={getPreloadProps:function(){return{queries:{}}},root:c("JSResourceForInteraction")("MWEBPinCodeSetupDialog.react").__setRef("MWEBPinCodeSetupDialog.entrypoint")};g["default"]=a}),98);
__d("MWXIconCloudUpload",["MWXSvgIcon","SVGIcon","cr:22275","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=d("MWXSvgIcon").mwxSvgIcon(d("SVGIcon").svgIcon(b("cr:22275")),c("gkx")("23219"));g["default"]=a}),98);
__d("MWEBWebOnboardingPostDecisionDialogContent.react",["fbt","AddOnStartOverride.react","CometRelay","MWChatEncryptedBackupsQPLEvents","MWEBDialogPage.react","MWEBOnboardingDismissOnboardingUpsellsInRelay","MWEBPinCodeSetupDialog.entrypoint","MWEncryptedBackupsRetrieveQplLoggingAnnotations","MWXColumn.react","MWXColumnItem.react","MWXDialogFooter.react","MWXIconCloudUpload","MWXIconForListCell.react","MWXList.react","MWXListCell.react","MWXText.react","MWXTextPairing.react","QPLUserFlow","cr:13913","cr:2060","react","react-compiler-runtime","useAsyncReStore","useLabyrinthLogging","usePushPage","useVisibilityObserver"],(function(a,b,c,d,e,f,g,h){"use strict";var i=["onHighIntent"],j,k=j||(j=d("react"));j.useCallback;function l(a){var b=d("react-compiler-runtime").c(17),e=a.instanceKey,f=a.onClose,g=a.onSkip,j=a.withCloseButton;b[0]===Symbol.for("react.memo_cache_sentinel")?(a={},b[0]=a):a=b[0];a=c("usePushPage")(c("MWEBPinCodeSetupDialog.entrypoint"),a);var l=a[0];a=a[1];if(b[1]!==a){a.onHighIntent;var m=babelHelpers.objectWithoutPropertiesLoose(a,i);m=m;b[1]=a;b[2]=m}else m=b[2];var n=d("CometRelay").useRelayEnvironment();b[3]!==n||b[4]!==f?(a=function(){d("MWEBOnboardingDismissOnboardingUpsellsInRelay").dismissOnboardingUpsellsInRelayStore({environment:n,upsellsToDismiss:"all"}),f()},b[3]=n,b[4]=f,b[5]=a):a=b[5];var o=a;b[6]!==l||b[7]!==e||b[8]!==f||b[9]!==g||b[10]!==o||b[11]!==j?(a=function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").backupSetupQplEvent,"WEB_ONBOARDING_POST_DECISION_DIALOG_NEXT",{instanceKey:e}),l({instanceKey:e,onClose:f,onSkip:g,onStart:o,qplEventName:d("MWChatEncryptedBackupsQPLEvents").backupSetupQplEvent,withCloseButton:j})},b[6]=l,b[7]=e,b[8]=f,b[9]=g,b[10]=o,b[11]=j,b[12]=a):a=b[12];a=a;var p;b[13]===Symbol.for("react.memo_cache_sentinel")?(p=h._(/*BTDS*/"Back up chats"),b[13]=p):p=b[13];b[14]!==m||b[15]!==a?(p=k.jsx(c("MWXDialogFooter.react"),{primaryCallToAction:babelHelpers.extends({label:p,onPress:a},m)}),b[14]=m,b[15]=a,b[16]=p):p=b[16];return p}function a(a){var e=d("react-compiler-runtime").c(26),f=a.instanceKey,g=a.onClose,i=a.onSkip,j=a.source;a=a.withCloseButton;var m=d("useLabyrinthLogging").useLabyrinthLoggingFlow(),n=m.startFlow,o=c("useAsyncReStore")();e[0]!==o||e[1]!==f||e[2]!==j||e[3]!==n?(m=async function(){d("MWEncryptedBackupsRetrieveQplLoggingAnnotations").encryptedBackupsRetrieveQplLoggingAnnotations({db:await o,onFetch:function(a){var b=a.ebsmWiped,e=a.firstUpsellTime;a=a.hasUserOnboardedBefore;n({additionalAnnotations:{eb_session_identifier:e,ebsm_wiped:b,has_user_onboarded_before:a,requested_setup_type:"pin_code"},event:d("MWChatEncryptedBackupsQPLEvents").backupSetupQplEvent,instanceKey:f,source:j});c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").backupSetupQplEvent,"WEB_ONBOARDING_POST_DECISION_DIALOG",{instanceKey:f})}})},e[0]=o,e[1]=f,e[2]=j,e[3]=n,e[4]=m):m=e[4];var p=m;e[5]!==p?(m={onVisible:function(){return void p()}},e[5]=p,e[6]=m):m=e[6];m=c("useVisibilityObserver")(m);var q;e[7]!==f||e[8]!==g||e[9]!==i||e[10]!==a?(q=k.jsx(l,{instanceKey:f,onClose:g,onSkip:i,withCloseButton:a}),e[7]=f,e[8]=g,e[9]=i,e[10]=a,e[11]=q):q=e[11];e[12]===Symbol.for("react.memo_cache_sentinel")?(g=k.jsx(c("MWXColumnItem.react"),{align:"center",children:k.jsx(b("cr:2060"),{})}),e[12]=g):g=e[12];e[13]===Symbol.for("react.memo_cache_sentinel")?(a=k.jsx(c("MWXColumnItem.react"),{children:k.jsx(c("MWXText.react"),{align:"center",type:"headlineEmphasized2",children:h._(/*BTDS*/"Keep your chat history safe")})}),e[13]=a):a=e[13];var r;e[14]===Symbol.for("react.memo_cache_sentinel")?(r=k.jsx(c("AddOnStartOverride.react"),{children:k.jsx(c("MWXIconForListCell.react"),{icon:b("cr:13913"),size:"large"})}),e[14]=r):r=e[14];var s;e[15]===Symbol.for("react.memo_cache_sentinel")?(s=h._(/*BTDS*/"Right now, messages are only saved on your browser."),e[15]=s):s=e[15];e[16]===Symbol.for("react.memo_cache_sentinel")?(r=k.jsx(c("MWXListCell.react"),{addOnStart:r,content:k.jsx(c("MWXTextPairing.react"),{body:s,bodyColor:"secondary",headline:h._(/*BTDS*/"Your chats aren\u2019t being backed up"),level:4})}),e[16]=r):r=e[16];e[17]===Symbol.for("react.memo_cache_sentinel")?(s=k.jsx(c("AddOnStartOverride.react"),{children:k.jsx(c("MWXIconForListCell.react"),{icon:c("MWXIconCloudUpload"),size:"large"})}),e[17]=s):s=e[17];var t;e[18]===Symbol.for("react.memo_cache_sentinel")?(t=h._(/*BTDS*/"Secure storage backs up your chats so you can restore them if you lose or replace your device."),e[18]=t):t=e[18];e[19]===Symbol.for("react.memo_cache_sentinel")?(r=k.jsx(c("MWXColumnItem.react"),{paddingHorizontal:0,children:k.jsxs(c("MWXList.react"),{children:[r,k.jsx(c("MWXListCell.react"),{addOnStart:s,content:k.jsx(c("MWXTextPairing.react"),{body:t,bodyColor:"secondary",headline:h._(/*BTDS*/"Start backing up your chats with secure storage"),level:4})})]})}),e[19]=r):r=e[19];e[20]!==m?(s=k.jsxs(c("MWXColumn.react"),{paddingTop:0,paddingVertical:8,ref:m,spacing:16,children:[g,a,r]}),e[20]=m,e[21]=s):s=e[21];e[22]!==i||e[23]!==s||e[24]!==q?(t=k.jsx(c("MWEBDialogPage.react"),{footer:q,onClose:i,children:s}),e[22]=i,e[23]=s,e[24]=q,e[25]=t):t=e[25];return t}g.default=a}),226);
__d("MWFDSCloudUpload.svg.react",["FBIconCloudArrowUpFilled12.svg.react"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("FBIconCloudArrowUpFilled12.svg.react")}),98);/*FB_PKG_DELIM*/
__d("CometComposerViewStateContext",["createEmptyCometComposerViewState","react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h||d("react");b=a.createContext(c("createEmptyCometComposerViewState")());g["default"]=b}),98);
__d("CometGroupsPathingFunnelLogger",[],(function(a,b,c,d,e,f){"use strict";function a(a){switch(a){case"1635855486666999":return"REACTION_MENU_LIKE";case"1678524932434102":return"REACTION_MENU_LOVE";case"478547315650144":return"REACTION_MENU_WOW";case"115940658764963":return"REACTION_MENU_HAHA";case"908563459236466":return"REACTION_MENU_SORRY";case"444813342392137":return"REACTION_MENU_ANGER";case"613557422527858":return"REACTION_MENU_SUPPORT";default:return void 0}}function b(a,b,c){return}function c(a){return}function d(a,b){return}function e(a,b,c){return}function g(a){return}e={addEventSharedPoint:e,addPoint:c,addSharedPoint:d,endCancel:g,getReactionQPLPointFromReaction:a,start:b};f["default"]=e}),66);
__d("CometUFIFunnelLogger",["CometUFIFunnelLoggerConstants","QPLUserFlow","qpl","recoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h={};function i(a){if(h[a])return;c("QPLUserFlow").start(c("qpl")._(3747131,"4389"),{instanceKey:a});h[a]=!0}function j(a){c("QPLUserFlow").endSuccess(c("qpl")._(3747131,"4389"),{instanceKey:a}),h[a]=!1}function k(a,b){h[a]||i(a),c("QPLUserFlow").addPoint(c("qpl")._(3747131,"4389"),b,{instanceKey:a})}function l(a){if(a>2||a<0){c("recoverableViolation")("Depth should be 0 to 2.","ufi2");return}switch(a){case 0:return d("CometUFIFunnelLoggerConstants").CometUFIFunnelLoggerEvents.LEVEL_0_PAGER_CLICK;case 1:return d("CometUFIFunnelLoggerConstants").CometUFIFunnelLoggerEvents.LEVEL_1_PAGER_CLICK;case 2:return d("CometUFIFunnelLoggerConstants").CometUFIFunnelLoggerEvents.LEVEL_2_PAGER_CLICK}}function m(a){switch(a){case"1635855486666999":return d("CometUFIFunnelLoggerConstants").CometUFIFunnelLoggerEvents.REACTION_MENU_LIKE;case"1678524932434102":return d("CometUFIFunnelLoggerConstants").CometUFIFunnelLoggerEvents.REACTION_MENU_LOVE;case"478547315650144":return d("CometUFIFunnelLoggerConstants").CometUFIFunnelLoggerEvents.REACTION_MENU_WOW;case"115940658764963":return d("CometUFIFunnelLoggerConstants").CometUFIFunnelLoggerEvents.REACTION_MENU_HAHA;case"908563459236466":return d("CometUFIFunnelLoggerConstants").CometUFIFunnelLoggerEvents.REACTION_MENU_SORRY;case"444813342392137":return d("CometUFIFunnelLoggerConstants").CometUFIFunnelLoggerEvents.REACTION_MENU_ANGER;case"613557422527858":return d("CometUFIFunnelLoggerConstants").CometUFIFunnelLoggerEvents.REACTION_MENU_SUPPORT}}a={addPoint:function(a,b){k(a,b)},endSuccess:function(a){j(a)},getPagerEventFromDepth:function(a){l(a)},getReactionMenuEventFromReaction:function(a){m(a)},start:function(a){i(a)}};b=a;g["default"]=b}),98);
__d("ContentAccessAndControlEventType",[],(function(a,b,c,d,e,f){a=Object.freeze({CLICK_BEGIN:"content_access_and_control_click_begin",CLICK_CANCEL:"content_access_and_control_click_cancel",CLICK_CONFIRM:"content_access_and_control_click_confirm",IMPRESSION:"content_access_and_control_impression",ENT_STORY_ACTION:"content_access_and_control_ent_story_action",SERVER_MUTATION_BEGIN:"content_access_and_control_mutation_begin",SERVER_MUTATION_FAILURE:"content_access_and_control_mutation_failure",SERVER_MUTATION_SUCCESS:"content_access_and_control_mutation_success",TRASH_METADATA_NOT_FOUND:"content_access_and_control_trash_metadata_not_found"});f["default"]=a}),66);
__d("DelightsTextTriggerPostTappedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1497");b=d("FalcoLoggerInternal").create("delights_text_trigger_post_tapped",a);e=b;g["default"]=e}),98);
__d("FDSCheckmarkFilled24Icon",["cr:13975"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:13975")}),98);
__d("FDSCheckmarkFilled24PNGIcon.react",["ix","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";a=d("fbicon")._(h("477815"),24);b=a;g["default"]=b}),98);
__d("FanFundingClientEventsFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("6478");b=d("FalcoLoggerInternal").create("fan_funding_client_events",a);e=b;g["default"]=e}),98);
__d("FbSharingEventFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("4274");b=d("FalcoLoggerInternal").create("fb_sharing_event",a);e=b;g["default"]=e}),98);
__d("FbSharingSendFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("4275");b=d("FalcoLoggerInternal").create("fb_sharing_send",a);e=b;g["default"]=e}),98);
__d("OptimisticLoadingTypeEnum",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({PENDING:"PENDING",SHOW_ANIMATION:"SHOW_ANIMATION",SHOW_LOADER:"SHOW_LOADER",SHOW_POST_PREVIEW:"SHOW_POST_PREVIEW",SHOW_PROGRESS_BAR:"SHOW_PROGRESS_BAR"});f["default"]=a}),66);
__d("TokenizeUtil",["nullthrows"],(function(a,b,c,d,e,f,g){var h=/[ ]+/g,i=/[^ ]+/g;f=new RegExp("[^ "+l()+"]+|"+a(),"g");var j=new RegExp(a(),"g"),k=1e3;function l(){return".,+*?$|#{}()'\\^\\-\\[\\]\\\\\\/!@%\"~=<>_:;\u30fb\u3001\u3002\u3008-\u3011\u3014-\u301f\uff1a-\uff1f\uff01-\uff0f\uff3b-\uff40\uff5b-\uff65\u2e2e\u061f\u066a-\u066c\u061b\u060c\u060d\ufd3e\ufd3f\u1801\u0964\u104a\u104b\u2010-\u2027\u2030-\u205e\xa1-\xb1\xb4-\xb8\xba\xbb\xbf"}function a(){return"["+l()+"]"}var m={},n={a:"\u0430 \xe0 \xe1 \xe2 \xe3 \xe4 \xe5 \u0101",b:"\u0431",c:"\u0446 \xe7 \u010d",d:"\u0434 \xf0 \u010f \u0111",e:"\u044d \u0435 \xe8 \xe9 \xea \xeb \u011b \u0113",f:"\u0444",g:"\u0433 \u011f \u0123",h:"\u0445 \u0127",i:"\u0438 \xec \xed \xee \xef \u0131 \u012b",j:"\u0439",k:"\u043a \u0138 \u0137",l:"\u043b \u013e \u013a \u0140 \u0142 \u013c",m:"\u043c",n:"\u043d \xf1 \u0148 \u0149 \u014b \u0146",o:"\u043e \xf8 \xf6 \xf5 \xf4 \xf3 \xf2",p:"\u043f",r:"\u0440 \u0159 \u0155",s:"\u0441 \u015f \u0161 \u017f",t:"\u0442 \u0165 \u0167 \xfe",u:"\u0443 \u044e \xfc \xfb \xfa \xf9 \u016f \u016b",v:"\u0432",y:"\u044b \xff \xfd",z:"\u0437 \u017e",ae:"\xe6",oe:"\u0153",ts:"\u0446",ch:"\u0447",ij:"\u0133",sh:"\u0448",ss:"\xdf",ya:"\u044f"};for(var o in n){var p=n[o].split(" ");for(var q=0;q<p.length;q++)m[p[q]]=o}function b(a){return a.replace(j," ")}function r(a){return a.replace(h," ")}function s(a){a=a.toLowerCase();var b="",c;for(var d=a.length;d--;)c=a.charAt(d),b=(m[c]||c)+b;return r(b)}function t(a,b){b===void 0&&(b=i);var c=[],d=b.exec(a);while(d){var e=d[0];c.push(e);d=b.exec(a)}return c}function d(a,b){b===void 0&&(b=i);var c={},d=0;return function(e,f){if(!Object.prototype.hasOwnProperty.call(c,e)){d>=k&&(c={},d=0);var g=s(e),h=a(g);c[e]={value:e,flatValue:g,tokens:t(h,b),isPrefixQuery:!!h&&h[h.length-1]!=" "};d++}f!=null&&f!==!1&&c[e].sortedTokens===void 0&&(c[e].sortedTokens=c[e].tokens.slice(),c[e].sortedTokens.sort(function(a,b){return b.length-a.length}));return c[e]}}var u=d(b),v=d(function(a){return a},f);function e(a,b,d){var e=a=="query"||a=="query_punc",f=a=="aligned",g=a=="query_punc"?v:u;b=g(b,a=="prefix");var h=a=="prefix"?c("nullthrows")(b.sortedTokens):b.tokens,i=g(d).tokens,j={},k=b.isPrefixQuery&&(e||f)?h.length-1:null;g=function(b,c){for(var d=0;d<i.length;++d){var g=i[d];if(!j[d]&&(g==b||((e||f)&&c===k||a=="prefix")&&g.indexOf(b)===0))return j[d]=!0;if(f&&!j[d])return!1}return!1};return Boolean(h.length&&h.every(g))}p={collapse:r,flatten:s,parse:u,parseIncludingPunctuations:v,getPunctuation:a,makeParse:d,isExactMatch:e.bind(null,"exact"),isQueryMatch:e.bind(null,"query"),isQueryMatchIncludingPunctuations:e.bind(null,"query_punc"),isAlignedMatch:e.bind(null,"aligned"),isPrefixMatch:e.bind(null,"prefix"),tokenize:t};q=p;g["default"]=q}),98);
__d("WhatsappDeeplinkClickedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("2");b=d("FalcoLoggerInternal").create("whatsapp_deeplink_clicked",a);e=b;g["default"]=e}),98);
__d("WhatsappDeeplinkRenderedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("20");b=d("FalcoLoggerInternal").create("whatsapp_deeplink_rendered",a);e=b;g["default"]=e}),98);
__d("baseTypeaheadContainsMatchBuilder",["escapeRegex"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=a.query;var b=new RegExp(""+c("escapeRegex")(a),"i");return function(a){return b.test((a=a.label)!=null?a:"")}}g["default"]=a}),98);
__d("cometComposerQPLLogger",["QPLUserFlow","qpl"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a.type){case"COMPOSER_ENTRY":break;case"COMPOSER_FEATURE_INTENT":break;case"COMPOSER_POST":break;case"COMPOSER_POST_MUTATION_START":break;case"COMPOSER_POST_SUCCESS":h(a.fields);break;case"COMPOSER_POST_FAILURE":i(a.fields);break;case"COMPOSER_POST_CANCEL":j(a.fields);break;case"COMPOSER_POST_TERMINAL":break;case"COMPOSER_POST_SERVER_CONTENT_RENDERED":break;case"COMPOSER_PUBLISH_FLOW_OPTIMISTIC_PROCESS":break;default:break}}function h(a){a=(a=a.payload)==null?void 0:a.qplEvent;if(a!=null)switch(a){case c("qpl")._(37631558,"4977"):c("QPLUserFlow").addPoint(c("qpl")._(37631558,"4977"),"composer_post_success");c("QPLUserFlow").endSuccess(c("qpl")._(37631558,"4977"));break;default:break}}function i(a){var b;b=(b=a.payload)==null?void 0:b.qplEvent;if(b!=null){a=a.errorDescription!=null?a.errorDescription:"";switch(b){case c("qpl")._(37631558,"4977"):c("QPLUserFlow").endFailure(c("qpl")._(37631558,"4977"),"composer_post_cancel",{debugInfo:a});break;default:break}}}function j(a){a=(a=a.payload)==null?void 0:a.qplEvent;if(a!=null)switch(a){case c("qpl")._(37631558,"4977"):c("QPLUserFlow").addPoint(c("qpl")._(37631558,"4977"),"composer_post_cancel");c("QPLUserFlow").endCancel(c("qpl")._(37631558,"4977"));break;default:break}}g["default"]=a}),98);/*FB_PKG_DELIM*/
__d("GroupsCometChatsEngagementLoggerWithDefaultExport",["GroupsCometChatsEngagementLogger"],(function(a,b,c,d,e,f,g){"use strict";a={log:d("GroupsCometChatsEngagementLogger").log};g["default"]=a}),98);
__d("LSDeleteMessage",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.filter(b.db.table(12).fetch([[[a[1]]],"messageId"]),function(c){return c.messageId===a[1]&&b.i64.eq(c.threadKey,a[0])}),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxDeleteMessageStoredProcedure";a.__tables__=["messages"];e.exports=a}),null);
__d("LSShimThreadPinMessage.nop",["FBLogger","I64","ReQL"],(function(a,b,c,d,e,f,g){"use strict";var h;a=async function(a,b,e,f,g){if(g==null){c("FBLogger")("messenger_web_pinned_messages").warn("threadKey is null in LSShimThreadPinMessage");return}b=await d("ReQL").toArrayAsync(d("ReQL").fromTableDescending(a.client_web_pinned_messages).getKeyRange(g,e));await Promise.all(b.map(function(b){return a.client_web_pinned_messages.delete(b.threadKey,b.offlineThreadingId,b.pinnedTimestampMs)}));await a.client_web_pinned_messages.put({offlineThreadingId:e,pinnedTimestampMs:f!=null?f:(h||(h=d("I64"))).of_float(Date.now()),threadKey:g})};a.__nop_name__="LSShimThreadPinMessage";g.default=a}),98);
__d("LSShimThreadUnpinMessage.nop",["FBLogger","ReQL"],(function(a,b,c,d,e,f,g){"use strict";a=async function(a,b,e,f){if(f==null){c("FBLogger")("messenger_web_pinned_messages").warn("threadKey is null in LSShimThreadUnpinMessage");return}b=await d("ReQL").toArrayAsync(d("ReQL").fromTableDescending(a.client_web_pinned_messages).getKeyRange(f,e));await Promise.all(b.map(function(b){return a.client_web_pinned_messages.delete(b.threadKey,b.offlineThreadingId,b.pinnedTimestampMs)}))};a.__nop_name__="LSShimThreadUnpinMessage";g.default=a}),98);
__d("LSSetOrUnsetPinnedMessage",["LSShimThreadPinMessage.nop","LSShimThreadUnpinMessage.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[];return c.sequence([function(d){return c.i64.eq(a[2],c.i64.cast([0,1]))||c.i64.eq(a[2],c.i64.cast([0,2]))?c.nativeOperation(b("LSShimThreadPinMessage.nop"),a[0],a[1],a[3]):c.nativeOperation(b("LSShimThreadUnpinMessage.nop"),a[0],a[3])},function(a){return c.resolve(d)}])}a.__sproc_name__="LSE2EEMessagingMetadataMailboxSetOrUnsetPinnedMessageStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSSetPinnedMessage",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=new c.Map(),d[0].set("thread_key",a[0]),d[0].set("message_id",a[1]),d[0].set("pinned_message_state",a[3]),d[1]=c.toJSON(d[0]),c.storedProcedure(b("LSIssueNewTask"),"set_pinned_message_search",c.i64.cast([0,751]),d[1],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))},function(b){return c.i64.eq(a[3],c.i64.cast([0,1]))?c.sequence([function(b){return c.forEach(c.db.table(205).fetch([[[a[0],a[1]]]]),function(a){return a["delete"]()})},function(b){return c.forEach(c.filter(c.db.table(205).fetch([[[a[0],a[1],a[2]]]]),function(b){return c.i64.eq(b.threadKey,a[0])&&b.messageId===a[1]&&c.i64.eq(b.pinnedTimestampMs,a[2])&&c.i64.lt(b.authorityLevel,c.i64.cast([0,80]))}),function(a){return a["delete"]()})},function(b){return c.db.table(205).add({threadKey:a[0],messageId:a[1],pinnedTimestampMs:a[2],authorityLevel:c.i64.cast([0,80])})}]):c.forEach(c.db.table(205).fetch([[[a[0],a[1]]]]),function(a){return a["delete"]()})}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxSetPinnedMessageStoredProcedure";a.__tables__=["msg_pinned_messages_v2"];e.exports=a}),null);
__d("MlsMessageActionFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1401");b=d("FalcoLoggerInternal").create("mls_message_action",a);e=b;g["default"]=e}),98);
__d("MWLogMessageAction",["I64","MWLSContactTypeExactUtils","MlsMessageActionFalcoEvent","ReQL","coerceMessagingThreadTypeToLSThreadType"],(function(a,b,c,d,e,f,g){"use strict";var h;async function a(a,b,e,f,g,i,j,k,l,m,n){var o,p=await (o=d("ReQL")).firstAsync(o.fromTableAscending(a.tables.threads).getKeyRange(e)),q=await o.toArrayAsync(o.fromTableAscending(a.tables.participants).getKeyRange(e)),r=await o.firstAsync(o.mergeJoin(o.fromTableAscending(a.tables.participants).getKeyRange(e),o.fromTableAscending(a.tables.contacts)).filter(function(a){a[0];a=a[1].contactTypeExact;return d("MWLSContactTypeExactUtils").isIgContact(a)}))!=null;p!=null&&c("MlsMessageActionFalcoEvent").log(function(){return{action:g,browser_window_height:window.innerHeight,browser_window_width:window.innerWidth,device_screen_height:window.screen.height,device_screen_width:window.screen.width,error_text:j,extra:i,group_size:String(q.length),is_xac_thread:r,ls_thread_type:c("coerceMessagingThreadTypeToLSThreadType")(p.threadType),message_type:m!=null?m:"text",mid:b,reaction:k,recipient_id:l!=null?(h||(h=d("I64"))).to_string(l):void 0,sender_id:(h||(h=d("I64"))).to_string(n),source:f,thread_id:h.to_string(e)}})}b={log:a};g.default=b}),98);
__d("MWXDialog.react",["MWXColumn.react","MWXColumnItem.react","cr:3020","cr:6827","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h=["children","hasTextOnlyContent"],i=["scrollAreaFocusProps"],j,k=j||d("react");function a(a){var e=d("react-compiler-runtime").c(15),f,g,j;e[0]!==a?(g=a.children,j=a.hasTextOnlyContent,f=babelHelpers.objectWithoutPropertiesLoose(a,h),e[0]=a,e[1]=f,e[2]=g,e[3]=j):(f=e[1],g=e[2],j=e[3]);if(b("cr:3020")!=null){if(e[4]!==f){a=f;a.scrollAreaFocusProps;a=babelHelpers.objectWithoutPropertiesLoose(a,i);a=a;e[4]=f;e[5]=a}else a=e[5];var l;e[6]!==g?(l=k.jsx(c("MWXColumn.react"),{expanding:!0,paddingHorizontal:16,paddingVertical:16,children:k.jsx(c("MWXColumnItem.react"),{expanding:!0,children:g})}),e[6]=g,e[7]=l):l=e[7];var m;e[8]!==a||e[9]!==l?(m=k.jsx(b("cr:3020"),babelHelpers["extends"]({},a,{children:l})),e[8]=a,e[9]=l,e[10]=m):m=e[10];return m}if(b("cr:6827")!=null){e[11]!==f||e[12]!==g||e[13]!==j?(a=k.jsx(b("cr:6827"),babelHelpers["extends"]({hasTextOnlyContent:j},f,{children:g})),e[11]=f,e[12]=g,e[13]=j,e[14]=a):a=e[14];return a}return null}g["default"]=a}),98);
__d("MWXDialogFooter.react",["MWXSpinner.react","cr:6993","cr:9720","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h=["callToActionGroupDirection","callToActionGroupWrap","primaryCallToAction","secondaryCallToAction"],i=["disabled","loading"],j,k=j||d("react");function a(a){var e=d("react-compiler-runtime").c(29),f,g,j,l,m;e[0]!==a?(g=a.callToActionGroupDirection,j=a.callToActionGroupWrap,l=a.primaryCallToAction,m=a.secondaryCallToAction,f=babelHelpers.objectWithoutPropertiesLoose(a,h),e[0]=a,e[1]=f,e[2]=g,e[3]=j,e[4]=l,e[5]=m):(f=e[1],g=e[2],j=e[3],l=e[4],m=e[5]);if(b("cr:9720")!=null){a=l!=null?l:m;var n=l==null?null:m;if(a==null)return null;var o,p,q;e[6]!==a?(o=a.disabled,p=a.loading,q=babelHelpers.objectWithoutPropertiesLoose(a,i),e[6]=a,e[7]=o,e[8]=p,e[9]=q):(o=e[7],p=e[8],q=e[9]);var r;e[10]!==p?(r=p===!0?k.jsx(c("MWXSpinner.react"),{color:"blue",size:24}):void 0,e[10]=p,e[11]=r):r=e[11];r=r;p=p===!0?!0:o;o=a.type==="destructive"?"fdsOverride_negative":a.type;e[12]!==r||e[13]!==q||e[14]!==p||e[15]!==o?(a=babelHelpers["extends"]({},q,{addOnPrimary:r,disabled:p,type:o}),e[12]=r,e[13]=q,e[14]=p,e[15]=o,e[16]=a):a=e[16];e[17]!==f||e[18]!==g||e[19]!==j||e[20]!==n||e[21]!==a?(r=k.jsx(b("cr:9720"),babelHelpers["extends"]({direction:g,primary:a,secondary:n,wrap:j},f)),e[17]=f,e[18]=g,e[19]=j,e[20]=n,e[21]=a,e[22]=r):r=e[22];return r}if(b("cr:6993")!=null){e[23]!==f||e[24]!==g||e[25]!==j||e[26]!==l||e[27]!==m?(q=k.jsx(b("cr:6993"),babelHelpers["extends"]({callToActionGroupDirection:g,callToActionGroupWrap:j,primaryCallToAction:l,secondaryCallToAction:m},f)),e[23]=f,e[24]=g,e[25]=j,e[26]=l,e[27]=m,e[28]=q):q=e[28];return q}return null}g["default"]=a}),98);
__d("MWXDialogHeader.react",["cr:73","cr:7626","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h=["mdsTitleLayout","showTruncationTooltip","title","titleImageAddOn","withoutDivider"],i,j=i||d("react");function a(a){var c=d("react-compiler-runtime").c(18),e,f,g,i,k,l;c[0]!==a?(f=a.mdsTitleLayout,g=a.showTruncationTooltip,i=a.title,k=a.titleImageAddOn,l=a.withoutDivider,e=babelHelpers.objectWithoutPropertiesLoose(a,h),c[0]=a,c[1]=e,c[2]=f,c[3]=g,c[4]=i,c[5]=k,c[6]=l):(e=c[1],f=c[2],g=c[3],i=c[4],k=c[5],l=c[6]);a=g===void 0?!0:g;if(b("cr:7626")!=null){g=i!=null?i:void 0;var m;c[7]!==e||c[8]!==a||c[9]!==g||c[10]!==k||c[11]!==l?(m=j.jsx(b("cr:7626"),babelHelpers["extends"]({text:g,titleImageAddOn:k},e,{showTruncationTooltip:a,withoutDivider:l})),c[7]=e,c[8]=a,c[9]=g,c[10]=k,c[11]=l,c[12]=m):m=c[12];return m}if(b("cr:73")!=null){c[13]!==e||c[14]!==f||c[15]!==i||c[16]!==k?(a=j.jsx(b("cr:73"),babelHelpers["extends"]({title:i,titleImageAddOn:k,titleLayout:f},e)),c[13]=e,c[14]=f,c[15]=i,c[16]=k,c[17]=a):a=c[17];return a}return null}g["default"]=a}),98);
__d("MessageRequestsBulkActionConfirmedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("256");b=d("FalcoLoggerInternal").create("message_requests_bulk_action_confirmed",a);e=b;g["default"]=e}),98);
__d("MessageRequestsBulkActionEditFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("2614");b=d("FalcoLoggerInternal").create("message_requests_bulk_action_edit",a);e=b;g["default"]=e}),98);
__d("MessageRequestsBulkActionTappedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("257");b=d("FalcoLoggerInternal").create("message_requests_bulk_action_tapped",a);e=b;g["default"]=e}),98);
__d("MessageRequestsInfoBannerShownFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("258");b=d("FalcoLoggerInternal").create("message_requests_info_banner_shown",a);e=b;g["default"]=e}),98);
__d("MessageRequestsThreadActionConfirmedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("259");b=d("FalcoLoggerInternal").create("message_requests_thread_action_confirmed",a);e=b;g["default"]=e}),98);
__d("MessageRequestsThreadActionTappedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("260");b=d("FalcoLoggerInternal").create("message_requests_thread_action_tapped",a);e=b;g["default"]=e}),98);
__d("MessageRequestsThreadDenialOptionsTappedFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("261");b=d("FalcoLoggerInternal").create("message_requests_thread_denial_options_tapped",a);e=b;g["default"]=e}),98);
__d("MessageRequestsViewThreadlistFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("263");b=d("FalcoLoggerInternal").create("message_requests_view_threadlist",a);e=b;g["default"]=e}),98);
__d("MetaAiIntentsImageEditingEventsFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("5317");b=d("FalcoLoggerInternal").create("meta_ai_intents_image_editing_events",a);e=b;g["default"]=e}),98);
__d("ZenonUserActionLoggerCommon",["ZenonUserActionLogger"],(function(a,b,c,d,e,f,g){"use strict";g.logClick=c("ZenonUserActionLogger").logClick,g.logImpression=c("ZenonUserActionLogger").logImpression}),98);/*FB_PKG_DELIM*/
__d("CometColumnHideable.react",["BaseView.react","BaseViewHideable.react","CometColumnContext","CometColumnItem.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h=["ref","align","children","expanding","hasDividers","paddingHorizontal","paddingTop","paddingVertical","spacing","verticalAlign","xstyle"],i,j=i||(i=d("react"));b=i;var k=b.useContext;b.useMemo;var l={expanding:{flexBasis:"x1l7klhg",flexGrow:"x1iyjqo2",flexShrink:"xs83m0k",minHeight:"x2lwn1j",$$css:!0},inner:{display:"x78zum5",flexDirection:"xdt5ytf",flexGrow:"x1iyjqo2",minHeight:"x2lwn1j",$$css:!0},root:{boxSizing:"x9f619",display:"x78zum5",flexDirection:"xdt5ytf",flexShrink:"x2lah0s",maxWidth:"x193iq5w",$$css:!0}},m={0:{paddingTop:"xexx8yu",$$css:!0},4:{paddingTop:"x1iorvi4",$$css:!0},8:{paddingTop:"x1y1aw1k",$$css:!0},12:{paddingTop:"xz9dl7a",$$css:!0},16:{paddingTop:"xyamay9",$$css:!0},20:{paddingTop:"x1cnzs8",$$css:!0},40:{paddingTop:"x13zrc24",$$css:!0}},n={4:{paddingTop:"x1iorvi4",paddingBottom:"xjkvuk6",$$css:!0},8:{paddingTop:"x1y1aw1k",paddingBottom:"xwib8y2",$$css:!0},12:{paddingTop:"xz9dl7a",paddingBottom:"xsag5q8",$$css:!0},16:{paddingTop:"xyamay9",paddingBottom:"x1l90r2v",$$css:!0},20:{paddingTop:"x1cnzs8",paddingBottom:"xx6bls6",$$css:!0},40:{paddingTop:"x13zrc24",paddingBottom:"x1t1ogtf",$$css:!0}},o={bottom:{justifyContent:"x13a6bvl",$$css:!0},center:{justifyContent:"xl56j7k",$$css:!0},"space-between":{justifyContent:"x1qughib",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(39),e,f,g,i,p,q,r,s,t,u,v,w;b[0]!==a?(i=a.ref,p=a.align,e=a.children,q=a.expanding,r=a.hasDividers,s=a.paddingHorizontal,f=a.paddingTop,t=a.paddingVertical,u=a.spacing,v=a.verticalAlign,w=a.xstyle,g=babelHelpers.objectWithoutPropertiesLoose(a,h),b[0]=a,b[1]=e,b[2]=f,b[3]=g,b[4]=i,b[5]=p,b[6]=q,b[7]=r,b[8]=s,b[9]=t,b[10]=u,b[11]=v,b[12]=w):(e=b[1],f=b[2],g=b[3],i=b[4],p=b[5],q=b[6],r=b[7],s=b[8],t=b[9],u=b[10],v=b[11],w=b[12]);a=p===void 0?null:p;p=q===void 0?!1:q;q=r===void 0?!1:r;r=s===void 0?null:s;s=t===void 0?0:t;t=u===void 0?null:u;u=v===void 0?"top":v;v=k(c("CometColumnContext"));var x;b[13]!==a||b[14]!==q||b[15]!==r||b[16]!==t?(x={align:a,hasDividers:q,paddingHorizontal:r,spacing:t},b[13]=a,b[14]=q,b[15]=r,b[16]=t,b[17]=x):x=b[17];a=x;q=a;r=p===!0&&l.expanding;t=n[s];x=f!=null&&m[f];b[18]!==r||b[19]!==t||b[20]!==x||b[21]!==w?(a=[l.root,r,t,x,w],b[18]=r,b[19]=t,b[20]=x,b[21]=w,b[22]=a):a=b[22];s=u!=="top"&&o[u];b[23]!==s?(f=[l.inner,s],b[23]=s,b[24]=f):f=b[24];b[25]!==e||b[26]!==q?(r=j.jsx(c("CometColumnContext").Provider,{value:q,children:e}),b[25]=e,b[26]=q,b[27]=r):r=b[27];b[28]!==f||b[29]!==r?(t=j.jsx(c("BaseView.react"),{xstyle:f,children:r}),b[28]=f,b[29]=r,b[30]=t):t=b[30];b[31]!==g||b[32]!==i||b[33]!==a||b[34]!==t?(x=j.jsx(c("BaseViewHideable.react"),babelHelpers["extends"]({},g,{ref:i,xstyle:a,children:t})),b[31]=g,b[32]=i,b[33]=a,b[34]=t,b[35]=x):x=b[35];w=x;if(v!=null){u=p!=null?p:void 0;b[36]!==w||b[37]!==u?(s=j.jsx(c("CometColumnItem.react"),{expanding:u,children:w}),b[36]=w,b[37]=u,b[38]=s):s=b[38];return s}return w}g["default"]=a}),98);
__d("CometColumnItemHideable.react",["BaseView.react","BaseViewHideable.react","CometColumnContext","CometErrorBoundary.react","CometPlaceholder.react","XPlatReactEnvironment","react","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h=["ref"],i=["align","children","expanding","fallback","paddingHorizontal","paddingTop","paddingVertical","placeholder","verticalAlign"],j=["fallback"],k=["placeholder"],l,m,n=m||(m=d("react")),o=m.useContext,p={divider:{borderTopColor:"x8cjs6t",borderTopStyle:"x13fuv20",borderTopWidth:"x178xt8z",$$css:!0},expanding:{flexBasis:"x1l7klhg",flexGrow:"x1iyjqo2",flexShrink:"xs83m0k",minHeight:"x2lwn1j",$$css:!0},root:{display:"x78zum5",flexDirection:"xdt5ytf",flexShrink:"x2lah0s",maxWidth:"x193iq5w",$$css:!0}},q={divider:{display:"xh99ass",$$css:!0},dividerMargin:{":first-child:empty + *_marginTop":"xb939ph",$$css:!0},marginFirstChild:{":first-child_marginTop":"x14l7nz5",$$css:!0},marginLastChild:{":last-child_marginBottom":"xzboxd6",$$css:!0}},r={center:{alignItems:"x6s0dn4",$$css:!0},end:{alignItems:"xuk3077",$$css:!0},start:{alignItems:"x1cy8zhl",$$css:!0}},s={4:{paddingInlineStart:"x135b78x",paddingInlineEnd:"x11lfxj5",paddingLeft:null,paddingRight:null,$$css:!0},8:{paddingInlineStart:"xmzvs34",paddingInlineEnd:"xf159sx",paddingLeft:null,paddingRight:null,$$css:!0},12:{paddingInlineStart:"x1g0dm76",paddingInlineEnd:"xpdmqnj",paddingLeft:null,paddingRight:null,$$css:!0},16:{paddingInlineStart:"xf7dkkf",paddingInlineEnd:"xv54qhq",paddingLeft:null,paddingRight:null,$$css:!0},20:{paddingInlineStart:"x106a9eq",paddingInlineEnd:"x1xnnf8n",paddingLeft:null,paddingRight:null,$$css:!0}},t={0:{paddingTop:"xexx8yu",$$css:!0},4:{paddingTop:"x1iorvi4",$$css:!0},8:{paddingTop:"x1y1aw1k",$$css:!0},12:{paddingTop:"xz9dl7a",$$css:!0},16:{paddingTop:"xyamay9",$$css:!0},20:{paddingTop:"x1cnzs8",$$css:!0},24:{paddingTop:"x1p5oq8j",$$css:!0},40:{paddingTop:"x13zrc24",$$css:!0}},u={4:{paddingTop:"x1iorvi4",paddingBottom:"xjkvuk6",$$css:!0},8:{paddingTop:"x1y1aw1k",paddingBottom:"xwib8y2",$$css:!0},12:{paddingTop:"xz9dl7a",paddingBottom:"xsag5q8",$$css:!0},16:{paddingTop:"xyamay9",paddingBottom:"x1l90r2v",$$css:!0},20:{paddingTop:"x1cnzs8",paddingBottom:"xx6bls6",$$css:!0},24:{paddingTop:"x1p5oq8j",paddingBottom:"xwxc41k",$$css:!0},40:{paddingTop:"x13zrc24",paddingBottom:"x1t1ogtf",$$css:!0}},v={4:{marginTop:"xr9ek0c",marginBottom:"xjpr12u",$$css:!0},8:{marginTop:"x1gslohp",marginBottom:"x12nagc",$$css:!0},12:{marginTop:"x1k70j0n",marginBottom:"xzueoph",$$css:!0},16:{marginTop:"x1xmf6yo",marginBottom:"x1e56ztr",$$css:!0},20:{marginTop:"x1anpbxc",marginBottom:"xyorhqc",$$css:!0},24:{marginTop:"x14vqqas",marginBottom:"xod5an3",$$css:!0},32:{marginTop:"xw7yly9",marginBottom:"x1yztbdb",$$css:!0},40:{marginTop:"x1sy10c2",marginBottom:"xieb3on",$$css:!0}},w={bottom:{justifyContent:"x13a6bvl",$$css:!0},center:{justifyContent:"xl56j7k",$$css:!0},"space-between":{justifyContent:"x1qughib",$$css:!0}},x={4:{marginInlineStart:"xdwrcjd",marginInlineEnd:"x2fvf9",marginLeft:null,marginRight:null,$$css:!0},8:{marginInlineStart:"x13fj5qh",marginInlineEnd:"x1xegmmw",marginLeft:null,marginRight:null,$$css:!0},12:{marginInlineStart:"x1diwwjn",marginInlineEnd:"xbmvrgn",marginLeft:null,marginRight:null,$$css:!0},16:{marginInlineStart:"xyqm7xq",marginInlineEnd:"x1ys307a",marginLeft:null,marginRight:null,$$css:!0},20:{marginInlineStart:"xqsn43r",marginInlineEnd:"x3aesyq",marginLeft:null,marginRight:null,$$css:!0}};function y(a){var b,e,f,g,m=a.ref;a=babelHelpers.objectWithoutPropertiesLoose(a,h);b=(b=o(c("CometColumnContext")))!=null?b:{};var z=a.align;e=z===void 0?(e=b.align)!=null?e:"stretch":z;z=a.children;var A=a.expanding;A=A===void 0?!1:A;var B=a.fallback,C=a.paddingHorizontal;f=C===void 0?(f=b.paddingHorizontal)!=null?f:0:C;C=a.paddingTop;var D=a.paddingVertical;D=D===void 0?0:D;var E=a.placeholder,F=a.verticalAlign;F=F===void 0?"top":F;var G=babelHelpers.objectWithoutPropertiesLoose(a,i),H=(l||(l=c("stylex"))).compose(a.xstyle);g=n.jsxs(n.Fragment,{children:[b.hasDividers===!0&&n.jsx(c("BaseView.react"),{role:"separator",xstyle:[p.divider,d("XPlatReactEnvironment").isWeb()&&q.divider,x[(g=b.paddingHorizontal)!=null?g:0],d("XPlatReactEnvironment").isWeb()&&b.spacing!=null&&q.dividerMargin]}),n.jsx(c("BaseViewHideable.react"),babelHelpers["extends"]({},G,{ref:m,xstyle:[p.root,A&&p.expanding,e!=="stretch"&&r[e],F!=="top"&&w[F],s[f],u[D],C!=null&&t[C],b.spacing!=null&&[v[b.spacing],d("XPlatReactEnvironment").isWeb()&&H.marginBottom==null&&q.marginLastChild,d("XPlatReactEnvironment").isWeb()&&H.marginTop==null&&q.marginFirstChild],a.xstyle],children:n.jsx(c("CometColumnContext").Provider,{value:null,children:z})}))]});if(B!==void 0){a.fallback;var I=babelHelpers.objectWithoutPropertiesLoose(a,j);B===null?g=n.jsx(c("CometErrorBoundary.react"),{children:g}):g=n.jsx(c("CometErrorBoundary.react"),{fallback:function(a,b){return n.jsx(y,babelHelpers["extends"]({},I,{ref:m,children:typeof B==="function"?B(a,b):B}))},children:g})}if(E!==void 0){a.placeholder;G=babelHelpers.objectWithoutPropertiesLoose(a,k);g=n.jsx(c("CometPlaceholder.react"),{fallback:E!=null?n.jsx(y,babelHelpers["extends"]({},G,{ref:m,children:E})):null,children:g})}return g}y.displayName=y.name+" [from "+f.id+"]";g["default"]=y}),98);/*FB_PKG_DELIM*/
__d("CometSharingSessionIDUtil",["uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h=c("uuidv4")(),i=null,j=!1;a=function(){return h};b=function(){return i};d=function(){return j};e=function(a){j=a};f=function(){i=h,j=!1,h=c("uuidv4")()};f={genNext:f,getIsAnythingSharedInCurrentSession:d,getPreviousSharingSessionID:b,getSharingSessionID:a,setIsAnythingSharedInCurrentSession:e};g["default"]=f}),98);
__d("CometUFIShareActionLinkMenuQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="23986436374297267"}),null);
__d("CometUFIShareActionLinkMenuQuery$Parameters",["CometUFIShareActionLinkMenuQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a={kind:"PreloadableConcreteRequest",params:{id:b("CometUFIShareActionLinkMenuQuery_facebookRelayOperation"),metadata:{},name:"CometUFIShareActionLinkMenuQuery",operationKind:"query",text:null}};e.exports=a}),null);
__d("CometUFIShareActionLinkMenu.entrypoint",["CometUFIShareActionLinkMenuQuery$Parameters","JSResourceForInteraction"],(function(a,b,c,d,e,f,g){"use strict";a={getPreloadProps:function(a){var c=a.feedLocation,d=a.qe_optional_share_to_page,e=a.storyUrl;a=a.url;return{extraProps:{},queries:{shareMenuQueryReference:{parameters:b("CometUFIShareActionLinkMenuQuery$Parameters"),variables:{feedLocation:c,hasParentStory:e!=null,qe_optional_share_to_page:d!=null?d:!1,shareableParams:{url:a},storyParams:{url:e}}}}}},root:c("JSResourceForInteraction")("CometUFIShareActionLinkMenu.react").__setRef("CometUFIShareActionLinkMenu.entrypoint")};g["default"]=a}),98);
__d("UnifiedShareSheetHScrollTilesItemPlaceholder.react",["CometColumn.react","CometColumnItem.react","FDSGlimmer.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j={glimmer:{borderStartStartRadius:"x16qb05n",borderStartEndRadius:"xi7iut8",borderEndEndRadius:"x1dm3dyd",borderEndStartRadius:"x1pv694p",height:"xlup9mm",width:"x1fxk84t",$$css:!0},profilePhotoGlimmer:{borderStartStartRadius:"x120xd9q",borderStartEndRadius:"x1k4ovr2",borderEndEndRadius:"xdfaw6k",borderEndStartRadius:"xefzod",height:"xng8ra",width:"x1247r65",$$css:!0},root:{height:"xnfxvih",width:"x19v3vle",$$css:!0}};function a(){var a=d("react-compiler-runtime").c(2),b;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b=i.jsx(c("CometColumnItem.react"),{children:i.jsx(c("FDSGlimmer.react"),{index:0,xstyle:j.profilePhotoGlimmer})}),a[0]=b):b=a[0];a[1]===Symbol["for"]("react.memo_cache_sentinel")?(b=i.jsxs(c("CometColumn.react"),{align:"center",paddingVertical:8,spacing:8,xstyle:j.root,children:[b,i.jsx(c("CometColumnItem.react"),{children:i.jsx(c("FDSGlimmer.react"),{index:0,xstyle:j.glimmer})})]}),a[1]=b):b=a[1];return b}g["default"]=a}),98);
__d("usePopPage",["BaseMultiPageViewContext","react","recoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");b.useCallback;var i=b.useContext;function a(){var a=i(c("BaseMultiPageViewContext")),b=j;return a==null?b:(b=a.popPage)!=null?b:null}function j(){c("recoverableViolation")("usePopPage can only be used inside BaseMultiPageView.","BaseMultiPageView")}g["default"]=a}),98);
__d("useShareLogger",["CometSharingSessionIDUtil","CometTrackingCodeContext","getVideoShareDownstreamSignalTracking","react","requireDeferred","useMinifiedProductAttribution"],(function(a,b,c,d,e,f,g){"use strict";var h=["is_anything_shared_in_current_session"],i;function j(a){if(null==a)throw new TypeError("Cannot destructure "+a)}b=i||d("react");var k=b.useCallback,l=b.useContext,m=b.useMemo,n=c("requireDeferred")("FbSharingEventFalcoEvent").__setRef("useShareLogger");function a(){var a=c("useMinifiedProductAttribution")(),b=l(c("CometTrackingCodeContext")),e=m(function(){var a;return(a=d("getVideoShareDownstreamSignalTracking").getVideoShareDownstreamSignalTracking())!=null?a:{}},[]),f=k(function(d){var f=babelHelpers["extends"]({},(j(d),d));c("CometSharingSessionIDUtil").genNext();n.onReady(function(d){return d.log(function(){var d;return babelHelpers["extends"]({event_type:"tap",feed_tracking:f.feed_tracking!=null?f.feed_tracking:b.encrypted_tracking,navigation_chain:a||"",shareable_entity_audience:"unknown",sharing_component_name:(d=f.sharing_component_name)!=null?d:"ufi_share_button",sharing_session_id:c("CometSharingSessionIDUtil").getSharingSessionID()},f,e)})})},[a,b.encrypted_tracking,e]),g=k(function(d){var f=babelHelpers["extends"]({},(j(d),d));c("CometSharingSessionIDUtil").genNext();n.onReady(function(d){return d.log(function(){return babelHelpers["extends"]({entry_point:"stories",event_type:"tap",feed_tracking:f.feed_tracking!=null?f.feed_tracking:b.encrypted_tracking,navigation_chain:a||"",shareable_entity_audience:"private",sharing_session_id:c("CometSharingSessionIDUtil").getSharingSessionID()},f,e)})})},[a,b.encrypted_tracking,e]),i=k(function(d){var f=d.is_anything_shared_in_current_session;f=f===void 0?!0:f;var g=babelHelpers.objectWithoutPropertiesLoose(d,h);g.sharing_component_name==="ufi_send_in_messenger_button"&&c("CometSharingSessionIDUtil").genNext();g.sharing_component_name==="send_in_messenger_button"&&c("CometSharingSessionIDUtil").setIsAnythingSharedInCurrentSession(f);n.onReady(function(d){return d.log(function(){return babelHelpers["extends"]({event_type:"tap",feed_tracking:g.feed_tracking!=null?g.feed_tracking:b.encrypted_tracking,navigation_chain:a||"",shareable_entity_audience:"private",sharing_session_id:c("CometSharingSessionIDUtil").getSharingSessionID()},g,e)})})},[a,b.encrypted_tracking,e]);return{onOpenBCFButtonClicked:i,onOpenSharesheetButtonClicked:f,onSharingCopyLinkClicked:g}}g["default"]=a}),98);/*FB_PKG_DELIM*/
__d("LSEBUnifiedRestoreUtils",["CurrentUser","LSIntEnum","LSMEBTaskCreationSource","LSProtobufRestoreHandler","LSVec","MAWAsyncEBPendingQueryPromise","MAWBridgeSafeActionsWorkerAndUI","MAWEBRestoreTrackingUtils","MAWEBUnstoredDbMsgUtils","MAWEncryptedBackupUtils","MAWEncryptedBackupsDYIHandleMessageRestore","MAWJids","MAWJobDefinitions","MAWRestoreProtobufsFromEncryptedBackupsDeferred","MWEBODSEntityName.enum","MWEBODSUtils","WATagsLogger","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n;async function a(a,b,e,f,g,o,p,q,r,s,t,u,v){d("WATagsLogger").TAGS(["labyrinth_web","eb_restore",q!=null?q:"no_request_id"]).LOG(h||(h=babelHelpers.taggedTemplateLiteralLoose(["starting eb restore - ",""])),q!=null?q:"no_request_id");d("MWEBODSUtils").markODSForEB(c("MWEBODSEntityName.enum").MAW_EB_RESTORE_COUNTER,"unified_restore");var w=[].concat(d("MAWEncryptedBackupUtils").convertLSTypesToJSTypesForRestoreJob(b));t=d("LSProtobufRestoreHandler").convertLSEchoMessageVecToArray(t);t=await d("MAWBridgeSafeActionsWorkerAndUI").sendAndReceiveBackendWorkerAndUIShared("convertEchoMessagesToEBProtobufs",{chatJid:v,encodedEchoMessages:t});w.push.apply(w,t);d("MAWEncryptedBackupUtils").logIfDuplicateMessagesFoundInRestore(w,"protobuf_restore");if(q!=null)try{d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"native_op_start_unified",traceId:q});t=d("MAWJids").toUserJid(c("CurrentUser").getAccountID());t=d("MAWEBUnstoredDbMsgUtils").getUnstoredDbMsgFromProtobuf(w,a,void 0,t);if(e===!0&&t.length===0){d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"hasMoreBefore_decodedMessages_inconsistency",traceId:q});b=b!=null?c("LSVec").toArray(b).length:0;d("WATagsLogger").TAGS(["labyrinth_web","eb_restore",q!=null?q:"no_request_id"]).ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["eb restore nativeop - no decoded messages but hasMoreBefore is true, messages count after decryption: ",""])),b)}d("MAWAsyncEBPendingQueryPromise").resolvePendingQueryIfPresent(q,{echoMessages:void 0,hasMoreAfter:g,hasMoreBefore:e,isPointQuery:p,messages:t,nextMessageTimestampMsBefore:f,protobufMessages:w,referenceTimestamp:r,requestId:q,restoreType:"protobuf",threadId:a})}catch(a){d("WATagsLogger").TAGS(["labyrinth_web","eb_restore",q!=null?q:"no_request_id"]).ERROR(j||(j=babelHelpers.taggedTemplateLiteralLoose(["eb restore native op - Failed to decode protobufs, with error: ",""])),a.message)}e===!0&&w.length===0&&(q!=null&&d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"hasMoreBefore_messages_inconsistency",traceId:q}),d("WATagsLogger").TAGS(["labyrinth_web","eb_restore",q!=null?q:"no_request_id"]).ERROR(k||(k=babelHelpers.taggedTemplateLiteralLoose(["eb restore nativeop - no messages but hasMoreBefore is true"]))));b=u!=null&&(n||(n=d("LSIntEnum"))).unwrapIntEnum(u)===c("LSMEBTaskCreationSource").FTS_INDEX_EB_MESSAGES_WEB;if(b){q!=null&&d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"search_restore_end",traceId:q});d("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(q);return Promise.resolve()}t=u!=null&&(n||(n=d("LSIntEnum"))).unwrapIntEnum(u)===c("LSMEBTaskCreationSource").MSGR_DYI;if(t){d("WATagsLogger").TAGS(["labyrinth_web","eb_restore",q!=null?q:"no_request_id"]).LOG(l||(l=babelHelpers.taggedTemplateLiteralLoose(["Restoring Messenger DYI batch"])));await d("MAWEncryptedBackupsDYIHandleMessageRestore").handleMAWProtobufMessageRangeQueryRestore(a,w,e,f);q!=null&&d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"dyi_restore_end",traceId:q});d("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(q);return Promise.resolve()}c("promiseDone")(d("MAWRestoreProtobufsFromEncryptedBackupsDeferred").call("AdvancedCrypto",d("MAWJobDefinitions").toThreadJidPrimaryId(a),w,e,f,g,o,p,q,r,s,void 0,u,void 0,v),function(){q!=null&&d("MAWEBRestoreTrackingUtils").addQPLRestorePoint({pointName:"native_op_end_unified",traceId:q})},function(a){d("WATagsLogger").TAGS(["labyrinth_web","eb_restore",q!=null?q:"no_request_id"]).ERROR(m||(m=babelHelpers.taggedTemplateLiteralLoose(["eb restore nativeop - Failed to restore protobufs, with error: ",""])),a.message);a={string:{error:a.message}};q!=null&&d("MAWEBRestoreTrackingUtils").markEBRestoreFail(q,!1,"native_op_reject_unified",a)});return Promise.resolve()}g.echoProtobufConsolidatedRestoreHelper=a}),98);
__d("MWFDSMobile.svg.react",["cr:21715"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:21715")}),98);/*FB_PKG_DELIM*/
__d("BaseMiddotSeparator.react",["BaseMiddot.react","react","react-compiler-runtime","react-strict-dom"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(10),e=a.children,f=a["aria-label"],g=a["aria-labelledby"];a=a.asList;var h=a===void 0?!1:a;if(b[0]!==h||b[1]!==e){b[3]!==h?(a=function(a,b){return i.jsxs(j,{asList:h,children:[b!==0?i.jsx(c("BaseMiddot.react"),{}):null,a]},b)},b[3]=h,b[4]=a):a=b[4];a=i.Children.toArray(e).filter(Boolean).map(a);b[0]=h;b[1]=e;b[2]=a}else a=b[2];e=a;b[5]!==f||b[6]!==g||b[7]!==h||b[8]!==e?(a=h?i.jsx(d("react-strict-dom").html.span,{"aria-label":f!=null?f:void 0,"aria-labelledby":g!=null?g:void 0,role:"list",children:e}):e,b[5]=f,b[6]=g,b[7]=h,b[8]=e,b[9]=a):a=b[9];return a}function j(a){var b=d("react-compiler-runtime").c(3),c=a.asList;a=a.children;var e;b[0]!==c||b[1]!==a?(e=c?i.jsx(d("react-strict-dom").html.span,{role:"listitem",children:a}):a,b[0]=c,b[1]=a,b[2]=e):e=b[2];return e}g["default"]=a}),98);
__d("CometFeedStoryMusicPostLevelAttributionDialogQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="24324621813794076"}),null);
__d("FDSCrossCircleFilled16Icon",["cr:13871"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:13871")}),98);
__d("FDSCrossCircleFilled16PNGIcon.react",["ix","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";a=d("fbicon")._(h("491580"),16);b=a;g["default"]=b}),98);
__d("FDSPlayFilled16Icon",["cr:15440"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:15440")}),98);
__d("FDSPlayFilled16PNGIcon.react",["ix","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";a=d("fbicon")._(h("484862"),16);b=a;g["default"]=b}),98);
__d("XCometEventsExploreControllerRouteBuilder",["jsRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsRouteBuilder")("/events/explore/{location_name}/{location_id}/{?time}/",Object.freeze({}),void 0);b=a;g["default"]=b}),98);/*FB_PKG_DELIM*/
__d("FDSBeachFilled24Icon",["cr:14518"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:14518")}),98);
__d("FDSBeachFilled24PNGIcon.react",["ix","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";a=d("fbicon")._(h("1210826"),24);b=a;g["default"]=b}),98);
__d("FDSBriefcaseFilled20Icon",["cr:14565"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:14565")}),98);
__d("FDSBriefcaseFilled20PNGIcon.react",["ix","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";a=d("fbicon")._(h("481905"),20);b=a;g["default"]=b}),98);
__d("FDSCheckmarkCircleFilled12Icon",["cr:13864"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:13864")}),98);
__d("FDSCheckmarkCircleFilled12PNGIcon.react",["ix","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";a=d("fbicon")._(h("498144"),12);b=a;g["default"]=b}),98);
__d("FDSClockFilled12Icon",["cr:14740"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:14740")}),98);
__d("FDSClockFilled12PNGIcon.react",["ix","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";a=d("fbicon")._(h("478791"),12);b=a;g["default"]=b}),98);
__d("FDSClockFilled20Icon",["cr:13869"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:13869")}),98);
__d("FDSClockFilled20PNGIcon.react",["ix","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";a=d("fbicon")._(h("478795"),20);b=a;g["default"]=b}),98);
__d("FDSDollarCircleFilled20Icon",["cr:14844"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:14844")}),98);
__d("FDSDollarCircleFilled20PNGIcon.react",["ix","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";a=d("fbicon")._(h("480625"),20);b=a;g["default"]=b}),98);
__d("FDSDollarCircleFilled24Icon",["cr:14845"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:14845")}),98);
__d("FDSFriendNeutralFilled20Icon",["cr:14221"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:14221")}),98);
__d("FDSFriendNeutralFilled20PNGIcon.react",["ix","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";a=d("fbicon")._(h("481919"),20);b=a;g["default"]=b}),98);
__d("FDSGroupFilled16Icon",["cr:14032"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:14032")}),98);
__d("FDSGroupFilled16PNGIcon.react",["ix","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";a=d("fbicon")._(h("485088"),16);b=a;g["default"]=b}),98);
__d("FDSGroupFilled24Icon",["cr:14033"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:14033")}),98);
__d("FDSGroupFilled24PNGIcon.react",["ix","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";a=d("fbicon")._(h("485094"),24);b=a;g["default"]=b}),98);
__d("FDSInternetFilled20Icon",["cr:14224"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:14224")}),98);
__d("FDSInternetFilled20PNGIcon.react",["ix","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";a=d("fbicon")._(h("487622"),20);b=a;g["default"]=b}),98);
__d("FDSPinLocationFilled20Icon",["cr:15428"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:15428")}),98);
__d("FDSPinLocationFilled20PNGIcon.react",["ix","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";a=d("fbicon")._(h("562643"),20);b=a;g["default"]=b}),98);
__d("FDSPostFilled20Icon",["cr:15482"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:15482")}),98);
__d("FDSPostFilled20PNGIcon.react",["ix","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";a=d("fbicon")._(h("729676"),20);b=a;g["default"]=b}),98);
__d("FDSProfileFilled24Icon",["cr:13851"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:13851")}),98);
__d("FDSShoppingBagFilled20Icon",["cr:15655"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:15655")}),98);
__d("FDSShoppingBagFilled20PNGIcon.react",["ix","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";a=d("fbicon")._(h("556467"),20);b=a;g["default"]=b}),98);
__d("FDSStarFilled12Icon",["cr:15696"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:15696")}),98);
__d("FDSStarFilled12PNGIcon.react",["ix","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";a=d("fbicon")._(h("479321"),12);b=a;g["default"]=b}),98);
__d("XCometEventCreateControllerRouteBuilder",["jsRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsRouteBuilder")("/events/create/",Object.freeze({default_is_online:!1,dialog_entry_point:"others"}),void 0);b=a;g["default"]=b}),98);
__d("XCometMarketplaceComposerControllerRouteBuilder",["jsRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsRouteBuilder")("/marketplace/create/{listing_type}/",Object.freeze({shipping:!1}),void 0);b=a;g["default"]=b}),98);/*FB_PKG_DELIM*/
__d("EBMinosDisableLabyrinth10Uploads",["gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("gkx")("16675")}g.disableLabyrinth10Uploads=a}),98);
__d("EncryptedBackupsUploadQueue",["EBMinosDisableLabyrinth10Uploads","EncryptedBackupsUploadEntity","MWEBODSEntityName.enum","MWEBODSUtils","PersistedQueueApi","Promise","QPLUserFlow","WAPersistedQueue","WATagsLogger","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=d("WATagsLogger").TAGS(["EbUploadQueue"]),l=null;function m(){return l==null?n():l}function n(){l!=null&&k.ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["EB Upload Queue is already initialized"])));var a=d("WAPersistedQueue").initPersistedQueue("ebUploadQueue",d("PersistedQueueApi").persistedQueueApi());l=a;return a}function a(a){if(a.length===0||d("EBMinosDisableLabyrinth10Uploads").disableLabyrinth10Uploads())return(j||(j=b("Promise"))).resolve();d("MWEBODSUtils").markODSForEB(c("MWEBODSEntityName.enum").MAW_EB_UPLOAD_COUNTER,"upload.api.put",a.length);var e=m();return e.addAndCommit(a.map(d("EncryptedBackupsUploadEntity").asEBUploadEntity)).then(function(){a.forEach(function(a){(a==null?void 0:a.instanceKey)!=null&&c("QPLUserFlow").endSuccess(c("qpl")._(521477113,"2698"),{instanceKey:a.instanceKey})})})["catch"](function(a){k.ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["Failed to write to ebUploadQueue ",""])),a);return(j||(j=b("Promise"))).reject(a)})}g.logger=k;g.ebUploadQueue=m;g.initEbUploadQueue=n;g.putMsgsToEbUpload=a}),98);